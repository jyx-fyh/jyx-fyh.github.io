<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title></title>
      <link href="/2023/09/20/mrab-regex/docs/Features/"/>
      <url>/2023/09/20/mrab-regex/docs/Features/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><?xml version="1.0" encoding="utf-8" ?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" /><title>README.rst</title><style type="text/css">/*:Author: David Goodger (goodger@python.org):Id: $Id: html4css1.css 7952 2016-07-26 18:15:59Z milde $:Copyright: This stylesheet has been placed in the public domain.Default cascading style sheet for the HTML output of Docutils.See http://docutils.sf.net/docs/howto/html-stylesheets.html for how tocustomize this style sheet.*//* used to remove borders from tables and images */.borderless, table.borderless td, table.borderless th {  border: 0 }table.borderless td, table.borderless th {  /* Override padding for "table.docutils td" with "! important".     The right padding separates the table cells. */  padding: 0 0.5em 0 0 ! important }.first {  /* Override more specific margin styles with "! important". */  margin-top: 0 ! important }.last, .with-subtitle {  margin-bottom: 0 ! important }.hidden {  display: none }.subscript {  vertical-align: sub;  font-size: smaller }.superscript {  vertical-align: super;  font-size: smaller }a.toc-backref {  text-decoration: none ;  color: black }blockquote.epigraph {  margin: 2em 5em ; }dl.docutils dd {  margin-bottom: 0.5em }object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {  overflow: hidden;}/* Uncomment (and remove this text!) to get bold-faced definition list termsdl.docutils dt {  font-weight: bold }*/div.abstract {  margin: 2em 5em }div.abstract p.topic-title {  font-weight: bold ;  text-align: center }div.admonition, div.attention, div.caution, div.danger, div.error,div.hint, div.important, div.note, div.tip, div.warning {  margin: 2em ;  border: medium outset ;  padding: 1em }div.admonition p.admonition-title, div.hint p.admonition-title,div.important p.admonition-title, div.note p.admonition-title,div.tip p.admonition-title {  font-weight: bold ;  font-family: sans-serif }div.attention p.admonition-title, div.caution p.admonition-title,div.danger p.admonition-title, div.error p.admonition-title,div.warning p.admonition-title, .code .error {  color: red ;  font-weight: bold ;  font-family: sans-serif }/* Uncomment (and remove this text!) to get reduced vertical space in   compound paragraphs.div.compound .compound-first, div.compound .compound-middle {  margin-bottom: 0.5em }div.compound .compound-last, div.compound .compound-middle {  margin-top: 0.5em }*/div.dedication {  margin: 2em 5em ;  text-align: center ;  font-style: italic }div.dedication p.topic-title {  font-weight: bold ;  font-style: normal }div.figure {  margin-left: 2em ;  margin-right: 2em }div.footer, div.header {  clear: both;  font-size: smaller }div.line-block {  display: block ;  margin-top: 1em ;  margin-bottom: 1em }div.line-block div.line-block {  margin-top: 0 ;  margin-bottom: 0 ;  margin-left: 1.5em }div.sidebar {  margin: 0 0 0.5em 1em ;  border: medium outset ;  padding: 1em ;  background-color: #ffffee ;  width: 40% ;  float: right ;  clear: right }div.sidebar p.rubric {  font-family: sans-serif ;  font-size: medium }div.system-messages {  margin: 5em }div.system-messages h1 {  color: red }div.system-message {  border: medium outset ;  padding: 1em }div.system-message p.system-message-title {  color: red ;  font-weight: bold }div.topic {  margin: 2em }h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {  margin-top: 0.4em }h1.title {  text-align: center }h2.subtitle {  text-align: center }hr.docutils {  width: 75% }img.align-left, .figure.align-left, object.align-left, table.align-left {  clear: left ;  float: left ;  margin-right: 1em }img.align-right, .figure.align-right, object.align-right, table.align-right {  clear: right ;  float: right ;  margin-left: 1em }img.align-center, .figure.align-center, object.align-center {  display: block;  margin-left: auto;  margin-right: auto;}table.align-center {  margin-left: auto;  margin-right: auto;}.align-left {  text-align: left }.align-center {  clear: both ;  text-align: center }.align-right {  text-align: right }/* reset inner alignment in figures */div.align-right {  text-align: inherit }/* div.align-center * { *//*   text-align: left } */.align-top    {  vertical-align: top }.align-middle {  vertical-align: middle }.align-bottom {  vertical-align: bottom }ol.simple, ul.simple {  margin-bottom: 1em }ol.arabic {  list-style: decimal }ol.loweralpha {  list-style: lower-alpha }ol.upperalpha {  list-style: upper-alpha }ol.lowerroman {  list-style: lower-roman }ol.upperroman {  list-style: upper-roman }p.attribution {  text-align: right ;  margin-left: 50% }p.caption {  font-style: italic }p.credits {  font-style: italic ;  font-size: smaller }p.label {  white-space: nowrap }p.rubric {  font-weight: bold ;  font-size: larger ;  color: maroon ;  text-align: center }p.sidebar-title {  font-family: sans-serif ;  font-weight: bold ;  font-size: larger }p.sidebar-subtitle {  font-family: sans-serif ;  font-weight: bold }p.topic-title {  font-weight: bold }pre.address {  margin-bottom: 0 ;  margin-top: 0 ;  font: inherit }pre.literal-block, pre.doctest-block, pre.math, pre.code {  margin-left: 2em ;  margin-right: 2em }pre.code .ln { color: grey; } /* line numbers */pre.code, code { background-color: #eeeeee }pre.code .comment, code .comment { color: #5C6576 }pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }pre.code .literal.string, code .literal.string { color: #0C5404 }pre.code .name.builtin, code .name.builtin { color: #352B84 }pre.code .deleted, code .deleted { background-color: #DEB0A1}pre.code .inserted, code .inserted { background-color: #A3D289}span.classifier {  font-family: sans-serif ;  font-style: oblique }span.classifier-delimiter {  font-family: sans-serif ;  font-weight: bold }span.interpreted {  font-family: sans-serif }span.option {  white-space: nowrap }span.pre {  white-space: pre }span.problematic {  color: red }span.section-subtitle {  /* font-size relative to parent (h1..h6 element) */  font-size: 80% }table.citation {  border-left: solid 1px gray;  margin-left: 1px }table.docinfo {  margin: 2em 4em }table.docutils {  margin-top: 0.5em ;  margin-bottom: 0.5em }table.footnote {  border-left: solid 1px black;  margin-left: 1px }table.docutils td, table.docutils th,table.docinfo td, table.docinfo th {  padding-left: 0.5em ;  padding-right: 0.5em ;  vertical-align: top }table.docutils th.field-name, table.docinfo th.docinfo-name {  font-weight: bold ;  text-align: left ;  white-space: nowrap ;  padding-left: 0 }/* "booktabs" style (no vertical lines) */table.docutils.booktabs {  border: 0px;  border-top: 2px solid;  border-bottom: 2px solid;  border-collapse: collapse;}table.docutils.booktabs * {  border: 0px;}table.docutils.booktabs th {  border-bottom: thin solid;  text-align: left;}h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {  font-size: 100% }ul.auto-toc {  list-style-type: none }</style></head><body><div class="document"><div class="section" id="introduction"><h1>Introduction</h1><p>This regex implementation is backwards-compatible with the standard 're' module, but offers additional functionality.</p></div><div class="section" id="note"><h1>Note</h1><p>The re module's behaviour with zero-width matches changed in Python 3.7, and this module follows that behaviour when compiled for Python 3.7.</p></div><div class="section" id="python-2"><h1>Python 2</h1><p>Python 2 is no longer supported. The last release that supported Python 2 was 2021.11.10.</p></div><div class="section" id="pypy"><h1>PyPy</h1><p>This module is targeted at CPython. It expects that all codepoints are the same width, so it won't behave properly with PyPy outside U+0000..U+007F because PyPy stores strings as UTF-8.</p></div><div class="section" id="multithreading"><h1>Multithreading</h1><p>The regex module releases the GIL during matching on instances of the built-in (immutable) string classes, enabling other Python threads to run concurrently. It is also possible to force the regex module to release the GIL during matching by calling the matching methods with the keyword argument <tt class="docutils literal">concurrent=True</tt>. The behaviour is undefined if the string changes during matching, so use it <em>only</em> when it is guaranteed that that won't happen.</p></div><div class="section" id="unicode"><h1>Unicode</h1><p>This module supports Unicode 15.0.0. Full Unicode case-folding is supported.</p></div><div class="section" id="flags"><h1>Flags</h1><p>There are 2 kinds of flag: scoped and global. Scoped flags can apply to only part of a pattern and can be turned on or off; global flags apply to the entire pattern and can only be turned on.</p><p>The scoped flags are: <tt class="docutils literal">ASCII <span class="pre">(?a)</span></tt>, <tt class="docutils literal">FULLCASE <span class="pre">(?f)</span></tt>, <tt class="docutils literal">IGNORECASE <span class="pre">(?i)</span></tt>, <tt class="docutils literal">LOCALE <span class="pre">(?L)</span></tt>, <tt class="docutils literal">MULTILINE <span class="pre">(?m)</span></tt>, <tt class="docutils literal">DOTALL <span class="pre">(?s)</span></tt>, <tt class="docutils literal">UNICODE <span class="pre">(?u)</span></tt>, <tt class="docutils literal">VERBOSE <span class="pre">(?x)</span></tt>, <tt class="docutils literal">WORD <span class="pre">(?w)</span></tt>.</p><p>The global flags are: <tt class="docutils literal">BESTMATCH <span class="pre">(?b)</span></tt>, <tt class="docutils literal">ENHANCEMATCH <span class="pre">(?e)</span></tt>, <tt class="docutils literal">POSIX <span class="pre">(?p)</span></tt>, <tt class="docutils literal">REVERSE <span class="pre">(?r)</span></tt>, <tt class="docutils literal">VERSION0 <span class="pre">(?V0)</span></tt>, <tt class="docutils literal">VERSION1 <span class="pre">(?V1)</span></tt>.</p><p>If neither the <tt class="docutils literal">ASCII</tt>, <tt class="docutils literal">LOCALE</tt> nor <tt class="docutils literal">UNICODE</tt> flag is specified, it will default to <tt class="docutils literal">UNICODE</tt> if the regex pattern is a Unicode string and <tt class="docutils literal">ASCII</tt> if it's a bytestring.</p><p>The <tt class="docutils literal">ENHANCEMATCH</tt> flag makes fuzzy matching attempt to improve the fit of the next match that it finds.</p><p>The <tt class="docutils literal">BESTMATCH</tt> flag makes fuzzy matching search for the best match instead of the next match.</p></div><div class="section" id="old-vs-new-behaviour"><h1>Old vs new behaviour</h1><p>In order to be compatible with the re module, this module has 2 behaviours:</p><ul><li><p class="first"><strong>Version 0</strong> behaviour (old behaviour, compatible with the re module):</p><p>Please note that the re module's behaviour may change over time, and I'll endeavour to match that behaviour in version 0.</p><ul class="simple"><li>Indicated by the <tt class="docutils literal">VERSION0</tt> flag.</li><li>Zero-width matches are not handled correctly in the re module before Python 3.7. The behaviour in those earlier versions is:<ul><li><tt class="docutils literal">.split</tt> won't split a string at a zero-width match.</li><li><tt class="docutils literal">.sub</tt> will advance by one character after a zero-width match.</li></ul></li><li>Inline flags apply to the entire pattern, and they can't be turned off.</li><li>Only simple sets are supported.</li><li>Case-insensitive matches in Unicode use simple case-folding by default.</li></ul></li><li><p class="first"><strong>Version 1</strong> behaviour (new behaviour, possibly different from the re module):</p><ul class="simple"><li>Indicated by the <tt class="docutils literal">VERSION1</tt> flag.</li><li>Zero-width matches are handled correctly.</li><li>Inline flags apply to the end of the group or pattern, and they can be turned off.</li><li>Nested sets and set operations are supported.</li><li>Case-insensitive matches in Unicode use full case-folding by default.</li></ul></li></ul><p>If no version is specified, the regex module will default to <tt class="docutils literal">regex.DEFAULT_VERSION</tt>.</p></div><div class="section" id="case-insensitive-matches-in-unicode"><h1>Case-insensitive matches in Unicode</h1><p>The regex module supports both simple and full case-folding for case-insensitive matches in Unicode. Use of full case-folding can be turned on using the <tt class="docutils literal">FULLCASE</tt> flag. Please note that this flag affects how the <tt class="docutils literal">IGNORECASE</tt> flag works; the <tt class="docutils literal">FULLCASE</tt> flag itself does not turn on case-insensitive matching.</p><p>Version 0 behaviour: the flag is off by default.</p><p>Version 1 behaviour: the flag is on by default.</p></div><div class="section" id="nested-sets-and-set-operations"><h1>Nested sets and set operations</h1><p>It's not possible to support both simple sets, as used in the re module, and nested sets at the same time because of a difference in the meaning of an unescaped <tt class="docutils literal">&quot;[&quot;</tt> in a set.</p><p>For example, the pattern <tt class="docutils literal"><span class="pre">[[a-z]--[aeiou]]</span></tt> is treated in the version 0 behaviour (simple sets, compatible with the re module) as:</p><ul class="simple"><li>Set containing &quot;[&quot; and the letters &quot;a&quot; to &quot;z&quot;</li><li>Literal &quot;--&quot;</li><li>Set containing letters &quot;a&quot;, &quot;e&quot;, &quot;i&quot;, &quot;o&quot;, &quot;u&quot;</li><li>Literal &quot;]&quot;</li></ul><p>but in the version 1 behaviour (nested sets, enhanced behaviour) as:</p><ul class="simple"><li>Set which is:<ul><li>Set containing the letters &quot;a&quot; to &quot;z&quot;</li></ul></li><li>but excluding:<ul><li>Set containing the letters &quot;a&quot;, &quot;e&quot;, &quot;i&quot;, &quot;o&quot;, &quot;u&quot;</li></ul></li></ul><p>Version 0 behaviour: only simple sets are supported.</p><p>Version 1 behaviour: nested sets and set operations are supported.</p></div><div class="section" id="notes-on-named-groups"><h1>Notes on named groups</h1><p>All groups have a group number, starting from 1.</p><p>Groups with the same group name will have the same group number, and groups with a different group name will have a different group number.</p><p>The same name can be used by more than one group, with later captures 'overwriting' earlier captures. All the captures of the group will be available from the <tt class="docutils literal">captures</tt> method of the match object.</p><p>Group numbers will be reused across different branches of a branch reset, eg. <tt class="docutils literal"><span class="pre">(?|(first)|(second))</span></tt> has only group 1. If groups have different group names then they will, of course, have different group numbers, eg. <tt class="docutils literal"><span class="pre">(?|(?P&lt;foo&gt;first)|(?P&lt;bar&gt;second))</span></tt> has group 1 (&quot;foo&quot;) and group 2 (&quot;bar&quot;).</p><p>In the regex <tt class="docutils literal"><span class="pre">(\s+)(?|(?P&lt;foo&gt;[A-Z]+)|(\w+)</span> <span class="pre">(?P&lt;foo&gt;[0-9]+)</span></tt> there are 2 groups:</p><ul class="simple"><li><tt class="docutils literal">(\s+)</tt> is group 1.</li><li><tt class="docutils literal"><span class="pre">(?P&lt;foo&gt;[A-Z]+)</span></tt> is group 2, also called &quot;foo&quot;.</li><li><tt class="docutils literal">(\w+)</tt> is group 2 because of the branch reset.</li><li><tt class="docutils literal"><span class="pre">(?P&lt;foo&gt;[0-9]+)</span></tt> is group 2 because it's called &quot;foo&quot;.</li></ul><p>If you want to prevent <tt class="docutils literal">(\w+)</tt> from being group 2, you need to name it (different name, different group number).</p></div><div class="section" id="additional-features"><h1>Additional features</h1><p>The issue numbers relate to the Python bug tracker, except where listed otherwise.</p><div class="section" id="added-p-horiz-space-and-p-vert-space-github-issue-477"><h2>Added <tt class="docutils literal">\p{Horiz_Space}</tt> and <tt class="docutils literal">\p{Vert_Space}</tt> (<a class="reference external" href="https://github.com/mrabarnett/mrab-regex/issues/477#issuecomment-1216779547">GitHub issue 477</a>)</h2><p><tt class="docutils literal">\p{Horiz_Space}</tt> or <tt class="docutils literal">\p{H}</tt> matches horizontal whitespace and <tt class="docutils literal">\p{Vert_Space}</tt> or <tt class="docutils literal">\p{V}</tt> matches vertical whitespace.</p></div><div class="section" id="added-support-for-lookaround-in-conditional-pattern-hg-issue-163"><h2>Added support for lookaround in conditional pattern (<a class="reference external" href="https://github.com/mrabarnett/mrab-regex/issues/163">Hg issue 163</a>)</h2><p>The test of a conditional pattern can be a lookaround.</p><pre class="code python literal-block"><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">match</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string single">'(?(?=\d)\d+|\w+)'</span><span class="punctuation">,</span> <span class="literal string single">'123abc'</span><span class="punctuation">)</span><span class="operator">&lt;</span><span class="name">regex</span><span class="operator">.</span><span class="name">Match</span> <span class="name builtin">object</span><span class="punctuation">;</span> <span class="name">span</span><span class="operator">=</span><span class="punctuation">(</span><span class="literal number integer">0</span><span class="punctuation">,</span> <span class="literal number integer">3</span><span class="punctuation">),</span> <span class="name">match</span><span class="operator">=</span><span class="literal string single">'123'</span><span class="operator">&gt;</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">match</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string single">'(?(?=\d)\d+|\w+)'</span><span class="punctuation">,</span> <span class="literal string single">'abc123'</span><span class="punctuation">)</span><span class="operator">&lt;</span><span class="name">regex</span><span class="operator">.</span><span class="name">Match</span> <span class="name builtin">object</span><span class="punctuation">;</span> <span class="name">span</span><span class="operator">=</span><span class="punctuation">(</span><span class="literal number integer">0</span><span class="punctuation">,</span> <span class="literal number integer">6</span><span class="punctuation">),</span> <span class="name">match</span><span class="operator">=</span><span class="literal string single">'abc123'</span><span class="operator">&gt;</span></pre><p>This is not quite the same as putting a lookaround in the first branch of a pair of alternatives.</p><pre class="code python literal-block"><span class="operator">&gt;&gt;&gt;</span> <span class="name builtin">print</span><span class="punctuation">(</span><span class="name">regex</span><span class="operator">.</span><span class="name">match</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string single">'(?:(?=\d)\d+\b|\w+)'</span><span class="punctuation">,</span> <span class="literal string single">'123abc'</span><span class="punctuation">))</span><span class="operator">&lt;</span><span class="name">regex</span><span class="operator">.</span><span class="name">Match</span> <span class="name builtin">object</span><span class="punctuation">;</span> <span class="name">span</span><span class="operator">=</span><span class="punctuation">(</span><span class="literal number integer">0</span><span class="punctuation">,</span> <span class="literal number integer">6</span><span class="punctuation">),</span> <span class="name">match</span><span class="operator">=</span><span class="literal string single">'123abc'</span><span class="operator">&gt;</span><span class="operator">&gt;&gt;&gt;</span> <span class="name builtin">print</span><span class="punctuation">(</span><span class="name">regex</span><span class="operator">.</span><span class="name">match</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string single">'(?(?=\d)\d+\b|\w+)'</span><span class="punctuation">,</span> <span class="literal string single">'123abc'</span><span class="punctuation">))</span><span class="keyword constant">None</span></pre><p>In the first example, the lookaround matched, but the remainder of the first branch failed to match, and so the second branch was attempted, whereas in the second example, the lookaround matched, and the first branch failed to match, but the second branch was <strong>not</strong> attempted.</p></div><div class="section" id="added-posix-matching-leftmost-longest-hg-issue-150"><h2>Added POSIX matching (leftmost longest) (<a class="reference external" href="https://github.com/mrabarnett/mrab-regex/issues/150">Hg issue 150</a>)</h2><p>The POSIX standard for regex is to return the leftmost longest match. This can be turned on using the <tt class="docutils literal">POSIX</tt> flag.</p><pre class="code python literal-block"><span class="operator">&gt;&gt;&gt;</span> <span class="comment single"># Normal matching.</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">search</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string single">'Mr|Mrs'</span><span class="punctuation">,</span> <span class="literal string single">'Mrs'</span><span class="punctuation">)</span><span class="operator">&lt;</span><span class="name">regex</span><span class="operator">.</span><span class="name">Match</span> <span class="name builtin">object</span><span class="punctuation">;</span> <span class="name">span</span><span class="operator">=</span><span class="punctuation">(</span><span class="literal number integer">0</span><span class="punctuation">,</span> <span class="literal number integer">2</span><span class="punctuation">),</span> <span class="name">match</span><span class="operator">=</span><span class="literal string single">'Mr'</span><span class="operator">&gt;</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">search</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string single">'one(self)?(selfsufficient)?'</span><span class="punctuation">,</span> <span class="literal string single">'oneselfsufficient'</span><span class="punctuation">)</span><span class="operator">&lt;</span><span class="name">regex</span><span class="operator">.</span><span class="name">Match</span> <span class="name builtin">object</span><span class="punctuation">;</span> <span class="name">span</span><span class="operator">=</span><span class="punctuation">(</span><span class="literal number integer">0</span><span class="punctuation">,</span> <span class="literal number integer">7</span><span class="punctuation">),</span> <span class="name">match</span><span class="operator">=</span><span class="literal string single">'oneself'</span><span class="operator">&gt;</span><span class="operator">&gt;&gt;&gt;</span> <span class="comment single"># POSIX matching.</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">search</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string single">'(?p)Mr|Mrs'</span><span class="punctuation">,</span> <span class="literal string single">'Mrs'</span><span class="punctuation">)</span><span class="operator">&lt;</span><span class="name">regex</span><span class="operator">.</span><span class="name">Match</span> <span class="name builtin">object</span><span class="punctuation">;</span> <span class="name">span</span><span class="operator">=</span><span class="punctuation">(</span><span class="literal number integer">0</span><span class="punctuation">,</span> <span class="literal number integer">3</span><span class="punctuation">),</span> <span class="name">match</span><span class="operator">=</span><span class="literal string single">'Mrs'</span><span class="operator">&gt;</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">search</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string single">'(?p)one(self)?(selfsufficient)?'</span><span class="punctuation">,</span> <span class="literal string single">'oneselfsufficient'</span><span class="punctuation">)</span><span class="operator">&lt;</span><span class="name">regex</span><span class="operator">.</span><span class="name">Match</span> <span class="name builtin">object</span><span class="punctuation">;</span> <span class="name">span</span><span class="operator">=</span><span class="punctuation">(</span><span class="literal number integer">0</span><span class="punctuation">,</span> <span class="literal number integer">17</span><span class="punctuation">),</span> <span class="name">match</span><span class="operator">=</span><span class="literal string single">'oneselfsufficient'</span><span class="operator">&gt;</span></pre><p>Note that it will take longer to find matches because when it finds a match at a certain position, it won't return that immediately, but will keep looking to see if there's another longer match there.</p></div><div class="section" id="added-define-hg-issue-152"><h2>Added <tt class="docutils literal"><span class="pre">(?(DEFINE)...)</span></tt> (<a class="reference external" href="https://github.com/mrabarnett/mrab-regex/issues/152">Hg issue 152</a>)</h2><p>If there's no group called &quot;DEFINE&quot;, then ... will be ignored except that any groups defined within it can be called and that the normal rules for numbering groups still apply.</p><pre class="code python literal-block"><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">search</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string single">'(?(DEFINE)(?P&lt;quant&gt;\d+)(?P&lt;item&gt;\w+))(?&amp;quant) (?&amp;item)'</span><span class="punctuation">,</span> <span class="literal string single">'5 elephants'</span><span class="punctuation">)</span><span class="operator">&lt;</span><span class="name">regex</span><span class="operator">.</span><span class="name">Match</span> <span class="name builtin">object</span><span class="punctuation">;</span> <span class="name">span</span><span class="operator">=</span><span class="punctuation">(</span><span class="literal number integer">0</span><span class="punctuation">,</span> <span class="literal number integer">11</span><span class="punctuation">),</span> <span class="name">match</span><span class="operator">=</span><span class="literal string single">'5 elephants'</span><span class="operator">&gt;</span></pre></div><div class="section" id="added-prune-skip-and-fail-hg-issue-153"><h2>Added <tt class="docutils literal">(*PRUNE)</tt>, <tt class="docutils literal">(*SKIP)</tt> and <tt class="docutils literal">(*FAIL)</tt> (<a class="reference external" href="https://github.com/mrabarnett/mrab-regex/issues/153">Hg issue 153</a>)</h2><p><tt class="docutils literal">(*PRUNE)</tt> discards the backtracking info up to that point. When used in an atomic group or a lookaround, it won't affect the enclosing pattern.</p><p><tt class="docutils literal">(*SKIP)</tt> is similar to <tt class="docutils literal">(*PRUNE)</tt>, except that it also sets where in the text the next attempt to match will start. When used in an atomic group or a lookaround, it won't affect the enclosing pattern.</p><p><tt class="docutils literal">(*FAIL)</tt> causes immediate backtracking. <tt class="docutils literal">(*F)</tt> is a permitted abbreviation.</p></div><div class="section" id="added-k-hg-issue-151"><h2>Added <tt class="docutils literal">\K</tt> (<a class="reference external" href="https://github.com/mrabarnett/mrab-regex/issues/151">Hg issue 151</a>)</h2><p>Keeps the part of the entire match after the position where <tt class="docutils literal">\K</tt> occurred; the part before it is discarded.</p><p>It does not affect what groups return.</p><pre class="code python literal-block"><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span> <span class="operator">=</span> <span class="name">regex</span><span class="operator">.</span><span class="name">search</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string single">'(\w\w\K\w\w\w)'</span><span class="punctuation">,</span> <span class="literal string single">'abcdef'</span><span class="punctuation">)</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="punctuation">[</span><span class="literal number integer">0</span><span class="punctuation">]</span><span class="literal string single">'cde'</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="punctuation">[</span><span class="literal number integer">1</span><span class="punctuation">]</span><span class="literal string single">'abcde'</span><span class="operator">&gt;&gt;&gt;</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span> <span class="operator">=</span> <span class="name">regex</span><span class="operator">.</span><span class="name">search</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string single">'(?r)(\w\w\K\w\w\w)'</span><span class="punctuation">,</span> <span class="literal string single">'abcdef'</span><span class="punctuation">)</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="punctuation">[</span><span class="literal number integer">0</span><span class="punctuation">]</span><span class="literal string single">'bc'</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="punctuation">[</span><span class="literal number integer">1</span><span class="punctuation">]</span><span class="literal string single">'bcdef'</span></pre></div><div class="section" id="added-capture-subscripting-for-expandf-and-subf-subfn-hg-issue-133"><h2>Added capture subscripting for <tt class="docutils literal">expandf</tt> and <tt class="docutils literal">subf</tt>/<tt class="docutils literal">subfn</tt> (<a class="reference external" href="https://github.com/mrabarnett/mrab-regex/issues/133">Hg issue 133</a>)</h2><p>You can use subscripting to get the captures of a repeated group.</p><pre class="code python literal-block"><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span> <span class="operator">=</span> <span class="name">regex</span><span class="operator">.</span><span class="name">match</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;(\w)+&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;abc&quot;</span><span class="punctuation">)</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">expandf</span><span class="punctuation">(</span><span class="literal string double">&quot;</span><span class="literal string interpol">{1}</span><span class="literal string double">&quot;</span><span class="punctuation">)</span><span class="literal string single">'c'</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">expandf</span><span class="punctuation">(</span><span class="literal string double">&quot;</span><span class="literal string interpol">{1[0]}</span><span class="literal string double"> </span><span class="literal string interpol">{1[1]}</span><span class="literal string double"> </span><span class="literal string interpol">{1[2]}</span><span class="literal string double">&quot;</span><span class="punctuation">)</span><span class="literal string single">'a b c'</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">expandf</span><span class="punctuation">(</span><span class="literal string double">&quot;</span><span class="literal string interpol">{1[-1]}</span><span class="literal string double"> </span><span class="literal string interpol">{1[-2]}</span><span class="literal string double"> </span><span class="literal string interpol">{1[-3]}</span><span class="literal string double">&quot;</span><span class="punctuation">)</span><span class="literal string single">'c b a'</span><span class="operator">&gt;&gt;&gt;</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span> <span class="operator">=</span> <span class="name">regex</span><span class="operator">.</span><span class="name">match</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;(?P&lt;letter&gt;\w)+&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;abc&quot;</span><span class="punctuation">)</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">expandf</span><span class="punctuation">(</span><span class="literal string double">&quot;</span><span class="literal string interpol">{letter}</span><span class="literal string double">&quot;</span><span class="punctuation">)</span><span class="literal string single">'c'</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">expandf</span><span class="punctuation">(</span><span class="literal string double">&quot;</span><span class="literal string interpol">{letter[0]}</span><span class="literal string double"> </span><span class="literal string interpol">{letter[1]}</span><span class="literal string double"> </span><span class="literal string interpol">{letter[2]}</span><span class="literal string double">&quot;</span><span class="punctuation">)</span><span class="literal string single">'a b c'</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">expandf</span><span class="punctuation">(</span><span class="literal string double">&quot;</span><span class="literal string interpol">{letter[-1]}</span><span class="literal string double"> </span><span class="literal string interpol">{letter[-2]}</span><span class="literal string double"> </span><span class="literal string interpol">{letter[-3]}</span><span class="literal string double">&quot;</span><span class="punctuation">)</span><span class="literal string single">'c b a'</span></pre></div><div class="section" id="added-support-for-referring-to-a-group-by-number-using-p"><h2>Added support for referring to a group by number using <tt class="docutils literal"><span class="pre">(?P=...)</span></tt></h2><p>This is in addition to the existing <tt class="docutils literal"><span class="pre">\g&lt;...&gt;</span></tt>.</p></div><div class="section" id="fixed-the-handling-of-locale-sensitive-regexes"><h2>Fixed the handling of locale-sensitive regexes</h2><p>The <tt class="docutils literal">LOCALE</tt> flag is intended for legacy code and has limited support. You're still recommended to use Unicode instead.</p></div><div class="section" id="added-partial-matches-hg-issue-102"><h2>Added partial matches (<a class="reference external" href="https://github.com/mrabarnett/mrab-regex/issues/102">Hg issue 102</a>)</h2><p>A partial match is one that matches up to the end of string, but that string has been truncated and you want to know whether a complete match could be possible if the string had not been truncated.</p><p>Partial matches are supported by <tt class="docutils literal">match</tt>, <tt class="docutils literal">search</tt>, <tt class="docutils literal">fullmatch</tt> and <tt class="docutils literal">finditer</tt> with the <tt class="docutils literal">partial</tt> keyword argument.</p><p>Match objects have a <tt class="docutils literal">partial</tt> attribute, which is <tt class="docutils literal">True</tt> if it's a partial match.</p><p>For example, if you wanted a user to enter a 4-digit number and check it character by character as it was being entered:</p><pre class="code python literal-block"><span class="operator">&gt;&gt;&gt;</span> <span class="name">pattern</span> <span class="operator">=</span> <span class="name">regex</span><span class="operator">.</span><span class="name">compile</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string single">'\d</span><span class="literal string interpol">{4}</span><span class="literal string single">'</span><span class="punctuation">)</span><span class="operator">&gt;&gt;&gt;</span> <span class="comment single"># Initially, nothing has been entered:</span><span class="operator">&gt;&gt;&gt;</span> <span class="name builtin">print</span><span class="punctuation">(</span><span class="name">pattern</span><span class="operator">.</span><span class="name">fullmatch</span><span class="punctuation">(</span><span class="literal string single">''</span><span class="punctuation">,</span> <span class="name">partial</span><span class="operator">=</span><span class="keyword constant">True</span><span class="punctuation">))</span><span class="operator">&lt;</span><span class="name">regex</span><span class="operator">.</span><span class="name">Match</span> <span class="name builtin">object</span><span class="punctuation">;</span> <span class="name">span</span><span class="operator">=</span><span class="punctuation">(</span><span class="literal number integer">0</span><span class="punctuation">,</span> <span class="literal number integer">0</span><span class="punctuation">),</span> <span class="name">match</span><span class="operator">=</span><span class="literal string single">''</span><span class="punctuation">,</span> <span class="name">partial</span><span class="operator">=</span><span class="keyword constant">True</span><span class="operator">&gt;</span><span class="operator">&gt;&gt;&gt;</span> <span class="comment single"># An empty string is OK, but it's only a partial match.</span><span class="operator">&gt;&gt;&gt;</span> <span class="comment single"># The user enters a letter:</span><span class="operator">&gt;&gt;&gt;</span> <span class="name builtin">print</span><span class="punctuation">(</span><span class="name">pattern</span><span class="operator">.</span><span class="name">fullmatch</span><span class="punctuation">(</span><span class="literal string single">'a'</span><span class="punctuation">,</span> <span class="name">partial</span><span class="operator">=</span><span class="keyword constant">True</span><span class="punctuation">))</span><span class="keyword constant">None</span><span class="operator">&gt;&gt;&gt;</span> <span class="comment single"># It'll never match.</span><span class="operator">&gt;&gt;&gt;</span> <span class="comment single"># The user deletes that and enters a digit:</span><span class="operator">&gt;&gt;&gt;</span> <span class="name builtin">print</span><span class="punctuation">(</span><span class="name">pattern</span><span class="operator">.</span><span class="name">fullmatch</span><span class="punctuation">(</span><span class="literal string single">'1'</span><span class="punctuation">,</span> <span class="name">partial</span><span class="operator">=</span><span class="keyword constant">True</span><span class="punctuation">))</span><span class="operator">&lt;</span><span class="name">regex</span><span class="operator">.</span><span class="name">Match</span> <span class="name builtin">object</span><span class="punctuation">;</span> <span class="name">span</span><span class="operator">=</span><span class="punctuation">(</span><span class="literal number integer">0</span><span class="punctuation">,</span> <span class="literal number integer">1</span><span class="punctuation">),</span> <span class="name">match</span><span class="operator">=</span><span class="literal string single">'1'</span><span class="punctuation">,</span> <span class="name">partial</span><span class="operator">=</span><span class="keyword constant">True</span><span class="operator">&gt;</span><span class="operator">&gt;&gt;&gt;</span> <span class="comment single"># It matches this far, but it's only a partial match.</span><span class="operator">&gt;&gt;&gt;</span> <span class="comment single"># The user enters 2 more digits:</span><span class="operator">&gt;&gt;&gt;</span> <span class="name builtin">print</span><span class="punctuation">(</span><span class="name">pattern</span><span class="operator">.</span><span class="name">fullmatch</span><span class="punctuation">(</span><span class="literal string single">'123'</span><span class="punctuation">,</span> <span class="name">partial</span><span class="operator">=</span><span class="keyword constant">True</span><span class="punctuation">))</span><span class="operator">&lt;</span><span class="name">regex</span><span class="operator">.</span><span class="name">Match</span> <span class="name builtin">object</span><span class="punctuation">;</span> <span class="name">span</span><span class="operator">=</span><span class="punctuation">(</span><span class="literal number integer">0</span><span class="punctuation">,</span> <span class="literal number integer">3</span><span class="punctuation">),</span> <span class="name">match</span><span class="operator">=</span><span class="literal string single">'123'</span><span class="punctuation">,</span> <span class="name">partial</span><span class="operator">=</span><span class="keyword constant">True</span><span class="operator">&gt;</span><span class="operator">&gt;&gt;&gt;</span> <span class="comment single"># It matches this far, but it's only a partial match.</span><span class="operator">&gt;&gt;&gt;</span> <span class="comment single"># The user enters another digit:</span><span class="operator">&gt;&gt;&gt;</span> <span class="name builtin">print</span><span class="punctuation">(</span><span class="name">pattern</span><span class="operator">.</span><span class="name">fullmatch</span><span class="punctuation">(</span><span class="literal string single">'1234'</span><span class="punctuation">,</span> <span class="name">partial</span><span class="operator">=</span><span class="keyword constant">True</span><span class="punctuation">))</span><span class="operator">&lt;</span><span class="name">regex</span><span class="operator">.</span><span class="name">Match</span> <span class="name builtin">object</span><span class="punctuation">;</span> <span class="name">span</span><span class="operator">=</span><span class="punctuation">(</span><span class="literal number integer">0</span><span class="punctuation">,</span> <span class="literal number integer">4</span><span class="punctuation">),</span> <span class="name">match</span><span class="operator">=</span><span class="literal string single">'1234'</span><span class="operator">&gt;</span><span class="operator">&gt;&gt;&gt;</span> <span class="comment single"># It's a complete match.</span><span class="operator">&gt;&gt;&gt;</span> <span class="comment single"># If the user enters another digit:</span><span class="operator">&gt;&gt;&gt;</span> <span class="name builtin">print</span><span class="punctuation">(</span><span class="name">pattern</span><span class="operator">.</span><span class="name">fullmatch</span><span class="punctuation">(</span><span class="literal string single">'12345'</span><span class="punctuation">,</span> <span class="name">partial</span><span class="operator">=</span><span class="keyword constant">True</span><span class="punctuation">))</span><span class="keyword constant">None</span><span class="operator">&gt;&gt;&gt;</span> <span class="comment single"># It's no longer a match.</span><span class="operator">&gt;&gt;&gt;</span> <span class="comment single"># This is a partial match:</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">pattern</span><span class="operator">.</span><span class="name">match</span><span class="punctuation">(</span><span class="literal string single">'123'</span><span class="punctuation">,</span> <span class="name">partial</span><span class="operator">=</span><span class="keyword constant">True</span><span class="punctuation">)</span><span class="operator">.</span><span class="name">partial</span><span class="keyword constant">True</span><span class="operator">&gt;&gt;&gt;</span> <span class="comment single"># This is a complete match:</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">pattern</span><span class="operator">.</span><span class="name">match</span><span class="punctuation">(</span><span class="literal string single">'1233'</span><span class="punctuation">,</span> <span class="name">partial</span><span class="operator">=</span><span class="keyword constant">True</span><span class="punctuation">)</span><span class="operator">.</span><span class="name">partial</span><span class="keyword constant">False</span></pre></div><div class="section" id="operator-not-working-correctly-with-sub-hg-issue-106"><h2><tt class="docutils literal">*</tt> operator not working correctly with sub() (<a class="reference external" href="https://github.com/mrabarnett/mrab-regex/issues/106">Hg issue 106</a>)</h2><p>Sometimes it's not clear how zero-width matches should be handled. For example, should <tt class="docutils literal">.*</tt> match 0 characters directly after matching &gt;0 characters?</p><pre class="code python literal-block"><span class="comment single"># Python 3.7 and later</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">sub</span><span class="punctuation">(</span><span class="literal string single">'.*'</span><span class="punctuation">,</span> <span class="literal string single">'x'</span><span class="punctuation">,</span> <span class="literal string single">'test'</span><span class="punctuation">)</span><span class="literal string single">'xx'</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">sub</span><span class="punctuation">(</span><span class="literal string single">'.*?'</span><span class="punctuation">,</span> <span class="literal string single">'|'</span><span class="punctuation">,</span> <span class="literal string single">'test'</span><span class="punctuation">)</span><span class="literal string single">'|||||||||'</span><span class="comment single"># Python 3.6 and earlier</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">sub</span><span class="punctuation">(</span><span class="literal string single">'(?V0).*'</span><span class="punctuation">,</span> <span class="literal string single">'x'</span><span class="punctuation">,</span> <span class="literal string single">'test'</span><span class="punctuation">)</span><span class="literal string single">'x'</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">sub</span><span class="punctuation">(</span><span class="literal string single">'(?V1).*'</span><span class="punctuation">,</span> <span class="literal string single">'x'</span><span class="punctuation">,</span> <span class="literal string single">'test'</span><span class="punctuation">)</span><span class="literal string single">'xx'</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">sub</span><span class="punctuation">(</span><span class="literal string single">'(?V0).*?'</span><span class="punctuation">,</span> <span class="literal string single">'|'</span><span class="punctuation">,</span> <span class="literal string single">'test'</span><span class="punctuation">)</span><span class="literal string single">'|t|e|s|t|'</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">sub</span><span class="punctuation">(</span><span class="literal string single">'(?V1).*?'</span><span class="punctuation">,</span> <span class="literal string single">'|'</span><span class="punctuation">,</span> <span class="literal string single">'test'</span><span class="punctuation">)</span><span class="literal string single">'|||||||||'</span></pre></div><div class="section" id="added-capturesdict-hg-issue-86"><h2>Added <tt class="docutils literal">capturesdict</tt> (<a class="reference external" href="https://github.com/mrabarnett/mrab-regex/issues/86">Hg issue 86</a>)</h2><p><tt class="docutils literal">capturesdict</tt> is a combination of <tt class="docutils literal">groupdict</tt> and <tt class="docutils literal">captures</tt>:</p><p><tt class="docutils literal">groupdict</tt> returns a dict of the named groups and the last capture of those groups.</p><p><tt class="docutils literal">captures</tt> returns a list of all the captures of a group</p><p><tt class="docutils literal">capturesdict</tt> returns a dict of the named groups and lists of all the captures of those groups.</p><pre class="code python literal-block"><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span> <span class="operator">=</span> <span class="name">regex</span><span class="operator">.</span><span class="name">match</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;(?:(?P&lt;word&gt;\w+) (?P&lt;digits&gt;\d+)\n)+&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;one 1</span><span class="literal string escape">\n</span><span class="literal string double">two 2</span><span class="literal string escape">\n</span><span class="literal string double">three 3</span><span class="literal string escape">\n</span><span class="literal string double">&quot;</span><span class="punctuation">)</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">groupdict</span><span class="punctuation">()</span><span class="punctuation">{</span><span class="literal string single">'word'</span><span class="punctuation">:</span> <span class="literal string single">'three'</span><span class="punctuation">,</span> <span class="literal string single">'digits'</span><span class="punctuation">:</span> <span class="literal string single">'3'</span><span class="punctuation">}</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">captures</span><span class="punctuation">(</span><span class="literal string double">&quot;word&quot;</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="literal string single">'one'</span><span class="punctuation">,</span> <span class="literal string single">'two'</span><span class="punctuation">,</span> <span class="literal string single">'three'</span><span class="punctuation">]</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">captures</span><span class="punctuation">(</span><span class="literal string double">&quot;digits&quot;</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="literal string single">'1'</span><span class="punctuation">,</span> <span class="literal string single">'2'</span><span class="punctuation">,</span> <span class="literal string single">'3'</span><span class="punctuation">]</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">capturesdict</span><span class="punctuation">()</span><span class="punctuation">{</span><span class="literal string single">'word'</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="literal string single">'one'</span><span class="punctuation">,</span> <span class="literal string single">'two'</span><span class="punctuation">,</span> <span class="literal string single">'three'</span><span class="punctuation">],</span> <span class="literal string single">'digits'</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="literal string single">'1'</span><span class="punctuation">,</span> <span class="literal string single">'2'</span><span class="punctuation">,</span> <span class="literal string single">'3'</span><span class="punctuation">]}</span></pre></div><div class="section" id="added-allcaptures-and-allspans-git-issue-474"><h2>Added <tt class="docutils literal">allcaptures</tt> and <tt class="docutils literal">allspans</tt> (<a class="reference external" href="https://github.com/mrabarnett/mrab-regex/issues/474">Git issue 474</a>)</h2><p><tt class="docutils literal">allcaptures</tt> returns a list of all the captures of all the groups.</p><p><tt class="docutils literal">allspans</tt> returns a list of all the spans of the all captures of all the groups.</p><pre class="code python literal-block"><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span> <span class="operator">=</span> <span class="name">regex</span><span class="operator">.</span><span class="name">match</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;(?:(?P&lt;word&gt;\w+) (?P&lt;digits&gt;\d+)\n)+&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;one 1</span><span class="literal string escape">\n</span><span class="literal string double">two 2</span><span class="literal string escape">\n</span><span class="literal string double">three 3</span><span class="literal string escape">\n</span><span class="literal string double">&quot;</span><span class="punctuation">)</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">allcaptures</span><span class="punctuation">()</span><span class="punctuation">([</span><span class="literal string single">'one 1</span><span class="literal string escape">\n</span><span class="literal string single">two 2</span><span class="literal string escape">\n</span><span class="literal string single">three 3</span><span class="literal string escape">\n</span><span class="literal string single">'</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="literal string single">'one'</span><span class="punctuation">,</span> <span class="literal string single">'two'</span><span class="punctuation">,</span> <span class="literal string single">'three'</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="literal string single">'1'</span><span class="punctuation">,</span> <span class="literal string single">'2'</span><span class="punctuation">,</span> <span class="literal string single">'3'</span><span class="punctuation">])</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">allspans</span><span class="punctuation">()</span><span class="punctuation">([(</span><span class="literal number integer">0</span><span class="punctuation">,</span> <span class="literal number integer">20</span><span class="punctuation">)],</span> <span class="punctuation">[(</span><span class="literal number integer">0</span><span class="punctuation">,</span> <span class="literal number integer">3</span><span class="punctuation">),</span> <span class="punctuation">(</span><span class="literal number integer">6</span><span class="punctuation">,</span> <span class="literal number integer">9</span><span class="punctuation">),</span> <span class="punctuation">(</span><span class="literal number integer">12</span><span class="punctuation">,</span> <span class="literal number integer">17</span><span class="punctuation">)],</span> <span class="punctuation">[(</span><span class="literal number integer">4</span><span class="punctuation">,</span> <span class="literal number integer">5</span><span class="punctuation">),</span> <span class="punctuation">(</span><span class="literal number integer">10</span><span class="punctuation">,</span> <span class="literal number integer">11</span><span class="punctuation">),</span> <span class="punctuation">(</span><span class="literal number integer">18</span><span class="punctuation">,</span> <span class="literal number integer">19</span><span class="punctuation">)])</span></pre></div><div class="section" id="allow-duplicate-names-of-groups-hg-issue-87"><h2>Allow duplicate names of groups (<a class="reference external" href="https://github.com/mrabarnett/mrab-regex/issues/87">Hg issue 87</a>)</h2><p>Group names can be duplicated.</p><pre class="code python literal-block"><span class="operator">&gt;&gt;&gt;</span> <span class="comment single"># With optional groups:</span><span class="operator">&gt;&gt;&gt;</span><span class="operator">&gt;&gt;&gt;</span> <span class="comment single"># Both groups capture, the second capture 'overwriting' the first.</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span> <span class="operator">=</span> <span class="name">regex</span><span class="operator">.</span><span class="name">match</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;(?P&lt;item&gt;\w+)? or (?P&lt;item&gt;\w+)?&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;first or second&quot;</span><span class="punctuation">)</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">group</span><span class="punctuation">(</span><span class="literal string double">&quot;item&quot;</span><span class="punctuation">)</span><span class="literal string single">'second'</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">captures</span><span class="punctuation">(</span><span class="literal string double">&quot;item&quot;</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="literal string single">'first'</span><span class="punctuation">,</span> <span class="literal string single">'second'</span><span class="punctuation">]</span><span class="operator">&gt;&gt;&gt;</span> <span class="comment single"># Only the second group captures.</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span> <span class="operator">=</span> <span class="name">regex</span><span class="operator">.</span><span class="name">match</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;(?P&lt;item&gt;\w+)? or (?P&lt;item&gt;\w+)?&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot; or second&quot;</span><span class="punctuation">)</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">group</span><span class="punctuation">(</span><span class="literal string double">&quot;item&quot;</span><span class="punctuation">)</span><span class="literal string single">'second'</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">captures</span><span class="punctuation">(</span><span class="literal string double">&quot;item&quot;</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="literal string single">'second'</span><span class="punctuation">]</span><span class="operator">&gt;&gt;&gt;</span> <span class="comment single"># Only the first group captures.</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span> <span class="operator">=</span> <span class="name">regex</span><span class="operator">.</span><span class="name">match</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;(?P&lt;item&gt;\w+)? or (?P&lt;item&gt;\w+)?&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;first or &quot;</span><span class="punctuation">)</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">group</span><span class="punctuation">(</span><span class="literal string double">&quot;item&quot;</span><span class="punctuation">)</span><span class="literal string single">'first'</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">captures</span><span class="punctuation">(</span><span class="literal string double">&quot;item&quot;</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="literal string single">'first'</span><span class="punctuation">]</span><span class="operator">&gt;&gt;&gt;</span><span class="operator">&gt;&gt;&gt;</span> <span class="comment single"># With mandatory groups:</span><span class="operator">&gt;&gt;&gt;</span><span class="operator">&gt;&gt;&gt;</span> <span class="comment single"># Both groups capture, the second capture 'overwriting' the first.</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span> <span class="operator">=</span> <span class="name">regex</span><span class="operator">.</span><span class="name">match</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;(?P&lt;item&gt;\w*) or (?P&lt;item&gt;\w*)?&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;first or second&quot;</span><span class="punctuation">)</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">group</span><span class="punctuation">(</span><span class="literal string double">&quot;item&quot;</span><span class="punctuation">)</span><span class="literal string single">'second'</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">captures</span><span class="punctuation">(</span><span class="literal string double">&quot;item&quot;</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="literal string single">'first'</span><span class="punctuation">,</span> <span class="literal string single">'second'</span><span class="punctuation">]</span><span class="operator">&gt;&gt;&gt;</span> <span class="comment single"># Again, both groups capture, the second capture 'overwriting' the first.</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span> <span class="operator">=</span> <span class="name">regex</span><span class="operator">.</span><span class="name">match</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;(?P&lt;item&gt;\w*) or (?P&lt;item&gt;\w*)&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot; or second&quot;</span><span class="punctuation">)</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">group</span><span class="punctuation">(</span><span class="literal string double">&quot;item&quot;</span><span class="punctuation">)</span><span class="literal string single">'second'</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">captures</span><span class="punctuation">(</span><span class="literal string double">&quot;item&quot;</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="literal string single">''</span><span class="punctuation">,</span> <span class="literal string single">'second'</span><span class="punctuation">]</span><span class="operator">&gt;&gt;&gt;</span> <span class="comment single"># And yet again, both groups capture, the second capture 'overwriting' the first.</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span> <span class="operator">=</span> <span class="name">regex</span><span class="operator">.</span><span class="name">match</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;(?P&lt;item&gt;\w*) or (?P&lt;item&gt;\w*)&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;first or &quot;</span><span class="punctuation">)</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">group</span><span class="punctuation">(</span><span class="literal string double">&quot;item&quot;</span><span class="punctuation">)</span><span class="literal string single">''</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">captures</span><span class="punctuation">(</span><span class="literal string double">&quot;item&quot;</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="literal string single">'first'</span><span class="punctuation">,</span> <span class="literal string single">''</span><span class="punctuation">]</span></pre></div><div class="section" id="added-fullmatch-issue-16203"><h2>Added <tt class="docutils literal">fullmatch</tt> (<a class="reference external" href="https://bugs.python.org/issue16203">issue #16203</a>)</h2><p><tt class="docutils literal">fullmatch</tt> behaves like <tt class="docutils literal">match</tt>, except that it must match all of the string.</p><pre class="code python literal-block"><span class="operator">&gt;&gt;&gt;</span> <span class="name builtin">print</span><span class="punctuation">(</span><span class="name">regex</span><span class="operator">.</span><span class="name">fullmatch</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;abc&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;abc&quot;</span><span class="punctuation">)</span><span class="operator">.</span><span class="name">span</span><span class="punctuation">())</span><span class="punctuation">(</span><span class="literal number integer">0</span><span class="punctuation">,</span> <span class="literal number integer">3</span><span class="punctuation">)</span><span class="operator">&gt;&gt;&gt;</span> <span class="name builtin">print</span><span class="punctuation">(</span><span class="name">regex</span><span class="operator">.</span><span class="name">fullmatch</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;abc&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;abcx&quot;</span><span class="punctuation">))</span><span class="keyword constant">None</span><span class="operator">&gt;&gt;&gt;</span> <span class="name builtin">print</span><span class="punctuation">(</span><span class="name">regex</span><span class="operator">.</span><span class="name">fullmatch</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;abc&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;abcx&quot;</span><span class="punctuation">,</span> <span class="name">endpos</span><span class="operator">=</span><span class="literal number integer">3</span><span class="punctuation">)</span><span class="operator">.</span><span class="name">span</span><span class="punctuation">())</span><span class="punctuation">(</span><span class="literal number integer">0</span><span class="punctuation">,</span> <span class="literal number integer">3</span><span class="punctuation">)</span><span class="operator">&gt;&gt;&gt;</span> <span class="name builtin">print</span><span class="punctuation">(</span><span class="name">regex</span><span class="operator">.</span><span class="name">fullmatch</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;abc&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;xabcy&quot;</span><span class="punctuation">,</span> <span class="name">pos</span><span class="operator">=</span><span class="literal number integer">1</span><span class="punctuation">,</span> <span class="name">endpos</span><span class="operator">=</span><span class="literal number integer">4</span><span class="punctuation">)</span><span class="operator">.</span><span class="name">span</span><span class="punctuation">())</span><span class="punctuation">(</span><span class="literal number integer">1</span><span class="punctuation">,</span> <span class="literal number integer">4</span><span class="punctuation">)</span><span class="operator">&gt;&gt;&gt;</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">match</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;a.*?&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;abcd&quot;</span><span class="punctuation">)</span><span class="operator">.</span><span class="name">group</span><span class="punctuation">(</span><span class="literal number integer">0</span><span class="punctuation">)</span><span class="literal string single">'a'</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">fullmatch</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;a.*?&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;abcd&quot;</span><span class="punctuation">)</span><span class="operator">.</span><span class="name">group</span><span class="punctuation">(</span><span class="literal number integer">0</span><span class="punctuation">)</span><span class="literal string single">'abcd'</span></pre></div><div class="section" id="added-subf-and-subfn"><h2>Added <tt class="docutils literal">subf</tt> and <tt class="docutils literal">subfn</tt></h2><p><tt class="docutils literal">subf</tt> and <tt class="docutils literal">subfn</tt> are alternatives to <tt class="docutils literal">sub</tt> and <tt class="docutils literal">subn</tt> respectively. When passed a replacement string, they treat it as a format string.</p><pre class="code python literal-block"><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">subf</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;(\w+) (\w+)&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;</span><span class="literal string interpol">{0}</span><span class="literal string double"> =&gt; </span><span class="literal string interpol">{2}</span><span class="literal string double"> </span><span class="literal string interpol">{1}</span><span class="literal string double">&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;foo bar&quot;</span><span class="punctuation">)</span><span class="literal string single">'foo bar =&gt; bar foo'</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">subf</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;(?P&lt;word1&gt;\w+) (?P&lt;word2&gt;\w+)&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;</span><span class="literal string interpol">{word2}</span><span class="literal string double"> </span><span class="literal string interpol">{word1}</span><span class="literal string double">&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;foo bar&quot;</span><span class="punctuation">)</span><span class="literal string single">'bar foo'</span></pre></div><div class="section" id="added-expandf-to-match-object"><h2>Added <tt class="docutils literal">expandf</tt> to match object</h2><p><tt class="docutils literal">expandf</tt> is an alternative to <tt class="docutils literal">expand</tt>. When passed a replacement string, it treats it as a format string.</p><pre class="code python literal-block"><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span> <span class="operator">=</span> <span class="name">regex</span><span class="operator">.</span><span class="name">match</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;(\w+) (\w+)&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;foo bar&quot;</span><span class="punctuation">)</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">expandf</span><span class="punctuation">(</span><span class="literal string double">&quot;</span><span class="literal string interpol">{0}</span><span class="literal string double"> =&gt; </span><span class="literal string interpol">{2}</span><span class="literal string double"> </span><span class="literal string interpol">{1}</span><span class="literal string double">&quot;</span><span class="punctuation">)</span><span class="literal string single">'foo bar =&gt; bar foo'</span><span class="operator">&gt;&gt;&gt;</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span> <span class="operator">=</span> <span class="name">regex</span><span class="operator">.</span><span class="name">match</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;(?P&lt;word1&gt;\w+) (?P&lt;word2&gt;\w+)&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;foo bar&quot;</span><span class="punctuation">)</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">expandf</span><span class="punctuation">(</span><span class="literal string double">&quot;</span><span class="literal string interpol">{word2}</span><span class="literal string double"> </span><span class="literal string interpol">{word1}</span><span class="literal string double">&quot;</span><span class="punctuation">)</span><span class="literal string single">'bar foo'</span></pre></div><div class="section" id="detach-searched-string"><h2>Detach searched string</h2><p>A match object contains a reference to the string that was searched, via its <tt class="docutils literal">string</tt> attribute. The <tt class="docutils literal">detach_string</tt> method will 'detach' that string, making it available for garbage collection, which might save valuable memory if that string is very large.</p><pre class="code python literal-block"><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span> <span class="operator">=</span> <span class="name">regex</span><span class="operator">.</span><span class="name">search</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;\w+&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;Hello world&quot;</span><span class="punctuation">)</span><span class="operator">&gt;&gt;&gt;</span> <span class="name builtin">print</span><span class="punctuation">(</span><span class="name">m</span><span class="operator">.</span><span class="name">group</span><span class="punctuation">())</span><span class="name">Hello</span><span class="operator">&gt;&gt;&gt;</span> <span class="name builtin">print</span><span class="punctuation">(</span><span class="name">m</span><span class="operator">.</span><span class="name">string</span><span class="punctuation">)</span><span class="name">Hello</span> <span class="name">world</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">detach_string</span><span class="punctuation">()</span><span class="operator">&gt;&gt;&gt;</span> <span class="name builtin">print</span><span class="punctuation">(</span><span class="name">m</span><span class="operator">.</span><span class="name">group</span><span class="punctuation">())</span><span class="name">Hello</span><span class="operator">&gt;&gt;&gt;</span> <span class="name builtin">print</span><span class="punctuation">(</span><span class="name">m</span><span class="operator">.</span><span class="name">string</span><span class="punctuation">)</span><span class="keyword constant">None</span></pre></div><div class="section" id="recursive-patterns-hg-issue-27"><h2>Recursive patterns (<a class="reference external" href="https://github.com/mrabarnett/mrab-regex/issues/27">Hg issue 27</a>)</h2><p>Recursive and repeated patterns are supported.</p><p><tt class="docutils literal"><span class="pre">(?R)</span></tt> or <tt class="docutils literal"><span class="pre">(?0)</span></tt> tries to match the entire regex recursively. <tt class="docutils literal"><span class="pre">(?1)</span></tt>, <tt class="docutils literal"><span class="pre">(?2)</span></tt>, etc, try to match the relevant group.</p><p><tt class="docutils literal"><span class="pre">(?&amp;name)</span></tt> tries to match the named group.</p><pre class="code python literal-block"><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">match</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;(Tarzan|Jane) loves (?1)&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;Tarzan loves Jane&quot;</span><span class="punctuation">)</span><span class="operator">.</span><span class="name">groups</span><span class="punctuation">()</span><span class="punctuation">(</span><span class="literal string single">'Tarzan'</span><span class="punctuation">,)</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">match</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;(Tarzan|Jane) loves (?1)&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;Jane loves Tarzan&quot;</span><span class="punctuation">)</span><span class="operator">.</span><span class="name">groups</span><span class="punctuation">()</span><span class="punctuation">(</span><span class="literal string single">'Jane'</span><span class="punctuation">,)</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span> <span class="operator">=</span> <span class="name">regex</span><span class="operator">.</span><span class="name">search</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;(\w)(?:(?R)|(\w?))\1&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;kayak&quot;</span><span class="punctuation">)</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">group</span><span class="punctuation">(</span><span class="literal number integer">0</span><span class="punctuation">,</span> <span class="literal number integer">1</span><span class="punctuation">,</span> <span class="literal number integer">2</span><span class="punctuation">)</span><span class="punctuation">(</span><span class="literal string single">'kayak'</span><span class="punctuation">,</span> <span class="literal string single">'k'</span><span class="punctuation">,</span> <span class="keyword constant">None</span><span class="punctuation">)</span></pre><p>The first two examples show how the subpattern within the group is reused, but is _not_ itself a group. In other words, <tt class="docutils literal">&quot;(Tarzan|Jane) loves <span class="pre">(?1)&quot;</span></tt> is equivalent to <tt class="docutils literal">&quot;(Tarzan|Jane) loves <span class="pre">(?:Tarzan|Jane)&quot;</span></tt>.</p><p>It's possible to backtrack into a recursed or repeated group.</p><p>You can't call a group if there is more than one group with that group name or group number (<tt class="docutils literal">&quot;ambiguous group reference&quot;</tt>).</p><p>The alternative forms <tt class="docutils literal"><span class="pre">(?P&gt;name)</span></tt> and <tt class="docutils literal"><span class="pre">(?P&amp;name)</span></tt> are also supported.</p></div><div class="section" id="full-unicode-case-folding-is-supported"><h2>Full Unicode case-folding is supported</h2><p>In version 1 behaviour, the regex module uses full case-folding when performing case-insensitive matches in Unicode.</p><pre class="code python literal-block"><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">match</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;(?iV1)strasse&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;stra</span><span class="literal string escape">\N{LATIN SMALL LETTER SHARP S}</span><span class="literal string double">e&quot;</span><span class="punctuation">)</span><span class="operator">.</span><span class="name">span</span><span class="punctuation">()</span><span class="punctuation">(</span><span class="literal number integer">0</span><span class="punctuation">,</span> <span class="literal number integer">6</span><span class="punctuation">)</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">match</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;(?iV1)stra\N{LATIN SMALL LETTER SHARP S}e&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;STRASSE&quot;</span><span class="punctuation">)</span><span class="operator">.</span><span class="name">span</span><span class="punctuation">()</span><span class="punctuation">(</span><span class="literal number integer">0</span><span class="punctuation">,</span> <span class="literal number integer">7</span><span class="punctuation">)</span></pre><p>In version 0 behaviour, it uses simple case-folding for backward compatibility with the re module.</p></div><div class="section" id="approximate-fuzzy-matching-hg-issue-12-hg-issue-41-hg-issue-109"><h2>Approximate &quot;fuzzy&quot; matching (<a class="reference external" href="https://github.com/mrabarnett/mrab-regex/issues/12">Hg issue 12</a>, <a class="reference external" href="https://github.com/mrabarnett/mrab-regex/issues/41">Hg issue 41</a>, <a class="reference external" href="https://github.com/mrabarnett/mrab-regex/issues/109">Hg issue 109</a>)</h2><p>Regex usually attempts an exact match, but sometimes an approximate, or &quot;fuzzy&quot;, match is needed, for those cases where the text being searched may contain errors in the form of inserted, deleted or substituted characters.</p><p>A fuzzy regex specifies which types of errors are permitted, and, optionally, either the minimum and maximum or only the maximum permitted number of each type. (You cannot specify only a minimum.)</p><p>The 3 types of error are:</p><ul class="simple"><li>Insertion, indicated by &quot;i&quot;</li><li>Deletion, indicated by &quot;d&quot;</li><li>Substitution, indicated by &quot;s&quot;</li></ul><p>In addition, &quot;e&quot; indicates any type of error.</p><p>The fuzziness of a regex item is specified between &quot;{&quot; and &quot;}&quot; after the item.</p><p>Examples:</p><ul class="simple"><li><tt class="docutils literal">foo</tt> match &quot;foo&quot; exactly</li><li><tt class="docutils literal"><span class="pre">(?:foo){i}</span></tt> match &quot;foo&quot;, permitting insertions</li><li><tt class="docutils literal"><span class="pre">(?:foo){d}</span></tt> match &quot;foo&quot;, permitting deletions</li><li><tt class="docutils literal"><span class="pre">(?:foo){s}</span></tt> match &quot;foo&quot;, permitting substitutions</li><li><tt class="docutils literal"><span class="pre">(?:foo){i,s}</span></tt> match &quot;foo&quot;, permitting insertions and substitutions</li><li><tt class="docutils literal"><span class="pre">(?:foo){e}</span></tt> match &quot;foo&quot;, permitting errors</li></ul><p>If a certain type of error is specified, then any type not specified will <strong>not</strong> be permitted.</p><p>In the following examples I'll omit the item and write only the fuzziness:</p><ul class="simple"><li><tt class="docutils literal"><span class="pre">{d&lt;=3}</span></tt> permit at most 3 deletions, but no other types</li><li><tt class="docutils literal"><span class="pre">{i&lt;=1,s&lt;=2}</span></tt> permit at most 1 insertion and at most 2 substitutions, but no deletions</li><li><tt class="docutils literal"><span class="pre">{1&lt;=e&lt;=3}</span></tt> permit at least 1 and at most 3 errors</li><li><tt class="docutils literal"><span class="pre">{i&lt;=2,d&lt;=2,e&lt;=3}</span></tt> permit at most 2 insertions, at most 2 deletions, at most 3 errors in total, but no substitutions</li></ul><p>It's also possible to state the costs of each type of error and the maximum permitted total cost.</p><p>Examples:</p><ul class="simple"><li><tt class="docutils literal"><span class="pre">{2i+2d+1s&lt;=4}</span></tt> each insertion costs 2, each deletion costs 2, each substitution costs 1, the total cost must not exceed 4</li><li><tt class="docutils literal"><span class="pre">{i&lt;=1,d&lt;=1,s&lt;=1,2i+2d+1s&lt;=4}</span></tt> at most 1 insertion, at most 1 deletion, at most 1 substitution; each insertion costs 2, each deletion costs 2, each substitution costs 1, the total cost must not exceed 4</li></ul><p>You can also use &quot;&lt;&quot; instead of &quot;&lt;=&quot; if you want an exclusive minimum or maximum.</p><p>You can add a test to perform on a character that's substituted or inserted.</p><p>Examples:</p><ul class="simple"><li><tt class="docutils literal"><span class="pre">{s&lt;=2:[a-z]}</span></tt> at most 2 substitutions, which must be in the character set <tt class="docutils literal"><span class="pre">[a-z]</span></tt>.</li><li><tt class="docutils literal"><span class="pre">{s&lt;=2,i&lt;=3:\d}</span></tt> at most 2 substitutions, at most 3 insertions, which must be digits.</li></ul><p>By default, fuzzy matching searches for the first match that meets the given constraints. The <tt class="docutils literal">ENHANCEMATCH</tt> flag will cause it to attempt to improve the fit (i.e. reduce the number of errors) of the match that it has found.</p><p>The <tt class="docutils literal">BESTMATCH</tt> flag will make it search for the best match instead.</p><p>Further examples to note:</p><ul class="simple"><li><tt class="docutils literal"><span class="pre">regex.search(&quot;(dog){e}&quot;,</span> &quot;cat and <span class="pre">dog&quot;)[1]</span></tt> returns <tt class="docutils literal">&quot;cat&quot;</tt> because that matches <tt class="docutils literal">&quot;dog&quot;</tt> with 3 errors (an unlimited number of errors is permitted).</li><li><tt class="docutils literal"><span class="pre">regex.search(&quot;(dog){e&lt;=1}&quot;,</span> &quot;cat and <span class="pre">dog&quot;)[1]</span></tt> returns <tt class="docutils literal">&quot; dog&quot;</tt> (with a leading space) because that matches <tt class="docutils literal">&quot;dog&quot;</tt> with 1 error, which is within the limit.</li><li><tt class="docutils literal"><span class="pre">regex.search(&quot;(?e)(dog){e&lt;=1}&quot;,</span> &quot;cat and <span class="pre">dog&quot;)[1]</span></tt> returns <tt class="docutils literal">&quot;dog&quot;</tt> (without a leading space) because the fuzzy search matches <tt class="docutils literal">&quot; dog&quot;</tt> with 1 error, which is within the limit, and the <tt class="docutils literal"><span class="pre">(?e)</span></tt> then it attempts a better fit.</li></ul><p>In the first two examples there are perfect matches later in the string, but in neither case is it the first possible match.</p><p>The match object has an attribute <tt class="docutils literal">fuzzy_counts</tt> which gives the total number of substitutions, insertions and deletions.</p><pre class="code python literal-block"><span class="operator">&gt;&gt;&gt;</span> <span class="comment single"># A 'raw' fuzzy match:</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">fullmatch</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;(?:cats|cat){e&lt;=1}&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;cat&quot;</span><span class="punctuation">)</span><span class="operator">.</span><span class="name">fuzzy_counts</span><span class="punctuation">(</span><span class="literal number integer">0</span><span class="punctuation">,</span> <span class="literal number integer">0</span><span class="punctuation">,</span> <span class="literal number integer">1</span><span class="punctuation">)</span><span class="operator">&gt;&gt;&gt;</span> <span class="comment single"># 0 substitutions, 0 insertions, 1 deletion.</span><span class="operator">&gt;&gt;&gt;</span> <span class="comment single"># A better match might be possible if the ENHANCEMATCH flag used:</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">fullmatch</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;(?e)(?:cats|cat){e&lt;=1}&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;cat&quot;</span><span class="punctuation">)</span><span class="operator">.</span><span class="name">fuzzy_counts</span><span class="punctuation">(</span><span class="literal number integer">0</span><span class="punctuation">,</span> <span class="literal number integer">0</span><span class="punctuation">,</span> <span class="literal number integer">0</span><span class="punctuation">)</span><span class="operator">&gt;&gt;&gt;</span> <span class="comment single"># 0 substitutions, 0 insertions, 0 deletions.</span></pre><p>The match object also has an attribute <tt class="docutils literal">fuzzy_changes</tt> which gives a tuple of the positions of the substitutions, insertions and deletions.</p><pre class="code python literal-block"><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span> <span class="operator">=</span> <span class="name">regex</span><span class="operator">.</span><span class="name">search</span><span class="punctuation">(</span><span class="literal string single">'(fuu){i&lt;=2,d&lt;=2,e&lt;=5}'</span><span class="punctuation">,</span> <span class="literal string single">'anaconda foo bar'</span><span class="punctuation">)</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">&lt;</span><span class="name">regex</span><span class="operator">.</span><span class="name">Match</span> <span class="name builtin">object</span><span class="punctuation">;</span> <span class="name">span</span><span class="operator">=</span><span class="punctuation">(</span><span class="literal number integer">7</span><span class="punctuation">,</span> <span class="literal number integer">10</span><span class="punctuation">),</span> <span class="name">match</span><span class="operator">=</span><span class="literal string single">'a f'</span><span class="punctuation">,</span> <span class="name">fuzzy_counts</span><span class="operator">=</span><span class="punctuation">(</span><span class="literal number integer">0</span><span class="punctuation">,</span> <span class="literal number integer">2</span><span class="punctuation">,</span> <span class="literal number integer">2</span><span class="punctuation">)</span><span class="operator">&gt;</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">fuzzy_changes</span><span class="punctuation">([],</span> <span class="punctuation">[</span><span class="literal number integer">7</span><span class="punctuation">,</span> <span class="literal number integer">8</span><span class="punctuation">],</span> <span class="punctuation">[</span><span class="literal number integer">10</span><span class="punctuation">,</span> <span class="literal number integer">11</span><span class="punctuation">])</span></pre><p>What this means is that if the matched part of the string had been:</p><pre class="code python literal-block"><span class="literal string single">'anacondfuuoo bar'</span></pre><p>it would've been an exact match.</p><p>However, there were insertions at positions 7 and 8:</p><pre class="code python literal-block"><span class="literal string single">'anaconda fuuoo bar'</span>        <span class="operator">^^</span></pre><p>and deletions at positions 10 and 11:</p><pre class="code python literal-block"><span class="literal string single">'anaconda f~~oo bar'</span>           <span class="operator">^^</span></pre><p>So the actual string was:</p><pre class="code python literal-block"><span class="literal string single">'anaconda foo bar'</span></pre></div><div class="section" id="named-lists-l-name-hg-issue-11"><h2>Named lists <tt class="docutils literal">\L&lt;name&gt;</tt> (<a class="reference external" href="https://github.com/mrabarnett/mrab-regex/issues/11">Hg issue 11</a>)</h2><p>There are occasions where you may want to include a list (actually, a set) of options in a regex.</p><p>One way is to build the pattern like this:</p><pre class="code python literal-block"><span class="operator">&gt;&gt;&gt;</span> <span class="name">p</span> <span class="operator">=</span> <span class="name">regex</span><span class="operator">.</span><span class="name">compile</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;first|second|third|fourth|fifth&quot;</span><span class="punctuation">)</span></pre><p>but if the list is large, parsing the resulting regex can take considerable time, and care must also be taken that the strings are properly escaped and properly ordered, for example, &quot;cats&quot; before &quot;cat&quot;.</p><p>The new alternative is to use a named list:</p><pre class="code python literal-block"><span class="operator">&gt;&gt;&gt;</span> <span class="name">option_set</span> <span class="operator">=</span> <span class="punctuation">[</span><span class="literal string double">&quot;first&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;second&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;third&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;fourth&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;fifth&quot;</span><span class="punctuation">]</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">p</span> <span class="operator">=</span> <span class="name">regex</span><span class="operator">.</span><span class="name">compile</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;\L&lt;options&gt;&quot;</span><span class="punctuation">,</span> <span class="name">options</span><span class="operator">=</span><span class="name">option_set</span><span class="punctuation">)</span></pre><p>The order of the items is irrelevant, they are treated as a set. The named lists are available as the <tt class="docutils literal">.named_lists</tt> attribute of the pattern object :</p><pre class="code python literal-block"><span class="operator">&gt;&gt;&gt;</span> <span class="name builtin">print</span><span class="punctuation">(</span><span class="name">p</span><span class="operator">.</span><span class="name">named_lists</span><span class="punctuation">)</span><span class="punctuation">{</span><span class="literal string single">'options'</span><span class="punctuation">:</span> <span class="name builtin">frozenset</span><span class="punctuation">({</span><span class="literal string single">'third'</span><span class="punctuation">,</span> <span class="literal string single">'first'</span><span class="punctuation">,</span> <span class="literal string single">'fifth'</span><span class="punctuation">,</span> <span class="literal string single">'fourth'</span><span class="punctuation">,</span> <span class="literal string single">'second'</span><span class="punctuation">})}</span></pre><p>If there are any unused keyword arguments, <tt class="docutils literal">ValueError</tt> will be raised unless you tell it otherwise:</p><pre class="code python literal-block"><span class="operator">&gt;&gt;&gt;</span> <span class="name">option_set</span> <span class="operator">=</span> <span class="punctuation">[</span><span class="literal string double">&quot;first&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;second&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;third&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;fourth&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;fifth&quot;</span><span class="punctuation">]</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">p</span> <span class="operator">=</span> <span class="name">regex</span><span class="operator">.</span><span class="name">compile</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;\L&lt;options&gt;&quot;</span><span class="punctuation">,</span> <span class="name">options</span><span class="operator">=</span><span class="name">option_set</span><span class="punctuation">,</span> <span class="name">other_options</span><span class="operator">=</span><span class="punctuation">[])</span><span class="name">Traceback</span> <span class="punctuation">(</span><span class="name">most</span> <span class="name">recent</span> <span class="name">call</span> <span class="name">last</span><span class="punctuation">):</span>  <span class="name">File</span> <span class="literal string double">&quot;&lt;stdin&gt;&quot;</span><span class="punctuation">,</span> <span class="name">line</span> <span class="literal number integer">1</span><span class="punctuation">,</span> <span class="operator word">in</span> <span class="operator">&lt;</span><span class="name">module</span><span class="operator">&gt;</span>  <span class="name">File</span> <span class="literal string double">&quot;C:\Python310\lib\site-packages</span><span class="literal string escape">\r</span><span class="literal string double">egex</span><span class="literal string escape">\r</span><span class="literal string double">egex.py&quot;</span><span class="punctuation">,</span> <span class="name">line</span> <span class="literal number integer">353</span><span class="punctuation">,</span> <span class="operator word">in</span> <span class="name builtin">compile</span>    <span class="keyword">return</span> <span class="name">_compile</span><span class="punctuation">(</span><span class="name">pattern</span><span class="punctuation">,</span> <span class="name">flags</span><span class="punctuation">,</span> <span class="name">ignore_unused</span><span class="punctuation">,</span> <span class="name">kwargs</span><span class="punctuation">,</span> <span class="name">cache_pattern</span><span class="punctuation">)</span>  <span class="name">File</span> <span class="literal string double">&quot;C:\Python310\lib\site-packages</span><span class="literal string escape">\r</span><span class="literal string double">egex</span><span class="literal string escape">\r</span><span class="literal string double">egex.py&quot;</span><span class="punctuation">,</span> <span class="name">line</span> <span class="literal number integer">500</span><span class="punctuation">,</span> <span class="operator word">in</span> <span class="name">_compile</span>    <span class="name">complain_unused_args</span><span class="punctuation">()</span>  <span class="name">File</span> <span class="literal string double">&quot;C:\Python310\lib\site-packages</span><span class="literal string escape">\r</span><span class="literal string double">egex</span><span class="literal string escape">\r</span><span class="literal string double">egex.py&quot;</span><span class="punctuation">,</span> <span class="name">line</span> <span class="literal number integer">483</span><span class="punctuation">,</span> <span class="operator word">in</span> <span class="name">complain_unused_args</span>    <span class="keyword">raise</span> <span class="name exception">ValueError</span><span class="punctuation">(</span><span class="literal string single">'unused keyword argument </span><span class="literal string interpol">{!a}</span><span class="literal string single">'</span><span class="operator">.</span><span class="name">format</span><span class="punctuation">(</span><span class="name">any_one</span><span class="punctuation">))</span><span class="name exception">ValueError</span><span class="punctuation">:</span> <span class="name">unused</span> <span class="name">keyword</span> <span class="name">argument</span> <span class="literal string single">'other_options'</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">p</span> <span class="operator">=</span> <span class="name">regex</span><span class="operator">.</span><span class="name">compile</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;\L&lt;options&gt;&quot;</span><span class="punctuation">,</span> <span class="name">options</span><span class="operator">=</span><span class="name">option_set</span><span class="punctuation">,</span> <span class="name">other_options</span><span class="operator">=</span><span class="punctuation">[],</span> <span class="name">ignore_unused</span><span class="operator">=</span><span class="keyword constant">True</span><span class="punctuation">)</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">p</span> <span class="operator">=</span> <span class="name">regex</span><span class="operator">.</span><span class="name">compile</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;\L&lt;options&gt;&quot;</span><span class="punctuation">,</span> <span class="name">options</span><span class="operator">=</span><span class="name">option_set</span><span class="punctuation">,</span> <span class="name">other_options</span><span class="operator">=</span><span class="punctuation">[],</span> <span class="name">ignore_unused</span><span class="operator">=</span><span class="keyword constant">False</span><span class="punctuation">)</span><span class="name">Traceback</span> <span class="punctuation">(</span><span class="name">most</span> <span class="name">recent</span> <span class="name">call</span> <span class="name">last</span><span class="punctuation">):</span>  <span class="name">File</span> <span class="literal string double">&quot;&lt;stdin&gt;&quot;</span><span class="punctuation">,</span> <span class="name">line</span> <span class="literal number integer">1</span><span class="punctuation">,</span> <span class="operator word">in</span> <span class="operator">&lt;</span><span class="name">module</span><span class="operator">&gt;</span>  <span class="name">File</span> <span class="literal string double">&quot;C:\Python310\lib\site-packages</span><span class="literal string escape">\r</span><span class="literal string double">egex</span><span class="literal string escape">\r</span><span class="literal string double">egex.py&quot;</span><span class="punctuation">,</span> <span class="name">line</span> <span class="literal number integer">353</span><span class="punctuation">,</span> <span class="operator word">in</span> <span class="name builtin">compile</span>    <span class="keyword">return</span> <span class="name">_compile</span><span class="punctuation">(</span><span class="name">pattern</span><span class="punctuation">,</span> <span class="name">flags</span><span class="punctuation">,</span> <span class="name">ignore_unused</span><span class="punctuation">,</span> <span class="name">kwargs</span><span class="punctuation">,</span> <span class="name">cache_pattern</span><span class="punctuation">)</span>  <span class="name">File</span> <span class="literal string double">&quot;C:\Python310\lib\site-packages</span><span class="literal string escape">\r</span><span class="literal string double">egex</span><span class="literal string escape">\r</span><span class="literal string double">egex.py&quot;</span><span class="punctuation">,</span> <span class="name">line</span> <span class="literal number integer">500</span><span class="punctuation">,</span> <span class="operator word">in</span> <span class="name">_compile</span>    <span class="name">complain_unused_args</span><span class="punctuation">()</span>  <span class="name">File</span> <span class="literal string double">&quot;C:\Python310\lib\site-packages</span><span class="literal string escape">\r</span><span class="literal string double">egex</span><span class="literal string escape">\r</span><span class="literal string double">egex.py&quot;</span><span class="punctuation">,</span> <span class="name">line</span> <span class="literal number integer">483</span><span class="punctuation">,</span> <span class="operator word">in</span> <span class="name">complain_unused_args</span>    <span class="keyword">raise</span> <span class="name exception">ValueError</span><span class="punctuation">(</span><span class="literal string single">'unused keyword argument </span><span class="literal string interpol">{!a}</span><span class="literal string single">'</span><span class="operator">.</span><span class="name">format</span><span class="punctuation">(</span><span class="name">any_one</span><span class="punctuation">))</span><span class="name exception">ValueError</span><span class="punctuation">:</span> <span class="name">unused</span> <span class="name">keyword</span> <span class="name">argument</span> <span class="literal string single">'other_options'</span><span class="operator">&gt;&gt;&gt;</span></pre></div><div class="section" id="start-and-end-of-word"><h2>Start and end of word</h2><p><tt class="docutils literal">\m</tt> matches at the start of a word.</p><p><tt class="docutils literal">\M</tt> matches at the end of a word.</p><p>Compare with <tt class="docutils literal">\b</tt>, which matches at the start or end of a word.</p></div><div class="section" id="unicode-line-separators"><h2>Unicode line separators</h2><p>Normally the only line separator is <tt class="docutils literal">\n</tt> (<tt class="docutils literal">\x0A</tt>), but if the <tt class="docutils literal">WORD</tt> flag is turned on then the line separators are <tt class="docutils literal">\x0D\x0A</tt>, <tt class="docutils literal">\x0A</tt>, <tt class="docutils literal">\x0B</tt>, <tt class="docutils literal">\x0C</tt> and <tt class="docutils literal">\x0D</tt>, plus <tt class="docutils literal">\x85</tt>, <tt class="docutils literal">\u2028</tt> and <tt class="docutils literal">\u2029</tt> when working with Unicode.</p><p>This affects the regex dot <tt class="docutils literal">&quot;.&quot;</tt>, which, with the <tt class="docutils literal">DOTALL</tt> flag turned off, matches any character except a line separator. It also affects the line anchors <tt class="docutils literal">^</tt> and <tt class="docutils literal">$</tt> (in multiline mode).</p></div><div class="section" id="set-operators"><h2>Set operators</h2><p><strong>Version 1 behaviour only</strong></p><p>Set operators have been added, and a set <tt class="docutils literal"><span class="pre">[...]</span></tt> can include nested sets.</p><p>The operators, in order of increasing precedence, are:</p><ul class="simple"><li><tt class="docutils literal">||</tt> for union (&quot;x||y&quot; means &quot;x or y&quot;)</li><li><tt class="docutils literal">~~</tt> (double tilde) for symmetric difference (&quot;x~~y&quot; means &quot;x or y, but not both&quot;)</li><li><tt class="docutils literal">&amp;&amp;</tt> for intersection (&quot;x&amp;&amp;y&quot; means &quot;x and y&quot;)</li><li><tt class="docutils literal"><span class="pre">--</span></tt> (double dash) for difference (&quot;x--y&quot; means &quot;x but not y&quot;)</li></ul><p>Implicit union, ie, simple juxtaposition like in <tt class="docutils literal">[ab]</tt>, has the highest precedence. Thus, <tt class="docutils literal"><span class="pre">[ab&amp;&amp;cd]</span></tt> is the same as <tt class="docutils literal"><span class="pre">[[a||b]&amp;&amp;[c||d]]</span></tt>.</p><p>Examples:</p><ul class="simple"><li><tt class="docutils literal">[ab]</tt> # Set containing 'a' and 'b'</li><li><tt class="docutils literal"><span class="pre">[a-z]</span></tt> # Set containing 'a' .. 'z'</li><li><tt class="docutils literal"><span class="pre">[[a-z]--[qw]]</span></tt> # Set containing 'a' .. 'z', but not 'q' or 'w'</li><li><tt class="docutils literal"><span class="pre">[a-z--qw]</span></tt> # Same as above</li><li><tt class="docutils literal"><span class="pre">[\p{L}--QW]</span></tt> # Set containing all letters except 'Q' and 'W'</li><li><tt class="docutils literal"><span class="pre">[\p{N}--[0-9]]</span></tt> # Set containing all numbers except '0' .. '9'</li><li><tt class="docutils literal"><span class="pre">[\p{ASCII}&amp;&amp;\p{Letter}]</span></tt> # Set containing all characters which are ASCII and letter</li></ul></div><div class="section" id="regex-escape-issue-2650"><h2>regex.escape (<a class="reference external" href="https://bugs.python.org/issue2650">issue #2650</a>)</h2><p>regex.escape has an additional keyword parameter <tt class="docutils literal">special_only</tt>. When True, only 'special' regex characters, such as '?', are escaped.</p><pre class="code python literal-block"><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">escape</span><span class="punctuation">(</span><span class="literal string double">&quot;foo!?&quot;</span><span class="punctuation">,</span> <span class="name">special_only</span><span class="operator">=</span><span class="keyword constant">False</span><span class="punctuation">)</span><span class="literal string single">'foo</span><span class="literal string escape">\\</span><span class="literal string single">!</span><span class="literal string escape">\\</span><span class="literal string single">?'</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">escape</span><span class="punctuation">(</span><span class="literal string double">&quot;foo!?&quot;</span><span class="punctuation">,</span> <span class="name">special_only</span><span class="operator">=</span><span class="keyword constant">True</span><span class="punctuation">)</span><span class="literal string single">'foo!</span><span class="literal string escape">\\</span><span class="literal string single">?'</span></pre></div><div class="section" id="regex-escape-hg-issue-249"><h2>regex.escape (<a class="reference external" href="https://github.com/mrabarnett/mrab-regex/issues/249">Hg issue 249</a>)</h2><p>regex.escape has an additional keyword parameter <tt class="docutils literal">literal_spaces</tt>. When True, spaces are not escaped.</p><pre class="code python literal-block"><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">escape</span><span class="punctuation">(</span><span class="literal string double">&quot;foo bar!?&quot;</span><span class="punctuation">,</span> <span class="name">literal_spaces</span><span class="operator">=</span><span class="keyword constant">False</span><span class="punctuation">)</span><span class="literal string single">'foo</span><span class="literal string escape">\\</span><span class="literal string single"> bar!</span><span class="literal string escape">\\</span><span class="literal string single">?'</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">escape</span><span class="punctuation">(</span><span class="literal string double">&quot;foo bar!?&quot;</span><span class="punctuation">,</span> <span class="name">literal_spaces</span><span class="operator">=</span><span class="keyword constant">True</span><span class="punctuation">)</span><span class="literal string single">'foo bar!</span><span class="literal string escape">\\</span><span class="literal string single">?'</span></pre></div><div class="section" id="repeated-captures-issue-7132"><h2>Repeated captures (<a class="reference external" href="https://bugs.python.org/issue7132">issue #7132</a>)</h2><p>A match object has additional methods which return information on all the successful matches of a repeated group. These methods are:</p><ul class="simple"><li><tt class="docutils literal"><span class="pre">matchobject.captures([group1,</span> <span class="pre">...])</span></tt><ul><li>Returns a list of the strings matched in a group or groups. Compare with <tt class="docutils literal"><span class="pre">matchobject.group([group1,</span> <span class="pre">...])</span></tt>.</li></ul></li><li><tt class="docutils literal"><span class="pre">matchobject.starts([group])</span></tt><ul><li>Returns a list of the start positions. Compare with <tt class="docutils literal"><span class="pre">matchobject.start([group])</span></tt>.</li></ul></li><li><tt class="docutils literal"><span class="pre">matchobject.ends([group])</span></tt><ul><li>Returns a list of the end positions. Compare with <tt class="docutils literal"><span class="pre">matchobject.end([group])</span></tt>.</li></ul></li><li><tt class="docutils literal"><span class="pre">matchobject.spans([group])</span></tt><ul><li>Returns a list of the spans. Compare with <tt class="docutils literal"><span class="pre">matchobject.span([group])</span></tt>.</li></ul></li></ul><pre class="code python literal-block"><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span> <span class="operator">=</span> <span class="name">regex</span><span class="operator">.</span><span class="name">search</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;(\w</span><span class="literal string interpol">{3}</span><span class="literal string double">)+&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;123456789&quot;</span><span class="punctuation">)</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">group</span><span class="punctuation">(</span><span class="literal number integer">1</span><span class="punctuation">)</span><span class="literal string single">'789'</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">captures</span><span class="punctuation">(</span><span class="literal number integer">1</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="literal string single">'123'</span><span class="punctuation">,</span> <span class="literal string single">'456'</span><span class="punctuation">,</span> <span class="literal string single">'789'</span><span class="punctuation">]</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">start</span><span class="punctuation">(</span><span class="literal number integer">1</span><span class="punctuation">)</span><span class="literal number integer">6</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">starts</span><span class="punctuation">(</span><span class="literal number integer">1</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="literal number integer">0</span><span class="punctuation">,</span> <span class="literal number integer">3</span><span class="punctuation">,</span> <span class="literal number integer">6</span><span class="punctuation">]</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">end</span><span class="punctuation">(</span><span class="literal number integer">1</span><span class="punctuation">)</span><span class="literal number integer">9</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">ends</span><span class="punctuation">(</span><span class="literal number integer">1</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="literal number integer">3</span><span class="punctuation">,</span> <span class="literal number integer">6</span><span class="punctuation">,</span> <span class="literal number integer">9</span><span class="punctuation">]</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">span</span><span class="punctuation">(</span><span class="literal number integer">1</span><span class="punctuation">)</span><span class="punctuation">(</span><span class="literal number integer">6</span><span class="punctuation">,</span> <span class="literal number integer">9</span><span class="punctuation">)</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span><span class="operator">.</span><span class="name">spans</span><span class="punctuation">(</span><span class="literal number integer">1</span><span class="punctuation">)</span><span class="punctuation">[(</span><span class="literal number integer">0</span><span class="punctuation">,</span> <span class="literal number integer">3</span><span class="punctuation">),</span> <span class="punctuation">(</span><span class="literal number integer">3</span><span class="punctuation">,</span> <span class="literal number integer">6</span><span class="punctuation">),</span> <span class="punctuation">(</span><span class="literal number integer">6</span><span class="punctuation">,</span> <span class="literal number integer">9</span><span class="punctuation">)]</span></pre></div><div class="section" id="atomic-grouping-issue-433030"><h2>Atomic grouping <tt class="docutils literal"><span class="pre">(?&gt;...)</span></tt> (<a class="reference external" href="https://bugs.python.org/issue433030">issue #433030</a>)</h2><p>If the following pattern subsequently fails, then the subpattern as a whole will fail.</p></div><div class="section" id="possessive-quantifiers"><h2>Possessive quantifiers</h2><p><tt class="docutils literal"><span class="pre">(?:...)?+</span></tt> ; <tt class="docutils literal"><span class="pre">(?:...)*+</span></tt> ; <tt class="docutils literal"><span class="pre">(?:...)++</span></tt> ; <tt class="docutils literal"><span class="pre">(?:...){min,max}+</span></tt></p><p>The subpattern is matched up to 'max' times. If the following pattern subsequently fails, then all the repeated subpatterns will fail as a whole. For example, <tt class="docutils literal"><span class="pre">(?:...)++</span></tt> is equivalent to <tt class="docutils literal"><span class="pre">(?&gt;(?:...)+)</span></tt>.</p></div><div class="section" id="scoped-flags-issue-433028"><h2>Scoped flags (<a class="reference external" href="https://bugs.python.org/issue433028">issue #433028</a>)</h2><p><tt class="docutils literal"><span class="pre">(?flags-flags:...)</span></tt></p><p>The flags will apply only to the subpattern. Flags can be turned on or off.</p></div><div class="section" id="definition-of-word-character-issue-1693050"><h2>Definition of 'word' character (<a class="reference external" href="https://bugs.python.org/issue1693050">issue #1693050</a>)</h2><p>The definition of a 'word' character has been expanded for Unicode. It conforms to the Unicode specification at <tt class="docutils literal"><span class="pre">http://www.unicode.org/reports/tr29/</span></tt>.</p></div><div class="section" id="variable-length-lookbehind"><h2>Variable-length lookbehind</h2><p>A lookbehind can match a variable-length string.</p></div><div class="section" id="flags-argument-for-regex-split-regex-sub-and-regex-subn-issue-3482"><h2>Flags argument for regex.split, regex.sub and regex.subn (<a class="reference external" href="https://bugs.python.org/issue3482">issue #3482</a>)</h2><p><tt class="docutils literal">regex.split</tt>, <tt class="docutils literal">regex.sub</tt> and <tt class="docutils literal">regex.subn</tt> support a 'flags' argument.</p></div><div class="section" id="pos-and-endpos-arguments-for-regex-sub-and-regex-subn"><h2>Pos and endpos arguments for regex.sub and regex.subn</h2><p><tt class="docutils literal">regex.sub</tt> and <tt class="docutils literal">regex.subn</tt> support 'pos' and 'endpos' arguments.</p></div><div class="section" id="overlapped-argument-for-regex-findall-and-regex-finditer"><h2>'Overlapped' argument for regex.findall and regex.finditer</h2><p><tt class="docutils literal">regex.findall</tt> and <tt class="docutils literal">regex.finditer</tt> support an 'overlapped' flag which permits overlapped matches.</p></div><div class="section" id="splititer"><h2>Splititer</h2><p><tt class="docutils literal">regex.splititer</tt> has been added. It's a generator equivalent of <tt class="docutils literal">regex.split</tt>.</p></div><div class="section" id="subscripting-match-objects-for-groups"><h2>Subscripting match objects for groups</h2><p>A match object accepts access to the groups via subscripting and slicing:</p><pre class="code python literal-block"><span class="operator">&gt;&gt;&gt;</span> <span class="name">m</span> <span class="operator">=</span> <span class="name">regex</span><span class="operator">.</span><span class="name">search</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;(?P&lt;before&gt;.*?)(?P&lt;num&gt;\d+)(?P&lt;after&gt;.*)&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;pqr123stu&quot;</span><span class="punctuation">)</span><span class="operator">&gt;&gt;&gt;</span> <span class="name builtin">print</span><span class="punctuation">(</span><span class="name">m</span><span class="punctuation">[</span><span class="literal string double">&quot;before&quot;</span><span class="punctuation">])</span><span class="name">pqr</span><span class="operator">&gt;&gt;&gt;</span> <span class="name builtin">print</span><span class="punctuation">(</span><span class="name builtin">len</span><span class="punctuation">(</span><span class="name">m</span><span class="punctuation">))</span><span class="literal number integer">4</span><span class="operator">&gt;&gt;&gt;</span> <span class="name builtin">print</span><span class="punctuation">(</span><span class="name">m</span><span class="punctuation">[:])</span><span class="punctuation">(</span><span class="literal string single">'pqr123stu'</span><span class="punctuation">,</span> <span class="literal string single">'pqr'</span><span class="punctuation">,</span> <span class="literal string single">'123'</span><span class="punctuation">,</span> <span class="literal string single">'stu'</span><span class="punctuation">)</span></pre></div><div class="section" id="named-groups"><h2>Named groups</h2><p>Groups can be named with <tt class="docutils literal"><span class="pre">(?&lt;name&gt;...)</span></tt> as well as the existing <tt class="docutils literal"><span class="pre">(?P&lt;name&gt;...)</span></tt>.</p></div><div class="section" id="group-references"><h2>Group references</h2><p>Groups can be referenced within a pattern with <tt class="docutils literal">\g&lt;name&gt;</tt>. This also allows there to be more than 99 groups.</p></div><div class="section" id="named-characters-n-name"><h2>Named characters <tt class="docutils literal">\N{name}</tt></h2><p>Named characters are supported. Note that only those known by Python's Unicode database will be recognised.</p></div><div class="section" id="unicode-codepoint-properties-including-scripts-and-blocks"><h2>Unicode codepoint properties, including scripts and blocks</h2><p><tt class="docutils literal">\p{property=value}</tt>; <tt class="docutils literal">\P{property=value}</tt>; <tt class="docutils literal">\p{value}</tt> ; <tt class="docutils literal">\P{value}</tt></p><p>Many Unicode properties are supported, including blocks and scripts. <tt class="docutils literal">\p{property=value}</tt> or <tt class="docutils literal">\p{property:value}</tt> matches a character whose property <tt class="docutils literal">property</tt> has value <tt class="docutils literal">value</tt>. The inverse of <tt class="docutils literal">\p{property=value}</tt> is <tt class="docutils literal">\P{property=value}</tt> or <tt class="docutils literal"><span class="pre">\p{^property=value}</span></tt>.</p><p>If the short form <tt class="docutils literal">\p{value}</tt> is used, the properties are checked in the order: <tt class="docutils literal">General_Category</tt>, <tt class="docutils literal">Script</tt>, <tt class="docutils literal">Block</tt>, binary property:</p><ul class="simple"><li><tt class="docutils literal">Latin</tt>, the 'Latin' script (<tt class="docutils literal">Script=Latin</tt>).</li><li><tt class="docutils literal">BasicLatin</tt>, the 'BasicLatin' block (<tt class="docutils literal">Block=BasicLatin</tt>).</li><li><tt class="docutils literal">Alphabetic</tt>, the 'Alphabetic' binary property (<tt class="docutils literal">Alphabetic=Yes</tt>).</li></ul><p>A short form starting with <tt class="docutils literal">Is</tt> indicates a script or binary property:</p><ul class="simple"><li><tt class="docutils literal">IsLatin</tt>, the 'Latin' script (<tt class="docutils literal">Script=Latin</tt>).</li><li><tt class="docutils literal">IsAlphabetic</tt>, the 'Alphabetic' binary property (<tt class="docutils literal">Alphabetic=Yes</tt>).</li></ul><p>A short form starting with <tt class="docutils literal">In</tt> indicates a block property:</p><ul class="simple"><li><tt class="docutils literal">InBasicLatin</tt>, the 'BasicLatin' block (<tt class="docutils literal">Block=BasicLatin</tt>).</li></ul></div><div class="section" id="posix-character-classes"><h2>POSIX character classes</h2><p><tt class="docutils literal"><span class="pre">[[:alpha:]]</span></tt>; <tt class="docutils literal"><span class="pre">[[:^alpha:]]</span></tt></p><p>POSIX character classes are supported. These are normally treated as an alternative form of <tt class="docutils literal"><span class="pre">\p{...}</span></tt>.</p><p>The exceptions are <tt class="docutils literal">alnum</tt>, <tt class="docutils literal">digit</tt>, <tt class="docutils literal">punct</tt> and <tt class="docutils literal">xdigit</tt>, whose definitions are different from those of Unicode.</p><p><tt class="docutils literal"><span class="pre">[[:alnum:]]</span></tt> is equivalent to <tt class="docutils literal">\p{posix_alnum}</tt>.</p><p><tt class="docutils literal"><span class="pre">[[:digit:]]</span></tt> is equivalent to <tt class="docutils literal">\p{posix_digit}</tt>.</p><p><tt class="docutils literal"><span class="pre">[[:punct:]]</span></tt> is equivalent to <tt class="docutils literal">\p{posix_punct}</tt>.</p><p><tt class="docutils literal"><span class="pre">[[:xdigit:]]</span></tt> is equivalent to <tt class="docutils literal">\p{posix_xdigit}</tt>.</p></div><div class="section" id="search-anchor-g"><h2>Search anchor <tt class="docutils literal">\G</tt></h2><p>A search anchor has been added. It matches at the position where each search started/continued and can be used for contiguous matches or in negative variable-length lookbehinds to limit how far back the lookbehind goes:</p><pre class="code python literal-block"><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">findall</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;\w</span><span class="literal string interpol">{2}</span><span class="literal string double">&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;abcd ef&quot;</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="literal string single">'ab'</span><span class="punctuation">,</span> <span class="literal string single">'cd'</span><span class="punctuation">,</span> <span class="literal string single">'ef'</span><span class="punctuation">]</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">findall</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;\G\w</span><span class="literal string interpol">{2}</span><span class="literal string double">&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;abcd ef&quot;</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="literal string single">'ab'</span><span class="punctuation">,</span> <span class="literal string single">'cd'</span><span class="punctuation">]</span></pre><ul class="simple"><li>The search starts at position 0 and matches 'ab'.</li><li>The search continues at position 2 and matches 'cd'.</li><li>The search continues at position 4 and fails to match any letters.</li><li>The anchor stops the search start position from being advanced, so there are no more results.</li></ul></div><div class="section" id="reverse-searching"><h2>Reverse searching</h2><p>Searches can also work backwards:</p><pre class="code python literal-block"><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">findall</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;.&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;abc&quot;</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="literal string single">'a'</span><span class="punctuation">,</span> <span class="literal string single">'b'</span><span class="punctuation">,</span> <span class="literal string single">'c'</span><span class="punctuation">]</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">findall</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;(?r).&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;abc&quot;</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="literal string single">'c'</span><span class="punctuation">,</span> <span class="literal string single">'b'</span><span class="punctuation">,</span> <span class="literal string single">'a'</span><span class="punctuation">]</span></pre><p>Note that the result of a reverse search is not necessarily the reverse of a forward search:</p><pre class="code python literal-block"><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">findall</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;..&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;abcde&quot;</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="literal string single">'ab'</span><span class="punctuation">,</span> <span class="literal string single">'cd'</span><span class="punctuation">]</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">findall</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;(?r)..&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;abcde&quot;</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="literal string single">'de'</span><span class="punctuation">,</span> <span class="literal string single">'bc'</span><span class="punctuation">]</span></pre></div><div class="section" id="matching-a-single-grapheme-x"><h2>Matching a single grapheme <tt class="docutils literal">\X</tt></h2><p>The grapheme matcher is supported. It conforms to the Unicode specification at <tt class="docutils literal"><span class="pre">http://www.unicode.org/reports/tr29/</span></tt>.</p></div><div class="section" id="branch-reset"><h2>Branch reset <tt class="docutils literal"><span class="pre">(?|...|...)</span></tt></h2><p>Group numbers will be reused across the alternatives, but groups with different names will have different group numbers.</p><pre class="code python literal-block"><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">match</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;(?|(first)|(second))&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;first&quot;</span><span class="punctuation">)</span><span class="operator">.</span><span class="name">groups</span><span class="punctuation">()</span><span class="punctuation">(</span><span class="literal string single">'first'</span><span class="punctuation">,)</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">match</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string double">&quot;(?|(first)|(second))&quot;</span><span class="punctuation">,</span> <span class="literal string double">&quot;second&quot;</span><span class="punctuation">)</span><span class="operator">.</span><span class="name">groups</span><span class="punctuation">()</span><span class="punctuation">(</span><span class="literal string single">'second'</span><span class="punctuation">,)</span></pre><p>Note that there is only one group.</p></div><div class="section" id="default-unicode-word-boundary"><h2>Default Unicode word boundary</h2><p>The <tt class="docutils literal">WORD</tt> flag changes the definition of a 'word boundary' to that of a default Unicode word boundary. This applies to <tt class="docutils literal">\b</tt> and <tt class="docutils literal">\B</tt>.</p></div><div class="section" id="timeout"><h2>Timeout</h2><p>The matching methods and functions support timeouts. The timeout (in seconds) applies to the entire operation:</p><pre class="code python literal-block"><span class="operator">&gt;&gt;&gt;</span> <span class="keyword namespace">from</span> <span class="name namespace">time</span> <span class="keyword namespace">import</span> <span class="name">sleep</span><span class="operator">&gt;&gt;&gt;</span><span class="operator">&gt;&gt;&gt;</span> <span class="keyword">def</span> <span class="name function">fast_replace</span><span class="punctuation">(</span><span class="name">m</span><span class="punctuation">):</span><span class="operator">...</span>     <span class="keyword">return</span> <span class="literal string single">'X'</span><span class="operator">...</span><span class="operator">&gt;&gt;&gt;</span> <span class="keyword">def</span> <span class="name function">slow_replace</span><span class="punctuation">(</span><span class="name">m</span><span class="punctuation">):</span><span class="operator">...</span>     <span class="name">sleep</span><span class="punctuation">(</span><span class="literal number float">0.5</span><span class="punctuation">)</span><span class="operator">...</span>     <span class="keyword">return</span> <span class="literal string single">'X'</span><span class="operator">...</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">sub</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string single">'[a-z]'</span><span class="punctuation">,</span> <span class="name">fast_replace</span><span class="punctuation">,</span> <span class="literal string single">'abcde'</span><span class="punctuation">,</span> <span class="name">timeout</span><span class="operator">=</span><span class="literal number integer">2</span><span class="punctuation">)</span><span class="literal string single">'XXXXX'</span><span class="operator">&gt;&gt;&gt;</span> <span class="name">regex</span><span class="operator">.</span><span class="name">sub</span><span class="punctuation">(</span><span class="literal string affix">r</span><span class="literal string single">'[a-z]'</span><span class="punctuation">,</span> <span class="name">slow_replace</span><span class="punctuation">,</span> <span class="literal string single">'abcde'</span><span class="punctuation">,</span> <span class="name">timeout</span><span class="operator">=</span><span class="literal number integer">2</span><span class="punctuation">)</span><span class="name">Traceback</span> <span class="punctuation">(</span><span class="name">most</span> <span class="name">recent</span> <span class="name">call</span> <span class="name">last</span><span class="punctuation">):</span>  <span class="name">File</span> <span class="literal string double">&quot;&lt;stdin&gt;&quot;</span><span class="punctuation">,</span> <span class="name">line</span> <span class="literal number integer">1</span><span class="punctuation">,</span> <span class="operator word">in</span> <span class="operator">&lt;</span><span class="name">module</span><span class="operator">&gt;</span>  <span class="name">File</span> <span class="literal string double">&quot;C:\Python310\lib\site-packages</span><span class="literal string escape">\r</span><span class="literal string double">egex</span><span class="literal string escape">\r</span><span class="literal string double">egex.py&quot;</span><span class="punctuation">,</span> <span class="name">line</span> <span class="literal number integer">278</span><span class="punctuation">,</span> <span class="operator word">in</span> <span class="name">sub</span>    <span class="keyword">return</span> <span class="name">pat</span><span class="operator">.</span><span class="name">sub</span><span class="punctuation">(</span><span class="name">repl</span><span class="punctuation">,</span> <span class="name">string</span><span class="punctuation">,</span> <span class="name">count</span><span class="punctuation">,</span> <span class="name">pos</span><span class="punctuation">,</span> <span class="name">endpos</span><span class="punctuation">,</span> <span class="name">concurrent</span><span class="punctuation">,</span> <span class="name">timeout</span><span class="punctuation">)</span><span class="name exception">TimeoutError</span><span class="punctuation">:</span> <span class="name">regex</span> <span class="name">timed</span> <span class="name">out</span></pre></div></div></div></body></html>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2023/09/19/%E9%93%BE%E8%A1%A8%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98%E6%B1%87%E6%80%BB/"/>
      <url>/2023/09/19/%E9%93%BE%E8%A1%A8%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98%E6%B1%87%E6%80%BB/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>d</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2023/09/16/%E5%9F%BA%E6%95%B0%E6%8E%92%E5%BA%8F/"/>
      <url>/2023/09/16/%E5%9F%BA%E6%95%B0%E6%8E%92%E5%BA%8F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="font-color-red--font"><font color='red'></font></h2><p> <strong></strong>  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(NlogN)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">Nl</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span>  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>k</mi><mo></mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(k*N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span>  k N </p><p><img src="/2022/img/%E5%9F%BA%E6%95%B0%E6%8E%92%E5%BA%8F1.png" alt="1"></p><p> 10~19 20~29 </p><p>0~9</p><p>1<br><img src="/2022/img/%E5%9F%BA%E6%95%B0%E6%8E%92%E5%BA%8F2.png" alt=""></p><p> <code>count</code> </p><p><img src="/2022/img/%E5%9F%BA%E6%95%B0%E6%8E%92%E5%BA%8F3.png" alt=""></p><p> <code>count</code>  <code>count'</code> </p><p><img src="/2022/img/%E5%9F%BA%E6%95%B0%E6%8E%92%E5%BA%8F4.png" alt=""></p><p> <strong></strong> </p><ol><li> 99</li><li> 9</li><li> <code>count'</code>  9  10 </li><li> 10  0~9 </li><li> 99  0~9  9 </li><li> 99  <code>tmp[9]</code> </li><li><code>count'[9]--</code></li></ol><blockquote><p> 5 99  0~9  8  9  9  0~8  9  99  9   </p></blockquote><p> 45 </p><ol><li> 45</li><li> 5</li><li> <code>count'</code>  5  8 </li><li> 8  0~7 </li><li> 45  0~7  7 </li><li> 45  <code>tmp[7]</code> </li><li><code>count'[5]--</code></li></ol><p> 75</p><ol><li> 75</li><li> 5</li><li> <code>count'</code>  5  7  7 </li><li> 7  0~6 </li><li> 75  0~6  6 </li><li> 75  <code>tmp[6]</code> </li><li><code>count'[5]--</code></li></ol><p> 457525  <code>count'</code>  4  5  0~4  5  8  5~7 0~4  4  457525  5~7 xxx 457525 45 1 5~7  7 </p><p></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">getDigit</span><span class="params">(<span class="type">int</span> num, <span class="type">int</span> fig)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> digit;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; fig; i++)</span><br><span class="line">&#123;</span><br><span class="line">digit = num % <span class="number">10</span>;</span><br><span class="line">num /= <span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> digit;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">getMax</span><span class="params">(<span class="type">int</span>* arr, <span class="type">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> max = <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">&#123;</span><br><span class="line">max = max &gt; arr[i] ? max : arr[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> max;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">radixSort</span><span class="params">(<span class="type">int</span>* arr, <span class="type">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//int tmp[len]; ,len250w</span></span><br><span class="line">    <span class="type">int</span>* tmp = <span class="keyword">new</span> <span class="type">int</span>[len];</span><br><span class="line"><span class="type">int</span> max = <span class="built_in">getMax</span>(arr, len);</span><br><span class="line"><span class="type">int</span> d = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(max) <span class="comment">//</span></span><br><span class="line">&#123;</span><br><span class="line">max /= <span class="number">10</span>;</span><br><span class="line">d++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= d; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> count[<span class="number">10</span>] = &#123;<span class="number">0</span>&#125;; <span class="comment">//count,</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>; k &lt; len; k++) <span class="comment">//</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> n = <span class="built_in">getDigit</span>(arr[k], i);</span><br><span class="line">count[n]++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">1</span>; k &lt; <span class="number">10</span>; k++) <span class="comment">//</span></span><br><span class="line">count[k] += count[k<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> k = len<span class="number">-1</span>; k &gt;= <span class="number">0</span>; k--)<span class="comment">//</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> n = <span class="built_in">getDigit</span>(arr[k], i);</span><br><span class="line"><span class="type">int</span> pos = count[n] - <span class="number">1</span>;</span><br><span class="line">tmp[pos] = arr[k];</span><br><span class="line">count[n]--;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>; k &lt; len; k++) <span class="comment">//</span></span><br><span class="line">arr[k] = tmp[k];</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">delete</span>[] tmp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="font-color-red--font"><font color='red'></font></h2><p><strong></strong> </p><ul><li><strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(Nk)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></strong>  N k  k  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span> </li><li><strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>N</mi><mo>+</mo><mi>d</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(N+d)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mclose">)</span></span></span></span></strong>  N  d  <code>tmp</code>  <code>count</code> </li><li><strong></strong></li></ul><p>Function1Function2<br><img src="/2022/img/image-20230919175406473.png" alt="10w"></p><p><a href="https://www.zhihu.com/question/27064078">-</a> </p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2023/09/09/%E5%B8%8C%E5%B0%94%E6%8E%92%E5%BA%8F/"/>
      <url>/2023/09/09/%E5%B8%8C%E5%B0%94%E6%8E%92%E5%BA%8F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p><a href="https://www.zhihu.com/question/24637339/answer/84079774">-</a> <a href="https://zh.wikipedia.org/zh-cn/%E5%B8%8C%E5%B0%94%E6%8E%92%E5%BA%8F">wiki</a> chatGPT<a href="https://www.zhihu.com/question/24637339/answer/3159556193">-helloCode</a></p></blockquote><p> O(N^2^) </p><ul><li></li><li><strong><font color='orange'></font></strong></li></ul><blockquote><p><strong><u>O(N^2^) O(N^2^)</u></strong><br><a href="https://www.zhihu.com/question/24637339/answer/84079774">-</a></p><p> O(N^2^) </p></blockquote><p> <strong></strong> <br><img src="/2022/img/v2-e7da344ba84144f716e7e0cb87148f13_1440w.webp" alt="-"></p><p> 7 7  C++ </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T, <span class="keyword">class</span> cmptor&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">shellSort</span><span class="params">(T* vec, <span class="type">int</span> len, cmptor cmp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> gap = len/<span class="number">2</span>; gap &gt; <span class="number">0</span>; gap /= <span class="number">2</span>) <span class="comment">//gap&gt;0gap&gt;=0!!!</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> g = <span class="number">0</span>; g &lt; gap; g++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//insert sort</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = g+gap; i &lt; len; i += gap)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> k = i; k &gt; g; k -= gap) <span class="comment">//k&gt;gk&gt;0</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">cmp</span>(vec[k-gap], vec[k]))</span><br><span class="line"><span class="built_in">swap</span>(vec[k-gap], vec[k]);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><strong><font color='orange'>=</font></strong></li><li><strong><font color='orange'>i </font></strong></li><li><strong><font color='orange'>8 <a href="https://jyx-fyh.github.io/2022/09/11/%E5%86%92%E6%B3%A1%E3%80%81%E9%80%89%E6%8B%A9%E3%80%81%E6%8F%92%E5%85%A5%E3%80%81%E5%B8%8C%E5%B0%94%E6%8E%92%E5%BA%8F/"></a></font></strong></li></ul><p> gap  1/2 <strong><font color='orange'></font></strong> </p><ol><li> n/2  1 </li><li>Hibbard Hibbard  2^k - 1  k  1  n Hibbard 1, 3, 7, 15, , 2^k - 1</li><li>Sedgewick Sedgewick  Robert Sedgewick  Hibbard Sedgewick </li></ol><p><strong></strong></p><ol><li></li><li></li></ol><p><strong></strong></p><ol><li> O(N^2^)  O(N^1.3^) </li><li></li></ol>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vim</title>
      <link href="/2023/09/07/%E5%85%A5%E5%9D%91vim/"/>
      <url>/2023/09/07/%E5%85%A5%E5%9D%91vim/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><table><thead><tr><th><font color='red'></font></th><th></th></tr></thead><tbody><tr><td>vim -R filename</td><td> Vim </td></tr><tr><td>i</td><td></td></tr><tr><td>I</td><td></td></tr><tr><td>o</td><td></td></tr><tr><td>O</td><td></td></tr><tr><td>a</td><td></td></tr><tr><td>A</td><td></td></tr></tbody></table><table><thead><tr><th><font color='red'></font></th><th></th></tr></thead><tbody><tr><td>/abc</td><td> abc</td></tr><tr><td>/^abc</td><td> abc  <strong>^</strong></td></tr><tr><td>/abc$</td><td> abc  <strong>$</strong></td></tr><tr><td>?abc</td><td> abc</td></tr><tr><td>n</td><td></td></tr><tr><td>N</td><td></td></tr><tr><td>:set ic</td><td></td></tr><tr><td>:set noic</td><td></td></tr></tbody></table><table><thead><tr><th><font color='red'></font></th><th></th></tr></thead><tbody><tr><td>r</td><td></td></tr><tr><td>R</td><td>Esc</td></tr><tr><td>:s/a1/a2/g</td><td> a1  a2  g  g </td></tr><tr><td>:n1,n2s/a1/a2/g</td><td> n1  n2  a1  a2 </td></tr><tr><td>:%s/a1/a2/g</td><td> a1  a2 </td></tr></tbody></table><table><thead><tr><th><font color='red'></font></th><th></th></tr></thead><tbody><tr><td>x</td><td></td></tr><tr><td>X</td><td></td></tr><tr><td>dd</td><td></td></tr><tr><td>ndd</td><td> n </td></tr><tr><td>dG</td><td></td></tr><tr><td>D</td><td></td></tr><tr><td>:a1,a2d</td><td> a1  a2 </td></tr></tbody></table><blockquote><p> p </p></blockquote><table><thead><tr><th><font color='red'></font></th><th></th></tr></thead><tbody><tr><td>p</td><td></td></tr><tr><td>P</td><td></td></tr><tr><td>y</td><td></td></tr><tr><td>nyy</td><td> n </td></tr><tr><td>yy</td><td> n</td></tr><tr><td>yw</td><td></td></tr><tr><td>: n,m y</td><td> n  m </td></tr></tbody></table><table><thead><tr><th><font color='red'></font></th><th></th></tr></thead><tbody><tr><td>u</td><td></td></tr><tr><td>ctrl + r</td><td></td></tr><tr><td>U</td><td></td></tr></tbody></table><table><thead><tr><th><font color='red'></font></th><th></th></tr></thead><tbody><tr><td>h</td><td></td></tr><tr><td>j</td><td>j </td></tr><tr><td>k</td><td></td></tr><tr><td>l</td><td></td></tr><tr><td>w  W</td><td></td></tr><tr><td>b  B</td><td></td></tr><tr><td>e  E</td><td></td></tr><tr><td>fx</td><td> x </td></tr><tr><td>Fx</td><td> x </td></tr><tr><td>gg</td><td></td></tr><tr><td>G</td><td></td></tr><tr><td>:n</td><td></td></tr><tr><td>0</td><td></td></tr><tr><td>$</td><td></td></tr></tbody></table><table><thead><tr><th><font color='red'></font></th><th></th><th></th></tr></thead><tbody><tr><td>v</td><td></td><td></td></tr><tr><td>V</td><td></td><td></td></tr><tr><td>Ctrl+shift+v</td><td></td><td></td></tr></tbody></table><table><thead><tr><th><font color='red'></font></th><th></th></tr></thead><tbody><tr><td>:sp filename</td><td></td></tr><tr><td>:vs filename</td><td></td></tr><tr><td>ctrl+ww</td><td></td></tr><tr><td>:q</td><td></td></tr></tbody></table><table><thead><tr><th><font color='red'></font></th><th></th></tr></thead><tbody><tr><td>:line1,line2 s/^/#/g</td><td>line1line2&quot;#&quot;</td></tr><tr><td>:line1,line2 s/^#//g</td><td>line1line2&quot;#&quot;</td></tr><tr><td>:line1,line2 s/^////g</td><td>line1line2&quot;//&quot;</td></tr></tbody></table><blockquote><p> <code>//</code> <br><strong>1</strong><br> home  .vimrc </p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">nnoremap</span> <span class="symbol">&lt;C-m&gt;</span> I//<span class="symbol">&lt;Esc&gt;</span> </span><br><span class="line"> ctrl+<span class="keyword">m</span>  I//<span class="symbol">&lt;Esc&gt;</span> ,IINSERT,//</span><br><span class="line"></span><br><span class="line"><span class="keyword">nnoremap</span> <span class="symbol">&lt;C-k&gt;</span> :s/^\/\///g<span class="symbol">&lt;Esc&gt;</span></span><br><span class="line">//</span><br></pre></td></tr></table></figure><p><strong>2</strong><br> home  .vimrc </p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title">COM</span><span class="params">(b1, b2)</span></span><br><span class="line"> <span class="keyword">execute</span> <span class="variable">a:b1</span>.<span class="string">&#x27;,&#x27;</span>.<span class="variable">a:b2</span>.<span class="string">&#x27;s/^/\/\//g&#x27;</span></span><br><span class="line"><span class="keyword">endfunction</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title">DCOM</span><span class="params">(b1, b2)</span></span><br><span class="line"> <span class="keyword">execute</span> <span class="variable">a:b1</span>.<span class="string">&#x27;,&#x27;</span>.<span class="variable">a:b2</span>.<span class="string">&#x27;s/^\/\///g&#x27;</span></span><br><span class="line"><span class="keyword">endfunction</span></span><br></pre></td></tr></table></figure><p> <code>COM(b1,b2)</code>  b1  b2  // <code>DCOM(b1,b2)</code> </p><ul><li><code>:CALL COM(X1,X2)</code></li><li></li><li> <code>a:</code> </li><li>execute </li><li><code>.</code> </li></ul><p><strong><font color='orange'> chatGPT</font></strong></p></blockquote><table><thead><tr><th><font color='red'></font></th><th></th></tr></thead><tbody><tr><td>:set nu<br />:set nonu</td><td></td></tr><tr><td>:syn on<br />:syn off</td><td></td></tr><tr><td>set hlsearch<br />set nohlsearch</td><td></td></tr><tr><td>set autoindent</td><td></td></tr><tr><td>set tabstop=4</td><td> Tab  4  <strong></strong></td></tr><tr><td>set mouse=a<br />set selection=exclusive<br />set selectmode=mouse,key</td><td>Vim </td></tr></tbody></table><blockquote><p> ~/.vimrc</p></blockquote><table><thead><tr><th><font color='red'></font></th><th></th></tr></thead><tbody><tr><td>: set backup</td><td></td></tr><tr><td>set backupdir=</td><td> .vimrc </td></tr><tr><td>: w filename</td><td> filename </td></tr></tbody></table><table><thead><tr><th><font color='red'></font></th><th></th></tr></thead><tbody><tr><td>!!normal</td><td></td></tr></tbody></table><table><thead><tr><th><strong><font color='red'></font></strong></th><th></th></tr></thead><tbody><tr><td>gf</td><td></td></tr><tr><td>ctrl+o</td><td></td></tr><tr><td>ctrl+i</td><td></td></tr></tbody></table><table><thead><tr><th><font color='red'></font></th><th></th></tr></thead><tbody><tr><td>J</td><td></td></tr><tr><td>ctrl+z  fg</td><td> ctrl+z fg </td></tr><tr><td>ctrl+n</td><td></td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vim </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++</title>
      <link href="/2023/09/05/%E5%90%91%E6%A8%A1%E6%9D%BF%E5%8F%82%E6%95%B0%E4%BC%A0%E5%87%BD%E6%95%B0%E6%A8%A1%E6%9D%BF/"/>
      <url>/2023/09/05/%E5%90%91%E6%A8%A1%E6%9D%BF%E5%8F%82%E6%95%B0%E4%BC%A0%E5%87%BD%E6%95%B0%E6%A8%A1%E6%9D%BF/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">mySort</span><span class="params">(T* vec, <span class="type">int</span> len)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> function&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sortTester</span><span class="params">(function fun)</span></span>;</span><br></pre></td></tr></table></figure><p> mySort vec len sortTester  fun </p><p></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sortTester</span>(mySort);</span><br></pre></td></tr></table></figure><p> <strong>sortTester  function  mySort  sortTester </strong></p><p> int </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1</span></span><br><span class="line"><span class="keyword">auto</span> funcPtr = mySort&lt;<span class="type">int</span>&gt;;</span><br><span class="line"><span class="built_in">sortTester</span>(funcPtr);</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//2</span></span><br><span class="line"><span class="built_in">sortTester</span>([](<span class="type">int</span>* arr, <span class="type">int</span> len)&#123;<span class="built_in">mySort</span>(arr, len);&#125;);</span><br></pre></td></tr></table></figure><p> lambda </p>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>23</title>
      <link href="/2023/07/22/23%E5%A4%A9%E8%8B%B1%E8%AF%AD%E8%83%8C%E8%AF%B5/"/>
      <url>/2023/07/22/23%E5%A4%A9%E8%8B%B1%E8%AF%AD%E8%83%8C%E8%AF%B5/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="font-color-red--font"><strong><font color='red'></font></strong></h2><p></p><h2 id="font-color-red-DAY-1-font"><font color='red'>DAY 1 </font></h2><p><strong>Reach the goals  </strong></p><ol><li><p>My life has been a trade-off.</p><p></p></li><li><p>If I wanted to reach the goals I set for myself, I had to get at it and stay at it everyday.</p><p></p></li><li><p>I had to think about it all the time.</p><p></p></li><li><p>I had to get up everyday with my mind set on improving something.</p><p></p></li><li><p>I was driven by a desire to always be on the top of the heap.</p><p></p></li></ol><hr><h2 id="font-color-red-DAY-2-font"><strong><font color='red'>DAY 2</font></strong></h2><p><strong>Mean something  </strong></p><ol><li><p>I want to do good.</p><p></p></li><li><p>I want the world to be better because I was here.</p><p></p></li><li><p>I want my life, my work, and my family to mean something.</p><p></p></li><li><p>If youre not making someone elses life better then youre wasting your time.</p><p></p></li><li><p>Your life will become better by making other lives better.</p><p></p></li><li><p>I want to represent an idea.</p><p></p></li><li><p>I want to represent possibilities.</p><p></p></li><li><p>I want to represent the idea that you really can make what you want.</p><p></p></li></ol><hr><h2 id="font-color-red-DAY-3-font"><strong><font color='red'>DAY 3</font></strong></h2><p><strong>Protect your dream  </strong></p><ol><li><p>Dont ever let someone tell you that you cant do something.<br></p></li><li><p>Not even me.<br></p></li><li><p>You got a dream, you gotta protect it.<br></p></li><li><p>When people cant do something themselves, theyre gonna tell you that you cant do it.<br></p></li><li><p>You want something, go get it.<br></p></li><li><p>Period.<br></p></li></ol><hr><h2 id="font-color-red-DAY-4-font"><strong><font color='red'>DAY 4</font></strong></h2><p><strong>Good artists copy, great artists steal.  </strong></p><ol><li><p>How do you know whats the right direction?<br></p></li><li><p>Ultimately it comes down to taste.<br></p></li><li><p>It comes down to taste.<br></p></li><li><p>Its a matter of trying to expose yourself to the best things that humans have done.<br></p></li><li><p>And then try to bring those things into what you are doing.<br></p></li><li><p>Picasso had a saying, Good artists copy, great artists steal.<br>, </p></li><li><p>We have always been shameless about stealing great ideas.<br></p></li></ol><hr><h2 id="font-color-red-DAY-5-font"><strong><font color='red'>DAY 5</font></strong></h2><p><strong>Failed over and over and over again </strong></p><p>1Ive missed more than 9000 shots in my career.</p><p>9000</p><p>2Ive lost almost 300 games.</p><p>300</p><p>326 times Ive been trusted to take the game winning shot and missed.</p><p>26</p><p>4Ive failed over and over and over again in my life.</p><p></p><p>5And that is why I succeed.</p><p></p><hr><h2 id="font-color-red-DAY-6-font"><strong><font color='red'>DAY 6</font></strong></h2><p><strong>Pushing through the pain </strong></p><ol><li><p>As a magician, I try to create images that make people stop and think.<br></p></li><li><p>I also try to challenge myself to do things that doctors say are not possible.<br></p></li><li><p>As a magician, I try to show things to people that seem impossible.<br></p></li><li><p>And I think magic, whether Im holding my breath or shuffling a deck of cards, is pretty simple.<br></p></li><li><p>Its practice, its training.<br></p></li><li><p>And Its practice, its training and experimenting, while pushing through the pain to be the best that I can be.<br></p></li><li><p>And thats what magic is to me, so, thank you. (Applause)<br></p></li></ol><hr><h2 id="font-color-red-DAY-7-font"><strong><font color='red'>DAY 7</font></strong></h2><p><strong>nasty place </strong></p><p></p><ol><li><p>Then the time come for you to be your own man and take on the world and you did.<br></p></li><li><p>But somewhere along the line, you changed.<br></p></li><li><p>You stopped being you.<br></p></li><li><p>You let people stick a finger in your face and tell you youre no good.<br></p></li><li><p>And when things got hard, you started looking for something to blame like a big shadow.<br></p></li><li><p>Let me tell you something you already know.<br></p></li><li><p>The world aint all sunshine and rainbows.<br></p></li><li><p>Its a very mean and nasty place, and I dont care how tough you are<br></p></li><li><p>It will beat you to your knees and keep you there permanently if you let it.<br></p></li></ol><hr><h2 id="font-color-red-DAY-8-font"><strong><font color='red'>DAY 8</font></strong></h2><p><strong>hit </strong></p><ol><li><p>You, me or nobody is gonna hit as hard as life.<br></p></li><li><p>But it aint about how hard you hit.<br></p></li><li><p>Its about how hard you can get hit and keep moving forward.<br></p></li><li><p>How much you can take and keep moving forward.<br></p></li><li><p>Thats how winning is done!<br></p></li><li><p>If you know what youre worth, go and get what youre worth.<br></p></li><li><p>But you gotta be willing to take the hits, and not pointing fingers saying you aint where you wanna be, because of him or her or anybody!<br></p></li><li><p>Cowards do that, and that aint you!<br></p></li><li><p>Youre better than that!<br></p></li></ol><hr><h2 id="font-color-red-DAY-9-font"><strong><font color='red'>DAY 9</font></strong></h2><p><strong>Will you fight?</strong></p><ol><li><p>I am William Wallace.<br></p></li><li><p>And I see a whole army of my countrymen here in defiance of tyranny.<br></p></li><li><p>Youve come to fight as free men.<br></p></li><li><p>And free men you are.<br></p></li><li><p>What will you do with that freedom?<br></p></li><li><p>Will you fight?<br></p></li><li><p>Fight, and you may die.<br></p></li><li><p>Run, and youll live  at least awhile.<br></p></li><li><p>And dying in your beds many years from now.<br></p></li><li><p>Would you be willing to trade all the days from this day to that.<br></p></li><li><p>For one chance, just for one chance.<br></p></li><li><p>To come back here and tell our enemies that they may take our lives,<br></p></li><li><p>But theyll never take our freedom!<br></p></li></ol><hr><h2 id="font-color-red-DAY-10-font"><strong><font color='red'>DAY 10</font></strong></h2><p><strong>Never surrender</strong></p><ol><li><p>We shall not flag or fail.<br></p></li><li><p>We shall go on to the end.<br></p></li><li><p>We shall fight in France.<br></p></li><li><p>We shall fight on the seas and oceans.<br></p></li><li><p>We shall fight with growing confidence and growing strength in the air.<br></p></li><li><p>We shall defend our island, whatever the cost may be.<br></p></li><li><p>We shall fight on the beaches.<br></p></li><li><p>We shall fight on the landing grounds.<br></p></li><li><p>We shall fight in the fields and in the streets.<br></p></li><li><p>We shall fight in the hills.<br></p></li><li><p>We shall never surrender.<br></p></li></ol><hr><h2 id="font-color-red-DAY-11-font"><strong><font color='red'>DAY 11</font></strong></h2><p><strong>Without victory, there is no survival </strong></p><ol><li><p>I would say to the House, as I said to those who have joined this government: I have nothing to offer but blood, toil, tears and sweat.<br></p></li><li><p>We have before us an ordeal of the most grievous kind.<br></p></li><li><p>We have before us many, many long months of struggle and of suffering.<br></p></li><li><p>You ask, what is our policy?<br></p></li><li><p>I will say: It is to wage war, by sea, land and air, with all our might, with all the strength that God has given us; to wage war against a monstrous tyranny, never surpassed in the dark, and lamentable catalogue of human crime.<br></p></li><li><p>That is our policy.<br></p></li><li><p>You ask, what is our aim?<br></p></li><li><p>I can answer in one word: victory.<br></p></li><li><p>Victory at all costs, victory in spite of all terror, victory, however long and hard the road may be.<br></p></li><li><p>For without victory, there is no survival.<br></p></li></ol><hr><h2 id="font-color-red-DAY-12-font"><strong><font color='red'>DAY 12</font></strong></h2><p><strong>It takes a strong man to save himself, and a great man to save another.</strong></p><p><strong></strong></p><ol><li><p>These walls are funny.<br></p></li><li><p>First you hate them, then you get used to them.<br></p></li><li><p>Enough time passes, you depend on them. Thats institutionalized.<br></p></li><li><p>I guess it comes down to a simple choice: get busy living or get busy dying.<br></p></li><li><p>In 1966, Andy Dufresne escaped from Shawshank Prison.<br>1966.</p></li><li><p>All they found (of him) was a muddy set of prison clothes, a bar of soap, and an old rock-hammer damn near worn down to the nub.<br></p></li><li><p>I remember thinking it would take a man six hundred years to tunnel through the wall with it. Old Andy did it in less than twenty.<br></p></li></ol><hr><h2 id="font-color-red-DAY-13-font"><strong><font color='red'>DAY 13</font></strong></h2><p><strong>Lay this brick perfectly </strong></p><ol><li><p>One summer his dad tore down a brick wall in the front of his business and told 12-year-old Will and his 9-year-old brother to rebuild it.<br>129</p></li><li><p>A job they said was impossible.<br></p></li><li><p>It took them a year and a half, but they did it.<br></p></li><li><p>And he said, now dont you ever tell me theres something that you cant do.<br></p></li><li><p>You dont set out to build a wall.<br></p></li><li><p>You dont say, Im going to build the biggest, baddest, greatest wall thats ever been built.<br></p></li><li><p>You dont start there.<br></p></li><li><p>You say, Im going to lay this brick as perfectly as a brick can be laid.<br></p></li><li><p>You do that every single day.<br></p></li><li><p>And soon you have a wall.<br></p></li></ol><hr><h2 id="font-color-red-DAY-14-font"><strong><font color='red'>DAY 14</font></strong></h2><p><strong>14.</strong> <strong>Do what you need to do </strong></p><ol><li><p>I have a great time with my life, and I want to share it.<br></p></li><li><p>I love living.<br></p></li><li><p>I think thats infectious, its something you cant fake.<br></p></li><li><p>Greatness is not this wonderful, esoteric elusive god-like feature that only special people possess.<br></p></li><li><p>Its something that truly exists within all of us.<br></p></li><li><p>Its very simple.<br></p></li><li><p>This is what I believe, and Im willing to die for it.<br></p></li><li><p>Period.<br></p></li><li><p>Its that simple.<br></p></li><li><p>I know who I am, I know what I believe, and thats all I need to know.<br></p></li><li><p>From there, you do what you need to do.<br></p></li><li><p>You know.<br></p></li><li><p>I think what happens is we make the situation more complex.<br></p></li></ol><hr><h2 id="font-color-red-DAY-15-font"><strong><font color='red'>DAY 15</font></strong></h2><p><strong>Sickening work ethic </strong></p><ol><li><p>The separation of talent and skill is one of the greatest misunderstood concepts for people who are trying to excel, who have dreams, who want to do things.<br></p></li><li><p>Talent you have naturally.<br></p></li><li><p>Skill is only developed by hours and hours and hours of beating on your craft.<br></p></li><li><p>Ive never really viewed myself as particularly talented.<br></p></li><li><p>And where I excel is ridiculous, sickening, work ethic.<br></p></li><li><p>You know, while the other guys sleeping? Im working.<br></p></li><li><p>While the other guys eatin? Im working.<br></p></li><li><p>Theres no easy way around it.<br></p></li><li><p>No matter how talented you are, your talent is going to fail you if youre not skilled.<br></p></li><li><p>If you dont study, work really hard and dedicate yourself to getting better every single day.<br></p></li><li><p>Youll never be able to communicate your artistry to people the way that you want.<br></p></li><li><p>The only thing that I see that is distinctly different about me is that Im not afraid to die on a treadmill.<br></p></li><li><p>You might have more talent than me, you might be smarter than me, but if we get on a treadmill together, therere two things.<br></p></li><li><p>Youre getting off first, or Im gonna die.<br></p></li><li><p>Its really that simple.<br></p></li></ol><hr><h2 id="font-color-red-DAY-16-font"><strong><font color='red'>DAY 16</font></strong></h2><p><strong>Bend your universe </strong></p><ol><li><p>Our thoughts, feelings, dreams, and ideas are physical in the Universe.<br></p></li><li><p>If we dream something, if we picture something, and if we commit ourselves to it  that is a physical thrust towards realization that we send out into the universe.<br></p></li><li><p>The universe is not a thing thats going to push us around.<br></p></li><li><p>The world, people, and situations are not going to push us around.<br></p></li><li><p>We are going to bend the universe.<br></p></li><li><p>We are going to command and DEMAND that the universe become what we want it to be.<br></p></li><li><p>I studied the patterns of the universe.<br></p></li><li><p>Theres a redemptive power that making a choice has.<br></p></li><li><p>Rather than feeling like youre just affected by all the things happening, make a choice.<br></p></li><li><p>Just DECIDE what youre gonna be, who youre gonna be, and how youre gonna do it.<br></p></li><li><p>Just decide.<br></p></li><li><p>From that point on, the Universe is gonna get out of your way.<br></p></li></ol><hr><h2 id="font-color-red-DAY-17-font"><strong><font color='red'>DAY 17</font></strong></h2><p><strong>super hard</strong></p><ol><li><p>The first is you need to work, if you, depending on how well you want to do.<br></p></li><li><p>Particularly if youre starting a company, you need to work super hard.<br></p></li><li><p>So what does super hard mean? </p></li><li><p>Well, when my brother and I were starting up our first company, instead of getting an apartment, we just rented a small office.<br></p></li><li><p>And we slept on the couch.<br></p></li><li><p>And we showered at the YMCA.<br></p></li><li><p>We were so hard up.<br></p></li><li><p>We had just one computer.<br></p></li><li><p>The website was up during the day, and I was coding at night, seven days a week, all the time.<br></p></li><li><p>And I briefly had a girlfriend at that period.<br></p></li><li><p>And in order to be with me, she had to sleep in the office.<br></p></li><li><p>So I worked hard at every waking hour.<br></p></li><li><p>Thats the thing I would say particularly if you are starting a company.<br></p></li><li><p>And if you do simple math, say like, if somebody else is working 50 hours, and youre working 100, youll get twice as much done in the course of a year as the other company.<br>50100</p></li></ol><hr><h2 id="font-color-red-DAY-18-font"><strong><font color='red'>DAY 18</font></strong></h2><p><strong>Think different </strong></p><ol><li><p>Heres to the crazy ones.<br></p></li><li><p>The misfits.<br></p></li><li><p>The rebels.<br></p></li><li><p>The troublemakers.<br></p></li><li><p>The round pegs in the square holes.<br></p></li><li><p>The ones who see things differently.<br></p></li><li><p>Theyre not fond of rules.<br></p></li><li><p>And they have no respect for the status quo.<br></p></li><li><p>You can quote them, disagree with them, glorify or vilify them.<br></p></li><li><p>About the only thing you cant do is ignore them.<br></p></li><li><p>Because they change things.<br></p></li><li><p>They push the human race forward.<br></p></li><li><p>And while some may see them as the crazy ones, we see genius.<br></p></li><li><p>Because the people who are crazy enough to think they can change the world, are the ones who do.<br></p></li></ol><hr><h2 id="font-color-red-DAY-19-font"><strong><font color='red'>DAY 19</font></strong></h2><p><strong>I always knew I was going to be rich </strong></p><ol><li><p>I always knew I was going to be rich.<br></p></li><li><p>I dont think I ever doubted it for a minute.<br></p></li><li><p>Einstein is reputed to have said that compound interest is the eighth wonder of the world. Or something like that.<br></p></li><li><p>And it goes back to that story, you probably learned when you were in grade school.<br></p></li><li><p>Where somebody did something for the king.<br></p></li><li><p>And the king said, What can I do for you?<br></p></li><li><p>And he said, Well, lets take a chessboard, and put one kernel of wheat on the first square, and then double it on the second, and double it on the third.<br></p></li><li><p>And the king readily agreed to it, and by the time he figured out what two to the 64th amounted to, he was giving away the entire kingdom.<br>264</p></li><li><p>So its a pretty simple concept, but over time, it accomplishes extraordinary things.<br></p></li></ol><hr><h2 id="font-color-red-DAY-20-font"><strong><font color='red'>DAY 20</font></strong></h2><p><strong>Compound interest </strong></p><p></p><ol><li><p>And very early, probably when I was seven or so, I took this book out of the Bensen Library, called A thousand ways to make a $1,000.<br>7</p></li><li><p>And one of the ways in this book was having penny weighing machines.<br></p></li><li><p>I sat and calculated how much it would cost to buy the first weighing machine, and then how long it would take for the profit from that one to buy another one.<br></p></li><li><p>And I would sit there and create these compound interest tables to figure out how long it would take me to have a weighing machine for every person in the world.<br></p></li><li><p>I had everybody in the country weighing themselves ten times a day, and me just sitting there like John D. Rockefeller of weighing machines.<br></p></li><li><p>That allowance when I was a little boy was a nickel a week,<br></p></li><li><p>But I liked the idea of having a little more than a nickel a week to work with.<br></p></li><li><p>And I went into business very early.<br></p></li><li><p>I started selling Coca-Cola door to door.<br></p></li><li><p>I sold gum door to door.<br></p></li><li><p>I sold Saturday Evening Post, Liberty Magazine, Ladies Home Journal, you name it.<br></p></li><li><p>I think I enjoyed the game almost right from the start.<br></p></li><li><p>But I like being my own boss.<br></p></li><li><p>Thats one thing I liked about delivering papers.<br></p></li><li><p>I could arrange the route I wanted.<br></p></li><li><p>Nobody was bothering me at 5.00 or 6.00 in the morning.<br></p></li><li><p>I was delivering 500 papers a day.<br>500</p></li><li><p>And I made a penny a paper, but in terms of compounding, that penny has turned into something else.<br></p></li></ol><hr><h2 id="font-color-red-DAY-21-font"><strong><font color='red'>DAY 21</font></strong></h2><p><strong>Method of learning </strong></p><ol><li>Alfred North Whitehead said it one time that the rapid advance of civilization came only when man invented the method of invention.<br></li><li>And of course he was referring to the huge growth of GDP per capita and all the other good things that we now take for granted which started a few hundred years ago and before that all was stasis.<br>GDP</li><li>So if civilization can progress only when it invents the method of invention, you can progress only when you learn the method of learning.<br></li><li>I was very lucky.<br></li><li>I came to law school having learned the method of learning and nothing has served me better in my long life than continuous learning.<br></li><li>And if you take Warren Buffett and watched him with a time clock, I would say half of all the time he spends is sitting on his ass and reading.<br></li><li>And a big chunk of the rest of the time is spent talking one on one, either on the telephone or personally, with highly gifted people whom he trusts and who trust him.<br></li><li>In other words, it looks quite academic, all this worldly success.<br></li></ol><hr><h2 id="font-color-red-DAY-22-font"><strong><font color='red'>DAY 22</font></strong></h2><p><strong>Change mindset change brain </strong></p><ol><li>Just the words yet or not yet, were finding, give kids greater confidence, give them a path into the future that creates greater persistence.<br></li><li>And we can actually change students mindsets.<br></li><li>In one study, we taught them that every time they push out of their comfort zone to learn something new and difficult, the neurons in their brain can form new, stronger connections, and over time they can get smarter.<br></li><li>Look what happened.<br></li><li>In this study, students who were not taught this growth mindset continued to show declining grades over this difficult school transition, but those who were taught this lesson showed a sharp rebound in their grades.<br><br>We have shown this now, this kind of improvement, with thousands and thousands of kids, especially struggling students.</li></ol><hr><h2 id="font-color-red-DAY-23-font"><strong><font color='red'>DAY 23</font></strong></h2><p><strong>Grit is the key to success </strong></p><ol><li>So I left the classroom, and I went to graduate school to become a psychologist.<br></li><li>I started studying kids and adults in all kinds of super challenging settings, and in every study my question was, who is successful here and why?<br></li><li>My research team and I went to West Point Military Academy.<br></li><li>We tried to predict which cadets would stay in military training and which would drop out.<br></li><li>We went to the National Spelling Bee and tried to predict which children would advance farthest in competition.<br></li><li>We studied rookie teachers working in really tough neighborhoods, asking which teachers are still going to be here in teaching by the end of the school year, and of those, who will be the most effective at improving learning outcomes for their students?<br></li><li>We partnered with private companies, asking, which of these salespeople is going to keep their jobs?<br></li><li>And whos going to earn the most money?<br></li><li>In all those very different contexts, one characteristic emerged as a significant predictor of success.<br></li><li>And it wasnt social intelligence.<br></li><li>It wasnt good looks, physical health, and it wasnt I.Q.<br>IQ</li><li>It was grit.<br></li><li>Grit is passion and perseverance for very long-term goals.<br></li><li>Grit is having stamina.<br></li><li>Grit is sticking with your future, day in, day out, not just for the week, not just for the month, but for years, and working really hard to make that future a reality.<br></li><li>Grit is living life like its a marathon, not a sprint.<br></li></ol>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gdb-</title>
      <link href="/2023/05/20/gdb%E8%B0%83%E8%AF%95-%E5%9F%BA%E7%A1%80/"/>
      <url>/2023/05/20/gdb%E8%B0%83%E8%AF%95-%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p><br><a href="http://c.biancheng.net/gdb/">C-gdb</a></p></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><p> <code>-g</code> </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">gcc main.c main -g</span></span><br></pre></td></tr></table></figure><p> <code>-O0</code>  GDB  <code>-Og</code> -Og  O0 ~ O1 </p><hr><h3 id="font-color-red--font"><font color='red'></font></h3><table><thead><tr><th></th><th> </th></tr></thead><tbody><tr><td>(gdb) help</td><td><code>help commands</code>  commands </td></tr><tr><td>(gdb) file program</td><td> program </td></tr><tr><td>(gdb) break xxx <br />(gdb) b xxx</td><td> xxx b main.c:3</td></tr><tr><td>(gdb) run <br />(gdb) r</td><td></td></tr><tr><td>(gdb) start</td><td> main </td></tr><tr><td>(gdb) continue <br />(gdb) c</td><td></td></tr><tr><td>(gdb) next <br />(gdb) n</td><td></td></tr><tr><td>(gdb) step<br />(gdb) s</td><td></td></tr><tr><td>(gdb) until<br />(gdb) u</td><td> GDB </td></tr><tr><td>(gdb) finish</td><td></td></tr><tr><td>(gdb) return</td><td></td></tr><tr><td>(gdb) print var <br />(gdb) p var</td><td>print var=1<a href="http://c.biancheng.net/view/vip_8513.html">print</a></td></tr><tr><td>(gdb) display</td><td> undisplay  disable </td></tr><tr><td>(gdb) list <br />(gdb) l</td><td></td></tr><tr><td>(gdb) delete</td><td></td></tr><tr><td>(gdb) clear</td><td></td></tr><tr><td>(gdb) disable</td><td></td></tr><tr><td>(gdb) enable</td><td></td></tr><tr><td>(gdb) quit <br />(gdb) q</td><td></td></tr><tr><td>-q <br />-quiet <br />-silent</td><td> GDB </td></tr><tr><td>args prog arg1<br />(gdb) set args arg1 </td><td> prog  arg1</td></tr><tr><td>(gdb) cd</td><td> GDB </td></tr><tr><td>(gdb) path xx/xx</td><td></td></tr><tr><td>(gdb) info xxx</td><td></td></tr><tr><td>(gdb) bt<br />(gdb) backtrace<br />(gdb) info stack</td><td></td></tr><tr><td>(gdb) info frame</td><td></td></tr><tr><td>(gdb) up</td><td></td></tr><tr><td>(gdb) down</td><td></td></tr><tr><td>(gdb) x</td><td> gdb  help x </td></tr><tr><td>(gdb) disassemble</td><td></td></tr><tr><td>(gdb) layout asm</td><td> layout src </td></tr></tbody></table><blockquote><p><code>(gdb)</code>  gdb gdb </p></blockquote><h3 id="font-color-orange-break-font"><font color='orange'>break</font></h3><p><strong>gdb </strong></p><p>break  2 </p><ul><li>(gdb) break location</li><li>(gdb) break  if cond</li></ul><table><thead><tr><th>location </th><th> </th></tr></thead><tbody><tr><td>linenum</td><td>linenum  list </td></tr><tr><td>filename:linenum</td><td>filename linenum </td></tr><tr><td>+ offset - offset</td><td>offset  2+offset  4  offset  6 </td></tr><tr><td>function</td><td>function  break </td></tr><tr><td>filename:function</td><td>filename function  filename  function </td></tr></tbody></table><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(gdb) b 7 if num&gt;10</span><br><span class="line">(gdb) b 8 if p==null</span><br></pre></td></tr></table></figure><p><strong><font color='orange'>break tbreak  rbreak</font></strong></p><p>tbreak  break <strong> tbreak  1 </strong> </p><p><strong>rbreak  CC++ </strong> rbreak </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(gdb) rbreak regex</span><br></pre></td></tr></table></figure><p> regex  regex rbreak <a href="https://jyx-fyh.github.io/2023/05/20/gdb%E8%B0%83%E8%AF%95-%E8%BF%9B%E9%98%B6/">gdb-</a> </p><p> delete info breakpoints </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(gdb) delete</span><br><span class="line">(gdb) info breakpoints</span><br></pre></td></tr></table></figure><h3 id="font-color-orange-watch-font"><font color='orange'>watch</font></h3><p>watch </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(gdb) watch var</span><br><span class="line">(gdb) watch var if cond</span><br></pre></td></tr></table></figure><p>watch  rwatch  awatch</p><ul><li>rwatch </li><li>awatch </li></ul><p>watch  <strong></strong>  <strong></strong> GDB  32  Intel x86  4 </p><p> PowerPC  x86 <strong> GDB </strong></p><h3 id="font-color-orange-catch-font"><font color='orange'>catch</font></h3><p><strong>catch </strong>  tcatch </p><table><thead><tr><th style="text-align:center"></th><th style="text-align:center"></th></tr></thead><tbody><tr><td style="text-align:center">catch exec</td><td style="text-align:center">exec</td></tr><tr><td style="text-align:center">catch fork</td><td style="text-align:center">fork</td></tr><tr><td style="text-align:center">catch load</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">catch unload</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">catch signal</td><td style="text-align:center">/</td></tr><tr><td style="text-align:center">catch syscall</td><td style="text-align:center">/</td></tr><tr><td style="text-align:center">catch throw</td><td style="text-align:center"></td></tr><tr><td style="text-align:center"></td><td style="text-align:center"></td></tr></tbody></table><p>breakwatch  if  catch  <strong>condition </strong> </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(gdb) info break</span><br><span class="line">Num     Type            Disp Enb Address                        What</span><br><span class="line">1       breakpoint      keep y     0x00005555555552d0  in main() at main.cpp:9    breakpoint already hit 1 time</span><br><span class="line">2       read watchpoint keep y                                       num</span><br><span class="line">3       catchpoint      keep y                                           exception throw      matching: int</span><br><span class="line">(gdb) condition 1 num==3             &lt;-- </span><br><span class="line">(gdb) condition 2 num==5             &lt;-- </span><br><span class="line">(gdb) condition 3 num==7             &lt;-- </span><br></pre></td></tr></table></figure><h3 id="font-color-orange-frame-font"><font color='orange'>frame</font></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">(gdb)info frame                              &lt;-- </span><br><span class="line">Stack level 0, frame at 0x7fffffffe240:      &lt;-- 0, 0x7fffffffe240</span><br><span class="line">rip = 0x4004cf in func (main.c:3); saved rip 0x4004e9   </span><br><span class="line">                                             &lt;-- 0x4004cf,0x4004e9</span><br><span class="line">called by frame at 0x7fffffffe260            &lt;--  1  0x7fffffffe260</span><br><span class="line">source language c.                           &lt;-- </span><br><span class="line">Arglist at 0x7fffffffe230, args: num=4       &lt;-- </span><br><span class="line">Locals at 0x7fffffffe230, Previous frame&#x27;s sp is 0x7fffffffe240  </span><br><span class="line">                                             &lt;--</span><br><span class="line">Saved registers:                             &lt;-- </span><br><span class="line">  rbp at 0x7fffffffe230, rip at 0x7fffffffe238</span><br></pre></td></tr></table></figure><h3 id="font-color-orange-info-font"><font color='orange'>info</font></h3><p> info </p><table><thead><tr><th style="text-align:center"></th><th style="text-align:center"></th></tr></thead><tbody><tr><td style="text-align:center">info breakpoints</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">info watchpoints</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">info registers</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">info address</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">info threads</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">info functions</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">info variables</td><td style="text-align:center"> <strong></strong> </td></tr><tr><td style="text-align:center">info locals</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">info args</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">info source</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">info sources</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">info frame</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">info stack</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">info program</td><td style="text-align:center">ID</td></tr><tr><td style="text-align:center">info sharedlibrary</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">info target</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">info display</td><td style="text-align:center">display </td></tr></tbody></table><p><strong> info  help info </strong></p><hr><h3 id="font-color-red--font"><font color='red'></font></h3><ol><li><p></p> <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">gdb program</span></span><br><span class="line"> </span><br><span class="line">(gdb) file program</span><br></pre></td></tr></table></figure></li><li><p></p> <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(gdb) attach program</span><br><span class="line"></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">gdb -p </span></span><br></pre></td></tr></table></figure><p> root  <code>detach</code>  GDB </p> <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">(gdb) detach</span></span><br><span class="line"></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">(gdb) q</span></span><br></pre></td></tr></table></figure></li></ol><h3 id="font-color-red--font"><font color='red'></font></h3><p> Linux  core Linux core dump GDB  core </p><p>Linux  core dump </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@bogon demo]# ulimit -a</span><br><span class="line">core file size          (blocks, -c) 0</span><br><span class="line">.......</span><br></pre></td></tr></table></figure><p> core file sizecore  0 core dump  core </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@bogon demo]# ulimit -c unlimited</span><br><span class="line">[root@bogon demo]# ulimit -a</span><br><span class="line">core file size     (blocks, -c) unlimited</span><br></pre></td></tr></table></figure><p> main.exe  core </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@bogon demo]# gdb main.exe core</span><br></pre></td></tr></table></figure><p> core<a href="https://www.jianshu.com/p/70e5b762386c"></a> </p><p>Core Core  ulimit  Core </p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gdb-</title>
      <link href="/2023/05/20/gdb%E8%B0%83%E8%AF%95-%E8%BF%9B%E9%98%B6/"/>
      <url>/2023/05/20/gdb%E8%B0%83%E8%AF%95-%E8%BF%9B%E9%98%B6/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>C:/Users/JiangYuxuan/Desktop/Typora/img/</p><h2 id="font-color-red--font"><font color='red'></font></h2><h2 id="font-color-red--font"><font color='red'></font></h2><p></p><h2 id=""></h2><ul><li><pre><code>  readelf -s  | gawk '  &#123;     if($4 == &quot;FUNC&quot; &amp;&amp; $2 != 0) &#123;       print &quot;# code for &quot; $NF;       print &quot;b &quot; $NF;       print &quot;commands&quot;;       print &quot;silent&quot;;       print &quot;bt 1&quot;;       print &quot;c&quot;;       print &quot;end&quot;;       print &quot;&quot;;&#125;     &#125;' &gt;   <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>  gdb --command=  -q</code></pre></li></ul><h2 id="font-color-red--font"><font color='red'></font></h2><p>rbreak</p><h2 id="font-color-red--font"><font color='red'></font></h2><p><a href="http://c.biancheng.net/view/8291.html">handle</a> </p><h2 id="font-color-red--font"><font color='red'></font></h2><h2 id="font-color-red--font"><font color='red'></font></h2>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2-Nginx</title>
      <link href="/2023/05/16/%E7%BB%83%E4%B9%A02-%E7%BC%96%E8%AF%91%E8%B0%83%E8%AF%95Nginx/"/>
      <url>/2023/05/16/%E7%BB%83%E4%B9%A02-%E7%BC%96%E8%AF%91%E8%B0%83%E8%AF%95Nginx/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p><a href="https://jyx-fyh.github.io/2023/05/01/%E7%BB%83%E4%B9%A01-%E7%BC%96%E8%AF%91%E8%B0%83%E8%AF%95teamtalk/">1-teamTalk</a><a href="https://jyx-fyh.github.io/2023/05/05/cmake%E5%85%A5%E9%97%A8/">cmake</a> makefile <br><a href="https://www.jianshu.com/p/14c81fbcb401">nginx</a><a href="https://cloud.tencent.com/developer/article/2205549?from=article.detail.1476984&amp;areaSource=106000.16&amp;traceId=il-m4ntHJ8HD5tlLzMjN_">WindowsNginx</a><a href="https://www.jianshu.com/p/3c2fdb06de9e">gdb</a>Nginxchatgpt </p></blockquote><h2 id="font-color-red--font"><font color='red'></font></h2><p>Nginx Web Nginx</p><ul><li><strong> gdb </strong></li><li><strong>CLion  +  gdb </strong></li><li><strong>CLion  CMake </strong></li><li><strong>VS  Nginx</strong></li></ul><p><a href="https://jyx-fyh.github.io/2023/05/01/%E7%BB%83%E4%B9%A01-%E7%BC%96%E8%AF%91%E8%B0%83%E8%AF%95teamtalk/">1-teamTalk</a> Windows  Visual Studio  Linux  CLion  Linux  Ubuntu 20.4.6 </p><h2 id="font-color-red--gdb--font"><font color='red'> gdb </font></h2><p> nginx  gdb <strong><font color='red'> Nginx</font></strong> </p><h3 id="font-color-orange-1--font"><font color='orange'>1.</font></h3><ul><li><p>pcre  nginx.conf </p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install libpcre3 libpcre3-dev  </span><br></pre></td></tr></table></figure></li><li><p>zlib  HTTP  gzip </p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install zlib1g-dev</span><br></pre></td></tr></table></figure></li><li><p>OpenSSL  SSL </p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install openssl libssl-dev </span><br></pre></td></tr></table></figure></li></ul><h3 id="font-color-orange-2--Nginx-font"><font color='orange'>2. Nginx</font></h3><ol><li><p><a href="https://nginx.org/download/"></a>Nginx 1.2.0 </p></li><li><p> makefile</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./configure --with-debug --prefix=<span class="string">&quot;/home/jyx/CLionProjects/nginx&quot;</span> --with-cc-opt=<span class="string">&quot;-Wno-error&quot;</span></span><br></pre></td></tr></table></figure><ul><li><strong><code>--with-debug</code> </strong></li><li><strong><code>--prefix=&quot;/home/jyx/CLionProjects/nginx&quot;</code> 1 <code>usr/local/nginx</code> 2<font color='orange'> nginx  conf  nginx.conf </font></strong><br> CLion  make install conf <strong><font color='red'></font></strong></li><li><code>--with-cc-opt=&quot;-Wno-error&quot;</code> <br><img src="/2022/img/image-20230519150021172.png" alt=""></li></ul><blockquote><p><strong> <code>./configure --help</code> </strong></p></blockquote></li><li><p> make <br><img src="/2022/img/webp.webp" alt=""><br><strong></strong> </p></li><li><p> sudo  objs/nginx<br><img src="/2022/img/image-20230519151235867.png" alt=""><br> nginx  logs <br><img src="/2022/img/image-20230519151351688.png" alt=""></p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sudo ps -aux | grep nginx</span><br><span class="line">jyx         1916  0.0  0.1 175184  8988 ?        Sl   May18   0:00 /usr/libexec/ibus-engine-simple</span><br><span class="line">root       15773  0.0  0.0   7324  1184 ?        Ss   00:38   0:00 nginx: master process /home/jyx/Downloads/nginx-1.2.0/objs/nginx</span><br><span class="line">nobody     15774  0.0  0.0   7960  3104 ?        S    00:38   0:00 nginx: worker process</span><br><span class="line">jyx        18578  0.0  0.0  17672   720 pts/1    S+   02:01   0:00 grep --color=auto ngi</span><br></pre></td></tr></table></figure><p> Nginx <strong><font color='gree'>nginx  nginx  bind </font></strong></p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo killall nginx</span><br></pre></td></tr></table></figure></li></ol><h3 id="font-color-orange-3--nginx-font"><font color='orange'>3. nginx</font></h3><p> Nginx  nginx.conf  Nginx   gdb <strong><font color='gree'> 1 </font></strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#nginx.conf</span><br><span class="line">worker_processes  1;</span><br></pre></td></tr></table></figure><p>Nginx  daemon   fork  exit(0)  gdb  fork()  <br><img src="/2022/img/image-20230519155524035.png" alt=""></p><p><strong><font color='gree'> daemon </font></strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#nginx.conf</span><br><span class="line">daemon off;</span><br></pre></td></tr></table></figure><p>masterworker master  fork  worker  gdb </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set follow-fbrk-mode child</span><br></pre></td></tr></table></figure><p> gdb  fork  master  worker<strong><font color='gree'></font></strong> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#nginx.conf</span><br><span class="line">master_process off;</span><br></pre></td></tr></table></figure><p></p><p> gdb  objs  nginx <strong><font color='orange'> sudo </font></strong> </p><p><img src="/2022/img/image-20230519151646848.png" alt="run,(ctrl+c),epoll"></p><p></p><hr><h2 id="font-color-red-CLion--gdb-font"><font color='red'>CLion +gdb</font></h2><p>Nginx  makefile  CLion  cmake  makefile  Nginx CLion compile_commands.json chatgpt </p><blockquote><p>compile_commands.json  JSON <br><strong><font color='orange'> cmake  makefile </font></strong> </p></blockquote><ol><li> compiledb  compile_commands.json</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#pipcompiledb </span></span><br><span class="line">pip install compiledb </span><br></pre></td></tr></table></figure><ol start="2"><li> makefile</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./configure --with-debug --prefix=<span class="string">&quot;/home/jyx/CLionProjects/nginx&quot;</span> --with-cc-opt=<span class="string">&quot;-Wno-error&quot;</span></span><br></pre></td></tr></table></figure><ol start="3"><li> compile_commands.json </li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ compiledb -nf make</span><br><span class="line"><span class="comment">#-nmake,;-fMakefile,Makefile.make.</span></span><br></pre></td></tr></table></figure><ol start="4"><li> CLion open as projecct </li></ol><p><img src="/2022/img/image-20230519164056329.png" alt=""></p><p> CLion  Nginx CTRL+</p><p> gdb  make  objs/nginx  gdbserver<br><img src="/2022/img/image-20230519170654151.png" alt=""></p><p> CLion <br><img src="/2022/img/image-20230519170830143.png" alt=""></p><p><img src="/2022/img/image-20230519170923113.png" alt=""></p><p> OK debug <br><img src="/2022/img/image-20230519172054271.png" alt=""><br><strong> gdbserver  CTRL+C CLion  gdb  CTRL+C </strong></p><blockquote><p><strong></strong></p></blockquote><hr><h2 id="font-color-red-CLion-CMake--font"><font color='red'>CLion + CMake </font></h2><p> gdb  CLion  cmake  makefile  CMakeLists.txt </p><ul><li>cmake  makefile  makefile  makefile  CMakeLists.txt </li><li> makefile  makefile  cmake  makefile CMakeLists.txt </li></ul><p> objs  makefile  configure </p><ol><li><p></p> <figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$(CC)</span> -c <span class="variable">$(CFLAGS)</span> <span class="variable">$(CORE_INCS)</span> </span><br><span class="line">-o objs/src/core/nginx.o \</span><br><span class="line">src/core/nginx.c</span><br><span class="line"><span class="comment">#nginx.c --&gt; nginx.o</span></span><br></pre></td></tr></table></figure></li><li><p> 208 </p> <figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$(LINK)</span> -o objs/nginx  \</span><br><span class="line">-lpthread -lcrypt -lpcre -lcrypto -lcrypto -lz <span class="comment">#</span></span><br></pre></td></tr></table></figure></li><li><p> 1068 </p></li></ol><p> CMakeLists.txt  makefile  cmake  CMakeLists.txt </p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.16</span>.<span class="number">3</span>)</span><br><span class="line"><span class="keyword">project</span>(nginx_cmake)</span><br><span class="line"><span class="keyword">set</span>(    SRC</span><br><span class="line">        src/core/nginx.c</span><br><span class="line">        src/core/ngx_log.c</span><br><span class="line">        src/core/ngx_palloc.c</span><br><span class="line">        src/core/ngx_array.c</span><br><span class="line">        src/core/ngx_list.c</span><br><span class="line">        src/core/ngx_hash.c</span><br><span class="line">        src/core/ngx_buf.c</span><br><span class="line">        src/core/ngx_queue.c</span><br><span class="line">        src/core/ngx_output_chain.c</span><br><span class="line">        src/core/ngx_string.c</span><br><span class="line">        src/core/ngx_parse.c</span><br><span class="line">        src/core/ngx_inet.c</span><br><span class="line">        src/core/ngx_file.c</span><br><span class="line">        src/core/ngx_crc32.c</span><br><span class="line">        src/core/ngx_murmurhash.c</span><br><span class="line">        src/core/ngx_md5.c</span><br><span class="line">        src/core/ngx_rbtree.c</span><br><span class="line">        src/core/ngx_radix_tree.c</span><br><span class="line">        src/core/ngx_slab.c</span><br><span class="line">        src/core/ngx_times.c</span><br><span class="line">        src/core/ngx_shmtx.c</span><br><span class="line">        src/core/ngx_connection.c</span><br><span class="line">        src/core/ngx_cycle.c</span><br><span class="line">        src/core/ngx_spinlock.c</span><br><span class="line">        src/core/ngx_cpuinfo.c</span><br><span class="line">        src/core/ngx_conf_file.c</span><br><span class="line">        src/core/ngx_resolver.c</span><br><span class="line">        src/core/ngx_open_file_cache.c</span><br><span class="line">        src/core/ngx_crypt.c</span><br><span class="line">        src/event/ngx_event.c</span><br><span class="line">        src/event/ngx_event_timer.c</span><br><span class="line">        src/event/ngx_event_posted.c</span><br><span class="line">        src/event/ngx_event_busy_lock.c</span><br><span class="line">        src/event/ngx_event_accept.c</span><br><span class="line">        src/event/ngx_event_connect.c</span><br><span class="line">        src/event/ngx_event_pipe.c</span><br><span class="line">        src/os/unix/ngx_time.c</span><br><span class="line">        src/os/unix/ngx_errno.c</span><br><span class="line">        src/os/unix/ngx_alloc.c</span><br><span class="line">        src/os/unix/ngx_files.c</span><br><span class="line">        src/os/unix/ngx_socket.c</span><br><span class="line">        src/os/unix/ngx_recv.c</span><br><span class="line">        src/os/unix/ngx_readv_chain.c</span><br><span class="line">        src/os/unix/ngx_udp_recv.c</span><br><span class="line">        src/os/unix/ngx_send.c</span><br><span class="line">        src/os/unix/ngx_writev_chain.c</span><br><span class="line">        src/os/unix/ngx_channel.c</span><br><span class="line">        src/os/unix/ngx_shmem.c</span><br><span class="line">        src/os/unix/ngx_process.c</span><br><span class="line">        src/os/unix/ngx_daemon.c</span><br><span class="line">        src/os/unix/ngx_setaffinity.c</span><br><span class="line">        src/os/unix/ngx_setproctitle.c</span><br><span class="line">        src/os/unix/ngx_posix_init.c</span><br><span class="line">        src/os/unix/ngx_user.c</span><br><span class="line">        src/os/unix/ngx_process_cycle.c</span><br><span class="line">        src/os/unix/ngx_linux_init.c</span><br><span class="line">        src/event/modules/ngx_epoll_module.c</span><br><span class="line">        src/os/unix/ngx_linux_sendfile_chain.c</span><br><span class="line">        src/core/ngx_regex.c</span><br><span class="line">        src/http/ngx_http.c</span><br><span class="line">        src/http/ngx_http_core_module.c</span><br><span class="line">        src/http/ngx_http_special_response.c</span><br><span class="line">        src/http/ngx_http_request.c</span><br><span class="line">        src/http/ngx_http_parse.c</span><br><span class="line">        src/http/ngx_http_header_filter_module.c</span><br><span class="line">        src/http/ngx_http_write_filter_module.c</span><br><span class="line">        src/http/ngx_http_copy_filter_module.c</span><br><span class="line">        src/http/modules/ngx_http_log_module.c</span><br><span class="line">        src/http/ngx_http_request_body.c</span><br><span class="line">        src/http/ngx_http_variables.c</span><br><span class="line">        src/http/ngx_http_script.c</span><br><span class="line">        src/http/ngx_http_upstream.c</span><br><span class="line">        src/http/ngx_http_upstream_round_robin.c</span><br><span class="line">        src/http/ngx_http_parse_time.c</span><br><span class="line">        src/http/modules/ngx_http_static_module.c</span><br><span class="line">        src/http/modules/ngx_http_index_module.c</span><br><span class="line">        src/http/modules/ngx_http_chunked_filter_module.c</span><br><span class="line">        src/http/modules/ngx_http_range_filter_module.c</span><br><span class="line">        src/http/modules/ngx_http_headers_filter_module.c</span><br><span class="line">        src/http/modules/ngx_http_not_modified_filter_module.c</span><br><span class="line">        src/http/ngx_http_busy_lock.c</span><br><span class="line">        src/http/ngx_http_file_cache.c</span><br><span class="line">        src/http/modules/ngx_http_gzip_filter_module.c</span><br><span class="line">        src/http/ngx_http_postpone_filter_module.c</span><br><span class="line">        src/http/modules/ngx_http_ssi_filter_module.c</span><br><span class="line">        src/http/modules/ngx_http_charset_filter_module.c</span><br><span class="line">        src/http/modules/ngx_http_userid_filter_module.c</span><br><span class="line">        src/http/modules/ngx_http_autoindex_module.c</span><br><span class="line">        src/http/modules/ngx_http_auth_basic_module.c</span><br><span class="line">        src/http/modules/ngx_http_access_module.c</span><br><span class="line">        src/http/modules/ngx_http_limit_conn_module.c</span><br><span class="line">        src/http/modules/ngx_http_limit_req_module.c</span><br><span class="line">        src/http/modules/ngx_http_geo_module.c</span><br><span class="line">        src/http/modules/ngx_http_map_module.c</span><br><span class="line">        src/http/modules/ngx_http_split_clients_module.c</span><br><span class="line">        src/http/modules/ngx_http_referer_module.c</span><br><span class="line">        src/http/modules/ngx_http_rewrite_module.c</span><br><span class="line">        src/http/modules/ngx_http_proxy_module.c</span><br><span class="line">        src/http/modules/ngx_http_fastcgi_module.c</span><br><span class="line">        src/http/modules/ngx_http_uwsgi_module.c</span><br><span class="line">        src/http/modules/ngx_http_scgi_module.c</span><br><span class="line">        src/http/modules/ngx_http_memcached_module.c</span><br><span class="line">        src/http/modules/ngx_http_empty_gif_module.c</span><br><span class="line">        src/http/modules/ngx_http_browser_module.c</span><br><span class="line">        src/http/modules/ngx_http_upstream_ip_hash_module.c</span><br><span class="line">        src/http/modules/ngx_http_upstream_keepalive_module.c</span><br><span class="line">        objs/ngx_modules.c</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">include_directories</span>(</span><br><span class="line">        src/core</span><br><span class="line">        src/event</span><br><span class="line">        src/event/modules</span><br><span class="line">        src/os/unix</span><br><span class="line">        objs</span><br><span class="line">        src/http</span><br><span class="line">        src/http/modules</span><br><span class="line">        src/mail</span><br><span class="line">        src/core</span><br><span class="line">)</span><br><span class="line"><span class="keyword">add_executable</span>(nginx <span class="variable">$&#123;SRC&#125;</span>)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(nginx pthread crypt pcre crypto z)</span><br></pre></td></tr></table></figure><p> txt </p><p> configure objs  <code>cmake ..</code>  makefile <code>make</code> <br> CLion  .idea  CMakeLists.txt CLion  cmake <br><img src="/2022/img/image-20230519195102239.png" alt=""></p><p><br><img src="/2022/img/image-20230519195155896.png" alt="image-20230519195155896"></p><p><br><img src="/2022/img/image-20230519195504657.png" alt="image-20230519195504657"></p><p><br><img src="/2022/img/image-20230519195605854.png" alt=""></p><p><br><img src="/2022/img/image-20230519195719650.png" alt="image-20230519195719650"></p><p> <code>Console</code>  epoll_wait <br><img src="/2022/img/image-20230519195904875.png" alt=""></p><p></p><hr><h2 id="font-color-red-VSNginx-font"><font color='red'>VSNginx</font></h2><p><a href="https://www.taurusxin.com/nginx-windows-build/#%E9%85%8D%E7%BD%AE-64-%E4%BD%8D-openssl">WindowsNginx</a><a href="https://cloud.tencent.com/developer/article/2205549?from=article.detail.1476984&amp;areaSource=106000.16&amp;traceId=il-m4ntHJ8HD5tlLzMjN_">VSNginx</a> </p><hr><h2 id="font-color-red--font"><font color='red'></font></h2><p> CLion  CMakeLists.txt<br><img src="/2022/img/image-20230520124805926.png" alt=""></p><p><strong> CMakeLists.txt  .h  .c </strong>  ./configure  makefile  .c  .h </p><hr><h2 id="font-color-red--font"><font color='red'></font></h2><ul><li> README</li><li> <code>./configure --help</code> </li><li></li><li> google </li></ul>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2023/05/07/%E9%9D%9E%E9%98%BB%E5%A1%9E%E5%A5%97%E6%8E%A5%E5%AD%97%E5%8F%8A%E5%85%B6%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/"/>
      <url>/2023/05/07/%E9%9D%9E%E9%98%BB%E5%A1%9E%E5%A5%97%E6%8E%A5%E5%AD%97%E5%8F%8A%E5%85%B6%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p> read/recv  -1 </p><p>P163</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>cmake-</title>
      <link href="/2023/05/05/cmake%E5%85%A5%E9%97%A8/"/>
      <url>/2023/05/05/cmake%E5%85%A5%E9%97%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="font-color-red--font"><font color='red'></font></h2><p> cmake </p><ul><li><p></p></li><li><p> myMath  3rdMath </p></li><li><p></p></li><li><p></p></li><li><p> Windows  Linux </p><blockquote><p> cmake  Windows  Linux </p></blockquote></li></ul><blockquote><p><a href="https://github.com/jyx-fyh/cmakeLearn/tree/master">cmake</a></p></blockquote><p> cmake  Linux  CLion  cmake </p><p> cmake </p><h2 id="font-color-red-cmakenmakemakemakefile-font"><font color='red'>cmakenmakemakemakefile</font></h2><p><img src="/2022/img/v2-497f031761c929e5c036138f938508c6_1440w.webp" alt=""></p><p>make  Unix/Linux  Makefile make  gcc  ld Makefile 1 Makefile 2Makefile  make  Unix/Linux  cmake  cmake<strong> CMakelist.txt <u><font color='orange'></font></u></strong><strong> Linux  MakefileWindows  .sln  .vcxproj </strong>  nmake  Linux make  Makefile  Windows  nmake  Makefile </p><h2 id="font-color-red--font"><font color='red'></font></h2><p></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line"> <span class="number">3</span>rdParty</span><br><span class="line">  lib3rdMath</span><br><span class="line">   bin</span><br><span class="line">    lib3rdMath.a</span><br><span class="line">   include</span><br><span class="line">       <span class="number">3</span>rdMath.h</span><br><span class="line">  libplay</span><br><span class="line">      bin</span><br><span class="line">       libplay.a</span><br><span class="line">      include</span><br><span class="line">          play.h</span><br><span class="line"> CMakeLists.txt</span><br><span class="line"> config.h.in</span><br><span class="line"> include</span><br><span class="line">  student.h</span><br><span class="line"> libs</span><br><span class="line">  CMakeLists.txt</span><br><span class="line">  myMath</span><br><span class="line">   include</span><br><span class="line">    myMath.h</span><br><span class="line">   src</span><br><span class="line">       myMath.c</span><br><span class="line">  work</span><br><span class="line">      include</span><br><span class="line">       work.h</span><br><span class="line">      src</span><br><span class="line">          work.c</span><br><span class="line"> README.md</span><br><span class="line"> src</span><br><span class="line">     main.c</span><br><span class="line">     student.c</span><br></pre></td></tr></table></figure><ul><li><code>src</code> <code>include</code> </li><li><code>lib</code> <strong>myMathwork</strong> </li><li><code>3rdParty</code> </li><li><code>config.h.in</code> </li><li><code>README</code> </li><li><code>CMakeLists.txt</code> </li></ul><h2 id="font-color-red--font"><font color='red'></font></h2><p> <strong> CMakeLists.txt </strong>  build  build  <strong></strong> </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir build</span><br><span class="line">cd build</span><br><span class="line">cmake ..</span><br><span class="line">make</span><br></pre></td></tr></table></figure><p> build </p><p> cmake  <code>PROJECT_BINARY_DIR</code> <strong><code>PROJECT_BINARY_DIR</code>  <code>cmake</code>  build <code>PROJECT_SOURCE_DIR</code> </strong> </p><h2 id="font-color-red--font"><font color='red'></font></h2><p>cmake  CMakeLists.txt  Makefile <strong> CMakeLists.txt </strong>  CMakeLists.txt  myMath  work  CMakeList.txt <br>CMakeLists.txt <strong>CMakeLists.txt</strong>  USE_MYMATH  myMath </p><p> CMakeLists.txt  cmake  <code>add_subdirectory</code>  CMakeLists.txt  CMakeLists.txt  cmake  CMakeLists.txt </p><p><strong><font color='orange'>cmake </font></strong>  CMakeLists.txt  <code>add_subdirectory</code>  CMakeLists.txt  cmake  <code>message</code> </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">dir0</span><br><span class="line"> CMakeLists.txt</span><br><span class="line"> dir1</span><br><span class="line">  CMakeLists.txt</span><br><span class="line">  dir3</span><br><span class="line">      CMakeLists.txt</span><br><span class="line"> dir2</span><br><span class="line">  CMakeLists.txt</span><br><span class="line"> main.c</span><br></pre></td></tr></table></figure><p> CMakeLists.txt </p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#dir0</span></span><br><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.5</span>)</span><br><span class="line"><span class="keyword">project</span>(untitled C)</span><br><span class="line"><span class="keyword">message</span>(<span class="string">&quot;dir0-before&quot;</span>)</span><br><span class="line"><span class="keyword">add_subdirectory</span>(dir1)</span><br><span class="line"><span class="keyword">add_subdirectory</span>(dir2)</span><br><span class="line"><span class="keyword">message</span>(<span class="string">&quot;dir0-after&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#dir1</span></span><br><span class="line"><span class="keyword">message</span>(<span class="string">&quot;dir1-before&quot;</span>)</span><br><span class="line"><span class="keyword">add_subdirectory</span>(dir3)</span><br><span class="line"><span class="keyword">message</span>(<span class="string">&quot;dir1-after&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#dir2</span></span><br><span class="line"><span class="keyword">message</span>(<span class="string">&quot;dir2&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#dir3</span></span><br><span class="line"><span class="keyword">message</span>(<span class="string">&quot;dir3&quot;</span>)</span><br></pre></td></tr></table></figure><p> build </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">~/CLionProjects/dir0$ </span><span class="language-bash"><span class="built_in">mkdir</span> build</span></span><br><span class="line"><span class="meta prompt_">~/CLionProjects/dir0$ </span><span class="language-bash"><span class="built_in">cd</span> build/</span></span><br><span class="line"><span class="meta prompt_">~/CLionProjects/dir0/build$ </span><span class="language-bash">cmake ..</span></span><br><span class="line">...........</span><br><span class="line">dir0-before</span><br><span class="line">dir1-before</span><br><span class="line">dir3</span><br><span class="line">dir1-after</span><br><span class="line">dir2</span><br><span class="line">dir0-after</span><br></pre></td></tr></table></figure><p><br><img src="/2022/img/ahshita.png" alt=""></p><p><strong><font color='orange'> CMakeLists.txt </font></strong>  CMakeLists.txt </p><p><strong></strong></p><ul><li> <code>add_subdirectory</code> </li></ul><p><strong></strong></p><ul><li></li><li></li></ul><blockquote><p><strong><font color='orange'> cmake </font></strong></p></blockquote><p><br><img src="/2022/img/mdfuck.png" alt="dir0A,dir1B"></p><p><strong><font color='orange'></font></strong>  add_definition C/C++  option  configure_file </p><blockquote><p><strong><font color='red'></font></strong></p></blockquote><h2 id="font-color-red--font"><font color='red'></font></h2><p> CMakeLists.txt  configure.in.h </p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#CMakeLists.txt</span></span><br><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.5</span>) <span class="comment">#cmake</span></span><br><span class="line"><span class="keyword">project</span>(cmake VERSION <span class="number">3.0</span>) <span class="comment">#</span></span><br><span class="line"><span class="comment"># Math</span></span><br><span class="line"><span class="keyword">option</span> (USE_MYMATH <span class="comment">#,</span></span><br><span class="line">        <span class="string">&quot;Use provided math implementation&quot;</span> <span class="comment">#</span></span><br><span class="line">        <span class="keyword">ON</span>) <span class="comment"># ON</span></span><br><span class="line"><span class="keyword">configure_file</span> (<span class="string">&quot;config.h.in&quot;</span> <span class="string">&quot;config.h&quot;</span>) <span class="comment">#,</span></span><br><span class="line"><span class="keyword">add_subdirectory</span>(libs) <span class="comment">#</span></span><br><span class="line"><span class="keyword">aux_source_directory</span>(src/ SRC) <span class="comment">#srcSRC</span></span><br><span class="line"><span class="keyword">set</span>(LIB play work) <span class="comment">#playworkLIB</span></span><br><span class="line"><span class="comment">#  myMath </span></span><br><span class="line"><span class="keyword">if</span> (USE_MYMATH)</span><br><span class="line">    <span class="keyword">include_directories</span> (<span class="string">&quot;libs/myMath/include&quot;</span>) <span class="comment">#</span></span><br><span class="line">    <span class="keyword">set</span> (LIB <span class="variable">$&#123;LIB&#125;</span> myMath) <span class="comment">#LIBmyMath</span></span><br><span class="line">    <span class="comment">#list(APPEND LIB myMath)</span></span><br><span class="line"><span class="keyword">else</span> ()</span><br><span class="line">    <span class="keyword">include_directories</span> (<span class="string">&quot;3rdParty/lib3rdMath/include&quot;</span>)</span><br><span class="line">    <span class="keyword">link_directories</span>(<span class="string">&quot;3rdParty/lib3rdMath/bin&quot;</span>) <span class="comment">#</span></span><br><span class="line">    <span class="keyword">set</span> (LIB <span class="variable">$&#123;LIB&#125;</span> <span class="number">3</span>rdMath)</span><br><span class="line"><span class="keyword">endif</span> (USE_MYMATH)</span><br><span class="line"></span><br><span class="line"><span class="keyword">include_directories</span>(</span><br><span class="line">        <span class="string">&quot;include&quot;</span></span><br><span class="line">        <span class="variable">$&#123;PROJECT_BINARY_DIR&#125;</span> <span class="comment">#config.h</span></span><br><span class="line">        <span class="string">&quot;libs/work/include&quot;</span></span><br><span class="line">        <span class="string">&quot;3rdParty/libplay/include&quot;</span>)</span><br><span class="line"><span class="keyword">link_directories</span>(<span class="string">&quot;3rdParty/libplay/bin&quot;</span>)</span><br><span class="line"><span class="keyword">set</span>(EXECUTABLE_OUTPUT_PATH <span class="variable">$&#123;PROJECT_BINARY_DIR&#125;</span>/bin) <span class="comment">#</span></span><br><span class="line"><span class="keyword">add_executable</span>(ctest <span class="variable">$&#123;SRC&#125;</span>) <span class="comment">#SRCctest</span></span><br><span class="line"><span class="keyword">target_link_libraries</span>(ctest <span class="variable">$&#123;LIB&#125;</span>) <span class="comment">#ctest</span></span><br><span class="line"><span class="keyword">install</span> (TARGETS ctest DESTINATION bin) <span class="comment">#ctestbin</span></span><br></pre></td></tr></table></figure><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#CMakeLists.txt</span></span><br><span class="line"><span class="keyword">aux_source_directory</span>(myMath/src/ myMathSrc)</span><br><span class="line"><span class="keyword">aux_source_directory</span>(work/src workSrc)</span><br><span class="line"><span class="keyword">set</span>(LIBRARY_OUTPUT_PATH <span class="variable">$&#123;PROJECT_BINARY_DIR&#125;</span>/bin) <span class="comment">#</span></span><br><span class="line"><span class="keyword">if</span> (USE_MYMATH) <span class="comment">#txt</span></span><br><span class="line">    <span class="keyword">add_library</span>(myMath STATIC <span class="variable">$&#123;myMathSrc&#125;</span>) <span class="comment">#myMath</span></span><br><span class="line"><span class="keyword">endif</span> (USE_MYMATH)</span><br><span class="line"><span class="keyword">if</span>(WIN32) <span class="comment">#Windows</span></span><br><span class="line">    <span class="keyword">add_definitions</span>(-D_WIN32_) <span class="comment">#_WIN32_</span></span><br><span class="line">    <span class="keyword">set</span>(LIB_POS bin)</span><br><span class="line"><span class="keyword">else</span>()</span><br><span class="line">    <span class="keyword">set</span>(LIB_POS lib)</span><br><span class="line"><span class="keyword">endif</span>()</span><br><span class="line"><span class="keyword">add_library</span>(work SHARED <span class="variable">$&#123;workSrc&#125;</span>) <span class="comment">#work</span></span><br><span class="line"><span class="keyword">install</span> (TARGETS work DESTINATION &#123;LIB_POS&#125;) <span class="comment">#work&#123;LIB_POS&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//configure.h.in</span><br><span class="line">#cmakedefine USE_MYMATH //USE_MYMATHON,,</span><br><span class="line">#define PROJECT_VERSION_MAJOR @PROJECT_VERSION_MAJOR@ //cmake</span><br><span class="line">#define PROJECT_VERSION_MINOR @PROJECT_VERSION_MINOR@ //cmake</span><br><span class="line">#define PROJECT_NAME @PROJECT_NAME@ //cmake</span><br></pre></td></tr></table></figure><p> txt </p><ul><li><p><strong> txt  txt</strong> </p></li><li><p> 3  <code>project</code>  <code>PROJECT_NAME</code> <strong><font color='orange'> <code>$&#123;&#125;</code></font></strong>  <code>PROJECT_VERSION_MAJOR</code>  <code>PROJECT_VERSION_MINOR</code>  <a href="http://configure.h.in">configure.h.in</a> </p></li><li><p> 5  USE_MYMATH  ON  myMath  option  set </p>  <figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>(USE_MYMATH <span class="keyword">ON</span>)</span><br></pre></td></tr></table></figure><p> set  ccmake <strong><font color='orange'>ccmake  cmake </font></strong> <br><img src="/2022/img/image-20230514102921312.png" alt=""><br> option  ccmake  USE_MYMATH </p><blockquote><p><strong><font color='orange'><code>CMAKE_BUILD_TYPE</code>  cmake  Debug  Release </font></strong> cmake</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//CMAKE_CFLAGS</span><br><span class="line">cmake -DCMAKE_C_FLAGS=&quot;-g -O0&quot; ..</span><br></pre></td></tr></table></figure></blockquote></li><li><p> 8 <strong><code>configure.h</code>  <code>configure.h.in</code> </strong> configure.h build<strong><font color='orange'><a href="http://configure.h.in">configure.h.in</a>  CMakeLists.txt </font></strong>  <a href="http://configure.h.in">configure.h.in</a> </p></li><li><p><strong><font color='orange'> configure.h <a href="http://configure.h.in">configure.h.in</a>  configure_file </font></strong>  5  option  configure_file </p><blockquote><p> configure_file </p></blockquote></li><li><p> 15 <code>set (LIB $&#123;LIB&#125; myMath)</code>  LIB  myMath<strong> <code>list(APPEND LIB myMath)</code> </strong> </p></li><li><p> 19 <strong> txt  14 cmake  4 </strong> </p></li><li><p><strong> 32 bin  Linux <code>/usr/local</code>  Windows  <code>C:\Program Files (x86)\</code></strong>  cmake  -D </p>  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmake -DCMAKE_INSTALL_PREFIX=\xxx\yyy</span><br></pre></td></tr></table></figure><p><code>CMAKE_INSTALL_PREFIX</code>  cmake <strong>cmake  -D  CMakeLists.txt  C/C++ </strong> </p></li></ul><p> txt</p><ul><li><p> 8 <code>WIN32</code>  cmake  Windows </p></li><li><p> 9 <code>add_definition</code>  C/C++ </p></li><li><p> 8~12  Windows bin  Linux lib  bin </p><blockquote><p> Linux  usr\bin  usr\lib  usr\lib  Windows  dll exe  exe  QQ <br><img src="/2022/img/image-20230514131005841.png" alt="exedll"></p></blockquote></li></ul><h2 id="font-color-red-Linux-font"><font color='red'>Linux</font></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">~/cmakeLearn$ </span><span class="language-bash"><span class="built_in">mkdir</span> build</span></span><br><span class="line"><span class="meta prompt_">~/cmakeLearn$ </span><span class="language-bash"><span class="built_in">cd</span> build</span></span><br><span class="line"><span class="meta prompt_">~/cmakeLearn/build$ </span><span class="language-bash">cmake ..</span></span><br><span class="line"><span class="meta prompt_">~/cmakeLearn/build$ </span><span class="language-bash">make</span></span><br></pre></td></tr></table></figure><p> myMath </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">~/cmakeLearn/build$ </span><span class="language-bash">./bin/ctest</span> </span><br><span class="line">PROJECT cmake</span><br><span class="line">VERSION 3.0</span><br><span class="line">use myMath.h //myMath</span><br><span class="line">The older age is 20.</span><br><span class="line">Let&#x27;s sing!  //play</span><br><span class="line">Let&#x27;s dance! //play</span><br><span class="line">Let&#x27;s work!  //work</span><br></pre></td></tr></table></figure><p> myMath </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">~/CLionProjects/cmakeLearn/build$ </span><span class="language-bash">cmake -DUSE_MYMATH=OFF ..</span></span><br><span class="line"><span class="meta prompt_">~/CLionProjects/cmakeLearn/build$ </span><span class="language-bash">make</span></span><br></pre></td></tr></table></figure><p></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">~/cmakeLearn/build$ </span><span class="language-bash">./bin/ctest</span> </span><br><span class="line">PROJECT cmake</span><br><span class="line">VERSION 3.0</span><br><span class="line">use 3rdMath.h</span><br><span class="line">The older age is 20.</span><br><span class="line">Let&#x27;s sing!</span><br><span class="line">Let&#x27;s dance!</span><br><span class="line">Let&#x27;s work!</span><br></pre></td></tr></table></figure><p> <strong><code>sudo make install</code></strong>  sudo<br><img src="/2022/img/image-20230514133434317.png" alt=""></p><p><strong><font color='orange'> ctest  /usr/local/lib lib </font></strong> </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export LD_LIBRARY_PATH=/usr/local/lib</span><br></pre></td></tr></table></figure><blockquote><p> .bashrc </p></blockquote><p></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">/$ </span><span class="language-bash">ctest</span></span><br><span class="line">PROJECT cmake</span><br><span class="line">VERSION 3.0</span><br><span class="line">use 3rdMath.h</span><br><span class="line">The older age is 20.</span><br><span class="line">Let&#x27;s sing!</span><br><span class="line">Let&#x27;s dance!</span><br><span class="line">Let&#x27;s work!</span><br></pre></td></tr></table></figure><h2 id="font-color-red-Windows-font"><font color='red'>Windows</font></h2><p> cmake</p><p></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;mkdir build</span><br><span class="line">&gt;<span class="built_in">cd</span> build</span><br><span class="line">&gt;cmake ..</span><br></pre></td></tr></table></figure><p><img src="/2022/img/image-20230514135550812.png" alt=""></p><blockquote><p> <code>.sln</code> <code>.vcxproj</code>  VS  Visual Studio  <strong><a href="https://jyx-fyh.github.io/2023/05/02/%E7%BC%96%E8%AF%91%E8%B0%83%E5%BC%8F%E5%A4%A7%E5%9E%8B%E9%A1%B9%E7%9B%AE/"> VS </a></strong></p></blockquote><p> cmake.sln <br><img src="/2022/img/image-20230514140109505.png" alt=""></p><p>cmake  6  ctestmyMath  work  ALL_BUILDINSTALLZERO_CHECK  cmake </p><ul><li>ALL_BUILD  makefile  make all INSTALL </li><li>INSTALL  make install </li><li>ZERO_CHECK  CMakeLists.txt  CMakeLists.txt  ZERO_CHECK </li></ul><p> INSTALL<br><img src="/2022/img/image-20230514162003916.png" alt=""></p><p> <code>C:\Program Files (x86)</code>  VS  sln INSTALL<br><img src="/2022/img/image-20230514162319358.png" alt=""></p><p> ctest.exe  sleep </p><hr><h2 id="font-color-red--font"><font color='red'></font></h2><table><thead><tr><th style="text-align:left"></th><th style="text-align:left"></th></tr></thead><tbody><tr><td style="text-align:left">CMAKE_BINARY_DIR<br />PROJECT_BINARY_DIR</td><td style="text-align:left"> build </td></tr><tr><td style="text-align:left">CMAKE_SOURCE_DIR<br />PROJECT_SOURCE_DIR</td><td style="text-align:left"> CMakeLists.txt </td></tr><tr><td style="text-align:left">CMAKE_CURRENT_SOURCE_DIR</td><td style="text-align:left"> CMakeLists.txt </td></tr><tr><td style="text-align:left">EXECUTABLE_OUTPUT_PATH<br />LIBRARY_OUTPUT_PATH</td><td style="text-align:left"></td></tr><tr><td style="text-align:left">PROJECT_NAME</td><td style="text-align:left"> PROJECT </td></tr><tr><td style="text-align:left">CMAKE_INSTALL_PREFIX</td><td style="text-align:left"></td></tr><tr><td style="text-align:left">CMAKE_BUILD_TYPE</td><td style="text-align:left"> Debug  Release</td></tr><tr><td style="text-align:left">CMAKE_C_COMPILER</td><td style="text-align:left">C </td></tr><tr><td style="text-align:left">CMAKE_CXX_COMPILER</td><td style="text-align:left">C++ </td></tr><tr><td style="text-align:left">CMAKE_C_FLAGS</td><td style="text-align:left">C</td></tr><tr><td style="text-align:left">WIN32</td><td style="text-align:left"> Windows </td></tr></tbody></table><table><thead><tr><th style="text-align:center"></th><th style="text-align:center"></th></tr></thead><tbody><tr><td style="text-align:center">set</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">list</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">add_subdirectory</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">add_definitions</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">configure_file</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">message</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">add_executable</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">add_library</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">aux_source_directory</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">link_directories</td><td style="text-align:center">cmake</td></tr><tr><td style="text-align:center">include_directories</td><td style="text-align:center">cmake</td></tr><tr><td style="text-align:center">target_include_directories</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">target_link_directories</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">target_link_libraries</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">install</td><td style="text-align:center"></td></tr></tbody></table><hr><h2 id="font-color-red--font"><font color='red'></font></h2><ul><li><p> Linux  ccmakeWindows  cmake <br><img src="/2022/img/image-20230514170003470.png" alt=""></p></li><li><p>Windows  cmake  sln  VS </p>  <figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;mkdir build</span><br><span class="line">&gt;<span class="built_in">cd</span> build</span><br><span class="line">&gt;cmake  .. </span><br><span class="line">&gt;cmake <span class="literal">--build</span> . <span class="literal">--config</span> Release //Release</span><br></pre></td></tr></table></figure><p><strong><font color='orange'><code>cmake ..</code>  Unix MakefilesNinjaVisual Studio </font></strong> </p>  <figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;cmake <span class="literal">-G</span> <span class="string">&quot;Visual Studio 17&quot;</span> ..</span><br><span class="line">&gt;cmake <span class="literal">--build</span> . <span class="literal">--config</span> Release</span><br></pre></td></tr></table></figure><p> Visual Studio 17 <strong> <code>cmake --build . --config Release</code>  CMake </strong>  Unix/Linux  gcc/g++ Windows  CL.exe </p></li><li><p> Linux </p>  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">./configure</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">make</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">make install</span></span><br></pre></td></tr></table></figure><p> ./configure  <code>cmake ..</code> configure  Autoconf Autoconf  configure  cmake  CMakeLists.txt Autoconf  cmake Autoconf  M4  shell  CMake  CMake M4  CMake </p></li><li><p> cmake  I/O  epoll  Linux Windows  IOCP Linux  Windows <a href=""></a></p></li></ul><p></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VS?</title>
      <link href="/2023/05/02/%E7%BC%96%E8%AF%91%E8%B0%83%E5%BC%8F%E5%A4%A7%E5%9E%8B%E9%A1%B9%E7%9B%AE/"/>
      <url>/2023/05/02/%E7%BC%96%E8%AF%91%E8%B0%83%E5%BC%8F%E5%A4%A7%E5%9E%8B%E9%A1%B9%E7%9B%AE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>  <code>.cpp</code>  <strong></strong>  <code>.h</code>**<strong><code>.ico</code><code>.rc</code></strong>** </p><blockquote><p><a href="https://zhuanlan.zhihu.com/p/580990312">C/C++</a> <a href="https://shiyousan.com/post/636441130259624698">.vs</a> <code>chatgpt</code> </p></blockquote><h2 id="font-color-red-VS--font"><font color='red'>VS </font></h2><p> github </p><p>1 README </p><p>2 MakeCMake</p><p>3</p><p>4 Google  chatgpt</p><p> IDE  Visual Studio </p><p>Visual Studio  <strong><u><font color='orange'></font></u></strong>  <strong><u><font color='orange'></font></u></strong></p><p> (Solution)  <strong></strong> <strong></strong>  C++ <strong></strong> </p><p> (Project) lib \ dll.exe Visual Studio .vcxprojsourceheaderresource</p><p> Visual Studio </p><p> teamtalk <br><img src="/2022/img/image-20230502133617307.png" alt=""></p><p>teamtalk  11 <br><img src="/2022/img/image-20230502133719222.png" alt=""></p><p> <code>DuiLib.dll</code>  DuiLib <strong><font color='orange'></font></strong> <strong> exe </strong>  <code>Set as Startup Project</code> <br><img src="/2022/img/image-20230502135834519.png" alt=""></p><p><strong><font color='orange'></font></strong>  Property<br><img src="/2022/img/image-20230502140120538.png" alt="image-20230502140120538"></p><p>teamtalk  .exe <strong><font color='orange'>Target Name</font></strong>  Output Directory  .exe<br><img src="/2022/img/image-20230502141050271.png" alt=""></p><p></p><hr><h2 id="font-color-red--font"><font color='red'></font></h2><p> teamtalk <br><img src="/2022/img/image-20230502140749981.png" alt=""></p><p> Visual Studio  C++ .vcxproj.vcxproj.filters  .vcxproj.user</p><p><strong><font color='gree'>1</font></strong> .vcxproj  Visual C++ <strong><font color='orange'> .vcxproj </font></strong></p><blockquote><p> <code>.vcproj</code> vcxproj  vcproj  Visual Studio <br>vcproj  Visual Studio 2002  2003  C++  vcxproj  Visual Studio 2005  C++ vcxproj  vcproj  XML </p></blockquote><p><strong><font color='gree'>2</font></strong> .vcxproj.filters  Visual C++    Main  ProjectFils  <br><img src="/2022/img/image-20230502142944601.png" alt=""></p><p> .vcxproj.filters <br><img src="/2022/img/image-20230502143614625.png" alt=""></p><p> .vcxproj.filters </p><p> <strong><u></u></strong> <strong></strong> </p><p><strong><font color='gree'>3</font></strong> .vcxproj.user </p><p><strong><font color='gree'>4</font></strong> .vs <strong> VS ///</strong> <br><img src="/2022/img/image-20230502151248516.png" alt=""></p><hr><h2 id="font-color-red--font"><font color='red'></font></h2><p><strong><font color='gree'>1</font></strong><br> solution  build  solution <br><img src="/2022/img/image-20230502151950947.png" alt=""></p><p><strong><font color='gree'>2</font></strong><br><br><img src="/2022/img/image-20230502153808196.png" alt=""></p><p> network  network  GifSmiley  httpclient</p><p><strong><font color='gree'>3</font></strong><br>Visual Studio</p><ol><li>Visual Studio </li><li> Visual Studio Windows SDK </li><li> <code>INCLUDE</code>  Visual Studio </li><li></li></ol><p><br><img src="/2022/img/image-20230502154638921.png" alt=""></p><p><strong><font color='gree'>5</font></strong><br></p><ol><li></li><li></li><li>LIB VS </li><li></li><li><u> VS </u></li></ol><p><br><img src="/2022/img/image-20230502155314071.png" alt=""></p><p><br><img src="/2022/img/image-20230502155518589.png" alt=""></p><p><strong><font color='gree'>6</font></strong><br><br><img src="/2022/img/image-20230502155709943.png" alt=""></p><p><strong><font color='gree'>7</font></strong><br>lib  dll<br><img src="../../public/2022/img/image-20230503220941281.png" alt=""></p><p><br><img src="../../public/2022/img/image-20230503220743624.png" alt=""></p><p><img src="../../public/2022/img/image-20230503220759030.png" alt=""></p><hr><p>OK teamtalkNginxLibevent uwebsocket</p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>1-teamtalk</title>
      <link href="/2023/05/01/%E7%BB%83%E4%B9%A01-%E7%BC%96%E8%AF%91%E8%B0%83%E8%AF%95teamtalk/"/>
      <url>/2023/05/01/%E7%BB%83%E4%B9%A01-%E7%BC%96%E8%AF%91%E8%B0%83%E8%AF%95teamtalk/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>TeamTalk <a href="https://github.com/balloonwj/TeamTalk"></a><br> Visual Studio  Visual Studio </p></blockquote><blockquote><p> TeamTalk TeamTalk_test TeamTalk_test  TeamTalk </p></blockquote><p>1 <a href="https://github.com/balloonwj/TeamTalk">github</a>  <code>.sln</code> <br><img src="/2022/img/image-20230501211233465.png" alt=""></p><p>2VS<br><img src="/2022/img/image-20230502103951134.png" alt=""></p><p>3 configuration manager Build Solution </p><p><img src="/2022/img/image-20230501212233009.png" alt=""></p><p>4 Build Solution<br><img src="/2022/img/image-20230501212537341.png" alt=""></p><hr><p> &lt;hash_map&gt;  <code>network</code>  &lt;hashmap&gt;    <code>network</code>  property  C/C++  Preprocessor  Preprocessor Definitions  <code>_SILENCE_STDEXT_HASH_DEPRECATION_WARNINGS</code> Modules  teamtalk <br><img src="/2022/img/image-20230501213353573.png" alt=""></p><hr><p> function: is not a member of std  &lt;functional&gt; </p><hr><p><br><img src="/2022/img/image-20230501214331967.png" alt=""><br><code>mbstate_t</code>  <code>0</code>  <code>&#123;0&#125;</code> </p><hr><p><br><img src="/2022/img/image-20230501214805977.png" alt=""><br> utility  <code>mfcs120ud.lib</code>  Modules  teamtalk  <code>utility.lib</code> <strong> <code>mfcs120ud.lib</code>  utility  <code>utility.lib</code>  Modules  teamtalk  <code>utility.lib</code> </strong>  <code>mfcs120ud.lib</code>  teamtalk <br><img src="/2022/img/image-20230501220032627.png" alt=""></p><p> chatgpt <br><img src="/2022/img/image-20230501220445545.png" alt="image-20230501220445545"></p><p>ok MFC  Visual Studio 2013  VS  2022 VS  VC  mfcs <br><img src="/2022/img/image-20230501220913135.png" alt=""></p><p>2022  <code>mfcs140u.lib</code>  <code>mfcs120ud.lib</code>  utility <br><img src="/2022/img/image-20230501221137089.png" alt=""></p><p><br><img src="/2022/img/image-20230501221225358.png" alt=""></p><p>utility  <code>mfcs120ud.lib</code> Modules </p><hr><p><br><img src="/2022/img/image-20230501221431394.png" alt=""></p><p> Modules  <code>libprotobuf-lite.lib</code> <code>_MSC_VER</code>  <code>_MSC_VER</code> chatgpt <br><img src="/2022/img/image-20230501221808184.png" alt=""></p><p>OK <code>libprotobuf-lite.lib</code> <code>libprotobuf-lite.lib</code> <br><img src="/2022/img/image-20230501222531477.png" alt=""></p><p> 3rdParty <code>libprotobuf-lite.lib</code> <a href="https://github.com/protocolbuffers/protobuf/tree/main">github</a> protobuf<br><img src="/2022/img/image-20230501233642275.png" alt=""></p><p> vsprojects  VS  <code>libprotobuf-lite.vcxproj</code> <br><img src="/2022/img/image-20230501233840160.png" alt=""></p><p> Build  <code>libprotobuf-lite.lib</code> </p><p><img src="/2022/img/image-20230501233437643.png" alt=""></p><p> Modules  linker Additional Library Directories <code>D:\VSProjects\TeamTalk\win-client\3rdParty\lib\debug</code> <img src="/2022/img/image-20230501235111560.png" alt=""></p><p> lib  lib <br><img src="/2022/img/image-20230501235420326.png" alt=""></p><p>teamwork <br><img src="/2022/img/image-20230502002924115.png" alt=""></p><p> <code>security.lib</code>  <code>libprotobuf-lite.lib</code>  <code>3rdParty\src</code>  <code>security.cpp</code>  solution <br><img src="/2022/img/image-20230502093523653.png" alt=""></p><p> <code>\TeamTalk\server\src\libsecurity\src</code> <br><img src="/2022/img/image-20230502093758527.png" alt=""></p><p><br><img src="/2022/img/image-20230502093855723.png" alt=""></p><p><code>typedef unsigned char uchar_t</code>  security <br><img src="/2022/img/image-20230502094149718.png" alt=""></p><p> chatgpt <br><img src="/2022/img/image-20230502094505883.png" alt=""></p><p><br><img src="/2022/img/image-20230502094705556.png" alt=""></p><p> security <br><img src="/2022/img/image-20230502094754249.png" alt=""></p><p> <code>SECURITY_WIN32</code> <br><img src="/2022/img/image-20230502094917057.png" alt=""></p><p> security <br><img src="/2022/img/image-20230502095015199.png" alt=""></p><p> <code>security.lib</code> <br><img src="/2022/img/image-20230502095155732.png" alt=""></p><p> solution<br><img src="/2022/img/image-20230502095844929.png" alt=""></p><p> <code>security.lib</code>  security <strong><u> <code>security.cpp</code> </u></strong>  security  <code>\TeamTalk\server\src\libsecurity\src</code> <br><img src="/2022/img/image-20230502100837276.png" alt=""></p><p>ok security <br><img src="/2022/img/image-20230502101048441.png" alt=""></p><p> <code>security.lib</code>  solution<br><img src="/2022/img/image-20230502102713327.png" alt=""></p><p><code>Please verify that you have sufficient right to run this command</code>  VS<br><img src="/2022/img/image-20230502102907161.png" alt=""></p><p></p><p> teamtalk </p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C</title>
      <link href="/2023/04/28/C%E8%AF%AD%E8%A8%80%E5%AE%8F%E7%9A%84%E5%87%A0%E5%A4%84%E9%99%B7%E9%98%B1/"/>
      <url>/2023/04/28/C%E8%AF%AD%E8%A8%80%E5%AE%8F%E7%9A%84%E5%87%A0%E5%A4%84%E9%99%B7%E9%98%B1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>C</p></blockquote><ol><li><p><strong></strong></p> <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MUL(x,y) ((x)*(y))</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MUL(x,y) (x*y)</span></span><br></pre></td></tr></table></figure><p></p> <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MUL(a+b, c+d);</span><br><span class="line"><span class="comment">// a + b * c + d , </span></span><br></pre></td></tr></table></figure></li><li><p><strong> do{}while() </strong></p> <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ERROR_RET(x) &#123;error_code=x;return false;&#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ERROR_RET(x) do&#123;error_code=x;return false;&#125;while(0);</span></span><br></pre></td></tr></table></figure><p> <code>&#123;&#125;</code> </p> <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(condition == <span class="literal">true</span>)</span><br><span class="line">    ERROR_RET(x);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br></pre></td></tr></table></figure><p></p> <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(condition == <span class="literal">true</span>)&#123;</span><br><span class="line">    error_code=x;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br></pre></td></tr></table></figure><p> 4  <code>;</code>  <code>do&#123;&#125;while()</code> <a href="https://jyx-fyh.github.io/2023/04/26/do-while-%E6%9C%89%E4%BB%80%E4%B9%88%E7%94%A8/">do{}while()</a> </p></li><li><p><strong></strong><br> <code></code> </p> <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> MAX(a,b) ((a)&gt;(b)?(a):(b))</span></span><br><span class="line"><span class="comment">//....</span></span><br><span class="line">x = <span class="number">5</span>, y = <span class="number">7</span>;</span><br><span class="line">z = MAX(x++, y++);</span><br><span class="line"><span class="comment">//x,y</span></span><br></pre></td></tr></table></figure><p><strong><u></u></strong> </p> <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> is_lower(ch)  (((ch) &gt; <span class="string">&#x27;a&#x27;</span> &amp;&amp; (ch) &lt; <span class="string">&#x27;z&#x27;</span>) ? 1 : 0)</span></span><br><span class="line"><span class="comment">//...</span></span><br><span class="line">is_lower(getchar());</span><br></pre></td></tr></table></figure><p>getchar() </p></li></ol><p></p>]]></content>
      
      
      <categories>
          
          <category> C </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>&lt;&gt;do{}while()?</title>
      <link href="/2023/04/26/do-while-%E6%9C%89%E4%BB%80%E4%B9%88%E7%94%A8/"/>
      <url>/2023/04/26/do-while-%E6%9C%89%E4%BB%80%E4%B9%88%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p> do{}while()  do{}while() <br><a href="https://www.cnblogs.com/lanxuezaipiao/p/3535674.html">do{}while()?</a></p></blockquote><p>Linux</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">do&#123;</span><br><span class="line"> ...</span><br><span class="line">&#125;while(0)</span><br></pre></td></tr></table></figure><p>dowhile</p><p>do{}while(0)</p><h2 id="font-color-red--font"><font color='red'></font></h2><p> C NC</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#define __set_task_state(tsk, state_value)      \</span><br><span class="line">    do &#123; (tsk)-&gt;state = (state_value); &#125; while (0)</span><br></pre></td></tr></table></figure><blockquote><p>LinuxCdo{}while(0)Google  Robert LoveLinux<br><strong><font color='orange'>do{}while(0)C</font></strong></p></blockquote><p><strong><font color='orange'> do{}while(0) </font></strong></p><p></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> foo(x) bar(x); baz(x)</span></span><br></pre></td></tr></table></figure><p></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">foo(wolf);</span><br></pre></td></tr></table></figure><p></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bar(wolf); baz(wolf);</span><br></pre></td></tr></table></figure><p></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!feral)</span><br><span class="line">    foo(wolf);</span><br></pre></td></tr></table></figure><p></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!feral)</span><br><span class="line">    bar(wolf);</span><br><span class="line">baz(wolf);</span><br></pre></td></tr></table></figure><p><strong></strong>  <strong>do/while(0)</strong> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> foo(x) &#123; bar(x); baz(x); &#125;</span></span><br></pre></td></tr></table></figure><p>if</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!feral)</span><br><span class="line">    foo(wolf);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    bin(wolf);</span><br></pre></td></tr></table></figure><p></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!feral) &#123;</span><br><span class="line">    bar(wolf);</span><br><span class="line">    baz(wolf);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    bin(wolf);</span><br></pre></td></tr></table></figure><p></p><p><strong><font color='orange'><u></u> do/while(0) </font></strong></p><h2 id="font-color-red-goto-font"><font color='red'>goto</font></h2><p>returnmallocgoto</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">foo</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    somestruct* ptr = <span class="built_in">malloc</span>(...);</span><br><span class="line">    <span class="comment">//dosomething...;</span></span><br><span class="line">    <span class="keyword">if</span>(error)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">goto</span> END;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//dosomething...;</span></span><br><span class="line">    <span class="keyword">if</span>(error)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">goto</span> END;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//dosomething...;</span></span><br><span class="line">END:</span><br><span class="line">    <span class="built_in">free</span>(ptr);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> goto  do{}while(0) </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">foo</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    somestruct* ptr = <span class="built_in">malloc</span>(...);</span><br><span class="line">    <span class="keyword">do</span>&#123;</span><br><span class="line">        <span class="comment">//dosomething...;</span></span><br><span class="line">        <span class="keyword">if</span>(error)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//dosomething...;</span></span><br><span class="line">        <span class="keyword">if</span>(error)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//dosomething...;</span></span><br><span class="line">    &#125;<span class="keyword">while</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">free</span>(ptr);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> do{}while(0)  break  goto</p><blockquote><p> goto </p></blockquote><h2 id="font-color-red--font"><font color='red'></font></h2><p>do{}while(0) </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#define EMPTYMICRO do&#123;&#125;while(0) </span><br></pre></td></tr></table></figure><p></p>]]></content>
      
      
      <categories>
          
          <category> C </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>EPOLLHUP/EPOLLRDHUPread0</title>
      <link href="/2023/04/24/EPOLLHUP-EPOLLRDHUP%E7%9A%84%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF/"/>
      <url>/2023/04/24/EPOLLHUP-EPOLLRDHUP%E7%9A%84%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p><a href="https://blog.csdn.net/halfclear/article/details/78061771">epoll</a> <a href="https://stackoverflow.com/questions/51833215/why-do-we-need-epollrdhup-when-epollhup-seems-enough">EPOLLHUP&amp;EPOLLRDHUP</a> <a href="https://man7.org/linux/man-pages/man2/epoll_ctl.2.html">man_page</a></p></blockquote><p> read/recv  0  0 close FIN  read  FIN  0 FIN  read  read  FIN  0  read  FIN </p><blockquote><p><strong>FIN  FIN  ACK read  FIN </strong></p></blockquote><p></p><ul><li> FIN  close read  0 read  0  close </li><li> EOF read  EOF  0<strong><font color='orange'> read  0 </font></strong> </li></ul><p> read/recv  0  epoll  EPOLLRDHUP  EPOLLHUP </p><p>EPOLLRDHUP <strong>closeshutdown(SHUT_WR)</strong>  EPOLLRDHUP  read <strong><font color='orange'> FIN  EPOLLRDHUP </font></strong> </p><blockquote><p> EPOLLRDHUP <strong> close  shutdown(SHUT_WR) RST </strong>  http  shutdown</p></blockquote><p>EPOLLHUP </p><ul><li><p><strong> RST </strong></p><blockquote><p>RST RST RST </p></blockquote></li><li><p><strong> EPOLL</strong></p><blockquote><p> socket()  listen  connect EPOLL  EPOLLHUP </p><p><strong><font color='orange'> close  EPOLLHUP shutdown  shutdown(SHUT_RDWR)  EPOLLHUP</font></strong> <strong> shutdown(SHUT_RDWR) </strong><font color='orange'><strong>close epoll </strong></font>  close </p></blockquote></li></ul><p><strong>EPOLLHUP </strong></p><p></p><ul><li><strong><font color='orange'> EPOLLERR  EPOLLHUP epoll_event  fd </font></strong></li><li><strong> RST  EPOLLIN + EPOLLRDHUP + EPOLLHUP + EPOLLERR </strong></li><li> close  shutdown  EPOLLIN + EPOLLRDHUP <strong> close  shutdown </strong>  close  RST  EPOLLIN + EPOLLRDHUP + EPOLLHUP + EPOLLERR  shutdown </li><li><strong><font color='orange'>close epoll </font></strong></li></ul>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2023/04/23/%E7%BB%86%E8%AF%B4%E4%BA%92%E6%96%A5%E9%94%81%E3%80%81%E6%9D%A1%E4%BB%B6%E5%8F%98%E9%87%8F%E4%B8%8E%E4%BF%A1%E5%8F%B7%E9%87%8F/"/>
      <url>/2023/04/23/%E7%BB%86%E8%AF%B4%E4%BA%92%E6%96%A5%E9%94%81%E3%80%81%E6%9D%A1%E4%BB%B6%E5%8F%98%E9%87%8F%E4%B8%8E%E4%BF%A1%E5%8F%B7%E9%87%8F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>Linux</p></blockquote><p>/</p><p><strong><font color='orange'>/</font></strong></p><p>POSIX </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//,0</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_mutex_init</span><span class="params">(<span class="type">pthread_mutex_t</span>* mutex, <span class="type">const</span> pthread_mutexattr* attr)</span>;</span><br><span class="line"><span class="comment">//,</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_destroy</span><span class="params">(<span class="type">pthread_mutex_t</span>* mutex)</span>;</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_lock</span><span class="params">(<span class="type">pthread_mutex_t</span>* mutex)</span>;</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_unlock</span><span class="params">(<span class="type">pthread_mutex_t</span>* mutex)</span>;</span><br><span class="line"><span class="comment">//,,EBUSY</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_trylock</span><span class="params">(<span class="type">pthread_mutex_t</span>* mutex)</span>;</span><br></pre></td></tr></table></figure><blockquote><p> 0 errno </p></blockquote><ul><li><p> <code>pthread_mutex_init</code>  <code>PTHREAD_MUTEX_INITIALIZER</code> </p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">pthread_mutex_t</span> mutex = PTHREAD_MUTEX_INITIALIZER;</span><br></pre></td></tr></table></figure><p></p></li><li><p><code>attr</code> pshared  typeattr  NULL </p></li><li><p>LinuxP278 </p></li></ul><p><strong><font color='orange'></font></strong> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">pthread_cond_init</span><span class="params">(<span class="type">pthread_cond_t</span>* cond, <span class="type">const</span> <span class="type">pthread_condattr_t</span>* attr)</span>; <span class="comment">//</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_cond_destroy</span><span class="params">(<span class="type">pthread_cond_t</span>* cond)</span>; <span class="comment">// ,</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_cond_wait</span><span class="params">(<span class="type">pthread_cond_t</span>* cond, <span class="type">pthread_mutex_t</span>* mutex)</span>; <span class="comment">//</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_cond_signal</span><span class="params">(<span class="type">pthread_cond_t</span>* cond)</span>;<span class="comment">//,</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_cond_broadcast</span><span class="params">(<span class="type">pthread_cond_t</span>* cond)</span>;<span class="comment">//</span></span><br></pre></td></tr></table></figure><blockquote><p> 0 errno </p></blockquote><ul><li><p></p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">pthread_cond_t</span> cond = PTHREAD_COND_INITIALIZER;</span><br></pre></td></tr></table></figure></li><li><p><strong><font color='orange'> <code>pthread_cond_wait()</code> </font></strong>  A  cond  <code>pthread_cond_wait()</code> **<u></u>**  BB  cond  <code>pthread_cond_signal()</code>  cond  A  <strong><u></u></strong>  A A  A  B <strong> <code>pthread_cond_signal()</code> </strong>  <code>pthread_cond_wait()</code>  <strong><font color='red'> <code>pthread_cond_wait()</code>  mutex </font></strong> </p><blockquote><p> <code>pthread_cond_wait()</code>  <code>pthread_cond_signal()</code> <strong><font color='red'> wait  signal </font></strong> </p></blockquote></li><li><p><strong><code>pthread_cond_wait()</code> </strong></p></li><li><p><code>pthread_cond_broadcast()</code>  P261</p></li></ul><p></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> food;</span><br><span class="line"><span class="type">pthread_cond_t</span> cond;</span><br><span class="line"><span class="type">pthread_mutex_t</span> mutex;</span><br><span class="line"><span class="type">void</span>* <span class="title function_">producer</span><span class="params">()</span> <span class="comment">//food,,food</span></span><br><span class="line">&#123;</span><br><span class="line">    pthread_mutex_lock(&amp;mutex);</span><br><span class="line">    <span class="keyword">if</span>(food == <span class="literal">true</span>)</span><br><span class="line">        pthread_cond_wait(&amp;cond, &amp;mutex);</span><br><span class="line">    add_food(&amp;food);</span><br><span class="line">    pthread_cond_signal(&amp;cond);</span><br><span class="line">    pthread_mutex_unlock(&amp;mutex);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span>* <span class="title function_">consumer</span><span class="params">()</span> <span class="comment">//food,,producer</span></span><br><span class="line">&#123;</span><br><span class="line">    pthread_mutex_lock(&amp;mutex);</span><br><span class="line">    <span class="keyword">if</span>(food == <span class="literal">false</span>)</span><br><span class="line">        pthread_cond_wait(&amp;cond, &amp;mutex);</span><br><span class="line">    eat_food(&amp;food);</span><br><span class="line">    pthread_cond_signal(&amp;cond);</span><br><span class="line">    pthread_mutex_unlock(&amp;mutex);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> A  food food  add_food  A A <u> B </u>  food  eat_food  A  17  food  B  18  eat_food()  food  eat</p><p><strong> B  A </strong>  <code>Hoare</code>  <code>Mesa</code>  <code>Hoare</code>  <code>Mesa</code> </p><p> 716  <code>if</code>  <code>while</code>  food<strong><font color='red'> while() </font></strong> </p><p> A  signal  A  signal  B B  food <strong></strong> <strong><font color='orange'></font></strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> food;</span><br><span class="line"><span class="type">pthread_cond_t</span> empty;</span><br><span class="line"><span class="type">pthread_cond_t</span> filled;</span><br><span class="line"><span class="type">pthread_mutex_t</span> mutex;</span><br><span class="line"><span class="type">void</span>* <span class="title function_">producer</span><span class="params">()</span> <span class="comment">//food,,food</span></span><br><span class="line">&#123;</span><br><span class="line">    pthread_mutex_lock(&amp;mutex);</span><br><span class="line">    <span class="keyword">if</span>(food == <span class="literal">true</span>)</span><br><span class="line">        pthread_cond_wait(&amp;empty, &amp;mutex); <span class="comment">//food,</span></span><br><span class="line">    add_food(&amp;food); </span><br><span class="line">    pthread_cond_signal(&amp;full);</span><br><span class="line">    pthread_mutex_unlock(&amp;mutex);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span>* <span class="title function_">consumer</span><span class="params">()</span> <span class="comment">//food,,producer</span></span><br><span class="line">&#123;</span><br><span class="line">    pthread_mutex_lock(&amp;mutex);</span><br><span class="line">    <span class="keyword">if</span>(food == <span class="literal">false</span>)</span><br><span class="line">        pthread_cond_wait(&amp;filled, &amp;mutex);</span><br><span class="line">    eat_food(&amp;food);</span><br><span class="line">    pthread_cond_signal(&amp;empty);</span><br><span class="line">    pthread_mutex_unlock(&amp;mutex);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><u></u></strong> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">sem_wait</span><span class="params">(<span class="type">sem_t</span> *sem)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (sem == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        errno = EINVAL;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (sem-&gt;pshared == PTHREAD_PROCESS_PRIVATE &amp;&amp; sem-&gt;value &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        pthread_mutex_lock(&amp;sem-&gt;lock);</span><br><span class="line">        <span class="keyword">while</span> (sem-&gt;value &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            pthread_cond_wait(&amp;sem-&gt;cond, &amp;sem-&gt;lock);</span><br><span class="line">        &#125;</span><br><span class="line">        sem-&gt;value--;</span><br><span class="line">        pthread_mutex_unlock(&amp;sem-&gt;lock);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        errno = ENOSYS;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">sem_post</span><span class="params">(<span class="type">sem_t</span> *sem)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (sem == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        errno = EINVAL;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (sem-&gt;pshared == PTHREAD_PROCESS_PRIVATE) &#123;</span><br><span class="line">        pthread_mutex_lock(&amp;sem-&gt;lock);</span><br><span class="line">        sem-&gt;value++;</span><br><span class="line">        pthread_cond_signal(&amp;sem-&gt;cond);</span><br><span class="line">        pthread_mutex_unlock(&amp;sem-&gt;lock);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        errno = ENOSYS;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    <span class="type">int</span> value;</span><br><span class="line">    <span class="type">int</span> pshared;</span><br><span class="line">    <span class="type">pthread_mutex_t</span> lock;</span><br><span class="line">    <span class="type">pthread_cond_t</span> cond;</span><br><span class="line">&#125; <span class="type">sem_t</span>;</span><br></pre></td></tr></table></figure><blockquote><p> chatgpt </p></blockquote><p></p><ol><li><p> value  value  food</p><blockquote><p> food true\false</p></blockquote></li><li><p> value value </p></li><li><p>/</p></li></ol><p><strong><font color='orange'> value  1 </font></strong></p><p> POSIX </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">sem_init</span><span class="params">(<span class="type">sem_t</span> *sem, <span class="type">int</span> pshared, <span class="type">unsigned</span> <span class="type">int</span> value)</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">sem_destroy</span><span class="params">(<span class="type">sem_t</span> *sem)</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">sem_wait</span><span class="params">(<span class="type">sem_t</span> *sem)</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">sem_post</span><span class="params">(<span class="type">sem_t</span> *sem)</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">sem_getvalue</span><span class="params">(<span class="type">sem_t</span> *sem, <span class="type">int</span> *sval)</span>;</span><br></pre></td></tr></table></figure><blockquote><p> 0 -1 errno</p></blockquote><ul><li>pshared  PTHREAD_PROCESS_PRIVATE  PTHREAD_PROCESS_SHAREDvalue </li><li><code>sem_wait()</code>  1  0 sem_wait  0 <br><code>sem_post()</code>  1</li></ul><p>/</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">queue</span> food; <span class="comment">//food,</span></span><br><span class="line"><span class="type">pthread_mutex_t</span> mutex;</span><br><span class="line"><span class="type">sem_t</span> sem; <span class="comment">//</span></span><br><span class="line"><span class="type">void</span>* <span class="title function_">producer</span><span class="params">()</span> </span><br><span class="line">&#123;</span><br><span class="line">    pthread_mutex_lock(&amp;mutex);</span><br><span class="line">    food.pushback(); <span class="comment">//food</span></span><br><span class="line">    pthread_mutex_unlock(&amp;mutex);</span><br><span class="line">    sem_post(&amp;sem);  <span class="comment">//+1,+1,</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span>* <span class="title function_">consumer</span><span class="params">()</span> </span><br><span class="line">&#123;</span><br><span class="line">    sem_wait(&amp;sem); <span class="comment">//-1,0</span></span><br><span class="line">    pthread_mutex_lock(&amp;mutex);</span><br><span class="line">    food.pop(); <span class="comment">//food</span></span><br><span class="line">    pthread_mutex_unlock(&amp;mutex);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><u><font color='orange'></font></u></strong> </p><blockquote><p><strong><font color='red'> sem_wait  sem_post </font></strong> P271</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2023/04/16/%E7%BD%91%E7%BB%9C%E5%AD%97%E8%8A%82%E5%BA%8F%E5%8F%8A%E5%85%B6%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/"/>
      <url>/2023/04/16/%E7%BD%91%E7%BB%9C%E5%AD%97%E8%8A%82%E5%BA%8F%E5%8F%8A%E5%85%B6%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p></p><ul><li><strong><font color='orange'> CPU </font></strong></li><li><strong><font color='orange'> int  char</font></strong></li></ul><p><br><strong><font color='red'> CPU </font></strong> 32  CPU  4 <br><img src="/2022/img/endian-1681633780948-2.png" alt=""></p><p> 0x11  0x11<br><img src="/2022/img/endian1.png" alt=""><br></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> num = <span class="number">0x11223344</span>;</span><br><span class="line">    <span class="type">char</span>* p = &amp;num;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%p\n&quot;</span>,*p);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> 0x44</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="type">char</span> j;</span><br><span class="line">    i = <span class="number">0x1234</span>;</span><br><span class="line">    j = (<span class="type">char</span>)i;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%p\n&quot;</span>, j);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> 0x34<strong><font color='orange'></font></strong>  4  0x11223344  1  char  0x44<strong></strong> </p><hr><p></p><p><strong><font color='orange'></font></strong> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">uint32_t</span> <span class="title function_">ntohl</span> <span class="params">(<span class="type">uint32_t</span> netlong)</span></span><br><span class="line"><span class="type">uint16_t</span> <span class="title function_">ntohs</span> <span class="params">(<span class="type">uint16_t</span> netshort)</span></span><br><span class="line">    net to host,</span><br><span class="line">    </span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">htonl</span> <span class="params">(<span class="type">uint32_t</span> hostlong)</span></span><br><span class="line"><span class="type">uint16_t</span> <span class="title function_">htons</span> <span class="params">(<span class="type">uint16_t</span> hostshort)</span></span><br><span class="line">    host to net,</span><br></pre></td></tr></table></figure><p>SOCKET  IP <strong><font color='orange'> char</font></strong>  int </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//client</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> sock = socket(AF_INET, SOCK_STREAM, <span class="number">0</span>);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">addr</span>;</span></span><br><span class="line">    bzero(&amp;addr, <span class="keyword">sizeof</span>(addr));</span><br><span class="line">    addr.sin_family = AF_INET;</span><br><span class="line">    addr.sin_addr.s_addr = inet_addr(<span class="string">&quot;127.0.0.1&quot;</span>);</span><br><span class="line">    addr.sin_port = htons(<span class="number">12345</span>);</span><br><span class="line">    Connect(sock, (<span class="keyword">struct</span> sockaddr*)&amp;addr, <span class="keyword">sizeof</span>(addr));</span><br><span class="line">    <span class="type">int</span> a = <span class="number">0x12345678</span>;</span><br><span class="line">    write(sock, &amp;a, <span class="keyword">sizeof</span>(<span class="type">int</span>));</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> wireshark  <code>78 56 34 12</code>  <code>0x78563412</code> <br><img src="/2022/img/image-20230416181222470.png" alt=""></p><p></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//....</span></span><br><span class="line">    <span class="type">int</span> a = htonl(<span class="number">0x12345678</span>);</span><br><span class="line">    write(sock, &amp;a, <span class="keyword">sizeof</span>(<span class="type">int</span>));</span><br><span class="line"><span class="comment">//....</span></span><br></pre></td></tr></table></figure><p><img src="/2022/img/image-20230416181831813.png" alt=""></p><hr><p></p><ul><li> C  int  4  2 </li><li></li></ul><p></p><ul><li></li><li></li></ul><p>Java</p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2023/04/15/%E4%B8%89%E6%8F%A1%E5%9B%9B%E6%8C%A5%E5%BC%82%E5%B8%B8%E5%88%86%E6%9E%90/"/>
      <url>/2023/04/15/%E4%B8%89%E6%8F%A1%E5%9B%9B%E6%8C%A5%E5%BC%82%E5%B8%B8%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p><a href="https://xiaolincoding.com/network/3_tcp/tcp_queue.html#%E5%AE%9E%E6%88%98-tcp-%E5%85%A8%E8%BF%9E%E6%8E%A5%E9%98%9F%E5%88%97%E6%BA%A2%E5%87%BA"></a> <a href="https://jyx-fyh.github.io/2022/08/04/SYN%E6%B3%9B%E6%B4%AA%E6%94%BB%E5%87%BB/">SYN</a></p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//server</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> sock_listen = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);</span><br><span class="line">    <span class="type">int</span> optval = <span class="number">1</span>;</span><br><span class="line">    <span class="type">socklen_t</span> optlen = <span class="keyword">sizeof</span>(optval);</span><br><span class="line">    setsockopt(sock_listen, SOL_SOCKET, SO_REUSEADDR, (<span class="type">void</span>*)&amp;optval, optlen);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">addr</span>;</span></span><br><span class="line">    bzero(&amp;addr, <span class="keyword">sizeof</span>(addr));</span><br><span class="line">    addr.sin_family = AF_INET;</span><br><span class="line">    addr.sin_port = htons(<span class="number">12345</span>);</span><br><span class="line">    addr.sin_addr.s_addr = inet_addr(<span class="string">&quot;192.168.248.128&quot;</span>);</span><br><span class="line">    Bind(sock_listen, (<span class="keyword">struct</span> sockaddr*)&amp;addr, <span class="keyword">sizeof</span>(addr));</span><br><span class="line">    Listen(sock_listen, <span class="number">3</span>);</span><br><span class="line">    <span class="type">int</span> sock_conn = Accept(sock_listen, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//client</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> sock;</span><br><span class="line">    sock = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">addr_serv</span>;</span></span><br><span class="line">    bzero(&amp;addr_serv, <span class="keyword">sizeof</span>(addr_serv));</span><br><span class="line">    addr_serv.sin_addr.s_addr = inet_addr(<span class="string">&quot;192.168.248.128&quot;</span>);</span><br><span class="line">    addr_serv.sin_port = htons(<span class="number">12345</span>);</span><br><span class="line">    addr_serv.sin_family = AF_INET;</span><br><span class="line">    Connect(sock, (<span class="keyword">struct</span> sockaddr *) &amp;addr_serv, <span class="keyword">sizeof</span>(addr_serv));</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Bind</span><span class="params">(<span class="type">int</span> fd, <span class="type">const</span> <span class="keyword">struct</span> sockaddr* addr, <span class="type">socklen_t</span> len)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="number">-1</span> == bind(fd, addr, len))</span><br><span class="line">        perror(<span class="string">&quot;bind&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Listen</span><span class="params">(<span class="type">int</span> fd, <span class="type">int</span> backlog)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="number">-1</span> == listen(fd, backlog))</span><br><span class="line">        perror(<span class="string">&quot;listen&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">Accept</span><span class="params">(<span class="type">int</span> fd, <span class="keyword">struct</span> sockaddr* addr, <span class="type">socklen_t</span>* len)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="number">-1</span> == accept(fd, addr, len))</span><br><span class="line">        perror(<span class="string">&quot;accept&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Connect</span><span class="params">(<span class="type">int</span> fd, <span class="keyword">struct</span> sockaddr* addr, <span class="type">socklen_t</span> len)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="number">-1</span> == connect(fd, addr, len))</span><br><span class="line">        perror(<span class="string">&quot;connect&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="font-color-red--font"><font color='red'></font></h2><p><br><strong>1  destination unreachable  ICMP </strong></p><blockquote><p> connect  IP </p></blockquote><p><strong>2connect  Connection refused </strong></p><p><strong>3 SYN </strong></p><p></p><p><strong><mark class="hl-label blue">SYN</mark> </strong></p><p></p><ol><li><strong> SYN-Cookie</strong></li><li><strong></strong></li></ol><p><strong><font color='orange'></font></strong></p><blockquote><p><strong>Ubuntu 16.04 <code>min(somaxconn,backlog)</code></strong></p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//server</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> sock_lsn = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">addr_lsn</span>;</span></span><br><span class="line">    <span class="built_in">memset</span>(&amp;addr_lsn, <span class="number">0</span>, <span class="keyword">sizeof</span>(addr_lsn));</span><br><span class="line">    addr_lsn.sin_addr.s_addr = htonl(INADDR_ANY);</span><br><span class="line">    addr_lsn.sin_port = htons(<span class="number">12345</span>);</span><br><span class="line">    addr_lsn.sin_family = AF_INET;</span><br><span class="line">    Bind(sock_lsn, (<span class="keyword">struct</span> sockaddr*)&amp;addr_lsn, <span class="keyword">sizeof</span>(addr_lsn));</span><br><span class="line">    Listen(sock_lsn, <span class="number">5</span>); <span class="comment">//backlog5,6,5</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)&#123;&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//====================================</span></span><br><span class="line"><span class="comment">//client</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">addr_clnt</span>;</span></span><br><span class="line">    <span class="built_in">memset</span>(&amp;addr_clnt, <span class="number">0</span> , <span class="keyword">sizeof</span>(addr_clnt));</span><br><span class="line">    addr_clnt.sin_port = htons(<span class="number">12345</span>);</span><br><span class="line">    addr_clnt.sin_addr.s_addr = inet_addr(<span class="string">&quot;127.0.0.1&quot;</span>);</span><br><span class="line">    addr_clnt.sin_family = AF_INET;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="number">0</span> == fork())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> sock_clnt = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);</span><br><span class="line">            Connect(sock_clnt, (<span class="keyword">struct</span> sockaddr*)&amp;addr_clnt, <span class="keyword">sizeof</span>(addr_clnt));</span><br><span class="line">            <span class="keyword">while</span>(<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li><p> SYN-Cookie  0 1</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//</span><br><span class="line">$ <span class="built_in">echo</span> 0 &gt; /proc/sys/net/ipv4/tcp_syncookies </span><br></pre></td></tr></table></figure><blockquote><p>0 <br>1  SYN <br>2 </p></blockquote></li><li><p> server </p></li><li><p> hping3 SYN </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">hping3 -c 1000 -d 120 -S -w 64 -p 12345 --flood --rand-source 127.0.0.1</span><br><span class="line">//-c 1000  = </span><br><span class="line">//-d 120   = ,</span><br><span class="line">//-S       =  SYN </span><br><span class="line">//-w 64    = TCP </span><br><span class="line">//-p 12345 = 12345</span><br><span class="line">//flood   = flood</span><br><span class="line">//--rand-source IP,</span><br><span class="line">//IP127.0.0.1</span><br></pre></td></tr></table></figure></li><li><p> SYN_RECV </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">netstat -nat | grep :12345 | grep SYN_RECV  | <span class="built_in">wc</span> -l </span><br><span class="line">5</span><br></pre></td></tr></table></figure></li></ol><p> 1000 <u></u> SYN  5  SYN  SYN-Cookie </p><ol><li><p> SYN-Cookie  1</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$cat</span> /proc/sys/net/ipv4/tcp_syncookies </span><br><span class="line">1</span><br></pre></td></tr></table></figure></li><li><p> server  hping3</p></li><li><p> SYN_RECV  5</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">netstat -nat | grep :12345 | grep SYN_RECV  | <span class="built_in">wc</span> -l </span><br><span class="line">5</span><br></pre></td></tr></table></figure></li><li><p> ESTABLISHED  0</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">netstat -nat | grep :12345 | grep ESTABLISH  | wc -l </span><br><span class="line">0</span><br></pre></td></tr></table></figure></li><li><p> ESTABLISHED </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">netstat -nat | grep :12345 | grep ESTABLISH  | <span class="built_in">wc</span> -l</span><br><span class="line">12</span><br></pre></td></tr></table></figure><blockquote><p> 12 6netstat <br> 6 </p></blockquote></li></ol><p><strong><font color='gree'> SYN-Cookie  SYN  SYN Cookies </font></strong><br><img src="/2022/img/39-1679303729834-1-1679373170821-1.jpg" alt=""></p><p><strong><font color='orange'></font></strong></p><ol><li><p></p></li><li><p> ESTABLISH  SYN_RECV </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">netstat -nat | grep :12345 | grep ESTABLISH  | <span class="built_in">wc</span> -l</span><br><span class="line">12</span><br><span class="line">netstat -nat | grep :12345 | grep SYN_RECV  | <span class="built_in">wc</span> -l </span><br><span class="line">0</span><br></pre></td></tr></table></figure><p><strong> SYN</strong> </p></li></ol><p> SYN </p><ol><li><p> client  23  10  5 5  6</p></li><li><p> server  client</p></li><li><p> ESTABLISHED </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">netstat -nat | grep :12345 | grep ESTABLISH  | <span class="built_in">wc</span> -l</span><br><span class="line">10</span><br></pre></td></tr></table></figure><p> 5 </p></li><li><p> hping3 SYN_RECV </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">netstat -nat | grep :12345 | grep SYN_RECV  | <span class="built_in">wc</span> -l </span><br><span class="line">5</span><br></pre></td></tr></table></figure><p></p></li></ol><p><br><img src="/2022/img/aha.png" alt=""></p><p><strong><mark class="hl-label blue">SYN</mark> </strong><br><strong><font color='orange'>SYN  <code>tcp_syn_retries</code> </font></strong>  1  2  4  8  16 <strong> 2 </strong>  6</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/sys/net/ipv4/tcp_syn_retries </span><br><span class="line">6</span><br></pre></td></tr></table></figure><p> SYN-Cookie SYN  wireshark <br><img src="/2022/img/image-20230407213529813.png" alt="image-20230407213529813"><br> 7  SYN  6 50 -&gt; 51 -&gt; 53 -&gt; 57 -&gt; 65 -&gt; 81  124816 34s 32s</p><hr><h2 id="font-color-red--font"><font color='red'></font></h2><p> SYN  client  server  SYN+ACK  server  ACK server <strong><font color='orange'> <code>tcp_synack_retries</code> </font></strong>  5<br>1 <code>iptables</code> </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -i lo -I INPUT -p tcp  --tcp-flags SYN,ACK SYN,ACK -j DROP</span><br></pre></td></tr></table></figure><p>2 server  client wireshark <br><img src="/2022/img/image-20230415194126268.png" alt=""></p><p></p><h2 id="font-color-red--font"><font color='red'></font></h2><p><br><img src="/2022/img/image-20230408101018084.png" alt=""></p><p> ACK  ACK  SYN_RECV  client  server </p><p>server  ACK  iptables  ACK </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -I INPUT -s 192.168.248.128 -p tcp --tcp-flag ACK,SYN  ACK -j DROP</span><br></pre></td></tr></table></figure><blockquote><p> ACK  <strong></strong>  SYN  iptables<a href="https://jyx-fyh.github.io/2023/04/08/%E2%80%9C%E5%8C%85%E8%BF%87%E6%BB%A4%E5%B7%A5%E5%85%B7%E2%80%94iptables%E2%80%9D/">iptables</a><br> -I  -D </p></blockquote><p><br><img src="/2022/img/image-20230408151310936.png" alt=""></p><p> ACK  ACK+SYN  5  <code>tcp_synack_retries</code>  clinet  ACK server  client </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">netstat -a | grep 12345</span><br><span class="line">tcp        0      0 192.168.248.128:59999   192.168.248.128:12345   ESTABLISHED</span><br><span class="line">tcp        0      0 192.168.248.128:12345   192.168.248.128:59999   SYN_RECV   </span><br></pre></td></tr></table></figure><p> client server  5 SYN_RECV  server  client <strong><font color='orange'> ESTABLISHED  <code>tcp_retries2</code>  15  15min</font></strong> </p><blockquote><p><code>tcp_retries1</code> </p></blockquote><p> client  ESTABLISHED TCP  <strong></strong> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">net.ipv4.tcp_keepalive_time=7200</span><br><span class="line">net.ipv4.tcp_keepalive_intvl=75 </span><br><span class="line">net.ipv4.tcp_keepalive_probes=9</span><br></pre></td></tr></table></figure><p><strong><font color='orange'> 2  11  15 </font></strong> </p><blockquote><p><a href="https://jyx-fyh.github.io/2023/04/08/%E4%BF%9D%E6%B4%BB%E6%9C%BA%E5%88%B6%E4%B8%8E%E5%BF%83%E8%B7%B3%E5%8C%85%E8%AE%BE%E8%AE%A1/"></a> </p></blockquote><hr><h2 id="font-color-red--font"><font color='red'></font></h2><p><strong><font color='gree'>FIN  FIN </font></strong></p><p> FIN  <code>tcp_orphan_retries</code>  <code>tcp_orphan_retries</code>  0 8<br><img src="/2022/img/28-1680942414542-4.jpg" alt=""></p><p><strong><font color='orange'> <code>FIN_WAIT1</code>  <code>tcp_orphan_retries</code>  <code>tcp_max_orphans</code> </font></strong>  <strong><font color='orange'><u> RST </u></font></strong></p><hr><h2 id="font-color-red--font"><font color='red'></font></h2><p> ACK <strong><font color='orange'>pure ACK </font></strong></p><h2 id="font-color-red--font"><font color='red'></font></h2><p> FIN  <code>tcp_orphan_retries</code>  client  <code>FIN_WAIT2</code> <strong><font color='orange'> client  close()  <code>FIN_WAIT2</code>  <code>tcp_fin_timeout</code>  60s client  shutdown()  <code>FIN_WAIT2</code>  </font></strong></p><blockquote><p> close  shutdown<a href="https://jyx-fyh.github.io/2023/03/05/Socket%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%85%A5%E9%97%A8%E7%AC%94%E8%AE%B0/">socket</a></p></blockquote><h2 id="font-color-red--font"><font color='red'></font></h2><p> FIN  TIME_WAIT  ACK<br><img src="/2022/img/image-20230416215104213.png" alt=""></p><hr><h2 id="font-color-red--font"><font color='red'></font></h2><p><strong><mark class="hl-label blue"></mark> </strong><br> kill  FIN </p><p><strong><mark class="hl-label blue"></mark> </strong><br> destination unreachable </p><p><strong><mark class="hl-label blue"></mark> </strong><br>Unix init  SIGTERM  SIGKILL </p><p><strong><mark class="hl-label blue"></mark> </strong><br> TCP  RST</p><blockquote><p>UNP<a href="https://xiaolincoding.com/network/3_tcp/tcp_optimize.html#%E4%B8%BB%E5%8A%A8%E6%96%B9%E7%9A%84%E4%BC%98%E5%8C%96"></a> <a href="https://www.cnblogs.com/kevingrace/p/6265113.html">iptable</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hping3</title>
      <link href="/2023/04/09/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0%E5%88%A9%E5%99%A8%E2%80%94hping3/"/>
      <url>/2023/04/09/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0%E5%88%A9%E5%99%A8%E2%80%94hping3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>hping3</p><blockquote><p><a href="https://techyrick.com/hping3-full-tutorial-for-dummies-to-pro/">hping3-tutorial</a> <a href="https://www.anquanke.com/post/id/239641#h2-10"></a><a href="https://linux.die.net/man/8/hping3">hping3-man</a></p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">  -c  --count     packet count</span><br><span class="line">  -i  --interval  wait (uX for X microseconds, for example -i u1000)</span><br><span class="line">      --fast      alias for -i u10000 (10 packets for second)</span><br><span class="line">      --faster    alias for -i u1000 (100 packets for second)</span><br><span class="line">      --flood   sent packets as fast as possible. Don&#x27;t show replies.</span><br><span class="line">  -n  --numeric   numeric output</span><br><span class="line">  -q  --quiet     quiet</span><br><span class="line">  -I  --interface interface name (otherwise default routing interface)</span><br><span class="line">  -V  --verbose   verbose mode</span><br><span class="line">  -D  --debug     debugging info</span><br><span class="line">  -z  --bind      bind ctrl+z to ttl           (default to dst port)</span><br><span class="line">  -Z  --unbind    unbind ctrl+z</span><br><span class="line">      --beep      beep for every matching packet received</span><br><span class="line">Mode</span><br><span class="line">  default mode     TCP</span><br><span class="line">  -0  --rawip      RAW IP mode</span><br><span class="line">  -1  --icmp       ICMP mode</span><br><span class="line">  -2  --udp        UDP mode</span><br><span class="line">  -8  --scan       SCAN mode.</span><br><span class="line">                   Example: hping --scan 1-30,70-90 -S www.target.host</span><br><span class="line">  -9  --listen     listen mode</span><br><span class="line">IP</span><br><span class="line">  -a  --f      spoof source address</span><br><span class="line">  --rand-dest      random destionation address mode. see the man.</span><br><span class="line">  --rand-source    random source address mode. see the man.</span><br><span class="line">  -t  --ttl        ttl (default 64)</span><br><span class="line">  -N  --id         id (default random)</span><br><span class="line">  -W  --winid      use win* id byte ordering</span><br><span class="line">  -r  --rel        relativize id field          (to estimate host traffic)</span><br><span class="line">  -f  --frag       split packets in more frag.  (may pass weak acl)</span><br><span class="line">  -x  --morefrag   set more fragments flag</span><br><span class="line">  -y  --dontfrag   set don&#x27;t fragment flag</span><br><span class="line">  -g  --fragoff    set the fragment offset</span><br><span class="line">  -m  --mtu        set virtual mtu, implies --frag if packet size &gt; mtu</span><br><span class="line">  -o  --tos        type of service (default 0x00), try --tos help</span><br><span class="line">  -G  --rroute     includes RECORD_ROUTE option and display the route buffer</span><br><span class="line">  --lsrr           loose source routing and record route</span><br><span class="line">  --ssrr           strict source routing and record route</span><br><span class="line">  -H  --ipproto    set the IP protocol field, only in RAW IP mode</span><br><span class="line">ICMP</span><br><span class="line">  -C  --icmptype   icmp type (default echo request)</span><br><span class="line">  -K  --icmpcode   icmp code (default 0)</span><br><span class="line">      --force-icmp send all icmp types (default send only supported types)</span><br><span class="line">      --icmp-gw    set gateway address for ICMP redirect (default 0.0.0.0)</span><br><span class="line">      --icmp-ts    Alias for --icmp --icmptype 13 (ICMP timestamp)</span><br><span class="line">      --icmp-addr  Alias for --icmp --icmptype 17 (ICMP address subnet mask)</span><br><span class="line">      --icmp-help  display help for others icmp options</span><br><span class="line">UDP/TCP</span><br><span class="line">  -s  --baseport   base source port             (default random)</span><br><span class="line">  -p  --destport   [+][+]&lt;port&gt; destination port(default 0) ctrl+z inc/dec</span><br><span class="line">  -k  --keep       keep still source port</span><br><span class="line">  -w  --win        winsize (default 64)</span><br><span class="line">  -O  --tcpoff     set fake tcp data offset     (instead of tcphdrlen / 4)</span><br><span class="line">  -Q  --seqnum     shows only tcp sequence number</span><br><span class="line">  -b  --badcksum   (try to) send packets with a bad IP checksum</span><br><span class="line">                   many systems will fix the IP checksum sending the packet</span><br><span class="line">                   so you&#x27;ll get bad UDP/TCP checksum instead.</span><br><span class="line">  -M  --setseq     set TCP sequence number</span><br><span class="line">  -L  --setack     set TCP ack</span><br><span class="line">  -F  --fin        set FIN flag</span><br><span class="line">  -S  --syn        set SYN flag</span><br><span class="line">  -R  --rst        set RST flag</span><br><span class="line">  -P  --push       set PUSH flag</span><br><span class="line">  -A  --ack        set ACK flag</span><br><span class="line">  -U  --urg        set URG flag</span><br><span class="line">  -X  --xmas       set X unused flag (0x40)</span><br><span class="line">  -Y  --ymas       set Y unused flag (0x80)</span><br><span class="line">  --tcpexitcode    use last tcp-&gt;th_flags as exit code</span><br><span class="line">  --tcp-mss        enable the TCP MSS option with the given value</span><br><span class="line">  --tcp-timestamp  enable the TCP timestamp option to guess the HZ/uptime</span><br><span class="line">Common</span><br><span class="line">  -d  --data       data size                    (default is 0)</span><br><span class="line">  -E  --file       data from file</span><br><span class="line">  -e  --sign       add &#x27;signature&#x27;</span><br><span class="line">  -j  --dump       dump packets in hex</span><br><span class="line">  -J  --print      dump printable characters</span><br><span class="line">  -B  --safe       enable &#x27;safe&#x27; protocol</span><br><span class="line">  -u  --end        tell you when --file reached EOF and prevent rewind</span><br><span class="line">  -T  --traceroute traceroute mode              (implies --bind and --ttl 1)</span><br><span class="line">  --tr-stop        Exit when receive the first not ICMP in traceroute mode</span><br><span class="line">  --tr-keep-ttl    Keep the source TTL fixed, useful to monitor just one hop</span><br><span class="line">  --tr-no-rtt    Don&#x27;t calculate/show RTT information in traceroute mode</span><br><span class="line">ARS packet description (new, unstable)</span><br><span class="line">  --apd-send       Send the packet described with APD (see docs/APD.txt)</span><br></pre></td></tr></table></figure><hr><p> 12345 </p><p><strong>1 <code>192.168.248.128</code>  ens33  IP  12345  5  SYN </strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hping3 -S 192.168.248.128 -p 12345 -c 5</span><br></pre></td></tr></table></figure><p><img src="/2022/img/image-20230410122835239.png" alt=""></p><p><strong>2 <code>192.168.248.128</code>  ens33  IP  12345  5  ACK  100</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hping3 -A  192.168.248.128 -p 12345 -c 5 -w 100</span><br></pre></td></tr></table></figure><p><img src="/2022/img/image-20230410123028629.png" alt="image-20230410123028629"></p><blockquote><p><strong><font color='red'></font></strong><br> 12345  SYN  SYN+ACK  ACK  RST <br><strong> SYN </strong></p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td></td><td>filtered</td></tr><tr><td>ICMP</td><td>filtered</td></tr><tr><td>SYN/ACK</td><td>open</td></tr><tr><td>RST</td><td>closed</td></tr></tbody></table><p><strong> ACK </strong></p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>RST</td><td>unfiltered(open/closed)</td></tr><tr><td></td><td>filtered</td></tr><tr><td>ICMP</td><td>filtered</td></tr></tbody></table><p><strong> SYN  ACK <font color='red'><u></u></font></strong> </p><p><a href="https://jyx-fyh.github.io/2023/04/08/%E2%80%9C%E5%8C%85%E8%BF%87%E6%BB%A4%E5%B7%A5%E5%85%B7%E2%80%94iptables%E2%80%9D/">iptables</a></p></blockquote><p><strong>3</strong><br> <a href="http://baidu.com">baidu.com</a>  75~85  12345 </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">hping3 --scan  75-85,12345 -S baidu.com</span></span><br><span class="line">Scanning baidu.com (39.156.66.10), port 75-85,12345</span><br><span class="line">12 ports to scan, use -V to see all the replies</span><br><span class="line">+----+-----------+---------+---+-----+-----+-----+</span><br><span class="line">|port| serv name |  flags  |ttl| id  | win | len |</span><br><span class="line">+----+-----------+---------+---+-----+-----+-----+</span><br><span class="line">   80 http       : .S..A... 128 27907 64240    46</span><br><span class="line">All replies received. Done.</span><br><span class="line">Not responding ports: (75 ) (76 ) (77 rje) (78 ) (79 finger) (81 ) (82 ) (83 ) (84 ) (85 ) (12345 ) </span><br></pre></td></tr></table></figure><p><strong>4flood </strong><br> <code>127.0.0.1:12345</code>  IP </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hping3 127.0.0.1 -S -p 12345 --flood --rand-source </span><br></pre></td></tr></table></figure><p><strong>5 12345 IP  1.1.1.1</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hping3 -S baidu.com -a 1.1.1.1 -s 12345</span><br><span class="line"></span><br><span class="line">hping3 -S baidu.com --spoof 1.1.1.1 --baseport 12345</span><br></pre></td></tr></table></figure><blockquote><p> IP </p></blockquote><p><strong>6</strong><br>Hping3  TCP/UDP/ICMP  TCP/UDP/ICMP  <code>--listen</code> </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">hping3 127.0.0.1  --listen signature --safe  --icmp</span> </span><br></pre></td></tr></table></figure><p> ICMP  ICMP </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hping3 127.0.0.1 --icmp -d 100 --sign signature --file ./data</span><br></pre></td></tr></table></figure><p>1 <code>-d</code> 2 <code>signature</code> <br><img src="/2022/img/image-20230410195315834.png" alt=","></p><p><br><img src="/2022/img/image-20230410201345056.png" alt=""><br><code>--safe</code> </p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iptables</title>
      <link href="/2023/04/08/%E2%80%9C%E5%8C%85%E8%BF%87%E6%BB%A4%E5%B7%A5%E5%85%B7%E2%80%94iptables%E2%80%9D/"/>
      <url>/2023/04/08/%E2%80%9C%E5%8C%85%E8%BF%87%E6%BB%A4%E5%B7%A5%E5%85%B7%E2%80%94iptables%E2%80%9D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p> Linux <code>iptables</code> (NAT) <strong><code>iptables</code>  <code>netfilter</code></strong> </p><p><strong><u> iptables </u></strong> <a href="https://jyx-fyh.github.io/2023/04/15/%E4%B8%89%E6%8F%A1%E5%9B%9B%E6%8C%A5%E5%BC%82%E5%B8%B8%E5%88%86%E6%9E%90/">TCP </a><a href="https://www.cnblogs.com/kevingrace/p/6265113.html">iptables</a> </p><hr><p><br><img src="/2022/img/FUCKAHA.png" alt=""></p><blockquote><p><code>ACCEPT</code> <br><code>DROP</code>  <br><code>REJECT</code> </p></blockquote><blockquote><p><strong><font color='red'></font></strong>  INPUT  DROP tcpdump/wireshark <code>Wire -&gt; NIC -&gt; tcpdump -&gt; netfilter/iptables</code> <code>iptables -&gt; tcpdump -&gt; NIC -&gt; Wire</code>  tcpdump/wireshark </p><p> INPUT  tcpdump </p></blockquote><p></p><p>1 lo  IP  <code>192.168.248.128</code>  <code>12345</code>  TCP </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -i lo -I INPUT  -d 192.168.248.128 -p tcp --dport 12345 -j DROP</span><br></pre></td></tr></table></figure><blockquote><p><strong></strong> <br> -I  -D </p></blockquote><p>2 IP  <code>192.168.248.128</code>  <code>12345</code>  TCP </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -I INPUT  -d 192.168.248.128 -p tcp --dport 12345 -j REJECT</span><br></pre></td></tr></table></figure><p> IMCP <img src="/2022/img/image-20230409110416756.png" alt=""></p><p>3 IP  <code>192.168.248.128</code>  <code>12345</code>  SYN </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -I INPUT -s 192.168.248.128 -p tcp --dport 12345 --tcp-flags SYN SYN -j DROP</span><br></pre></td></tr></table></figure><p> IP  <code>192.168.248.128</code>  <code>12345</code> </p><blockquote><p> tcp </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--tcp-flags mask comp</span><br></pre></td></tr></table></figure><p> mask <br> comp <br></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -I INPUT -s 192.168.248.128 -p tcp --dport 12345 --tcp-flags SYN,ACK ACK -j DROP</span><br></pre></td></tr></table></figure><p> ACK  SYN <br>Flags  SYN ACK FIN RST URG PSH ALL NONE</p><p> <code>-m</code> </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -I INPUT -s 192.168.248.128 -p tcp --dport 12345 -m tcp --tcp-flags SYN,ACK ACK -j DROP</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -A FORWARD -m mac --mac-source 00:0c:29:27:55:3F -j DROP</span><br></pre></td></tr></table></figure></blockquote><p>4 filter </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">iptables -t filter -L</span></span><br><span class="line">Chain INPUT (policy ACCEPT)</span><br><span class="line">target     prot opt source               destination         </span><br><span class="line">DROP       tcp  --  192.168.248.128      anywhere             tcp dpt:12345 flags:SYN,ACK/ACK</span><br><span class="line">DROP       tcp  --  192.168.248.128      anywhere             tcp dpt:12345 flags:SYN/SYN</span><br></pre></td></tr></table></figure><blockquote><p><strong><font color='orange'> <code>-t</code>  filter</font></strong></p></blockquote><p>5</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables  -D INPUT 1  </span><br></pre></td></tr></table></figure><p>6<code>!</code> </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -I INPUT ! -s 192.168.248.128 -p tcp -j DROP</span><br></pre></td></tr></table></figure><p> IP  <code>192.168.248.128</code>  TCP </p><p>7</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -I INPUT -s 10.20.30.0/24 -j DROP</span><br></pre></td></tr></table></figure><p>8</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -I INPUT -s 192.168.248.128 -p tcp --dport 1000:2000 -j DROP</span><br></pre></td></tr></table></figure><p>9 DDOS </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -p tcp --dport 80 -m limit --limit 25/minute --limit-burst 100 -j ACCEPT</span><br></pre></td></tr></table></figure><blockquote><p>-m limit: limit<br>limit 25/minute: 25<br>limit-burst 100: 10025/minute</p><p> DDOS </p></blockquote><p>10</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -D INPUT -p tcp --dport 12345 -m string --algo bm --string &#x27;admin&#x27; -j REJECT</span><br></pre></td></tr></table></figure><p> 12345  admin </p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>socket</title>
      <link href="/2023/04/02/%E5%B8%B8%E7%94%A8socket%E9%80%89%E9%A1%B9/"/>
      <url>/2023/04/02/%E5%B8%B8%E7%94%A8socket%E9%80%89%E9%A1%B9/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="font-color-red-socket-font"><font color='red'>socket</font></h2><p> <code>getsockopt()</code>  <code>setsockopt</code>  socket </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">getsockopt</span><span class="params">(<span class="type">int</span> socket, </span></span><br><span class="line"><span class="params">               <span class="type">int</span> level, </span></span><br><span class="line"><span class="params">               <span class="type">int</span> option_name,</span></span><br><span class="line"><span class="params">               <span class="type">void</span> *<span class="keyword">restrict</span> option_value,</span></span><br><span class="line"><span class="params">               <span class="type">socklen_t</span> *<span class="keyword">restrict</span> option_len)</span>;</span><br><span class="line"><span class="comment">//example</span></span><br><span class="line">    <span class="type">int</span> bufsize = <span class="number">10000</span>;</span><br><span class="line">    <span class="type">socklen_t</span> optlen = <span class="keyword">sizeof</span>(bufsize);</span><br><span class="line">    getsockopt(sock_listen, SOL_SOCKET, SO_RCVBUF, &amp;bufsize, &amp;optlen);</span><br><span class="line"><span class="comment">//============================================================================</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">setsockopt</span> <span class="params">(<span class="type">int</span> socket,</span></span><br><span class="line"><span class="params">                <span class="type">int</span> level,</span></span><br><span class="line"><span class="params">                <span class="type">int</span> option_name,</span></span><br><span class="line"><span class="params">       <span class="type">const</span> <span class="type">void</span> *option_val,</span></span><br><span class="line"><span class="params">                <span class="type">socklen_t</span> option_len)</span>;</span><br><span class="line"><span class="comment">//example</span></span><br><span class="line">    <span class="type">int</span> bufsize = <span class="number">10000</span>;</span><br><span class="line">    setsockopt(sock_listen, SOL_SOCKET, SO_RCVBUF, &amp;bufsize, <span class="keyword">sizeof</span>(bufsize));</span><br></pre></td></tr></table></figure><ul><li><strong> 0 -1</strong> </li><li>UPN 151 </li></ul><p> sock_listen<strong><font color='orange'></font></strong> <strong><font color='red'>SO_KEEPALIVESO_LINGERSO_RECVBUFSO_SNDBUFSO_RCVLOWATSO_SNDLOWATTCP_MAXSEGTCP_NODELAY</font></strong> SO_DEBUFSO_DONTROUTESO_OBBINLINE <u>getpeername() </u></p><h2 id="font-color-red-SO-RCVBUF--SO-SNDBUF-font"><font color='red'>SO_RCVBUF  SO_SNDBUF</font></h2><p> Socket  Socket <br><img src="/2022/img/IMG_0579(20230406-190556).PNG" alt=""></p><ul><li><strong><font color='gree'>/</font></strong></li><li><strong><font color='gree'></font></strong></li><li><strong><font color='gree'>write</font></strong></li><li><strong><font color='gree'></font></strong></li><li><strong><font color='gree'> ACK</font></strong></li><li><strong><font color='gree'>read</font></strong></li><li><strong><font color='gree'></font></strong></li><li><strong><font color='gree'>TCP  &lt;= </font></strong></li></ul><blockquote><p><a href="https://jyx-fyh.github.io/2023/03/21/%E7%BD%91%E7%BB%9C%E6%95%B0%E6%8D%AE%E8%AF%BB%E5%8F%96%E7%9A%84%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/"></a> </p></blockquote><p><strong><font color='red'>SO_RCVBUF  TCP </font></strong> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//server</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> sock_listen = socket(AF_INET, SOCK_STREAM, <span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> recv_size = <span class="number">3000</span>;</span><br><span class="line">    <span class="type">socklen_t</span> optlen = <span class="keyword">sizeof</span>(recv_size);</span><br><span class="line">    setsockopt(sock_listen, SOL_SOCKET, SO_RCVBUF, (<span class="type">void</span>*)&amp;recv_size, optlen);</span><br><span class="line">    getsockopt(sock_listen, SOL_SOCKET, SO_RCVBUF,(<span class="type">void</span>*)&amp;recv_size,&amp;optlen);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;server recv buffer size: %d\n&quot;</span>,recv_size);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">addr_listen</span>;</span></span><br><span class="line">    bzero(&amp;addr_listen, <span class="keyword">sizeof</span>(addr_listen));</span><br><span class="line">    addr_listen.sin_addr.s_addr = inet_addr(<span class="string">&quot;192.168.248.128&quot;</span>);</span><br><span class="line">    addr_listen.sin_port = htons(<span class="number">12345</span>);</span><br><span class="line">    addr_listen.sin_family = AF_INET;</span><br><span class="line">    Bind(sock_listen, (<span class="keyword">struct</span> sockaddr *) &amp;addr_listen, <span class="keyword">sizeof</span>(addr_listen));</span><br><span class="line">    Listen(sock_listen, <span class="number">20</span>);</span><br><span class="line">    <span class="type">int</span> sock_conn = Accept(sock_listen, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>); <span class="comment">//read,close</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//client</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> sock_clnt;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">addr_serv</span>;</span></span><br><span class="line">    sock_clnt = socket(AF_INET, SOCK_STREAM, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">memset</span>(&amp;addr_serv, <span class="number">0</span>, <span class="keyword">sizeof</span>(addr_serv));</span><br><span class="line">    addr_serv.sin_family = AF_INET;</span><br><span class="line">    addr_serv.sin_port = htons(<span class="number">12345</span>);</span><br><span class="line">    addr_serv.sin_addr.s_addr = inet_addr(<span class="string">&quot;192.168.248.128&quot;</span>);</span><br><span class="line">    Connect(sock_clnt, (<span class="keyword">struct</span> sockaddr*)&amp;addr_serv, <span class="keyword">sizeof</span>(addr_serv));</span><br><span class="line">    <span class="type">char</span> buf[<span class="number">100000</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    writen(sock_clnt, buf, <span class="keyword">sizeof</span>(buf));</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> server  client server  6000</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">server recv buffer size: <span class="number">6000</span></span><br></pre></td></tr></table></figure><blockquote><p> recv_size  3000 6000<strong> recv_size 2</strong>  2304 </p></blockquote><p> wireshark <br><img src="/2022/img/image-20230403111812767.png" alt=""></p><p>server  SYN <strong>win  3000 SO_RECVBUF </strong>  SO_RECVBUF<strong><u><font color='gree'></font></u></strong> </p><blockquote><p><strong></strong> </p></blockquote><p></p><ol><li><strong><u><font color='orange'> server listen  client connect </font></u></strong>  accept  accept <a href="https://jyx-fyh.github.io/2023/03/05/Socket%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%85%A5%E9%97%A8%E7%AC%94%E8%AE%B0/">socket</a></li><li> MSS  MSS  4 UNPP163</li><li><strong><font color='orange'>-</font></strong> UNPP164 </li></ol><h2 id="font-color-red-SO-RCVLOWAT--SO-SNDLOWAT-font"><font color='red'>SO_RCVLOWAT  SO_SNDLOWAT</font></h2><p> select/poll/epoll I/O <code>SO_RCVLOWAT</code>  select/poll/epoll  1 <code>SO_SNDLOWAT</code> <u></u> select/poll/epoll socket  2048 1 </p><h2 id="font-color-red-SO-REUSEADDR-font"><font color='red'>SO_REUSEADDR</font></h2><p></p><ol><li><p><strong> TIME_WAIT </strong></p><blockquote><p> TIME_WAIT <u></u><a href="https://jyx-fyh.github.io/2023/03/16/TIME-WAIT%E5%AE%9E%E8%B7%B5%E6%8E%A2%E7%A9%B6/">TIME_WAIT</a></p></blockquote></li><li><p><strong></strong> <br>a<br>b<br>c<br>d</p></li><li><p><strong> IP IP </strong></p><blockquote><p> <code>127.0.0.1</code>  IP  SO_REUSEADDR<br><strong><u>INADDR_ANY</u></strong></p></blockquote></li><li><p>UNPP166</p></li></ol><p><strong><font color='orange'> TCP  UDP </font></strong></p><p><strong><font color='red'> TCP  bind  SO_REUSEADDR </font></strong></p><blockquote><p> <code>SO_REUSEPORT</code> UNPP165</p></blockquote><h2 id="font-color-red-SO-LINGER-font"><font color='red'>SO_LINGER</font></h2><p><code>SO_LINGER</code>  close <br><img src="/2022/img/image-20230407141037746.png" alt=""><br><img src="/2022/img/image-20230407141059416.png" alt=""><img src="/2022/img/IMG_0580(20230407-134909).PNG" alt=""></p><p><strong><u></u></strong> </p><p><u></u>UPNP161</p><p><strong> SHUT_RD </strong></p><h2 id="font-color-red-TCP-NODELAY-font"><font color='red'>TCP_NODELAY</font></h2><p> Nagle  Nagle <a href="https://jyx-fyh.github.io/2022/08/07/TCP%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6%E8%AF%A6%E8%A7%A3/">TCP</a>   Nagle </p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>wireshark</title>
      <link href="/2023/04/02/wireshark%E5%85%A5%E9%97%A8%E7%AC%94%E8%AE%B0/"/>
      <url>/2023/04/02/wireshark%E5%85%A5%E9%97%A8%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p> wireshark  tcpdump<strong> tcpdump  wireshark </strong>  <a href="https://jyx-fyh.github.io/2023/03/21/tcpdump/">tcpdump</a><br>Ubuntu 16.04 LTS</p></blockquote><hr><h2 id="font-color-red--wireshark-font"><font color='red'> wireshark</font></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">sudo apt install wireshark-qt</span></span><br></pre></td></tr></table></figure><h2 id="font-color-red--wireshark-font"><font color='red'> wireshark</font></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">wireshark</span></span><br></pre></td></tr></table></figure><p><br><img src="/2022/img/image-20230402115238469.png" alt=""></p><p></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ifconfig</span></span><br><span class="line">ens33     Link encap:Ethernet  HWaddr 00:0c:29:48:09:a9  </span><br><span class="line">          inet addr:192.168.248.128  Bcast:192.168.248.255  Mask:255.255.255.0</span><br><span class="line">          inet6 addr: fe80::555a:9e00:3f14:e7f/64 Scope:Link</span><br><span class="line">          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1</span><br><span class="line">          RX packets:4331 errors:0 dropped:0 overruns:0 frame:0</span><br><span class="line">          TX packets:3064 errors:0 dropped:0 overruns:0 carrier:0</span><br><span class="line">          collisions:0 txqueuelen:1000 </span><br><span class="line">          RX bytes:2400943 (2.4 MB)  TX bytes:462038 (462.0 KB)</span><br><span class="line"></span><br><span class="line">lo        Link encap:Local Loopback  </span><br><span class="line">          inet addr:127.0.0.1  Mask:255.0.0.0</span><br><span class="line">          inet6 addr: ::1/128 Scope:Host</span><br><span class="line">          UP LOOPBACK RUNNING  MTU:65536  Metric:1</span><br><span class="line">          RX packets:1249 errors:0 dropped:0 overruns:0 frame:0</span><br><span class="line">          TX packets:1249 errors:0 dropped:0 overruns:0 carrier:0</span><br><span class="line">          collisions:0 txqueuelen:1000 </span><br><span class="line">          RX bytes:121848 (121.8 KB)  TX bytes:121848 (121.8 KB)</span><br></pre></td></tr></table></figure><p><code>ens33</code> <code>lo</code> </p><p> <code>ens33</code>  wireshark</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">sudo wireshark</span></span><br></pre></td></tr></table></figure><p><img src="/2022/img/image-20230402115430627.png" alt=""></p><p> <code>ens33</code> <strong><u></u></strong>  wireshark </p><hr><h2 id="font-color-red--font"><font color='red'></font></h2><p> wireshark  wireshark  wireshark </p><p><img src="/2022/img/image-20230402151407256.png" alt=""></p><p> wireshark <br><img src="/2022/img/image-20230402151634036.png" alt=""></p><p> <a href="https://jyx-fyh.github.io/2023/03/21/tcpdump/">tcpdump</a> </p><blockquote><p> TCP  TCP  ICMP </p></blockquote><hr><h2 id="font-color-red--font"><font color='red'></font></h2><p><br><img src="/2022/img/image-20230402152619594.png" alt=""></p><p> tcpdump <a href="https://www.wireshark.org/docs/wsug_html_chunked/ChWorkBuildDisplayFilterSection.html">wireshark manual</a></p><hr><h2 id="font-color-red--font"><font color='red'></font></h2><p><img src="/2022/img/image-20230402163513811.png" alt=""><br><img src="/2022/img/image-20230402163636148.png" alt=""></p><ul><li> 1 MAC </li><li> 2 80  http </li><li> 3 IP </li><li> 4 IP  DNS </li><li> 5 IP DNS </li></ul><p><br><img src="/2022/img/image-20230402165754095.png" alt=""></p><p> IP <br><img src="/2022/img/image-20230402165953271.png" alt=""><br> IP  Resolved Address </p><hr>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>tcpdump</title>
      <link href="/2023/03/21/tcpdump/"/>
      <url>/2023/03/21/tcpdump/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="font-color-red-tcpdump-font"><font color='red'>tcpdump</font></h2><blockquote><p><a href="https://www.tcpdump.org/manpages/tcpdump.1.html">tcpdump man</a></p></blockquote><p>tcpdump </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">tcpdump</span></span><br><span class="line">listening on ens33, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br></pre></td></tr></table></figure><ul><li> tcpdump  <code>ens33</code> </li><li> 262144 </li></ul><p> <code>ifconfig</code> </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">ifconfig</span></span><br><span class="line">ens33     Link encap:Ethernet  HWaddr 00:0c:29:48:09:a9  </span><br><span class="line">          inet addr:192.168.248.128  Bcast:192.168.248.255  Mask:255.255.255.0</span><br><span class="line">          inet6 addr: fe80::555a:9e00:3f14:e7f/64 Scope:Link</span><br><span class="line">          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1</span><br><span class="line">          RX packets:12058 errors:0 dropped:0 overruns:0 frame:0</span><br><span class="line">          TX packets:4911 errors:0 dropped:0 overruns:0 carrier:0</span><br><span class="line">          collisions:0 txqueuelen:1000 </span><br><span class="line">          RX bytes:9115911 (9.1 MB)  TX bytes:577567 (577.5 KB)</span><br><span class="line"></span><br><span class="line">lo        Link encap:Local Loopback  </span><br><span class="line">          inet addr:127.0.0.1  Mask:255.0.0.0</span><br><span class="line">          inet6 addr: ::1/128 Scope:Host</span><br><span class="line">          UP LOOPBACK RUNNING  MTU:65536  Metric:1</span><br><span class="line">          RX packets:1110 errors:0 dropped:0 overruns:0 frame:0</span><br><span class="line">          TX packets:1110 errors:0 dropped:0 overruns:0 carrier:0</span><br><span class="line">          collisions:0 txqueuelen:1000 </span><br><span class="line">          RX bytes:1022006 (1.0 MB)  TX bytes:1022006 (1.0 MB)</span><br></pre></td></tr></table></figure><hr><p><strong><mark class="hl-label blue">-i </mark> </strong></p><p> <code>ens33</code>  <code>lo</code> </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> tcpdump -i lo</span><br><span class="line">listening on lo, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br></pre></td></tr></table></figure><p><code>-i any</code> </p><hr><p><strong><mark class="hl-label blue">-nn IP</mark> </strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#tcpdump -i lo</span></span><br><span class="line">listening on lo, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">01:12:54.640796 IP localhost.44438 &gt; localhost.12345: Flags [S], <span class="built_in">seq</span> 1028792545, win 65495, options [mss 65495,sackOK,TS val 1381449987 ecr 0,nop,wscale 7], length 0</span><br><span class="line">01:12:54.640834 IP localhost.12345 &gt; localhost.44438: Flags [S.], <span class="built_in">seq</span> 3925511357, ack 1028792546, win 65483, options [mss 65495,sackOK,TS val 1381449987 ecr 1381449987,nop,wscale 7], length 0</span><br><span class="line">01:12:54.640870 IP localhost.44438 &gt; localhost.12345: Flags [.], ack 1, win 512, options [nop,nop,TS val 1381449987 ecr 1381449987], length 0</span><br></pre></td></tr></table></figure><p> TCP  <code>localhost</code>  server  client  <code>localhost</code>  ssh  22  22  ssh IP  <code>-nn</code> </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">tcpdump -i lo -nn</span></span><br><span class="line">01:14:54.615811 IP 127.0.0.1.44438 &gt; 127.0.0.1.12345: Flags [P.], seq 1028792546:1028792548, ack 3925511358, win 512, options [nop,nop,TS val 1381569983 ecr 1381449987], length 2</span><br></pre></td></tr></table></figure><hr><p><strong><mark class="hl-label blue">-n IP</mark> </strong></p><p> IP  DNS </p><hr><p><strong><mark class="hl-label blue"></mark> </strong></p><ul><li> eth1 192.168.1.1 </li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">tcpdump -i eth1 host 192.168.1.1</span></span><br></pre></td></tr></table></figure><ul><li></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">tcpdump -i eth1 src host 192.168.1.1</span></span><br></pre></td></tr></table></figure><ul><li></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">tcpdump -i eth1 dst host 192.168.1.1</span></span><br></pre></td></tr></table></figure><ul><li></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">tcpdump -i eth1 dest host <span class="string">&quot;baidu.com&quot;</span></span></span><br></pre></td></tr></table></figure><p><strong><mark class="hl-label blue"></mark> </strong></p><ul><li> eth1 25 </li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">tcpdump -i eth1 port 25</span></span><br></pre></td></tr></table></figure><ul><li></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">tcpdump -i eth1 src port 25</span></span><br></pre></td></tr></table></figure><ul><li></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">tcpdump -i eth1 dst port 25</span></span><br></pre></td></tr></table></figure><ul><li><p>portrange</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">tcpdump -i lo portrange 10000-20000</span></span><br></pre></td></tr></table></figure></li><li><p></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">tcpdump port http</span> </span><br></pre></td></tr></table></figure></li></ul><p><strong><mark class="hl-label blue"></mark> </strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">tcpdump -i eth1 net 192.168</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">tcpdump -i eth1 src net 192.168</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">tcpdump -i eth1 dst net 192.168.0.0/16</span>  </span><br></pre></td></tr></table></figure><p><strong><mark class="hl-label blue"></mark> </strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">tcpdump arp</span>  </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">tcpdump ip</span>   </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">tcpdump tcp</span>  </span><br></pre></td></tr></table></figure><p><strong><font color='orange'>,</font></strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">tcpdump http</span>  </span><br></pre></td></tr></table></figure><p></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">tcpdump port http</span></span><br></pre></td></tr></table></figure><p><strong><mark class="hl-label blue"></mark> </strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> : !  not </span><br><span class="line"> : &amp;&amp;  and  </span><br><span class="line"> : ||  or</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">tcpdump -i lo -nn tcp &amp;&amp; dst port 12345 &amp;&amp; src host 127.0.0.1</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">tcpdump -i lo -nn tcp and dst port 12345 and src host 127.0.0.1</span></span><br></pre></td></tr></table></figure><p></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">tcpdump -i eth1 <span class="string">&#x27;((tcp) and (! port 80) and ((dst host 192.168.1.254) or (dst host 192.168.1.200)))&#x27;</span></span></span><br><span class="line">eth1192.168.1.254192.168.1.200,80TCP</span><br></pre></td></tr></table></figure><p><strong> <code>''</code>  <code>&quot;&quot;</code> </strong></p><hr><p><strong><mark class="hl-label blue"></mark> </strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">proto[x:y]          : xyip[2:2]340</span><br><span class="line">proto[x:y] &amp; z = 0  : proto[x:y]z0</span><br><span class="line">proto[x:y] &amp; z !=0  : proto[x:y]z0</span><br></pre></td></tr></table></figure><p><strong>IP</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">    0                   1                   2                   3</span><br><span class="line">    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1   \bit</span><br><span class="line">    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">0   |Version|  IHL  |Type of Service|          Total Length         |</span><br><span class="line">    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">4   |         Identification        |Flags|      Fragment Offset    |</span><br><span class="line">    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">12  |  Time to Live |    Protocol   |         Header Checksum       |</span><br><span class="line">    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">16  |                       Source Address                          |</span><br><span class="line">    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">20  |                    Destination Address                        |</span><br><span class="line">    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">24  |                    Options                    |    Padding    | &lt;-- optional</span><br><span class="line">    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">28  |                            DATA ...                           |</span><br><span class="line">    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">\byte</span><br></pre></td></tr></table></figure><p><strong>TCP</strong></p> <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">   0                   1                   2                   3</span><br><span class="line">   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1  \bit</span><br><span class="line">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">0  |          Source Port          |       Destination Port        |</span><br><span class="line">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">4  |                        Sequence Number                        |</span><br><span class="line">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">8  |                    Acknowledgment Number                      |</span><br><span class="line">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">   |  Data |       |C|E|U|A|P|R|S|F|                               |</span><br><span class="line">12 | Offset|  Res. |W|C|R|C|S|S|Y|I|            Window             |</span><br><span class="line">   |       |       |R|E|G|K|H|T|N|N|                               |</span><br><span class="line">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">16 |           Checksum            |         Urgent Pointer        |</span><br><span class="line">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">20 |                    Options                    |    Padding    |</span><br><span class="line">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">24 |                             data                              |</span><br><span class="line">   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">\byte</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">tcpdump -i lo <span class="string">&quot;tcp[2:2]=12345&quot;</span></span></span><br><span class="line">12345</span><br></pre></td></tr></table></figure><p><strong>TCPTCP 13 </strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">tcpdump -i lo <span class="string">&quot;src port 12345 &amp;&amp; tcp[13]&amp;1 = 1&quot;</span></span></span><br><span class="line">12345FIN</span><br></pre></td></tr></table></figure><p>TCP</p><p><code>tcpflags</code> , <code>tcp-fin</code> , <code>tcp-syn</code> , <code>tcp-rst</code> , <code>tcp-push</code> , <code>tcp-push</code> , <code>tcp-ack</code> , <code>tcp-urg</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">tcpdump -i lo <span class="string">&quot;dst port 12345 &amp;&amp; tcp[tcpflags]&amp;tcp-fin=tcp-fin&quot;</span></span></span><br></pre></td></tr></table></figure><p><strong><mark class="hl-label blue">-w -r </mark> </strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">tcpdump tcp -w test.cap</span></span><br></pre></td></tr></table></figure><p> test.cap  <code>cap</code>  <code>pcap</code>  wireshark <br><img src="/2022/img/image-20230401192959234.png" alt=""></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">tcpdump tcp -r test.cap</span></span><br></pre></td></tr></table></figure><p> <code>test.cap</code> </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">tcpdump tcp -r test.cap port 12345</span></span><br></pre></td></tr></table></figure><hr><p><strong><mark class="hl-label blue"></mark> </strong></p><ul><li><code>-t</code></li><li><code>-tt</code></li><li><code>-ttt</code>()</li><li><code>-tttt</code></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">tcpdump -t dst  <span class="string">&quot;baidu.com&quot;</span></span></span><br><span class="line">IP 192.168.248.128 &gt; 39.156.66.10: ICMP echo request, id 11930, seq 1650, length 64</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">tcpdump -tt dst  <span class="string">&quot;baidu.com&quot;</span></span></span><br><span class="line">1680352032.093467 IP 192.168.248.128 &gt; 39.156.66.10: ICMP echo request, id 11930, seq 1662, length 64</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">tcpdump -ttt dst  <span class="string">&quot;baidu.com&quot;</span></span></span><br><span class="line"> 00:00:00.000000 IP 192.168.248.128 &gt; 39.156.66.10: ICMP echo request, id 11930, seq 1672, length 64</span><br><span class="line"> 00:00:01.002438 IP 192.168.248.128 &gt; 39.156.66.10: ICMP echo request, id 11930, seq 1673, length 64</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">tcpdump -tttt dst  <span class="string">&quot;baidu.com&quot;</span></span></span><br><span class="line">2023-04-01 05:27:30.131073 IP 192.168.248.128 &gt; 39.156.66.10: ICMP echo request, id 11930, seq 1680, length 64</span><br></pre></td></tr></table></figure><hr><p><strong><mark class="hl-label blue">-v </mark> </strong></p><p><code>-v</code>TTLidIP</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:/home/butcher/Documents# tcpdump -v dst  &quot;baidu.com&quot;</span><br><span class="line">tcpdump: listening on ens33, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">05:36:46.543701 IP (tos 0x0, ttl 64, id 44013, offset 0, flags [DF], proto ICMP (1), length 84)</span><br><span class="line">    192.168.248.128 &gt; 39.156.66.10: ICMP echo request, id 12115, seq 7, length 64</span><br></pre></td></tr></table></figure><p><strong><mark class="hl-label blue">-c </mark> </strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">tcpdump -v -c 3</span> </span><br><span class="line">05:46:32.275269 ARP, Ethernet (len 6), IPv4 (len 4), Request who-has 192.168.248.2 tell 192.168.248.1, length 46</span><br><span class="line">05:46:32.276545 IP (tos 0x0, ttl 64, id 50690, offset 0, flags [DF], proto UDP (17), length 72)</span><br><span class="line">    192.168.248.128.34566 &gt; 192.168.248.2.domain: 39118+ PTR? 2.248.168.192.in-addr.arpa. (44)</span><br><span class="line">05:46:32.280758 IP (tos 0x0, ttl 128, id 35219, offset 0, flags [none], proto UDP (17), length 127)</span><br><span class="line">    192.168.248.2.domain &gt; 192.168.248.128.34566: 39118 NXDomain 0/1/0 (99)</span><br><span class="line">3 packets captured</span><br></pre></td></tr></table></figure><p></p><p><strong><mark class="hl-label blue">-C -W </mark> </strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">tcpdump -C 1 -W 4 -w <span class="built_in">test</span></span></span><br></pre></td></tr></table></figure><p>-C  -w  1MB</p><ul><li><code>-C 1</code>  1MB</li><li><code>-W</code>  4 </li><li><code>-w</code> </li></ul><p>test1test2test3test4 <strong><u> 4  4 </u></strong></p><hr><p><strong><mark class="hl-label blue">-Q </mark> </strong></p><ul><li>-Q in </li><li>-Q out </li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">tcpdump -Q <span class="keyword">in</span></span></span><br><span class="line">06:04:34.157713 IP 192.168.248.1.50277  &gt; 239.255.255.250.1900: UDP, length 175</span><br><span class="line">06:04:34.163603 IP 192.168.248.2.domain &gt; 192.168.248.128.34566: 27092 NXDomain 0/1/0 (103)</span><br><span class="line">06:04:35.003369 IP 180.101.49.186.https &gt; 192.168.248.128.33644: Flags [.], ack 769671203, win 64240, length 0</span><br></pre></td></tr></table></figure><p><strong><mark class="hl-label blue">-s </mark> </strong></p><p><code>-s</code>  byte 262144 [|proto]proto tcpdump <strong><u></u></strong>  80  TCP IP </p><p><code>-s 0</code>  262144</p><p><strong><mark class="hl-label blue">-e </mark> </strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">tcpdump  -e</span> </span><br><span class="line">06:49:36.315000 00:0c:29:48:09:a9 (oui Unknown) &gt; 00:50:56:fb:6d:e0 (oui Unknown), ethertype IPv4 (0x0800), length 54: 192.168.248.128.33644 &gt; 180.101.49.186.https: Flags [.], ack 565954419, win 65535, length 0</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong><mark class="hl-label blue">-F </mark> </strong></p><p> tcpdump </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">tcpdump -F filter_file</span></span><br></pre></td></tr></table></figure><p></p><hr><p><strong><mark class="hl-label blue">lessgreater </mark> </strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">tcpdump less 100</span></span><br></pre></td></tr></table></figure><hr><p><strong><mark class="hl-label blue">-X </mark> </strong><br><code>-X</code> ASCII<code>-XX</code> <br><img src="/2022/img/image-20230402084531352.png" alt=""></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>I/O&amp;</title>
      <link href="/2023/03/21/%E7%BD%91%E7%BB%9C%E6%95%B0%E6%8D%AE%E8%AF%BB%E5%8F%96%E7%9A%84%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/"/>
      <url>/2023/03/21/%E7%BD%91%E7%BB%9C%E6%95%B0%E6%8D%AE%E8%AF%BB%E5%8F%96%E7%9A%84%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>UNIXUNIXTCP/IP<a href="http://c.biancheng.net/view/2349.html">socket</a></p></blockquote><h2 id="font-color-red-read-font"><font color='red'>read</font></h2><p><img src="/2022/img/IMG_0576(20230325-120322).PNG" alt=""></p><blockquote><p><code>ssize_t</code>  long<code>size_t</code>  unsigned long</p></blockquote><p> read  write  <strong></strong>  -1 errno  -1 read  1000  read  10000  read </p><blockquote><p> read </p></blockquote><p><strong><font color='orange'>TCP  IO  IO</font></strong> <strong><u> IO  IO  IO  IO  OK IO  IO  IO IO  IO </u></strong> </p><p> read<u></u> read  read  read  -1errno  EINTR <strong><font color='orange'> POSIX  read errno </font></strong> </p><blockquote><p><strong><font color='gree'> Socket  read </font></strong>  Socket  read read </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//server</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> sock_server = socket(AF_INET, SOCK_STREAM , IPPROTO_TCP);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">server_addr</span>;</span></span><br><span class="line">    <span class="built_in">memset</span>(&amp;server_addr, <span class="number">0</span>, <span class="keyword">sizeof</span>(server_addr));</span><br><span class="line">    server_addr.sin_addr.s_addr = htonl(INADDR_ANY);</span><br><span class="line">    server_addr.sin_port = htons(<span class="number">12345</span>);</span><br><span class="line">    server_addr.sin_family = AF_INET;</span><br><span class="line">    bind(sock_server, (<span class="keyword">struct</span> sockaddr*)&amp;server_addr, <span class="keyword">sizeof</span>(server_addr));</span><br><span class="line">    listen(sock_server, <span class="number">20</span>);</span><br><span class="line">    <span class="type">int</span> sock_clnt = accept(sock_server,<span class="literal">NULL</span>,<span class="literal">NULL</span>);</span><br><span class="line">    <span class="type">char</span> buf[<span class="number">100000</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">int</span> rcv_buf=<span class="number">1000</span>; <span class="comment">//,2304</span></span><br><span class="line">    <span class="type">socklen_t</span> len = <span class="keyword">sizeof</span>(rcv_buf);</span><br><span class="line">    setsockopt(sock_clnt,SOL_SOCKET,SO_RCVBUF,(<span class="type">void</span>*)&amp;rcv_buf,<span class="keyword">sizeof</span>(rcv_buf));</span><br><span class="line">    getsockopt(sock_clnt,SOL_SOCKET,SO_RCVBUF,(<span class="type">void</span>*)&amp;rcv_buf,&amp;len);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;server rcv_buf : %d\n&quot;</span>,rcv_buf);</span><br><span class="line">    <span class="type">ssize_t</span> size = read(sock_clnt, buf, <span class="number">100000</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;server received %ld bytes\n&quot;</span>,size);</span><br><span class="line">    close(sock_server);</span><br><span class="line">    close(sock_clnt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//=====================================</span></span><br><span class="line"><span class="comment">//client</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> sock_clnt = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">server_addr</span>;</span></span><br><span class="line">    <span class="built_in">memset</span>(&amp;server_addr, <span class="number">0</span>, <span class="keyword">sizeof</span>(server_addr));</span><br><span class="line">    server_addr.sin_family = AF_INET;</span><br><span class="line">    server_addr.sin_port = htons(<span class="number">12345</span>);</span><br><span class="line">    server_addr.sin_addr.s_addr = inet_addr(<span class="string">&quot;127.0.0.1&quot;</span>);</span><br><span class="line">    connect(sock_clnt, (<span class="keyword">struct</span> sockaddr*)&amp;server_addr, <span class="keyword">sizeof</span>(server_addr));</span><br><span class="line">    <span class="type">char</span> out_buf[<span class="number">100000</span>];</span><br><span class="line">    <span class="type">int</span> snd_buf =<span class="number">100000</span>;</span><br><span class="line">    <span class="type">socklen_t</span> len = <span class="keyword">sizeof</span>(snd_buf);</span><br><span class="line">    setsockopt(sock_clnt,SOL_SOCKET,SO_SNDBUF,(<span class="type">void</span>*)&amp;snd_buf,<span class="keyword">sizeof</span>(snd_buf));</span><br><span class="line">    getsockopt(sock_clnt,SOL_SOCKET,SO_SNDBUF,(<span class="type">void</span>*)&amp;snd_buf,&amp;len);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;client snd_buf : %d\n&quot;</span>,snd_buf);</span><br><span class="line">    <span class="type">ssize_t</span> size = write(sock_clnt, out_buf, <span class="number">100000</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;client sent %ld bytes\n&quot;</span>,size);</span><br><span class="line">    close(sock_clnt);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> server <br><img src="/2022/img/image-20230324152945053.png" alt=""></p><p>server  2304  read  65482  2304 100000 read  10000 </p></blockquote><p> read </p><ol><li><strong> EOF</strong></li><li><strong></strong></li></ol><p> read  readn </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ssize_t</span> <span class="title function_">readn</span><span class="params">(<span class="type">int</span> fd, <span class="type">void</span>* buf, <span class="type">size_t</span> n)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">size_t</span> nleft = n;</span><br><span class="line">    <span class="type">ssize_t</span> nread;</span><br><span class="line">    <span class="type">char</span>* tmp = buf;</span><br><span class="line">    <span class="keyword">while</span>(nleft &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>((nread = read(fd, tmp, nleft)) &lt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(nread == EINTR)</span><br><span class="line">                nread = <span class="number">0</span>; <span class="comment">//,</span></span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(nread == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        nleft -= nread;</span><br><span class="line">        tmp += nread;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> n - nleft;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><font color='orange'>readn </font> EOF  n  read read  EOF  n </strong> readn </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//server</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> sock_server = socket(AF_INET, SOCK_STREAM , IPPROTO_TCP);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">server_addr</span>;</span></span><br><span class="line">    <span class="built_in">memset</span>(&amp;server_addr, <span class="number">0</span>, <span class="keyword">sizeof</span>(server_addr));</span><br><span class="line">    server_addr.sin_addr.s_addr = htonl(INADDR_ANY);</span><br><span class="line">    server_addr.sin_port = htons(<span class="number">12345</span>);</span><br><span class="line">    server_addr.sin_family = AF_INET;</span><br><span class="line">    bind(sock_server, (<span class="keyword">struct</span> sockaddr*)&amp;server_addr, <span class="keyword">sizeof</span>(server_addr));</span><br><span class="line">    listen(sock_server, <span class="number">20</span>);</span><br><span class="line">    <span class="type">int</span> sock_clnt = accept(sock_server,<span class="literal">NULL</span>,<span class="literal">NULL</span>);</span><br><span class="line">    <span class="type">char</span> buf[<span class="number">1000</span>];</span><br><span class="line">    <span class="type">ssize_t</span> size = readn(sock_clnt, buf, <span class="number">1000</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;received %lu bytes\n&quot;</span>,size);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>,buf);</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>); </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//==============================================</span></span><br><span class="line"><span class="comment">//client</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> sock_clnt = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">server_addr</span>;</span></span><br><span class="line">    <span class="built_in">memset</span>(&amp;server_addr, <span class="number">0</span>, <span class="keyword">sizeof</span>(server_addr));</span><br><span class="line">    server_addr.sin_family = AF_INET;</span><br><span class="line">    server_addr.sin_port = htons(<span class="number">12345</span>);</span><br><span class="line">    server_addr.sin_addr.s_addr = inet_addr(<span class="string">&quot;127.0.0.1&quot;</span>);</span><br><span class="line">    connect(sock_clnt, (<span class="keyword">struct</span> sockaddr*)&amp;server_addr, <span class="keyword">sizeof</span>(server_addr));</span><br><span class="line">    <span class="type">char</span> buf[<span class="number">100</span>];</span><br><span class="line">    fgets(buf,<span class="number">100</span>,<span class="built_in">stdin</span>);</span><br><span class="line">    writen(sock_clnt,buf,<span class="built_in">strlen</span>(buf));</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>);<span class="comment">//while,EOF</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> readn  1000  EOF readn  read</p><p><strong>recv  MSG_WAITALL  flags  MSG_WAITALL recv  nbytes recv </strong></p><h2 id="font-color-red-write-font"><font color='red'>write</font></h2><p><strong> read</strong> </p><p> write  write  write </p><ol><li><strong></strong></li><li><strong> ACK</strong></li><li><strong>read</strong></li><li><strong>write </strong></li></ol><p></p><p><strong><mark class="hl-label blue"></mark> </strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//server</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> sock_server = socket(AF_INET, SOCK_STREAM , IPPROTO_TCP);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">server_addr</span>;</span></span><br><span class="line">    <span class="built_in">memset</span>(&amp;server_addr, <span class="number">0</span>, <span class="keyword">sizeof</span>(server_addr));</span><br><span class="line">    server_addr.sin_addr.s_addr = htonl(INADDR_ANY);</span><br><span class="line">    server_addr.sin_port = htons(<span class="number">12345</span>);</span><br><span class="line">    server_addr.sin_family = AF_INET;</span><br><span class="line">    Bind(sock_server, (<span class="keyword">struct</span> sockaddr*)&amp;server_addr, <span class="keyword">sizeof</span>(server_addr));</span><br><span class="line">    listen(sock_server, <span class="number">20</span>);</span><br><span class="line">    <span class="type">int</span> sock_clnt = accept(sock_server,<span class="literal">NULL</span>,<span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> buf_size = <span class="number">100000</span>; <span class="comment">//,,200000</span></span><br><span class="line">    <span class="type">socklen_t</span> len = <span class="keyword">sizeof</span>(buf_size);</span><br><span class="line">    setsockopt(sock_clnt,SOL_SOCKET,SO_RCVBUF,(<span class="type">void</span>*)&amp;buf_size,len);</span><br><span class="line">    <span class="type">char</span> buf[<span class="number">100000</span>];</span><br><span class="line">    <span class="type">ssize_t</span> size = readn(sock_clnt, buf, <span class="number">100000</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;received %lu bytes\n&quot;</span>,size);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>,buf);</span><br><span class="line">    close(sock_server);</span><br><span class="line">    close(sock_clnt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//================</span></span><br><span class="line"><span class="comment">//client</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> sock_clnt = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">server_addr</span>;</span></span><br><span class="line">    <span class="built_in">memset</span>(&amp;server_addr, <span class="number">0</span>, <span class="keyword">sizeof</span>(server_addr));</span><br><span class="line">    server_addr.sin_family = AF_INET;</span><br><span class="line">    server_addr.sin_port = htons(<span class="number">12345</span>);</span><br><span class="line">    server_addr.sin_addr.s_addr = inet_addr(<span class="string">&quot;127.0.0.1&quot;</span>);</span><br><span class="line">    Connect(sock_clnt, (<span class="keyword">struct</span> sockaddr*)&amp;server_addr, <span class="keyword">sizeof</span>(server_addr));</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> buf_size = <span class="number">1000</span>; <span class="comment">//,3000</span></span><br><span class="line">    <span class="type">socklen_t</span> len = <span class="keyword">sizeof</span>(buf_size);</span><br><span class="line">    setsockopt(sock_clnt,SOL_SOCKET,SO_SNDBUF,(<span class="type">void</span>*)&amp;buf_size,len);</span><br><span class="line">    <span class="type">char</span> buf[<span class="number">100000</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">size_t</span> size = write(sock_clnt,buf,<span class="keyword">sizeof</span>(buf));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lu\n&quot;</span>,size);</span><br><span class="line">    close(sock_clnt);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong></strong> client  100000 server  100000  client  1000</p><p><strong><mark class="hl-label blue"></mark> </strong></p><p> server  1000<strong></strong>  100000 readn</p><p> 14~22 </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> buf_size = <span class="number">1000</span>;</span><br><span class="line"><span class="type">socklen_t</span> len = <span class="keyword">sizeof</span>(buf_size);</span><br><span class="line">setsockopt(sock_clnt,SOL_SOCKET,SO_RCVBUF,(<span class="type">void</span>*)&amp;buf_size,len);</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>); <span class="comment">//,close</span></span><br></pre></td></tr></table></figure><p> close close </p><p><strong></strong>  read client  ACK client  server  ACK  write  23 </p><p><strong><mark class="hl-label blue"></mark> </strong></p><p> client  100000 client  <code>100000</code>  client  100000  write  server  1000  100000  4 </p><hr><hr><h2 id="font-color-red-sendfile-font"><font color='red'>sendfile</font></h2>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2023/03/20/%E5%8D%8A%E8%BF%9E%E6%8E%A5%E4%B8%8E%E5%85%A8%E8%BF%9E%E6%8E%A5%E9%98%9F%E5%88%97/"/>
      <url>/2023/03/20/%E5%8D%8A%E8%BF%9E%E6%8E%A5%E4%B8%8E%E5%85%A8%E8%BF%9E%E6%8E%A5%E9%98%9F%E5%88%97/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>UNIX<a href="https://blog.csdn.net/qq_42877870/article/details/105027743">hping3</a><a href="https://xiaolincoding.com/network/3_tcp/tcp_queue.html#%E5%AE%9E%E6%88%98-tcp-%E5%85%A8%E8%BF%9E%E6%8E%A5%E9%98%9F%E5%88%97%E6%BA%A2%E5%87%BA"></a><a href="https://www.51cto.com/article/687595.html">51CTO</a></p></blockquote><p><strong><font color='orange'></font></strong> SYNaccept </p><p> SYN  SYN_RCVD <br> ACK   ESTABLISHED  accept </p><hr><p><strong><mark class="hl-label blue">backlog</mark> </strong></p><p><strong>backlog UNIX </strong>  Ubuntu 16.04 </p><blockquote><p>UNP 3  84 </p></blockquote><p><strong></strong></p><p><strong><font color='orange'> Linux  2.2 <code>backlog</code> <code>tcp_max_syn_backlog</code></font></strong> </p><blockquote><p></p><ul><li><strong><code> = min(somaxconn, backlog)+1</code></strong></li><li><strong><font color='orange'> <code>backlog</code><code>somaxconn</code>  <code>tcp_max_syn_backlog</code> </font></strong> </li></ul><p><code>somaxconn</code>  Linux  128 <code>/proc/sys/net/core/somaxconn</code> </p></blockquote><p><strong> <code>backlog</code> </strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">////======!!!BindListen,!!!=======</span></span><br><span class="line"><span class="comment">//server</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> sock_lsn = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">addr_lsn</span>;</span></span><br><span class="line">    <span class="built_in">memset</span>(&amp;addr_lsn, <span class="number">0</span>, <span class="keyword">sizeof</span>(addr_lsn));</span><br><span class="line">    addr_lsn.sin_addr.s_addr = htonl(INADDR_ANY);</span><br><span class="line">    addr_lsn.sin_port = htons(<span class="number">12345</span>);</span><br><span class="line">    addr_lsn.sin_family = AF_INET;</span><br><span class="line">    Bind(sock_lsn, (<span class="keyword">struct</span> sockaddr*)&amp;addr_lsn, <span class="keyword">sizeof</span>(addr_lsn));</span><br><span class="line">    Listen(sock_lsn, <span class="number">5</span>);</span><br><span class="line">    <span class="comment">//,acceptclose</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//=====================</span></span><br><span class="line"><span class="comment">//client</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">addr_clnt</span>;</span></span><br><span class="line">    <span class="built_in">memset</span>(&amp;addr_clnt, <span class="number">0</span> , <span class="keyword">sizeof</span>(addr_clnt));</span><br><span class="line">    addr_clnt.sin_port = htons(<span class="number">12345</span>);</span><br><span class="line">    addr_clnt.sin_addr.s_addr = inet_addr(<span class="string">&quot;127.0.0.1&quot;</span>);</span><br><span class="line">    addr_clnt.sin_family = AF_INET;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) <span class="comment">//10</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="number">0</span> == fork())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> sock_clnt = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);</span><br><span class="line">            Connect(sock_clnt, (<span class="keyword">struct</span> sockaddr*)&amp;addr_clnt, <span class="keyword">sizeof</span>(addr_clnt));</span><br><span class="line">            sleep(<span class="number">10</span>);<span class="comment">//10s,</span></span><br><span class="line">            close(sock_clnt);</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><br><img src="/2022/img/image-20230319223902516.png" alt=""></p><p><strong><code>netstat</code>  20  10 </strong> 10  6  ESTABLISHED  4  SYN_SENT  <code>backlog</code>  5 5  ESTABLISHED <u><strong> <code>backlog</code>  <font color='orange'></font></strong></u>  +1<code> = backlog + 1</code> <br><img src="/2022/img/IMG_0575(20230319-224643).PNG" alt=""></p><blockquote><p>UNP85~87 </p></blockquote><p> <code>somaxconn</code> </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cat</span> /prog/sys/net/core/somaxconn</span><br><span class="line">128</span><br></pre></td></tr></table></figure><p> 3</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//</span><br><span class="line">$ <span class="built_in">echo</span> 3 &gt; /prog/sys/net/core/somaxconn</span><br></pre></td></tr></table></figure><p><br><img src="/2022/img/image-20230321093637098.png" alt=""><br> 4  <code>somaxconn</code>  1 </p><p><strong><font color='orange'> = min(somaxconn, backlog) + 1</font></strong></p><p><strong><mark class="hl-label blue"></mark> </strong><br> <code>tcp_abort_on_overflow</code> </p><ul><li>0  ACK </li><li>1  RST </li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> 1 &gt; /prog/sys/net/ipv4/tcp_abort_on_overflow</span><br></pre></td></tr></table></figure><p> 0  ACK </p><hr><p><strong></strong> </p><p> SYN_RCV  SYN  SYN  SYN_RCV </p><ol><li><p> hping3  SYN-flood </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install hping3</span><br></pre></td></tr></table></figure></li><li><p></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tcp_max_syn_backlog = 128</span><br><span class="line">somaxconn = 150</span><br></pre></td></tr></table></figure><p> backlog  9 10</p></li><li><p></p></li><li><p></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">hping3 -c 1000 -d 120 -S -w 64 -p 12345 --flood --rand-source 127.0.0.1</span><br><span class="line">//-c 1000  = </span><br><span class="line">//-d 120   = ,</span><br><span class="line">//-S       =  SYN </span><br><span class="line">//-w 64    = TCP </span><br><span class="line">//-p 12345 = 12345</span><br><span class="line">//flood   = flood</span><br><span class="line">//--rand-source IP</span><br><span class="line">//IP127.0.0.1</span><br></pre></td></tr></table></figure></li><li><p> SYN_RECV </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">netstat -nat | grep :12345 | grep SYN_RECV  | <span class="built_in">wc</span> -l</span><br><span class="line">9</span><br></pre></td></tr></table></figure><p><strong> backlog</strong></p></li><li><p> backlog  200</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">netstat -nat | grep :12345 | grep SYN_RECV  | <span class="built_in">wc</span> -l </span><br><span class="line">150</span><br></pre></td></tr></table></figure><p><strong>Ubuntu 16.04 <font color='orange'> backlog  <code>somaxconn</code>  backlog <code>somaxconn</code>  <code>tcp_max_syn_backlog</code> </font></strong></p></li></ol><p> <strong><font color='orange'><u></u> <code>tcp_max_syn_backlog</code> <code>somaxconn</code>  <code>backlog</code>  <code>tcp_max_syn_backlog</code>  </font></strong> </p><p> SYN  SYN -<a href="https://jyx-fyh.github.io/2022/08/04/SYN%E6%B3%9B%E6%B4%AA%E6%94%BB%E5%87%BB/">SYN</a></p><hr><p> <code>ss</code> </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ ss -nlt</span><br><span class="line">State       Recv-Q  Send-Q        Local Address:Port    Peer Address:Port</span><br><span class="line">LISTEN      11      10            *:12345               *:*       </span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ ss -nt</span><br><span class="line">State       Recv-Q  Send-Q        Local Address:Port    Peer Address:Port</span><br><span class="line">ESTAB       100     0             127.0.0.1:12345       127.0.0.1:59492              </span><br><span class="line">ESTAB       100     0             127.0.0.1:12345       127.0.0.1:59496              </span><br><span class="line">.......</span><br></pre></td></tr></table></figure><blockquote><p>-n <br>-t  tcp sockets<br>-l (LISTEN) sockets</p></blockquote><p><strong> LISTEN  socket</strong></p><ul><li><strong>Recv-Q accept  TCP </strong></li><li><strong>Send-Q</strong></li></ul><p><strong> LISTEN  socket</strong></p><ul><li><strong>Recv-Q <u><font color='gree'></font></u> </strong></li><li><strong>Send-Q <u><font color='gree'></font></u> </strong></li></ul><p>LISTEN  Recv-Q  11 Send-Q 10 Send-Q  backlog </p><p><strong><font color='orange'><code>ss</code>  <code>netstat</code>  LISTEN  Recv-Q  Send-Q </font></strong> </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ netstat -at</span><br><span class="line">Proto    Recv-Q     Send-Q   Local Address           Foreign Address         State </span><br><span class="line">tcp      0          0        *:12345                 *:*                     LISTEN</span><br><span class="line">$ ss -nlt</span><br><span class="line">State       Recv-Q  Send-Q        Local Address:Port    Peer Address:Port</span><br><span class="line">LISTEN      11      10            *:12345               *:*  </span><br></pre></td></tr></table></figure><p> Recv-Q  Send-Q  <code>netstat</code>  Recv-Q  Send-Q </p><p></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2023/03/18/%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86-%E5%8C%85%E8%A3%B9%E5%87%BD%E6%95%B0/"/>
      <url>/2023/03/18/%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86-%E5%8C%85%E8%A3%B9%E5%87%BD%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>UNIXUNIX</p></blockquote><h2 id="font-color-red-errno-font"><font color='red'>errno</font></h2><p> <strong><u></u></strong> <strong> errno</strong>  -1 errno errno  <code>errno.h</code> </p><ul><li><p> errno </p></li><li><p>errno  0 errno </p><blockquote><p><strong> pthread_  Unix  errno  errno  0  0 </strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="keyword">if</span>((n=pthread_mutex_lock(&amp;ndoen_mutex))!=<span class="number">0</span>)&#123;</span><br><span class="line"><span class="built_in">fprintf</span>(<span class="built_in">stderr</span>,<span class="string">&quot;error:%s&quot;</span>,strerror(n));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> pthread_  pthread_ </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">Pthread_mutex_lock</span><span class="params">(<span class="type">pthread_mutex_t</span> *mptr)</span>&#123;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="keyword">if</span>((n=pthread_mutex_lock(mptr))!=<span class="number">0</span>)</span><br><span class="line">  <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>,<span class="string">&quot;error:%s&quot;</span>,strerror(n));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote></li><li><p><strong><font color='red'> errno  errno Thread-Local StorageTLS errnoAPUEP358</font></strong><br><img src="../../public/2022/img/image-20230410230004254.png" alt=""></p></li><li><p><strong> errno  errno </strong>  errno write errno <strong> errno </strong> <strong><font color='orange'></font></strong>  errno</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">sig_alarm</span><span class="params">(<span class="type">int</span> signo)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> errno_cpy = errno;</span><br><span class="line">    <span class="comment">//do something...</span></span><br><span class="line">    write(....);</span><br><span class="line">    errno = errno_cpy;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="font-color-red-perrorstrerror-font"><font color='red'>perrorstrerror</font></h2><p>C  <strong>void perror(const char *str)</strong>  stderr str  str</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="number">-1</span> == connect(fd, addr, len))</span><br><span class="line">    perror(<span class="string">&quot;connect&quot;</span>);</span><br><span class="line"><span class="comment">//</span></span><br><span class="line">connect: Connection refused</span><br></pre></td></tr></table></figure><p>C  <strong>char *strerror(int errnum)</strong>  <strong>errnum</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="number">-1</span> == connect(fd, addr, len))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span>* str = strerror(errno);</span><br><span class="line">    <span class="built_in">fputs</span>(str, <span class="built_in">stderr</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="font-color-red--font"><font color='red'></font></h2><p> errno  EINTR </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>((sock_conn=accept(sock_listen,<span class="literal">NULL</span>,<span class="literal">NULL</span>))&lt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(errno==EINTR)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            perror(<span class="string">&quot;accept&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>APUE 260 </p><p></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">Bind</span><span class="params">(<span class="type">int</span> fd, <span class="type">const</span> <span class="keyword">struct</span> sockaddr *sa, <span class="type">socklen_t</span> salen)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (bind(fd, sa, salen) &lt; <span class="number">0</span>)</span><br><span class="line">err_sys(<span class="string">&quot;bind error&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Connect</span><span class="params">(<span class="type">int</span> fd, <span class="type">const</span> <span class="keyword">struct</span> sockaddr *sa, <span class="type">socklen_t</span> salen)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (connect(fd, sa, salen) &lt; <span class="number">0</span>)</span><br><span class="line">err_sys(<span class="string">&quot;connect error&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><a href="https://github.com/jyx-fyh/unp-source-code/blob/master/lib/wrapsock.c">UNP-sockwarp.c</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TIME_WAITSO_REUSEADDR</title>
      <link href="/2023/03/16/TIME-WAIT%E5%AE%9E%E8%B7%B5%E6%8E%A2%E7%A9%B6/"/>
      <url>/2023/03/16/TIME-WAIT%E5%AE%9E%E8%B7%B5%E6%8E%A2%E7%A9%B6/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>Ubuntu 16.0.4</p></blockquote><ul><li><p> SO_REUSEADDR  TIME_WAIT  bind  <strong>TIME_WAIT </strong> </p><blockquote><p> TIME_WAIT </p></blockquote></li><li><p> SO_REUSEADDR TIME_WAIT  bind </p></li><li><p><strong><font color='red'> accept  connect  TIME_WAIT  bind  TIME_WAIT </font></strong> </p></li><li><p><strong><font color='red'> bind  bind </font></strong></p></li><li><p><code>SO_REUSEADDR</code>  <code>/proc/sys/net/ipv4/tcp_timestamps</code>  11</p><blockquote><p></p></blockquote></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//server</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> pid = getpid();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;server pid:%d\n&quot;</span>,pid);</span><br><span class="line">    <span class="type">int</span> sock_server = socket(AF_INET, SOCK_STREAM , IPPROTO_TCP);</span><br><span class="line">    <span class="type">int</span> opt = <span class="number">0</span>; <span class="comment">//SO_REUSEADDR0</span></span><br><span class="line">    <span class="type">socklen_t</span> optlen = <span class="keyword">sizeof</span>(opt);</span><br><span class="line">    setsockopt(sock_server, SOL_SOCKET, SO_REUSEADDR, &amp;opt, optlen);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">server_addr</span>;</span></span><br><span class="line">    <span class="built_in">memset</span>(&amp;server_addr, <span class="number">0</span>, <span class="keyword">sizeof</span>(server_addr));</span><br><span class="line">    server_addr.sin_addr.s_addr = htonl(INADDR_ANY);</span><br><span class="line">    server_addr.sin_port = htons(<span class="number">12345</span>);</span><br><span class="line">    server_addr.sin_family = AF_INET;</span><br><span class="line">    <span class="keyword">if</span>(<span class="number">-1</span> == bind(sock_server, (<span class="keyword">struct</span> sockaddr*)&amp;server_addr, <span class="keyword">sizeof</span>(server_addr)))&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;server failed to bind\n&quot;</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">    listen(sock_server, <span class="number">20</span>);</span><br><span class="line">    <span class="type">char</span> buf[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">int</span> sock_clnt;</span><br><span class="line">    <span class="keyword">if</span>(<span class="number">-1</span> != (sock_clnt = accept(sock_server,<span class="literal">NULL</span>,<span class="literal">NULL</span>)))&#123;</span><br><span class="line">        <span class="type">ssize_t</span> size = read(sock_clnt, buf, <span class="keyword">sizeof</span>(buf));</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;server received %ld bytes\n&quot;</span>,size);</span><br><span class="line">        size = write(sock_clnt, buf, <span class="keyword">sizeof</span>(buf));</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;server sent %ld bytes\n=====================&quot;</span>,size);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//sleep(3);  //stop 3s so that client could send FIN first</span></span><br><span class="line">    close(sock_server);</span><br><span class="line">    close(sock_clnt);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//client</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> pid = getpid();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;client pid:%d\n&quot;</span>,pid);</span><br><span class="line">    <span class="type">int</span> sock_clnt = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">server_addr</span>;</span></span><br><span class="line">    <span class="built_in">memset</span>(&amp;server_addr, <span class="number">0</span>, <span class="keyword">sizeof</span>(server_addr));</span><br><span class="line">    server_addr.sin_family = AF_INET;</span><br><span class="line">    server_addr.sin_port = htons(<span class="number">12345</span>);</span><br><span class="line">    server_addr.sin_addr.s_addr = inet_addr(<span class="string">&quot;127.0.0.1&quot;</span>);</span><br><span class="line">    connect(sock_clnt, (<span class="keyword">struct</span> sockaddr*)&amp;server_addr, <span class="keyword">sizeof</span>(server_addr));</span><br><span class="line">    <span class="type">char</span> in_buf[<span class="number">100</span>];</span><br><span class="line">    <span class="type">char</span> out_buf[<span class="number">100</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">99</span>;i++)</span><br><span class="line">        out_buf[i]=<span class="string">&#x27;f&#x27;</span>;</span><br><span class="line">    <span class="type">ssize_t</span> size = write(sock_clnt, out_buf, <span class="keyword">sizeof</span>(out_buf));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;client sent %ld bytes\n&quot;</span>,size);</span><br><span class="line">    size = read(sock_clnt, in_buf, <span class="keyword">sizeof</span>(in_buf));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;client received %ld bytes\n&quot;</span>,size);</span><br><span class="line">    sleep(<span class="number">3</span>); <span class="comment">//stop 3s so that server could send FIN first</span></span><br><span class="line">    close(sock_clnt);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> server  client <br><img src="/2022/img/image-20230316190258629.png" alt="server"><br><img src="/2022/img/image-20230316190325197.png" alt="client"><br> close  sleep server <br><img src="/2022/img/image-20230316190534357.png" alt=""><br><code>localhost:12345</code> <code>localhost:53188</code>  server  FIN  TIME_WAIT <br><img src="/2022/img/image-20230316191622035.png" alt=""><br> TIME_WAIT <br><img src="/2022/img/image-20230316191842098.png" alt=""><br> <code>46937</code>  server  client  bind  TIME_WAIT  bind</p><p> client  server  sleep  client  sleep <br><img src="/2022/img/image-20230316193318143.png" alt="server"><br><img src="/2022/img/image-20230316193335972.png" alt="client"><br><img src="/2022/img/image-20230316193425965.png" alt=""><br> <code>localhost:53200</code>  client  FIN  client  bind  client  TIME_WAIT </p><p> SO_REUSEADDR  TIME_WAIT  server  7  opt  1  TIME_WAIT  server  client <br><img src="/2022/img/image-20230316204302114.png" alt=""><br><img src="/2022/img/image-20230316204349584.png" alt=""> TIME_WAIT </p><p><strong><font color='red'> SO_REUSEADDR  1TIME_WAIT  bind </font></strong></p><p></p><p><a href="https://xiaolincoding.com/network/3_tcp/tcp_tw_reuse_close.html#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E8%AE%BE%E8%AE%A1-time-wait-%E7%8A%B6%E6%80%81">https://xiaolincoding.com/network/3_tcp/tcp_tw_reuse_close.html#-time-wait-</a></p><p><a href="https://xiaolincoding.com/network/3_tcp/time_wait_recv_syn.html#%E5%85%88%E8%AF%B4%E7%BB%93%E8%AE%BA">https://xiaolincoding.com/network/3_tcp/time_wait_recv_syn.html#</a></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Socket</title>
      <link href="/2023/03/05/Socket%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%85%A5%E9%97%A8%E7%AC%94%E8%AE%B0/"/>
      <url>/2023/03/05/Socket%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%85%A5%E9%97%A8%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><ul><li>Socket</li><li>Socket<a href="https://jyx-fyh.github.io/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"></a></li><li>UNIXTCP/IP</li><li>UNIX</li></ul></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> servSock = <span class="built_in">socket</span>(AF_INET,SOCK_STREAM,IPPROTO_TCP);</span><br><span class="line">    sockaddr_in servAddr;</span><br><span class="line">    <span class="built_in">memset</span>(&amp;servAddr,<span class="number">0</span>,<span class="built_in">sizeof</span>(servAddr)); <span class="comment">//&lt;string.h&gt;</span></span><br><span class="line">    servAddr.sin_addr.s_addr = <span class="built_in">inet_addr</span>(<span class="string">&quot;127.0.0.1&quot;</span>);</span><br><span class="line">    servAddr.sin_port = <span class="built_in">htons</span>(<span class="number">1234</span>);</span><br><span class="line">    servAddr.sin_family = AF_INET;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">bind</span>(servSock,(sockaddr*)&amp;servAddr,<span class="built_in">sizeof</span>(servAddr));</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">listen</span>(servSock,<span class="number">20</span>);</span><br><span class="line">    </span><br><span class="line">    sockaddr_in clntAddr;</span><br><span class="line">    <span class="type">socklen_t</span> clntAddrSize = <span class="built_in">sizeof</span>(clntAddr);</span><br><span class="line">    <span class="type">int</span> clntSock = <span class="built_in">accept</span>(servSock,(sockaddr*)&amp;clntAddr,&amp;clntAddrSize);</span><br><span class="line">    <span class="type">char</span> msg[] = <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line">    <span class="built_in">write</span>(clntSock,msg,<span class="built_in">sizeof</span>(msg)); <span class="comment">//&lt;unistd.h&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">close</span>(clntSock);</span><br><span class="line">    <span class="built_in">close</span>(servSock);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><font color='orange'></font></strong></p><ol><li><strong> socket <font color='gree'></font></strong></li><li><strong> socket servAddr IP </strong></li><li><strong>servAddrbindservSock</strong></li><li><strong> </strong></li><li><strong>accept<u>clntSock</u></strong></li><li><strong>write  read</strong></li><li><strong>close</strong></li></ol><blockquote><p><strong><font color='red'></font></strong> <strong><font color='red'> accept <u></u> clntSock clntAddr </font></strong> <strong></strong></p></blockquote><p><strong><font color='orange'></font></strong></p><h3 id="font-color-red-socket-font"><font color='red'>socket</font></h3><p><img src="/2022/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE38-1678261426526-2.png" alt=""></p><ul><li> listen </li><li><strong>protocol </strong>   <strong> 0</strong> </li></ul><h3 id="font-color-red-bind-font"><font color='red'>bind</font></h3><p><img src="/2022/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE42-1678287450215-8.png" alt=""></p><ul><li><p> addr  sockfd </p></li><li><p><strong>bind  IP </strong></p>  <img src="/2022/img/image-20230308162549530.png" style="zoom:80%;" /><p><strong><font color='red'> IPv4 INADDR_ANY IPv6 in6addr_any</font></strong> </p>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">servSock.sin_addr.s_addr = <span class="built_in">htonl</span>(INADDR_ANY); <span class="comment">//INADDR_ANY0,htonl</span></span><br></pre></td></tr></table></figure></li><li><p><strong> INADDR_ANY IP  SYN  IP</strong> </p></li><li><p><strong><u> TCP <font color='orange'> listen (server)  connect (client) </font></u></strong> <strong><u><font color='orange'></font></u></strong> </p></li><li><p><strong><u> TCP  IP  TCP  SYN IP IP </u></strong></p></li><li><p><strong><font color='red'></font></strong> <a href="https://jyx-fyh.github.io/2023/03/16/TIME-WAIT%E5%AE%9E%E8%B7%B5%E6%8E%A2%E7%A9%B6/">TIME_WAIT  SO_REUSEADDR</a> </p></li><li><p><strong> TIME_WAIT  EADDRINUSE </strong> <a href="https://jyx-fyh.github.io/2023/03/16/TIME-WAIT%E5%AE%9E%E8%B7%B5%E6%8E%A2%E7%A9%B6/">TIME_WAIT  SO_REUSEADDR</a> </p></li><li><p> bind  accept -</p></li></ul><h3 id="font-color-red-listen-font"><font color='red'>listen</font></h3><p><img src="/2022/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE40.png" alt=""></p><ul><li><strong> socket  listen </strong></li><li><strong> listen  CLOSED  LISTEN </strong> <a href="https://jyx-fyh.github.io/2022/08/03/TCP%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E4%B8%8E%E6%8C%A5%E6%89%8B/">TCP</a></li><li>bocklog backlog <strong><u><font color='orange'></font></u></strong> <a href="https://jyx-fyh.github.io/2023/03/20/%E5%8D%8A%E8%BF%9E%E6%8E%A5%E4%B8%8E%E5%85%A8%E8%BF%9E%E6%8E%A5%E9%98%9F%E5%88%97/">socket</a> </li></ul><h3 id="font-color-red-accept-font"><font color='red'>accept</font></h3><p><img src="/2022/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE41.png" alt=""></p><ul><li><p> bind <strong></strong>  clntAddr clntAddr  addrLenaddrLen - clntAddr  addrLen<strong><font color='orange'> NULL</font></strong> </p><blockquote><p> IPv4 IPv6clntAddr  <code>sockaddr_storage</code>  </p></blockquote></li><li><p><strong><font color='red'>accept </font></strong> </p></li><li><p><strong><font color='orange'>accept  connect  accept </font></strong></p><blockquote><p></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//======!!!BindListen,!!!=======</span></span><br><span class="line"><span class="comment">//server</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line"> <span class="type">int</span> sock_lsn = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);</span><br><span class="line"> <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">addr_lsn</span>;</span></span><br><span class="line"> <span class="built_in">memset</span>(&amp;addr_lsn, <span class="number">0</span>, <span class="keyword">sizeof</span>(addr_lsn));</span><br><span class="line"> addr_lsn.sin_addr.s_addr = htonl(INADDR_ANY);</span><br><span class="line"> addr_lsn.sin_port = htons(<span class="number">12345</span>);</span><br><span class="line"> addr_lsn.sin_family = AF_INET;</span><br><span class="line"> Bind(sock_lsn, (<span class="keyword">struct</span> sockaddr*)&amp;addr_lsn, <span class="keyword">sizeof</span>(addr_lsn));</span><br><span class="line"> Listen(sock_lsn, <span class="number">20</span>);</span><br><span class="line"> <span class="comment">//,acceptclose</span></span><br><span class="line"> <span class="keyword">while</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//=================================</span></span><br><span class="line"><span class="comment">//client</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line"> <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">addr_clnt</span>;</span></span><br><span class="line"> <span class="built_in">memset</span>(&amp;addr_clnt, <span class="number">0</span> , <span class="keyword">sizeof</span>(addr_clnt));</span><br><span class="line"> addr_clnt.sin_port = htons(<span class="number">12345</span>);</span><br><span class="line"> addr_clnt.sin_addr.s_addr = inet_addr(<span class="string">&quot;127.0.0.1&quot;</span>);</span><br><span class="line"> addr_clnt.sin_family = AF_INET;</span><br><span class="line"> <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) <span class="comment">//10</span></span><br><span class="line"> &#123;</span><br><span class="line">     <span class="keyword">if</span>(<span class="number">0</span> == fork())</span><br><span class="line">     &#123;</span><br><span class="line">         <span class="type">int</span> sock_clnt = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);</span><br><span class="line">         Connect(sock_clnt, (<span class="keyword">struct</span> sockaddr*)&amp;addr_clnt, <span class="keyword">sizeof</span>(addr_clnt));</span><br><span class="line">         sleep(<span class="number">10</span>);<span class="comment">//10s,</span></span><br><span class="line">         close(sock_clnt);</span><br><span class="line">         <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p><img src="/2022/img/image-20230319221140308.png" alt=""><br> server  client<code>netstat</code>  20  10  accept<strong><font color='orange'>accept </font></strong> <br><strong> IP IP TCP </strong> </p></blockquote></li></ul><h3 id="font-color-red-connect-font"><font color='red'>connect</font></h3><ul><li><p>connect  bind</p></li><li><p>connect </p><ol><li><p> SYN  ACK ETIMEDOUT </p><blockquote><p>SYN  <code>tcp_syn_retries</code> <u><strong></strong></u>  1  2  4  2 </p></blockquote></li><li><p> SYN  RST ECONNREFUSED </p></li><li><p>SYN  ICMP  SYN </p></li></ol></li><li><p><strong><font color='red'> connect  connect connect </font></strong></p><blockquote><p> connect  TIME_WAIT  SYN  MSL()  ACK  ACK  MSL  2MSL  connect  connect  SYN ACK  SYN  ACK<br></p></blockquote></li></ul><h3 id="font-color-red-close-font"><font color='red'>close</font></h3><ul><li> close <strong><font color='orange'> 1</font></strong> <strong> 0 FIN  0 </strong> </li><li><strong>close close  <code>SO_LINGER</code> </strong>  <code>SO_LINGER</code> <a href="https://jyx-fyh.github.io/2023/04/02/%E5%B8%B8%E7%94%A8socket%E9%80%89%E9%A1%B9/">SOCKET</a></li><li> FIN  ACK  <code>FIN_WAIT2</code> <strong><font color='orange'> close()  <code>FIN_WAIT2</code>  <code>tcp_fin_timeout</code>  60s shutdown()  <code>FIN_WAIT2</code>  </font></strong></li></ul><h3 id="font-color-red-shutdown-font"><font color='red'>shutdown</font></h3><ul><li>close  shutdown </li><li><strong><font color='orange'> shutdown <u></u> RST</font></strong></li><li><strong><font color='orange'>shutdown  SHUT_WR  0</font></strong></li></ul><p><img src="/2022/img/IMG_0580(20230407-134909)-1681295358001-1.png" alt=""></p><h3 id="font-color-red--font"><font color='red'></font></h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">in_addr_t</span> <span class="title function_">inet_addr</span> <span class="params">(<span class="type">const</span> <span class="type">char</span> *str)</span></span><br><span class="line">    ,,<span class="title function_">INADDR_NONE</span><span class="params">(<span class="number">-1</span>)</span></span><br></pre></td></tr></table></figure><p> str  32 32  IPv4  <code>255.255.255.255</code> UNPP67</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">inet_aton</span> <span class="params">(<span class="type">const</span> <span class="type">char</span> *str, <span class="keyword">struct</span> in_addr *addr)</span></span><br><span class="line">    ,1,0</span><br></pre></td></tr></table></figure><p> str  32  addr </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> *<span class="title function_">inet_ntoa</span> <span class="params">(<span class="keyword">struct</span> in_addr addr)</span></span><br></pre></td></tr></table></figure><p> 32 <strong><font color='orange'><u>inet_ntoa() </u></font></strong><br><img src="/2022/img/image-20230415204033411.png" alt=""></p><blockquote><p><a href="https://jyx-fyh.github.io/2023/04/15/%E4%BB%80%E4%B9%88%E6%98%AF%E4%B8%8D%E5%8F%AF%E9%87%8D%E5%85%A5/"></a></p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">inet_pton</span> <span class="params">(<span class="type">int</span> family, <span class="type">const</span> <span class="type">char</span> * str, <span class="type">void</span> * addr)</span></span><br><span class="line">    1,str0,-1</span><br></pre></td></tr></table></figure><p> IPv4  IPv6 void* in_addr  in6_addr </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> *<span class="title function_">inet_ntop</span> <span class="params">(<span class="type">int</span> family, <span class="type">const</span> <span class="type">void</span> * addr, <span class="type">char</span> * str, <span class="type">socklen_t</span> len)</span></span><br><span class="line">    ,<span class="literal">NULL</span>,errnoENOSPC</span><br></pre></td></tr></table></figure><p> IPv4  IPv6 str  NULL str  <code>&lt;netinet/in.h&gt;</code> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> INET_ADDRSTRLEN 16</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> INET6_ADDRSTRLEN 46</span></span><br></pre></td></tr></table></figure><p><strong> addr  <code>in_addr</code>  <code>in6_addr</code></strong> </p><blockquote><p><code>inet_pton</code>  <code>inet_ntop</code>  <code>inet_ntop</code>  <code>inet_ntoa</code></p></blockquote><h3 id="font-color-red-getsocknamegetpeername-font"><font color='red'>getsocknamegetpeername</font></h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">getsockname</span> <span class="params">(<span class="type">int</span> fd, <span class="keyword">struct</span> sockaddr *local_addr, <span class="type">socklen_t</span> *len)</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">getpeername</span> <span class="params">(<span class="type">int</span> fd, <span class="keyword">struct</span> sockaddr *peer_addr, <span class="type">socklen_t</span> *len)</span></span><br><span class="line">    0,-1</span><br></pre></td></tr></table></figure><p><strong><font color='orange'> len -</font></strong>  getpeername  IPv4  IPv6 <code>sockaddr_in</code> IPv4len  <code>sockaddr_in</code>  IPv6  <code>sockaddr_in</code>  <code>sockaddr_in6</code> len  <code>sockaddr_in6</code> <strong><font color='orange'> <code>sockaddr_storage</code> </font></strong> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_storage</span> <span class="title">saddr</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span>* <span class="title">pinaddr</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in6</span>* <span class="title">pin6addr</span>;</span></span><br><span class="line"><span class="type">socklen_t</span> len = <span class="keyword">sizeof</span>(saddr);</span><br><span class="line"><span class="type">int</span> ret = getpeername(sock, (<span class="keyword">struct</span> sockaddr*)&amp;saddr, &amp;len);</span><br><span class="line"><span class="keyword">if</span>(ret == <span class="number">-1</span>)</span><br><span class="line">    err_quit(<span class="string">&quot;getpeername err\n&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(saddr.ss_family == AF_INET)</span><br><span class="line">&#123;</span><br><span class="line">    pinaddr = (<span class="keyword">struct</span> sockaddr_in*)&amp;saddr;</span><br><span class="line">    <span class="type">char</span> str[INET_ADDRSTRLEN];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;IPv4:%s\n&quot;</span>, inet_ntop(AF_INET,&amp;pinaddr-&gt;sin_addr, str, <span class="keyword">sizeof</span>(str)));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;port:%u\n&quot;</span>, ntohs(pinaddr-&gt;sin_port));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(saddr.ss_family == AF_INET6)</span><br><span class="line">&#123;</span><br><span class="line">    pin6addr = (<span class="keyword">struct</span> sockaddr_in6*)&amp;saddr;</span><br><span class="line">    <span class="type">char</span> str[INET6_ADDRSTRLEN];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;IPv6:%s\n&quot;</span>, inet_ntop(AF_INET,&amp;pin6addr-&gt;sin6_addr, str, <span class="keyword">sizeof</span>(str)));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;port:%ud\n&quot;</span>, ntohs(pinaddr-&gt;sin_port));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><ul><li> bind connect  getsockname </li><li> <code>INADDR_ANY</code>  getsockname <strong><font color='orange'> SYN  getsockname </font></strong></li><li><strong><font color='orange'> accept  exec  getpeername </font></strong> inetd  Telnet <br><img src="/2022/img/IMG_0585(20230415-212627).PNG" alt=""></li></ul><h3 id="font-color-red--font"><font color='red'></font></h3><p></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">uint32_t</span> <span class="title function_">ntohl</span> <span class="params">(<span class="type">uint32_t</span> netlong)</span></span><br><span class="line"><span class="type">uint16_t</span> <span class="title function_">ntohs</span> <span class="params">(<span class="type">uint16_t</span> netshort)</span></span><br><span class="line">    net to host,</span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">htonl</span> <span class="params">(<span class="type">uint32_t</span> hostlong)</span></span><br><span class="line"><span class="type">uint16_t</span> <span class="title function_">htons</span> <span class="params">(<span class="type">uint16_t</span> hostshort)</span></span><br><span class="line">    host to net,</span><br></pre></td></tr></table></figure><p> IP <a href=""></a></p><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong><mark class="hl-label blue">bind sockaddr_in*  sockaddr*</mark> </strong></p><p><strong><font color='orange'> bind </font></strong></p><p><code>sockaddr_in</code>  IPv4 </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> &#123;</span></span><br><span class="line">    <span class="type">sa_family_t</span> sin_family;  <span class="comment">// AF_INET</span></span><br><span class="line">    <span class="type">uint16_t</span> sin_port;       <span class="comment">// </span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">in_addr</span> <span class="title">sin_addr</span>;</span> <span class="comment">// IPv4</span></span><br><span class="line">    <span class="type">char</span> sin_zero[<span class="number">8</span>];        <span class="comment">// 0</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//16</span></span><br></pre></td></tr></table></figure><p><code>sockaddr</code> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sockaddr</span> &#123;</span></span><br><span class="line">    <span class="type">sa_family_t</span> sa_family;    <span class="comment">// </span></span><br><span class="line">    <span class="type">char</span> sa_data[<span class="number">14</span>];         <span class="comment">// </span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//16</span></span><br></pre></td></tr></table></figure><p> <code>sa_family</code>  <code>sa_family</code> bind  len <strong><u> sockaddr*  len </u></strong> </p><p> len  sa_family  sa_family  AF_INET sockaddr_in  len <strong><font color='orange'> UNIX </font></strong>  len <br><img src="/2022/img/AF42B09F2B4C386B42D377D97AB95965.png" alt=""></p><p> <code>sockaddr_storage</code> <strong></strong> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_storage</span> &#123;</span></span><br><span class="line">    <span class="type">sa_family_t</span> ss_family;      <span class="comment">// </span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> __ss_align;   <span class="comment">// </span></span><br><span class="line">    <span class="type">char</span> __ss_padding[<span class="number">128</span> - <span class="keyword">sizeof</span>(<span class="type">unsigned</span> <span class="type">long</span>)];  <span class="comment">// </span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p> ss_family </p><p> <code>sockaddr_in</code>  8 </p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CHATGPT</title>
      <link href="/2023/02/10/%E5%85%B3%E4%BA%8ECHAT-GPT%E7%9A%84%E4%B8%80%E4%BA%9B%E6%83%B3%E6%B3%95/"/>
      <url>/2023/02/10/%E5%85%B3%E4%BA%8ECHAT-GPT%E7%9A%84%E4%B8%80%E4%BA%9B%E6%83%B3%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>chatgptchatgpt</p><p><strong><mark class="hl-label blue">chatgpt</mark> </strong><br><br><img src="/2022/img/b&bo=NwQzBjcEMwYWECA!&rf=viewer_311.jpeg" alt="AI" style="zoom:80%;" /><br><img src="/2022/img/b&ek=1&kp=1&pt=0&bo=OARgCTgEYAkWECA!&tl=1&vuin=1572676601&tm=1676037600&dis_t=1676037625&dis_k=f9474985ff1e09ce64e0efcb968d67df&sce=50-1-1&rf=viewer_311.jpeg" alt="AI" style="zoom:67%;" /></p><p>2018chatgptChatGPT</p><p>AI<br><img src="/2022/img/image-20230210223238238.png" alt=""><br>AIAI</p><p><strong><mark class="hl-label blue"></mark> </strong><br><a href="https://www.huxiu.com/article/787988.html">ChatGPT</a></p><p><br><img src="/2022/img/image-20230210231638974.png" style="zoom:50%;" /><br><img src="/2022/img/image-20230210231800724.png" style="zoom:50%;" /><br>chatgptgpt<br><img src="/2022/img/image-20230210232254477.png" style="zoom:67%;" /><br>chatgpt2022OpenAI49355G</p><p><strong><mark class="hl-label default">AI</mark> </strong><br><img src="/2022/img/image-20230210222435996.png" alt=""><br>2</p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>-</title>
      <link href="/2023/01/27/%E6%B7%B1%E5%BA%A6%E6%80%9D%E7%BB%B4-%E8%AF%BB%E4%B9%A6%E6%80%BB%E7%BB%93/"/>
      <url>/2023/01/27/%E6%B7%B1%E5%BA%A6%E6%80%9D%E7%BB%B4-%E8%AF%BB%E4%B9%A6%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p></p><p></p><p></p><p><strong></strong> 5so5why<strong></strong>  5why5sososososo<br><strong></strong> </p><p><strong></strong> </p><ol><li><strong></strong></li><li><strong></strong></li></ol><p>OMG</p><p><strong></strong> <strong></strong> <br></p><p><strong></strong> <strong></strong>  80%~70% 70%~80% <br><img src="/2022/img/37.png" style="zoom:150%;" /><br> A  B  B  B </p><p><strong></strong> <br><strong></strong> </p><p><br> --&gt;  --&gt;  --&gt;  --&gt;  --&gt;  --&gt; <br>ta<br><br> 20% <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1.</mn><msup><mn>2</mn><mn>7</mn></msup><mo>=</mo><mn>4.29</mn></mrow><annotation encoding="application/x-tex">1.2^7=4.29</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1.</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4.29</span></span></span></span>  4.29  20% </p><p><strong></strong> <br><br></p><p></p><blockquote><p><br><br></p></blockquote><p>2010</p><p></p><p></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>?</title>
      <link href="/2023/01/13/%E6%9B%B4%E5%AE%89%E5%85%A8%E7%9A%84%E7%94%A8%E6%88%B7%E8%BF%9B%E7%A8%8B/"/>
      <url>/2023/01/13/%E6%9B%B4%E5%AE%89%E5%85%A8%E7%9A%84%E7%94%A8%E6%88%B7%E8%BF%9B%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p><code>data_limit_3gb</code></p></blockquote><p><a href="https://jyx-fyh.github.io/2023/01/06/%E5%AE%9E%E7%8E%B0%E7%94%A8%E6%88%B7%E8%BF%9B%E7%A8%8B-%E4%BB%A3%E7%A0%81%E8%AF%A6%E8%A7%A3/"></a> 3GB  4GB<br><img src="/2022/img/image-20230112155046604-1673594986128-1.png" alt=""><br> Linux 0.11  Linux 0.11 <u></u> 4GB  3GB </p><p> <code>0xbfffffff</code> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//:tss.c</span></span><br><span class="line"><span class="comment">//:tss_init()</span></span><br><span class="line">*((<span class="keyword">struct</span> gdt_desc*)<span class="number">0xc0000938</span>) = make_gdt_desc((<span class="type">uint32_t</span>*)<span class="number">0</span>, <span class="number">0xbffff</span>, GDT_CODE_ATTR_LOW_DPL3, GDT_ATTR_HIGH);</span><br></pre></td></tr></table></figure><p> syscall</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//.....</span></span><br><span class="line"><span class="type">uint32_t</span> _syscall1(<span class="type">uint32_t</span> no, <span class="type">uint32_t</span> _arg1)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> retval;</span><br><span class="line">    <span class="keyword">asm</span> <span class="title function_">volatile</span></span><br><span class="line">    <span class="params">(<span class="string">&quot;int 0x80&quot;</span></span></span><br><span class="line"><span class="params">    : <span class="string">&quot;=a&quot;</span> (retval)</span></span><br><span class="line"><span class="params">    : <span class="string">&quot;a&quot;</span> (no), <span class="string">&quot;b&quot;</span> (_arg1)</span></span><br><span class="line"><span class="params">    : <span class="string">&quot;memory&quot;</span></span></span><br><span class="line"><span class="params">    )</span>;</span><br><span class="line">    <span class="keyword">return</span> retval;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//.....syscall</span></span><br></pre></td></tr></table></figure><p> 3GB  makefile </p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#:makefile</span></span><br><span class="line"><span class="variable">$(BUILD)</span>/kernel.bin: <span class="variable">$(KERNEL)</span></span><br><span class="line">ld  -m elf_i386 <span class="variable">$^</span> -o <span class="variable">$@</span> -Ttext 0xc0001500</span><br></pre></td></tr></table></figure><p> kernel.bin <code>0xc0001500</code>  <code>0xc0000000</code>  3GB  _syscallX <br> dsesfscs</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">;.....</span><br><span class="line">;3 </span><br><span class="line">   push eax</span><br><span class="line">   mov  ax,0x10   ;</span><br><span class="line">   mov  ds,ax</span><br><span class="line">   mov  es,ax</span><br><span class="line">   mov  fs,ax</span><br><span class="line">   pop  eax</span><br><span class="line">   call [syscall_table + eax*4]    ; C</span><br><span class="line">   add esp, 12                      ; </span><br><span class="line">;.....</span><br></pre></td></tr></table></figure><p>ok</p><p><img src="/2022/img/image-20230114134607206.png" alt="image-20230114134607206"></p><p> GP <br><img src="/2022/img/image-20230114150332216.png" alt=""></p><p> Bochs <strong><font color='orange'></font></strong> </p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2023/01/11/%E5%8A%A0%E5%85%A5%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8-syscall/"/>
      <url>/2023/01/11/%E5%8A%A0%E5%85%A5%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8-syscall/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p><code>printk</code></p></blockquote><h3 id="font-color-red-API-font"><font color='red'>API</font></h3><p> API </p><p><strong>API (Application Programming Interface)</strong> <u></u> API </p><blockquote><p>API  C  printf printf  printf  API <strong></strong> </p></blockquote><p>malloc<br> API  API <strong>API </strong> </p><h3 id="font-color-red--font"><font color='red'></font></h3><p> ring0 ring0 Linux <strong><font color='orange'>Linux  0x80 eax ebxecxedxesi  edi  eax </font></strong> </p><blockquote><p></p></blockquote><p>Linux <br><strong><mark class="hl-label blue"> glibc </mark> </strong><br>glibc  Linux  C glibc  API glibc  <code>chmod</code>  <code>etc/passwd</code>  444</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">        <span class="type">int</span> rc;</span><br><span class="line">        rc = chmod(<span class="string">&quot;/etc/passwd&quot;</span>, <span class="number">0444</span>);</span><br><span class="line">        <span class="keyword">if</span> (rc == <span class="number">-1</span>)</span><br><span class="line">                <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;chmod failed, errno = %d\n&quot;</span>, errno);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;chmod success!\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><mark class="hl-label blue">syscall</mark> &quot;</strong><br>syscall  syscall  glibc  API glibc  <code>syscall</code> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">long</span> <span class="type">int</span> <span class="title function_">syscall</span> <span class="params">(<span class="type">long</span> <span class="type">int</span> sysno, ...)</span></span><br></pre></td></tr></table></figure><p> sysno <code>...</code> 0~5<br><strong><mark class="hl-label blue">int</mark> </strong><br></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">long</span> rc;</span><br><span class="line">    <span class="type">char</span> *file_name = <span class="string">&quot;/etc/passwd&quot;</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">short</span> mode = <span class="number">0444</span>;</span><br><span class="line">    <span class="keyword">asm</span></span><br><span class="line">    (</span><br><span class="line">     <span class="string">&quot;int $0x80&quot;</span></span><br><span class="line">    :<span class="string">&quot;=a&quot;</span> (rc)</span><br><span class="line">    :<span class="string">&quot;0&quot;</span> (SYS_chmod), <span class="string">&quot;b&quot;</span> ((<span class="type">long</span>)file_name), <span class="string">&quot;c&quot;</span> ((<span class="type">long</span>)mode)</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong> <code>int</code> </strong> </p><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong><mark class="hl-label blue">_syscallX</mark> </strong><br> _syscallX  X  _syscall3 </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _syscall3(type, name, atype, a, btype, b, ctype, c)              \</span></span><br><span class="line"><span class="meta">type name(atype a,btype b,ctype c)&#123;                                      \</span></span><br><span class="line"><span class="meta">long __res;                                                              \</span></span><br><span class="line"><span class="meta">asm volatile                                                             \</span></span><br><span class="line"><span class="meta">    (<span class="string">&quot;int $0x80&quot;</span>                                                         \</span></span><br><span class="line"><span class="meta">: <span class="string">&quot;=a&quot;</span> (__res)                                                       \</span></span><br><span class="line"><span class="meta">: <span class="string">&quot;0&quot;</span> (__NR_##name),<span class="string">&quot;b&quot;</span> ((long)(a)),<span class="string">&quot;c&quot;</span> ((long)(b)),<span class="string">&quot;d&quot;</span> ((long)(c))) \</span></span><br><span class="line"><span class="meta"><span class="keyword">if</span> (__res&gt;=0)                                                            \</span></span><br><span class="line"><span class="meta">return (type) __res;                                                 \</span></span><br><span class="line"><span class="meta">errno=-__res;                                                            \</span></span><br><span class="line"><span class="meta">return -1;                                                               \</span></span><br><span class="line"><span class="meta">&#125;</span></span><br></pre></td></tr></table></figure><p> _syscallX  Linux  _syscallX </p><p> 0~3 </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//:syscall.c</span></span><br><span class="line"><span class="type">static</span> <span class="type">uint32_t</span> callno_ret;</span><br><span class="line"><span class="type">static</span> <span class="type">uint32_t</span> arg1;</span><br><span class="line"><span class="type">static</span> <span class="type">uint32_t</span> arg2;</span><br><span class="line"><span class="type">static</span> <span class="type">uint32_t</span> arg3;</span><br><span class="line"><span class="type">uint32_t</span> _syscall0(<span class="type">uint32_t</span> no)</span><br><span class="line">&#123;</span><br><span class="line">    callno_ret = no;</span><br><span class="line">    <span class="keyword">asm</span>(<span class="string">&quot;mov eax,callno_ret&quot;</span>);</span><br><span class="line">    <span class="keyword">asm</span>(<span class="string">&quot;int 0x80&quot;</span>);</span><br><span class="line">    <span class="keyword">asm</span>(<span class="string">&quot;mov callno_ret,eax&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> callno_ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">uint32_t</span> _syscall1(<span class="type">uint32_t</span> no, <span class="type">uint32_t</span> _arg1)</span><br><span class="line">&#123;</span><br><span class="line">    callno_ret = no;</span><br><span class="line">    arg1 = _arg1;</span><br><span class="line">    <span class="keyword">asm</span>(<span class="string">&quot;mov eax,callno_ret&quot;</span>);</span><br><span class="line">    <span class="keyword">asm</span>(<span class="string">&quot;mov ebx,arg1&quot;</span>);</span><br><span class="line">    <span class="keyword">asm</span>(<span class="string">&quot;int 0x80&quot;</span>);</span><br><span class="line">    <span class="keyword">asm</span>(<span class="string">&quot;mov callno_ret,eax&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> callno_ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">uint32_t</span> _syscall2(<span class="type">uint32_t</span> no, <span class="type">uint32_t</span> _arg1, <span class="type">uint32_t</span> _arg2)</span><br><span class="line">&#123;</span><br><span class="line">    callno_ret = no;</span><br><span class="line">    arg1 = _arg1;</span><br><span class="line">    arg2 = _arg2;</span><br><span class="line">    <span class="keyword">asm</span>(<span class="string">&quot;mov eax,callno_ret&quot;</span>);</span><br><span class="line">    <span class="keyword">asm</span>(<span class="string">&quot;mov ebx,arg1&quot;</span>);</span><br><span class="line">    <span class="keyword">asm</span>(<span class="string">&quot;mov ecx,arg2&quot;</span>);</span><br><span class="line">    <span class="keyword">asm</span>(<span class="string">&quot;int 0x80&quot;</span>);</span><br><span class="line">    <span class="keyword">asm</span>(<span class="string">&quot;mov callno_ret,eax&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> callno_ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">uint32_t</span> _syscall3(<span class="type">uint32_t</span> no, <span class="type">uint32_t</span> _arg1, <span class="type">uint32_t</span> _arg2, <span class="type">uint32_t</span> _arg3)</span><br><span class="line">&#123;</span><br><span class="line">    callno_ret = no;</span><br><span class="line">    arg1 = _arg1;</span><br><span class="line">    arg2 = _arg2;</span><br><span class="line">    arg3 = _arg3;</span><br><span class="line">    <span class="keyword">asm</span>(<span class="string">&quot;mov eax,callno_ret&quot;</span>);</span><br><span class="line">    <span class="keyword">asm</span>(<span class="string">&quot;mov ebx,arg1&quot;</span>);</span><br><span class="line">    <span class="keyword">asm</span>(<span class="string">&quot;mov ecx,arg2&quot;</span>);</span><br><span class="line">    <span class="keyword">asm</span>(<span class="string">&quot;mov edx,arg3&quot;</span>);</span><br><span class="line">    <span class="keyword">asm</span>(<span class="string">&quot;int 0x80&quot;</span>);</span><br><span class="line">    <span class="keyword">asm</span>(<span class="string">&quot;mov callno_ret,eax&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> callno_ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li></li></ul><p> <code>mov callno_ret,eax</code>  ABI  eax  eax  callno_ret callno_ret </p><p><strong><mark class="hl-label blue"></mark> </strong><br> 0x80  iret 0x80 </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">;:interrupt.s</span><br><span class="line">;.............</span><br><span class="line">;;;;;;;;;;;;;;;;   0x80   ;;;;;;;;;;;;;;;;</span><br><span class="line">[bits 32]</span><br><span class="line">extern syscall_table</span><br><span class="line">section .text</span><br><span class="line">global syscall_handler</span><br><span class="line">syscall_handler:</span><br><span class="line">;1 </span><br><span class="line">   push 0               ; 0, </span><br><span class="line">   push ds</span><br><span class="line">   push es</span><br><span class="line">   push fs</span><br><span class="line">   push gs</span><br><span class="line">   pushad               ; PUSHAD32:</span><br><span class="line">                        ; EAX,ECX,EDX,EBX,ESP,EBP,ESI,EID</span><br><span class="line">   push 0x80            ; 0x80</span><br><span class="line"></span><br><span class="line">;2 </span><br><span class="line">   push edx            ; 3</span><br><span class="line">   push ecx            ; 2</span><br><span class="line">   push ebx            ; 1</span><br><span class="line"></span><br><span class="line">;3 </span><br><span class="line">   call [syscall_table + eax*4]    ; C</span><br><span class="line">   add esp, 12                      ; </span><br><span class="line">;4 calleax</span><br><span class="line">   mov [esp + 8*4], eax</span><br><span class="line">   jmp intr_exit                    ; intr_exit,</span><br></pre></td></tr></table></figure><ul><li></li><li><code>syscall_handler</code> </li><li> 25  <code>syscall_table</code>  <code>syscall_init.c</code> </li><li> 28  eax  eax  eax eax  eax </li></ul><p><strong><mark class="hl-label blue"> 0x80 </mark> </strong></p><p> 0x80 </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//:idt.c</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> IDT_DESC_CNT 0x81  <span class="comment">//0x81</span></span></span><br><span class="line"><span class="comment">//........</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">idt_desc_init</span><span class="params">()</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; IDT_DESC_CNT; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        make_idt_desc(&amp;idt[i],  IDT_DESC_DPL0, interrupt_entry_table[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    make_idt_desc(&amp;idt[<span class="number">0x80</span>],IDT_DESC_DPL3,syscall_handler); <span class="comment">//0x80</span></span><br><span class="line">    put_str(<span class="string">&quot;idt is done\n&quot;</span>,BG_BLACK+FT_YELLOW);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//........</span></span><br></pre></td></tr></table></figure><p> write </p><h3 id="font-color-red-write-font"><font color='red'>write</font></h3><p>write console_put_str </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//:syscall_init.c</span></span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">sys_write</span><span class="params">(<span class="type">char</span>* str)</span></span><br><span class="line">&#123;</span><br><span class="line">    console_put_str(str,DEFUALT);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">strlen</span>(str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> <code>syscall_handler</code>  write </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//:syscall.c</span></span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">write</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* str)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> _syscall1(SYS_WRITE,(<span class="type">uint32_t</span>)str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> <code>SYS_WRITE</code>  syscall.h </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">SYSCALL_NR</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    SYS_WRITE</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><strong><font color='orange'><u></u></font></strong></p><div class="mermaid-wrap"><pre class="mermaid-src" hidden>  graph LRB(write)--&gt;L(_syscall1)--&gt;G(int 0x80)--&gt;K(syscall_handler)--&gt;A(sys_write)  </pre></div><p></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//:syscall_init.c</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">syscall_init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    console_put_str(<span class="string">&quot;syscall_init start\n&quot;</span>,DEFUALT);</span><br><span class="line">    syscall_table[SYS_WRITE] = sys_write;</span><br><span class="line">    console_put_str(<span class="string">&quot;syscall_init done\n&quot;</span>,DEFUALT);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//:init.c</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">init_all</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    put_str(<span class="string">&quot;init_all\n&quot;</span>,DEFUALT);</span><br><span class="line">    idt_init();    <span class="comment">// </span></span><br><span class="line">    timer_init();  <span class="comment">// PIT</span></span><br><span class="line">    thread_init(); <span class="comment">// </span></span><br><span class="line">    mem_init();   <span class="comment">// </span></span><br><span class="line">    console_init();<span class="comment">// </span></span><br><span class="line">    tss_init();    <span class="comment">// tss</span></span><br><span class="line">    syscall_init();<span class="comment">// </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> print  0xd  write </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">kernel_main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    init_all();</span><br><span class="line">    process_execute(u_prog_a,<span class="string">&quot;proa&quot;</span>);</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Hi,man\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">u_prog_a</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">        write(<span class="string">&quot;hello\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div id="dplayer3" class="dplayer hexo-tag-dplayer-mark" style="margin-bottom: 20px;"></div><script>(function(){var player = new DPlayer({"container":document.getElementById("dplayer3"),"theme":"#FADFA3","lang":"zh-cn//","screenshot":true,"hotkey":true,"preload":"auto","volume":0.9,"video":{"url":"/2022/video/protalk.mp4","pic":"/2022/image/1.jpg"},"danmaku":{"id":"9E2E3368B56CD123BB4","api":"https://api.prprpr.me/dplayer/","token":"tokendemo","maximum":1000,"addition":["['https://api.prprpr.me/dplayer/v3/bilibili?aid=4157142']"]}});window.dplayers||(window.dplayers=[]);window.dplayers.push(player);})()</script><h3 id="font-color-red--font"><font color='red'></font></h3><p><a href="https://jyx-fyh.github.io/2022/11/26/%E7%89%B9%E6%9D%83%E7%BA%A7%E5%85%A8%E9%9D%A2%E5%89%96%E6%9E%90/"></a> ss  esp 0 esp  ss  esp <a href="https://jyx-fyh.github.io/2022/11/21/%E5%8A%A0%E5%85%A5%E4%B8%AD%E6%96%AD/"></a><br><img src="/2022/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE36-1673590654821-2.png" alt=""><br></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">syscall_handler:</span><br><span class="line">;1 </span><br><span class="line">   push 0               ; 0, </span><br><span class="line">   push ds</span><br><span class="line">   push es</span><br><span class="line">   push fs</span><br><span class="line">   push gs</span><br><span class="line">   pushad               ; PUSHAD32:</span><br><span class="line">                        ; EAX,ECX,EDX,EBX,ESP,EBP,ESI,EDI</span><br><span class="line">   push 0x80            ; 0x80</span><br><span class="line"></span><br><span class="line">;2 esp</span><br><span class="line">   mov ebx,[esp+4+48+4+12]</span><br><span class="line">;3 </span><br><span class="line">   push dword [ebx+12]  ; 3</span><br><span class="line">   push dword [ebx+8]   ; 2</span><br><span class="line">   push dword [ebx+4]   ; 1</span><br><span class="line">   mov eax,[ebx]        ; </span><br><span class="line">;4 </span><br><span class="line">   call [syscall_table + eax*4]    ; C</span><br><span class="line">   add esp, 12                      ; </span><br><span class="line">;5 calleax</span><br><span class="line">   mov [esp + 8*4], eax</span><br><span class="line">   jmp intr_exit                    ; intr_exit,</span><br></pre></td></tr></table></figure><h3 id="font-color-red--font"><font color='red'></font></h3><p> API </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">uint32_t</span> <span class="title function_">write</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* str)</span></span><br><span class="line">&#123;</span><br><span class="line">    callno_ret = SYS_WRITE</span><br><span class="line">    arg1 = _arg1;</span><br><span class="line">    <span class="keyword">asm</span>(<span class="string">&quot;mov eax,callno_ret&quot;</span>);</span><br><span class="line">    <span class="keyword">asm</span>(<span class="string">&quot;mov ebx,arg1&quot;</span>);</span><br><span class="line">    <span class="keyword">asm</span>(<span class="string">&quot;int 0x80&quot;</span>);</span><br><span class="line">    <span class="keyword">asm</span>(<span class="string">&quot;mov callno_ret,eax&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> callno_ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> syscallX  syscall syscall3</p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>printf-shortlong long</title>
      <link href="/2023/01/10/printf%E5%8A%A0%E5%BC%BA%E7%89%88/"/>
      <url>/2023/01/10/printf%E5%8A%A0%E5%BC%BA%E7%89%88/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p><a href="https://jyx-fyh.github.io/2023/01/07/printf%E5%BA%95%E5%B1%82%E5%89%96%E6%9E%90%E5%8F%8A%E5%AE%9E%E7%8E%B0/">printf </a><br><a href="https://zhuanlan.zhihu.com/p/112361959">x8664 - </a> <a href="https://blog.csdn.net/kjlist2017/article/details/104113265"></a><br><code>printk-enhanced</code></p></blockquote><p> Linux 0.11  printk  short  int  long long <code>%hd</code>  <code>%lld</code> <br> short  long long Bochs  <strong>32  x86  64 </strong> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">long</span> <span class="type">long</span> a = <span class="number">10</span>;</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> b = <span class="number">2</span>;</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> c = a / b;</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> d = a % c;</span><br></pre></td></tr></table></figure><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">undefined reference to `__divdi3&#x27;</span><br><span class="line">undefined reference to `__moddi3&#x27;</span><br></pre></td></tr></table></figure><p><strong><code>__divdi3</code>  <code>__moddi3</code>  gcc  64 </strong>  64 </p><p> bug <a href="https://zhuanlan.zhihu.com/p/112361959"></a></p><p><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><msup><mn>2</mn><mn>32</mn></msup><mo></mo><mi>H</mi><mo>+</mo><mi>L</mi></mrow><annotation encoding="application/x-tex">x=2^{32}H+L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">32</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></strong></p><p> H  64  x  32 L  32 <br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi mathvariant="normal">/</mi><mi>y</mi><mo>=</mo><mo stretchy="false">(</mo><msup><mn>2</mn><mn>32</mn></msup><mo></mo><mi>H</mi><mo>+</mo><mi>L</mi><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>y</mi><mo>=</mo><msup><mn>2</mn><mn>32</mn></msup><mo></mo><mi>H</mi><mi mathvariant="normal">/</mi><mi>y</mi><mo>+</mo><mi>L</mi><mi mathvariant="normal">/</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">x/y=(2^{32}H+L)/y=2^{32}H/y+L/y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">32</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">32</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span><br> y  32  y  base 2~32 <br> 64  32 </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">61</span>/<span class="number">8</span>=(<span class="number">29</span>+<span class="number">32</span>)/<span class="number">8</span>=<span class="number">29</span>/<span class="number">8</span>+<span class="number">32</span>/<span class="number">8</span>=<span class="number">3</span>+<span class="number">4</span>=<span class="number">7</span>  <span class="comment">//,:</span></span><br><span class="line"><span class="number">61</span>/<span class="number">8</span>=(<span class="number">31</span>+<span class="number">31</span>)/<span class="number">8</span>=<span class="number">31</span>/<span class="number">8</span>+<span class="number">31</span>/<span class="number">8</span>=<span class="number">3</span>+<span class="number">3</span>=<span class="number">6</span>  <span class="comment">//</span></span><br></pre></td></tr></table></figure><p> 81016printf</p><p><font color='orange'><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>=</mo><mo stretchy="false">(</mo><msup><mn>2</mn><mn>32</mn></msup><mo></mo><mi>H</mi><mo>+</mo><mi>L</mi><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><msup><mn>2</mn><mn>3</mn></msup><mo>=</mo><msup><mn>2</mn><mrow><mn>32</mn><mo></mo><mn>3</mn></mrow></msup><mo></mo><mi>H</mi><mo>+</mo><mi>L</mi><mi mathvariant="normal">/</mi><mn>8</mn><mo>=</mo><msup><mn>2</mn><mn>29</mn></msup><mo></mo><mi>H</mi><mo>+</mo><mi>L</mi><mi mathvariant="normal">/</mi><mn>8</mn></mrow><annotation encoding="application/x-tex">x/8=(2^{32}H+L)/2^{3}=2^{32-3}H+L/8=2^{29}H+L/8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mord">/8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">32</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mclose">)</span><span class="mord">/</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">32</span><span class="mbin mtight"></span><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mord">/8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">29</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mord">/8</span></span></span></span></font><br><font color='orange'><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi mathvariant="normal">/</mi><mn>16</mn><mo>=</mo><mo stretchy="false">(</mo><msup><mn>2</mn><mn>32</mn></msup><mo></mo><mi>H</mi><mo>+</mo><mi>L</mi><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><msup><mn>2</mn><mn>4</mn></msup><mo>=</mo><msup><mn>2</mn><mrow><mn>32</mn><mo></mo><mn>4</mn></mrow></msup><mo></mo><mi>H</mi><mo>+</mo><mi>L</mi><mi mathvariant="normal">/</mi><mn>16</mn><mo>=</mo><msup><mn>2</mn><mn>28</mn></msup><mo></mo><mi>H</mi><mo>+</mo><mi>L</mi><mi mathvariant="normal">/</mi><mn>16</mn></mrow><annotation encoding="application/x-tex">x/16=(2^{32}H+L)/2^4=2^{32-4}H+L/16=2^{28}H+L/16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mord">/16</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">32</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mclose">)</span><span class="mord">/</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">32</span><span class="mbin mtight"></span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mord">/16</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">28</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mord">/16</span></span></span></span></font><br> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi mathvariant="normal">/</mi><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">L/base</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mord">/</span><span class="mord mathnormal">ba</span><span class="mord mathnormal">se</span></span></span></span> </p><p> 64 <br><u><strong><font color='orange'> (a%b)  b  2^n  a &amp; (b - 1)</font></strong></u></p><blockquote><p> b  2^n ,a/b a  n  n  a%b </p></blockquote><p> 2  10  2 <a href="https://zhuanlan.zhihu.com/p/112361959">x8664 - </a></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> is_digit(c)((c) &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; (c) &lt;= <span class="string">&#x27;9&#x27;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> <span class="title function_">skip_atoi</span><span class="params">(<span class="type">const</span> <span class="type">char</span> **fmtp)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (is_digit(**fmtp))</span><br><span class="line">        i = i*<span class="number">10</span> + *((*fmtp)++) - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ZEROPAD1<span class="comment">/* pad with zero */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SIGN2<span class="comment">/* unsigned/signed long */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLUS4<span class="comment">/* show plus */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SPACE8<span class="comment">/* space if plus */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LEFT16<span class="comment">/* left justified */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SPECIAL32<span class="comment">/* 0x */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SMALL64<span class="comment">/* use &#x27;abcdef&#x27; instead of &#x27;ABCDEF&#x27; */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LONG    128     <span class="comment">//if long long</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> <span class="title function_">do_div_10</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span>* n)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> t = *n % <span class="number">10</span>;</span><br><span class="line">    *n = *n / <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">return</span> t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> <span class="title function_">do_div_16_8</span><span class="params">(<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> *n, <span class="type">int</span> base)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> t = base==<span class="number">16</span>?<span class="number">28</span>:<span class="number">29</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> low = *n;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> hign= (*n)&gt;&gt;<span class="number">32</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> mod = ((*n)&amp;(base==<span class="number">16</span>?<span class="number">15</span>:<span class="number">7</span>)); <span class="comment">//a &amp; (base - 1)</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> tmp = (<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span>)(<span class="number">1</span>&lt;&lt;t) * hign + low / base;</span><br><span class="line">    *n = tmp;</span><br><span class="line">    <span class="keyword">return</span> mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">static</span> <span class="type">char</span> * <span class="title function_">number</span><span class="params">(<span class="type">char</span> * str, <span class="type">long</span> <span class="type">long</span> num, <span class="type">int</span> base, <span class="type">int</span> size, <span class="type">int</span> precision,<span class="type">int</span> type)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> c,sign,tmp[<span class="number">36</span>];</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *digits=<span class="string">&quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span>;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="keyword">if</span> (type&amp;SMALL) digits=<span class="string">&quot;0123456789abcdefghijklmnopqrstuvwxyz&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (type&amp;LEFT) type &amp;= ~ZEROPAD;</span><br><span class="line">    <span class="keyword">if</span> (base&lt;<span class="number">2</span> || base&gt;<span class="number">36</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    c = (type &amp; ZEROPAD) ? <span class="string">&#x27;0&#x27;</span> : <span class="string">&#x27; &#x27;</span> ;</span><br><span class="line">    <span class="keyword">if</span> (type&amp;SIGN &amp;&amp; num&lt;<span class="number">0</span>) </span><br><span class="line">    &#123;</span><br><span class="line">        sign=<span class="string">&#x27;-&#x27;</span>;</span><br><span class="line">        num = -num;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        sign=(type&amp;PLUS) ? <span class="string">&#x27;+&#x27;</span> : ((type&amp;SPACE) ? <span class="string">&#x27; &#x27;</span> : <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (sign) size--;</span><br><span class="line">    <span class="keyword">if</span> (type&amp;SPECIAL) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (base==<span class="number">16</span>) size -= <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (base==<span class="number">8</span>)</span><br><span class="line">            size--;</span><br><span class="line">    &#125;</span><br><span class="line">    i=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (num==<span class="number">0</span>)</span><br><span class="line">        tmp[i++]=<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span>(base==<span class="number">16</span> || base==<span class="number">8</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!(type&amp;LONG))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> *p = &amp;num;</span><br><span class="line">            *(++p) = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (num!=<span class="number">0</span>)</span><br><span class="line">            tmp[i++]=digits[do_div_16_8(&amp;num,base)];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(base==<span class="number">10</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!(type&amp;LONG))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">while</span> (num != <span class="number">0</span>)</span><br><span class="line">                tmp[i++] = digits[do_div_10(&amp;num)];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">unsigned</span> <span class="type">int</span> low = num;</span><br><span class="line">            <span class="type">unsigned</span> <span class="type">int</span> hign= num&gt;&gt;<span class="number">32</span>;</span><br><span class="line">            <span class="keyword">while</span>(low&gt;<span class="number">0</span>) </span><br><span class="line">            &#123;</span><br><span class="line">                tmp[i++] = ((hign % <span class="number">10</span>) * <span class="number">6</span> + low % <span class="number">10</span>) % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">                low = <span class="number">429496729</span> * (hign % <span class="number">10</span>) + low / <span class="number">10</span> + ((hign % <span class="number">10</span>) * <span class="number">6</span> + low % <span class="number">10</span>) / <span class="number">10</span>;</span><br><span class="line">                hign = hign / <span class="number">10</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (i&gt;precision) </span><br><span class="line">        precision=i;</span><br><span class="line">    size -= precision;</span><br><span class="line">    <span class="keyword">if</span> (!(type&amp;(ZEROPAD+LEFT)))</span><br><span class="line">        <span class="keyword">while</span>(size--&gt;<span class="number">0</span>)</span><br><span class="line">            *str++ = <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span> (sign)</span><br><span class="line">        *str++ = sign;</span><br><span class="line">    <span class="keyword">if</span> (type&amp;SPECIAL) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (base==<span class="number">8</span>)</span><br><span class="line">            *str++ = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (base==<span class="number">16</span>) </span><br><span class="line">        &#123;</span><br><span class="line">            *str++ = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">            *str++ = digits[<span class="number">33</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!(type&amp;LEFT))</span><br><span class="line">        <span class="keyword">while</span>(size--&gt;<span class="number">0</span>)</span><br><span class="line">            *str++ = c;</span><br><span class="line">    <span class="keyword">while</span>(i&lt;precision--)</span><br><span class="line">        *str++ = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">    <span class="keyword">while</span>(i--&gt;<span class="number">0</span>)</span><br><span class="line">        *str++ = tmp[i];</span><br><span class="line">    <span class="keyword">while</span>(size--&gt;<span class="number">0</span>)</span><br><span class="line">        *str++ = <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">vsprintf</span><span class="params">(<span class="type">char</span> *buf, <span class="type">const</span> <span class="type">char</span> *fmt, va_list args)</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> len;</span><br><span class="line">    <span class="type">char</span> * str;</span><br><span class="line">    <span class="type">char</span> *s;</span><br><span class="line">    <span class="type">int</span> *ip;</span><br><span class="line">    <span class="type">int</span> flags;<span class="comment">/* flags to number() */</span></span><br><span class="line">    <span class="type">int</span> field_width;<span class="comment">/* width of output field */</span></span><br><span class="line">    <span class="type">int</span> precision;<span class="comment">/* min. # of digits for integers; max number of chars for from string */</span></span><br><span class="line">    <span class="type">int</span> qualifier;<span class="comment">/* &#x27;h&#x27;, &#x27;l&#x27;, or &#x27;L&#x27; for integer fields */</span></span><br><span class="line">    <span class="keyword">for</span> (str=buf ; *fmt ; ++fmt)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (*fmt != <span class="string">&#x27;%&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            *str++ = *fmt;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* process flags */</span></span><br><span class="line">        flags = <span class="number">0</span>;</span><br><span class="line">        repeat:</span><br><span class="line">        ++fmt;<span class="comment">/* this also skips first &#x27;%&#x27; */</span></span><br><span class="line">        <span class="keyword">switch</span> (*fmt) </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;-&#x27;</span>: flags |= LEFT; <span class="keyword">goto</span> repeat;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;+&#x27;</span>: flags |= PLUS; <span class="keyword">goto</span> repeat;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27; &#x27;</span>: flags |= SPACE; <span class="keyword">goto</span> repeat;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;#&#x27;</span>: flags |= SPECIAL; <span class="keyword">goto</span> repeat;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;0&#x27;</span>: flags |= ZEROPAD; <span class="keyword">goto</span> repeat;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* get field width */</span></span><br><span class="line">        field_width = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">if</span> (is_digit(*fmt))</span><br><span class="line">            field_width = skip_atoi(&amp;fmt);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (*fmt == <span class="string">&#x27;*&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            ++fmt;</span><br><span class="line">            <span class="comment">/* it&#x27;s the next argument */</span></span><br><span class="line">            field_width = va_arg(args, <span class="type">int</span>);</span><br><span class="line">            <span class="keyword">if</span> (field_width &lt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                field_width = -field_width;</span><br><span class="line">                flags |= LEFT;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/* get the precision */</span></span><br><span class="line">        precision = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">if</span> (*fmt == <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            ++fmt;</span><br><span class="line">            <span class="keyword">if</span> (is_digit(*fmt))</span><br><span class="line">                precision = skip_atoi(&amp;fmt);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (*fmt == <span class="string">&#x27;*&#x27;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                ++fmt;</span><br><span class="line">                <span class="comment">/* it&#x27;s the next argument */</span></span><br><span class="line">                precision = va_arg(args, <span class="type">int</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (precision &lt; <span class="number">0</span>)</span><br><span class="line">                precision = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* get the conversion qualifier */</span></span><br><span class="line">        qualifier = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">if</span> (*fmt == <span class="string">&#x27;h&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            qualifier = *fmt;</span><br><span class="line">            ++fmt;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(*fmt == <span class="string">&#x27;l&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            qualifier = *fmt;</span><br><span class="line">            fmt++;</span><br><span class="line">            <span class="keyword">if</span>(*fmt == <span class="string">&#x27;l&#x27;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                qualifier = <span class="string">&#x27;m&#x27;</span>;</span><br><span class="line">                flags |= LONG;</span><br><span class="line">                fmt++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> (*fmt) </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;c&#x27;</span>:</span><br><span class="line">                <span class="keyword">if</span> (!(flags &amp; LEFT))</span><br><span class="line">                    <span class="keyword">while</span> (--field_width &gt; <span class="number">0</span>)</span><br><span class="line">                        *str++ = <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">                *str++ = (<span class="type">unsigned</span> <span class="type">char</span>) va_arg(args, <span class="type">int</span>);</span><br><span class="line">                <span class="keyword">while</span> (--field_width &gt; <span class="number">0</span>)</span><br><span class="line">                    *str++ = <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;s&#x27;</span>:</span><br><span class="line">                s = va_arg(args, <span class="type">char</span> *);</span><br><span class="line">                len = <span class="built_in">strlen</span>(s);</span><br><span class="line">                <span class="keyword">if</span> (precision &lt; <span class="number">0</span>)</span><br><span class="line">                    precision = len;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (len &gt; precision)</span><br><span class="line">                    len = precision;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (!(flags &amp; LEFT))</span><br><span class="line">                    <span class="keyword">while</span> (len &lt; field_width--)</span><br><span class="line">                        *str++ = <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">                    *str++ = *s++;</span><br><span class="line">                <span class="keyword">while</span> (len &lt; field_width--)</span><br><span class="line">                    *str++ = <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;o&#x27;</span>:</span><br><span class="line">                <span class="keyword">if</span>(qualifier==<span class="string">&#x27;h&#x27;</span>)</span><br><span class="line">                    str = number(str, va_arg(args, <span class="type">unsigned</span> <span class="type">short</span>), <span class="number">8</span>, field_width, precision, flags);</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(qualifier==<span class="string">&#x27;l&#x27;</span>)</span><br><span class="line">                    str = number(str, va_arg(args, <span class="type">unsigned</span> <span class="type">long</span>), <span class="number">8</span>, field_width, precision, flags);</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(qualifier==<span class="string">&#x27;m&#x27;</span>)</span><br><span class="line">                    str = number(str, va_arg(args, <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span>), <span class="number">8</span>, field_width, precision, flags);</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    str = number(str, va_arg(args, <span class="type">unsigned</span> <span class="type">int</span>), <span class="number">8</span>, field_width, precision, flags);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;p&#x27;</span>:</span><br><span class="line">                <span class="keyword">if</span> (field_width == <span class="number">-1</span>) </span><br><span class="line">                &#123;</span><br><span class="line">                    field_width = <span class="number">8</span>;</span><br><span class="line">                    flags |= ZEROPAD;</span><br><span class="line">                &#125;</span><br><span class="line">                str = number(str,(<span class="type">unsigned</span> <span class="type">long</span>) va_arg(args, <span class="type">void</span> *), <span class="number">16</span>,field_width, precision, flags);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;x&#x27;</span>:</span><br><span class="line">                flags |= SMALL;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;X&#x27;</span>:</span><br><span class="line">                <span class="keyword">if</span>(qualifier==<span class="string">&#x27;h&#x27;</span>)</span><br><span class="line">                    str = number(str, va_arg(args, <span class="type">unsigned</span> <span class="type">short</span>), <span class="number">16</span>, field_width, precision, flags);</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(qualifier==<span class="string">&#x27;l&#x27;</span>)</span><br><span class="line">                    str = number(str, va_arg(args, <span class="type">unsigned</span> <span class="type">long</span>), <span class="number">16</span>, field_width, precision, flags);</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(qualifier==<span class="string">&#x27;m&#x27;</span>)<span class="comment">// %llx</span></span><br><span class="line">                    str = number(str, va_arg(args, <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span>), <span class="number">16</span>, field_width, precision, flags);</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    str = number(str, va_arg(args, <span class="type">unsigned</span> <span class="type">int</span>), <span class="number">16</span>, field_width, precision, flags);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;d&#x27;</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;i&#x27;</span>:</span><br><span class="line">                flags |= SIGN;</span><br><span class="line">                <span class="keyword">if</span>(qualifier==<span class="string">&#x27;h&#x27;</span>)</span><br><span class="line">                    str = number(str, va_arg(args, <span class="type">short</span>), <span class="number">10</span>, field_width, precision, flags);</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(qualifier==<span class="string">&#x27;l&#x27;</span>)</span><br><span class="line">                    str = number(str, va_arg(args, <span class="type">long</span>), <span class="number">10</span>, field_width, precision, flags);</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(qualifier==<span class="string">&#x27;m&#x27;</span>)</span><br><span class="line">                    str = number(str, va_arg(args, <span class="type">long</span> <span class="type">long</span>), <span class="number">10</span>, field_width, precision, flags);</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    str = number(str, va_arg(args, <span class="type">int</span>), <span class="number">10</span>, field_width, precision, flags);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;u&#x27;</span>:</span><br><span class="line">                <span class="keyword">if</span>(qualifier==<span class="string">&#x27;h&#x27;</span>)</span><br><span class="line">                    str = number(str, va_arg(args, <span class="type">unsigned</span> <span class="type">short</span>), <span class="number">10</span>, field_width, precision, flags);</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(qualifier==<span class="string">&#x27;l&#x27;</span>)</span><br><span class="line">                    str = number(str, va_arg(args, <span class="type">unsigned</span> <span class="type">long</span>), <span class="number">10</span>, field_width, precision, flags);</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(qualifier==<span class="string">&#x27;m&#x27;</span>)</span><br><span class="line">                    str = number(str, va_arg(args, <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span>), <span class="number">10</span>, field_width, precision, flags);</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    str = number(str, va_arg(args, <span class="type">unsigned</span> <span class="type">int</span>), <span class="number">10</span>, field_width, precision, flags);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;n&#x27;</span>:</span><br><span class="line">                ip = va_arg(args, <span class="type">int</span> *);</span><br><span class="line">                *ip = (str - buf);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">if</span> (*fmt != <span class="string">&#x27;%&#x27;</span>)</span><br><span class="line">                    *str++ = <span class="string">&#x27;%&#x27;</span>;</span><br><span class="line">                <span class="keyword">if</span> (*fmt)</span><br><span class="line">                    *str++ = *fmt;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    --fmt;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    *str = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> str-buf;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>do_div_16_8  16  8 </p></li><li><p> do_div_10  do_div do_div_10  32 </p></li><li><p>86~88  64  10 </p></li><li><p> 198  long long  qualifier  m switch </p></li><li><p> 199  long long  LONG  flag  8  16  long long 67~68  num  4  4  16  8  32  1 number  number  num  long long 32  32  -1  <code>0XFFFFFFFF</code>  <code>0xFFFFFFFFFFFFFFFF</code> <code>printf(&quot;%x&quot;,-1)</code>  <code>0xFFFFFFFFFFFFFFFF</code>  8  F  32  32 </p><blockquote><p>[CSAPP][<a href="https://jyx-fyh.github.io/2022/07/08/CSAPP/">https://jyx-fyh.github.io/2022/07/08/CSAPP/</a>] <strong></strong></p></blockquote></li></ul><p><br><img src="/2022/img/image-20230111102501588.png" alt=""><br></p>]]></content>
      
      
      <categories>
          
          <category> C </category>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>printf</title>
      <link href="/2023/01/07/printf%E5%BA%95%E5%B1%82%E5%89%96%E6%9E%90%E5%8F%8A%E5%AE%9E%E7%8E%B0/"/>
      <url>/2023/01/07/printf%E5%BA%95%E5%B1%82%E5%89%96%E6%9E%90%E5%8F%8A%E5%AE%9E%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p><a href="https://jyx-fyh.github.io/2022/06/19/%E5%8F%AF%E5%8F%98%E9%95%BF%E5%8F%82%E6%95%B0%E5%88%97%E8%A1%A8/"></a><a href="https://jyx-fyh.github.io/2022/10/27/%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E7%BA%A6%E5%AE%9A/"></a><br><a href="https://book.douban.com/subject/3422332/">495C</a><a href="https://book.douban.com/subject/1231236/">Linux</a><a href="https://www.runoob.com/cprogramming/c-function-printf.html">printf-</a><br><code>printk</code></p></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><p> C  Hello World </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;hello world!&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> <code>printf</code>  <code>printf</code>  C  C  <code>printf</code>  <code>%d</code><code>%s</code><code>%c</code><code>%x</code>  <code>printf</code>  <code>printf</code>  <code>printf</code> </p><p> <code>printf</code> </p><ul><li><strong><font color='gree'></font></strong></li><li><strong><font color='gree'></font></strong></li><li><strong><font color='gree'></font></strong></li><li><strong><font color='gree'></font></strong></li><li><strong><font color='gree'>printf</font></strong></li></ul><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong><font color='orange'></font></strong> <strong><font color='orange'>char  short  intfloat  double</font></strong> <br><code>%f</code>  float<code>%lf</code>  double <code>%f</code>  float  double  <code>%lf</code>  double printf <br><img src="/2022/img/image-20230108145958396.png" alt=""></p><blockquote><p></p></blockquote><p> char/short  int <strong><u> int </u></strong> </p><blockquote><p> <code>printf</code> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">printf</span><span class="params">(<span class="type">const</span> <span class="type">char</span> * fmt, ...)</span></span><br></pre></td></tr></table></figure><p><code>...</code> <code>printf</code>  <code>f</code>  <code>format</code> </p></blockquote><p></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">test</span><span class="params">(<span class="type">int</span> a, <span class="type">short</span> b, <span class="type">char</span> c)</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> a = <span class="number">1</span>;</span><br><span class="line">    <span class="type">short</span> b = <span class="number">2</span>;</span><br><span class="line">    <span class="type">char</span> c = <span class="number">3</span>;</span><br><span class="line">    test(a,b,c);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">test</span><span class="params">(<span class="type">int</span> a, <span class="type">short</span> b, <span class="type">char</span> c)</span></span><br><span class="line">&#123;</span><br><span class="line">    a=<span class="number">10</span>,b=<span class="number">11</span>,c=<span class="number">12</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">00000000 &lt;main&gt;:</span><br><span class="line">   0:   8d 4c 24 04             lea    ecx,[esp+0x4]</span><br><span class="line">   4:   83 e4 f0                and    esp,0xfffffff0</span><br><span class="line">   7:   ff 71 fc                push   DWORD PTR [ecx-0x4]</span><br><span class="line">   a:   55                      push   ebp</span><br><span class="line">   b:   89 e5                   mov    ebp,esp</span><br><span class="line">   d:   51                      push   ecx</span><br><span class="line">   e:   83 ec 14                sub    esp,0x14</span><br><span class="line">  11:   c7 45 f4 01 00 00 00    mov    DWORD PTR [ebp-0xc],0x1</span><br><span class="line">  18:   66 c7 45 f2 02 00       mov    WORD PTR [ebp-0xe],0x2</span><br><span class="line">  1e:   c6 45 f1 03             mov    BYTE PTR [ebp-0xf],0x3</span><br><span class="line">  22:   0f be 55 f1             movsx  edx,BYTE PTR [ebp-0xf]</span><br><span class="line">  26:   0f bf 45 f2             movsx  eax,WORD PTR [ebp-0xe]</span><br><span class="line">  2a:   83 ec 04                sub    esp,0x4</span><br><span class="line">  2d:   52                      push   edx</span><br><span class="line">  2e:   50                      push   eax</span><br><span class="line">  2f:   ff 75 f4                push   DWORD PTR [ebp-0xc]</span><br><span class="line">  32:   e8 fc ff ff ff          call   33 &lt;main+0x33&gt;</span><br><span class="line">  37:   83 c4 10                add    esp,0x10</span><br><span class="line">  3a:   b8 00 00 00 00          mov    eax,0x0</span><br><span class="line">  3f:   8b 4d fc                mov    ecx,DWORD PTR [ebp-0x4]</span><br><span class="line">  42:   c9                      leave  </span><br><span class="line">  43:   8d 61 fc                lea    esp,[ecx-0x4]</span><br><span class="line">  46:   c3                      ret    </span><br><span class="line"></span><br><span class="line">00000047 &lt;test&gt;:</span><br><span class="line">  47:   55                      push   ebp</span><br><span class="line">  48:   89 e5                   mov    ebp,esp</span><br><span class="line">  4a:   83 ec 08                sub    esp,0x8</span><br><span class="line">  4d:   8b 55 0c                mov    edx,DWORD PTR [ebp+0xc]</span><br><span class="line">  50:   8b 45 10                mov    eax,DWORD PTR [ebp+0x10]</span><br><span class="line">  53:   66 89 55 fc             mov    WORD PTR [ebp-0x4],dx</span><br><span class="line">  57:   88 45 f8                mov    BYTE PTR [ebp-0x8],al</span><br><span class="line">  5a:   c7 45 08 0a 00 00 00    mov    DWORD PTR [ebp+0x8],0xa</span><br><span class="line">  61:   66 c7 45 fc 0b 00       mov    WORD PTR [ebp-0x4],0xb</span><br><span class="line">  67:   c6 45 f8 0c             mov    BYTE PTR [ebp-0x8],0xc</span><br><span class="line">  6b:   90                      nop</span><br><span class="line">  6c:   c9                      leave  </span><br><span class="line">  6d:   c3                      ret  </span><br></pre></td></tr></table></figure><p> 34~36 intshortchar  DWORDWORDBYTE </p><blockquote><p> char  <code>push BYTE PTR [xxx]</code> <strong><font color='orange'> charshortint  longlong long 4  long long 8 </font></strong>  15~17 </p></blockquote><p> <code>printf</code> </p><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong></strong> <br><img src="/2022/img/image-20230108153040201.png" alt=""></p><p><br><img src="/2022/img/image-20230108153229945.png" alt=""><br></p><h3 id="font-color-red--font"><font color='red'></font></h3><p><a href="https://jyx-fyh.github.io/2022/10/27/%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E7%BA%A6%E5%AE%9A/"></a><strong><u></u></strong></p><ol><li><p><strong><font color='orange'></font></strong></p><blockquote><p>  <code>fmt...</code>  <code>printf (% s % s,str1 ,str2)</code>  <code>%s</code> <code>fmt...</code>  esp  <code>fmt...</code> <code>fmt...</code> </p></blockquote></li><li><p><strong><font color='orange'></font></strong></p><blockquote><p> <code>printf</code> <code>printf</code>  <code>printf</code>  <code>printf</code>  <code>printf</code> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    printf(&quot;%d  %c&quot;, 1, 2);</span><br><span class="line">&#125;</span><br><span class="line">//</span><br><span class="line">//......</span><br><span class="line">00BF17E1  push        2  </span><br><span class="line">00BF17E3  push        1  </span><br><span class="line">00BF17E5  push        offset string &quot;%d\n&quot; (0BF7BD8h)  </span><br><span class="line">00BF17EA  call        _printf  </span><br><span class="line">00BF17EF  add         esp,0Ch  </span><br><span class="line">//......</span><br></pre></td></tr></table></figure><p>call  push  add esp,0xC  printf  push </p></blockquote></li></ol><p> __cdel __cdel  C/C++ <br> <code>fmt...</code> </p><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong><mark class="hl-label blue">%</mark> </strong><br></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%%&quot;</span>);</span><br></pre></td></tr></table></figure><p> <code>%</code>  <code>\</code>  <code>printf(&quot;\%&quot;)</code> <code>\n</code>  ASCII 10 <code>\n</code>  10  <code>\%</code>  <code>%</code> </p><p><strong><mark class="hl-label blue">printf</mark> </strong><br> printf </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,<span class="number">110</span>);</span><br></pre></td></tr></table></figure><p><code>110</code> <code>110</code>  int <code>%d</code> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,<span class="number">110</span>);</span><br></pre></td></tr></table></figure><p><br><img src="/2022/img/image-20230110115919374.png" alt=""><br> <code>110</code>  int4) printf  <code>%lld</code>  <code>110</code>  long long8) long long*  <code>110</code>  <code>110</code> <br><img src="/2022/img/image-20230110130458876.png" alt=""><br> <code>0xfffffffff</code>  int  long long</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,(<span class="type">long</span> <span class="type">long</span>)<span class="number">110</span>);</span><br></pre></td></tr></table></figure><p> printf </p><h3 id="font-color-red-printf-font"><font color='red'>printf</font></h3><blockquote><p><strong></strong></p><ul><li> Linux 0.11  Linus Torvalds  Linux  printf </li><li>printkprint kernel printf </li><li> printk  printf  printf </li></ul></blockquote><p> <code>printk</code> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">char</span> buf[<span class="number">1024</span>];</span><br><span class="line"><span class="type">int</span> <span class="title function_">printk</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *fmt, ...)</span></span><br><span class="line">&#123;</span><br><span class="line">va_list args;</span><br><span class="line"><span class="type">int</span> i;</span><br><span class="line">va_start(args, fmt);</span><br><span class="line">i=<span class="built_in">vsprintf</span>(buf,fmt,args);</span><br><span class="line">va_end(args);</span><br><span class="line">__asm__(<span class="string">&quot;push %%fs\n\t&quot;</span></span><br><span class="line"><span class="string">&quot;push %%ds\n\t&quot;</span></span><br><span class="line"><span class="string">&quot;pop %%fs\n\t&quot;</span></span><br><span class="line"><span class="string">&quot;pushl %0\n\t&quot;</span></span><br><span class="line"><span class="string">&quot;pushl $_buf\n\t&quot;</span></span><br><span class="line"><span class="string">&quot;pushl $0\n\t&quot;</span></span><br><span class="line"><span class="string">&quot;call _tty_write\n\t&quot;</span></span><br><span class="line"><span class="string">&quot;addl $8,%%esp\n\t&quot;</span></span><br><span class="line"><span class="string">&quot;popl %0\n\t&quot;</span></span><br><span class="line"><span class="string">&quot;pop %%fs&quot;</span></span><br><span class="line">::<span class="string">&quot;r&quot;</span> (i):<span class="string">&quot;ax&quot;</span>,<span class="string">&quot;cx&quot;</span>,<span class="string">&quot;dx&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><u> printk  printf </u> <code>printf</code> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">char</span> buf[<span class="number">1024</span>];</span><br><span class="line"><span class="type">int</span> <span class="title function_">printf</span><span class="params">(<span class="type">const</span> <span class="type">char</span> * fmt, ...)</span> </span><br><span class="line">&#123;</span><br><span class="line">    va_list args;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    va_start(args, fmt);</span><br><span class="line">    <span class="built_in">vsprintf</span>(buf, fmt, args);</span><br><span class="line">    va_end(args);</span><br><span class="line">    <span class="type">int</span> i = write(buf);</span><br><span class="line">    <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li> 9  9  write write <strong><font color='orange'> write  printf </font></strong> </li><li><code>printf</code> </li></ul><p> <code>va_list</code> <code>va_start</code> <code>va_end</code>  <code>va_arg</code> </p><p><strong><mark class="hl-label blue"></mark> </strong><br></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="type">char</span>* va_list;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> va_start(p, fmt) (p = (char*)&amp;fmt + sizeof(char*))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> va_end(p)        (p = 0)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> va_arg(p, type)  (p += __va_rounded_size(type), *((type*)(p - __va_rounded_size (type))))</span></span><br></pre></td></tr></table></figure><ul><li><p><em><em><code>va_list</code> <u> char</em> args</u></em>* </p></li><li><p><strong><code>va_start</code> <u> args  <code>...</code> </u></strong> </p><blockquote><p><code>p = (char*)&amp;fmt + sizeof(char*)</code>  p  fmt  fmt <code>&amp;fmt</code>  char* </p></blockquote></li><li><p><strong><code>va_end</code> <u> args  NULL</u></strong> </p></li><li><p><code>va_arg</code>  <code>vsprintf</code> <strong><u><code>va_arg</code>  args  args </u></strong> </p><blockquote><p><code>__va_rounded_size(type)</code> <strong><u> type  int </u></strong>  type  char 4type  long long 8 </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> __va_rounded_size(type)  \</span></span><br><span class="line"><span class="meta">  (((sizeof (type) + sizeof (int) - 1) / sizeof (int)) * sizeof (int))</span></span><br></pre></td></tr></table></figure><p>va_arg <u> A </u> p  B+=p A  long long </p></blockquote></li></ul><p> vsprintf </p><p><strong><mark class="hl-label blue">vsprintf</mark> </strong><br><strong>vsprintf  fmt  buf</strong> <code>fmt</code>  <code>%d</code> <code>%s</code>  printf </p><p> <code>%s</code>  format format </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%[flags][width][.precision][length]specifier</span><br></pre></td></tr></table></figure><p> printf </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%-10ld&quot;</span>);</span><br></pre></td></tr></table></figure><p> <code>-</code>  flags<code>10</code>  width<code>l</code>  <code>d</code>  long<code>d</code>  specifier<br></p><table><thead><tr><th><strong>flags</strong></th><th><strong></strong></th></tr></thead><tbody><tr><td><strong>-</strong></td><td></td></tr><tr><td><strong>+</strong></td><td>+  - +  - </td></tr><tr><td><strong></strong></td><td></td></tr><tr><td><strong>#</strong></td><td> ox  X  00x  0X #  feg </td></tr><tr><td><strong>0</strong></td><td></td></tr></tbody></table><table><thead><tr><th style="text-align:left"><strong>width</strong></th><th style="text-align:left"><strong></strong></th></tr></thead><tbody><tr><td style="text-align:left"><strong>number</strong></td><td style="text-align:left"></td></tr><tr><td style="text-align:left">*</td><td style="text-align:left"> format </td></tr></tbody></table><table><thead><tr><th style="text-align:left">.precision</th><th style="text-align:left"></th></tr></thead><tbody><tr><td style="text-align:left"><strong>.number</strong></td><td style="text-align:left">diouxXprecision  0  <br /> s <br /> c  1</td></tr><tr><td style="text-align:left"><strong>.</strong>*</td><td style="text-align:left"> format </td></tr></tbody></table><table><thead><tr><th style="text-align:left"><strong>length</strong></th><th style="text-align:left"></th></tr></thead><tbody><tr><td style="text-align:left"><strong>h</strong></td><td style="text-align:left"> shortidoux  X</td></tr><tr><td style="text-align:left"><strong>l</strong></td><td style="text-align:left"> longidoux  X c s</td></tr><tr><td style="text-align:left"><strong>L</strong></td><td style="text-align:left">eEfg  G</td></tr><tr><td style="text-align:left"><strong>ll</strong></td><td style="text-align:left">ll  <strong> long long</strong></td></tr></tbody></table><table><thead><tr><th style="text-align:left"></th><th style="text-align:left"></th></tr></thead><tbody><tr><td style="text-align:left">d</td><td style="text-align:left">()</td></tr><tr><td style="text-align:left">i</td><td style="text-align:left"> d </td></tr><tr><td style="text-align:left">o</td><td style="text-align:left">(0)</td></tr><tr><td style="text-align:left">x,X</td><td style="text-align:left">(Ox)</td></tr><tr><td style="text-align:left">u</td><td style="text-align:left"></td></tr><tr><td style="text-align:left">c</td><td style="text-align:left"></td></tr><tr><td style="text-align:left">s</td><td style="text-align:left"></td></tr><tr><td style="text-align:left">p</td><td style="text-align:left"></td></tr><tr><td style="text-align:left">n</td><td style="text-align:left"></td></tr></tbody></table><p><br><img src="/2022/img/image-20230109092042387.png" alt=""><br><img src="/2022/img/image-20230109092442698.png" alt=""><br><img src="/2022/img/image-20230109094520482.png" alt="VS%n Bochs "></p><p> vsprintf  flags --&gt; width --&gt; .precision --&gt; length --&gt; specifier </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//2,flag,</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ZEROPAD1<span class="comment">/* pad with zero */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SIGN2<span class="comment">/* unsigned/signed long */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLUS4<span class="comment">/* show plus */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SPACE8<span class="comment">/* space if plus */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LEFT16<span class="comment">/* left justified */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SPECIAL32<span class="comment">/* 0x */</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SMALL64<span class="comment">/* use &#x27;abcdef&#x27; instead of &#x27;ABCDEF&#x27; */</span></span></span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">vsprintf</span><span class="params">(<span class="type">char</span> *buf, <span class="type">const</span> <span class="type">char</span> *fmt, va_list args)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> len;</span><br><span class="line"><span class="type">int</span> i;</span><br><span class="line"><span class="type">char</span>* str;</span><br><span class="line"><span class="type">char</span>* s;</span><br><span class="line"><span class="type">int</span> *ip;</span><br><span class="line"><span class="type">int</span> flags;          <span class="comment">// flags to number() </span></span><br><span class="line"><span class="type">int</span> field_width;    <span class="comment">// width of output field </span></span><br><span class="line"><span class="type">int</span> precision;      <span class="comment">// min of digits for integers; max number of chars for from string </span></span><br><span class="line"><span class="type">int</span> qualifier;      <span class="comment">// &#x27;h&#x27;, &#x27;l&#x27;, or &#x27;L&#x27; for integer fields </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (str=buf ; *fmt ; ++fmt) </span><br><span class="line">&#123;</span><br><span class="line">        <span class="comment">//format,str</span></span><br><span class="line"><span class="keyword">if</span> (*fmt != <span class="string">&#x27;%&#x27;</span>)</span><br><span class="line">&#123;</span><br><span class="line">*str++ = *fmt;</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line">        </span><br><span class="line"><span class="comment">//flags</span></span><br><span class="line">flags = <span class="number">0</span>;</span><br><span class="line">repeat:</span><br><span class="line">++fmt;</span><br><span class="line"><span class="keyword">switch</span> (*fmt) </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;-&#x27;</span>: flags |= LEFT; <span class="keyword">goto</span> repeat;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;+&#x27;</span>: flags |= PLUS; <span class="keyword">goto</span> repeat;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27; &#x27;</span>: flags |= SPACE; <span class="keyword">goto</span> repeat;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;#&#x27;</span>: flags |= SPECIAL; <span class="keyword">goto</span> repeat;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;0&#x27;</span>: flags |= ZEROPAD; <span class="keyword">goto</span> repeat;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">field_width = <span class="number">-1</span>; <span class="comment">//-1,, flag | -1 = flag</span></span><br><span class="line"><span class="keyword">if</span> (is_digit(*fmt))</span><br><span class="line">field_width = skip_atoi(&amp;fmt); <span class="comment">//skip_atoi,</span></span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (*fmt == <span class="string">&#x27;*&#x27;</span>) </span><br><span class="line">&#123;</span><br><span class="line">fmt++;  <span class="comment">//,bug</span></span><br><span class="line">field_width = va_arg(args, <span class="type">int</span>); <span class="comment">//*,width </span></span><br><span class="line"><span class="keyword">if</span> (field_width &lt; <span class="number">0</span>)  <span class="comment">//0,,&#x27;-&#x27;</span></span><br><span class="line">&#123;</span><br><span class="line">field_width = -field_width;</span><br><span class="line">flags |= LEFT;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">precision = <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">if</span> (*fmt == <span class="string">&#x27;.&#x27;</span>) </span><br><span class="line">&#123;</span><br><span class="line">++fmt;</span><br><span class="line"><span class="keyword">if</span> (is_digit(*fmt))</span><br><span class="line">precision = skip_atoi(&amp;fmt);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (*fmt == <span class="string">&#x27;*&#x27;</span>) </span><br><span class="line">            &#123;</span><br><span class="line">fmt++;  <span class="comment">//,bug</span></span><br><span class="line">precision = va_arg(args, <span class="type">int</span>); <span class="comment">//*,precision </span></span><br><span class="line">            &#125;</span><br><span class="line"><span class="keyword">if</span> (precision &lt; <span class="number">0</span>)</span><br><span class="line">precision = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">qualifier = <span class="number">-1</span>;  </span><br><span class="line"><span class="keyword">if</span> (*fmt == <span class="string">&#x27;h&#x27;</span> || *fmt == <span class="string">&#x27;l&#x27;</span> || *fmt == <span class="string">&#x27;L&#x27;</span>) </span><br><span class="line">&#123;</span><br><span class="line">qualifier = *fmt;  <span class="comment">//,qualifier,</span></span><br><span class="line">++fmt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="keyword">switch</span> (*fmt) </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;c&#x27;</span>:</span><br><span class="line"><span class="keyword">if</span> (!(flags &amp; LEFT)) <span class="comment">//,field_width-1</span></span><br><span class="line"><span class="keyword">while</span> (--field_width &gt; <span class="number">0</span>)</span><br><span class="line">*str++ = <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">*str++ = (<span class="type">unsigned</span> <span class="type">char</span>) va_arg(args, <span class="type">int</span>);</span><br><span class="line"><span class="keyword">while</span> (--field_width &gt; <span class="number">0</span>) <span class="comment">//</span></span><br><span class="line">*str++ = <span class="string">&#x27; &#x27;</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;s&#x27;</span>:</span><br><span class="line">s = va_arg(args, <span class="type">char</span> *);</span><br><span class="line">len = <span class="built_in">strlen</span>(s);</span><br><span class="line"><span class="keyword">if</span> (precision &lt; <span class="number">0</span>)</span><br><span class="line">precision = len;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (len &gt; precision) <span class="comment">//,</span></span><br><span class="line">len = precision;</span><br><span class="line"><span class="keyword">if</span> (!(flags &amp; LEFT))</span><br><span class="line"><span class="keyword">while</span> (len &lt; field_width--)</span><br><span class="line">*str++ = <span class="string">&#x27; &#x27;</span>;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">*str++ = *s++;</span><br><span class="line"><span class="keyword">while</span> (len &lt; field_width--)<span class="comment">//while,</span></span><br><span class="line">*str++ = <span class="string">&#x27; &#x27;</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;o&#x27;</span>:  <span class="comment">//number</span></span><br><span class="line">str = number(str, va_arg(args, <span class="type">unsigned</span> <span class="type">int</span>), <span class="number">8</span>, field_width, precision, flags);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;p&#x27;</span>: <span class="comment">//,8,0</span></span><br><span class="line"><span class="keyword">if</span> (field_width == <span class="number">-1</span>) </span><br><span class="line">&#123;</span><br><span class="line">field_width = <span class="number">8</span>;</span><br><span class="line">flags |= ZEROPAD;</span><br><span class="line">&#125;</span><br><span class="line">str = number(str,(<span class="type">unsigned</span> <span class="type">int</span>)va_arg(args,<span class="type">void</span>*), <span class="number">16</span>, field_width, precision, flags);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;x&#x27;</span>:</span><br><span class="line">flags |= SMALL;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;X&#x27;</span>:</span><br><span class="line">str = number(str, va_arg(args, <span class="type">unsigned</span> <span class="type">int</span>), <span class="number">16</span>, field_width, precision, flags);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;d&#x27;</span>:</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;i&#x27;</span>:</span><br><span class="line">flags |= SIGN;  <span class="comment">//%d%i</span></span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;u&#x27;</span>:</span><br><span class="line">str = number(str, va_arg(args, <span class="type">unsigned</span> <span class="type">int</span>), <span class="number">10</span>, field_width, precision, flags);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;n&#x27;</span>:</span><br><span class="line">ip = va_arg(args, <span class="type">int</span> *);</span><br><span class="line">*ip = (str - buf); <span class="comment">//</span></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//&#x27;%,,%;,</span></span><br><span class="line">        <span class="comment">//,107;,</span></span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line"><span class="keyword">if</span> (*fmt != <span class="string">&#x27;%&#x27;</span>)</span><br><span class="line">*str++ = <span class="string">&#x27;%&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> (*fmt)</span><br><span class="line">*str++ = *fmt;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">--fmt;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">*str = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line"><span class="keyword">return</span> str-buf;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> 90 <code>va_arg(args, int)</code>  int  <strong><u><font color='orange'></font></u></strong>  char  <code>va_arg(args,char)</code>  va_arg args <br><img src="../../public/2022/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE35.png" alt=""></p><p> skip_atoi()  number() </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> is_digit(c)((c) &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; (c) &lt;= <span class="string">&#x27;9&#x27;</span>) <span class="comment">//</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> do_div(n,base) (&#123; \    <span class="comment">// n=n/base,n%base</span></span></span><br><span class="line"><span class="type">int</span> __res; \                   <span class="comment">//,</span></span><br><span class="line">__asm__(<span class="string">&quot;div %4&quot;</span>:<span class="string">&quot;=a&quot;</span> (n),<span class="string">&quot;=d&quot;</span> (__res):<span class="string">&quot;0&quot;</span> (n),<span class="string">&quot;1&quot;</span> (<span class="number">0</span>),<span class="string">&quot;r&quot;</span> (base)); \</span><br><span class="line">__res; &#125;)</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> <span class="title function_">skip_atoi</span><span class="params">(<span class="type">const</span> <span class="type">char</span> **fmtp)</span><span class="comment">//pointer to fmt,fmt,</span></span><br><span class="line">&#123;                                      <span class="comment">//?fmt(,)</span></span><br><span class="line">    <span class="type">int</span> i=<span class="number">0</span>;                           <span class="comment">//fmt,,</span></span><br><span class="line">    <span class="keyword">while</span> (is_digit(**fmtp))</span><br><span class="line">        i = i*<span class="number">10</span> + *((*fmtp)++) - <span class="string">&#x27;0&#x27;</span>; <span class="comment">//(*fmtp)++,fmt++</span></span><br><span class="line">    <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">char</span> * <span class="title function_">number</span><span class="params">(<span class="type">char</span> * str, <span class="type">int</span> num, <span class="type">int</span> base, <span class="type">int</span> size, <span class="type">int</span> precision,<span class="type">int</span> type)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">char</span> c,sign,tmp[<span class="number">36</span>];</span><br><span class="line"><span class="type">const</span> <span class="type">char</span> *digits=<span class="string">&quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span>;</span><br><span class="line"><span class="type">int</span> i;</span><br><span class="line"><span class="keyword">if</span> (type&amp;SMALL) </span><br><span class="line">digits=<span class="string">&quot;0123456789abcdefghijklmnopqrstuvwxyz&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (type&amp;LEFT) </span><br><span class="line">type &amp;= ~ZEROPAD; <span class="comment">//,0</span></span><br><span class="line"><span class="keyword">if</span> (base&lt;<span class="number">2</span> || base&gt;<span class="number">36</span>) <span class="comment">//2~36,</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">c = (type &amp; ZEROPAD) ? <span class="string">&#x27;0&#x27;</span> : <span class="string">&#x27; &#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> (type&amp;SIGN &amp;&amp; num&lt;<span class="number">0</span>) </span><br><span class="line">&#123;</span><br><span class="line">sign=<span class="string">&#x27;-&#x27;</span>;</span><br><span class="line">num = -num; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">sign=(type&amp;PLUS) ? <span class="string">&#x27;+&#x27;</span> : ((type&amp;SPACE) ? <span class="string">&#x27; &#x27;</span> : <span class="number">0</span>);<span class="comment">//+,1</span></span><br><span class="line"><span class="keyword">if</span> (sign)</span><br><span class="line">size--; <span class="comment">//,</span></span><br><span class="line"><span class="keyword">if</span> (type&amp;SPECIAL)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (base==<span class="number">16</span>) </span><br><span class="line">size -= <span class="number">2</span>; <span class="comment">//0x</span></span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (base==<span class="number">8</span>)</span><br><span class="line">size--;    <span class="comment">//0</span></span><br><span class="line">&#125;</span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">i=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (num==<span class="number">0</span>)</span><br><span class="line">tmp[i++]=<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">while</span> (num!=<span class="number">0</span>)</span><br><span class="line">tmp[i++]=digits[ do_div(num,base) ]; <span class="comment">//num,tmp,</span></span><br><span class="line"><span class="keyword">if</span> (i&gt;precision)                     <span class="comment">//,72</span></span><br><span class="line">precision=i; <span class="comment">//,,</span></span><br><span class="line">size -= precision;</span><br><span class="line"><span class="keyword">if</span> (!(type&amp;(ZEROPAD+LEFT)))</span><br><span class="line"><span class="keyword">while</span>(size--&gt;<span class="number">0</span>)</span><br><span class="line">*str++ = <span class="string">&#x27; &#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> (sign)</span><br><span class="line">*str++ = sign;</span><br><span class="line"><span class="keyword">if</span> (type&amp;SPECIAL)</span><br><span class="line"><span class="keyword">if</span> (base==<span class="number">8</span>)</span><br><span class="line">*str++ = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (base==<span class="number">16</span>) </span><br><span class="line">&#123;</span><br><span class="line">*str++ = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">*str++ = digits[<span class="number">33</span>]; <span class="comment">//&#x27;X&#x27;&#x27;x&#x27;,digit</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!(type&amp;LEFT))</span><br><span class="line"><span class="keyword">while</span>(size--&gt;<span class="number">0</span>) <span class="comment">//,0</span></span><br><span class="line">*str++ = c;</span><br><span class="line"><span class="keyword">while</span>(i&lt;precision--)<span class="comment">//,0</span></span><br><span class="line">*str++ = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line"><span class="keyword">while</span>(i--&gt;<span class="number">0</span>)</span><br><span class="line">*str++ = tmp[i];<span class="comment">//i--,str++,</span></span><br><span class="line"><span class="keyword">while</span>(size--&gt;<span class="number">0</span>)</span><br><span class="line">*str++ = <span class="string">&#x27; &#x27;</span>; <span class="comment">//67,</span></span><br><span class="line"><span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><br> printf  <code>%hd</code> (short)<code>%lld</code> (long long) <a href="https://jyx-fyh.github.io/2023/01/10/printf%E5%8A%A0%E5%BC%BA%E7%89%88/">printf</a><br><img src="/2022/img/image-20230110134655302.png" alt=""></p><p></p>]]></content>
      
      
      <categories>
          
          <category> C </category>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>-</title>
      <link href="/2023/01/06/%E5%AE%9E%E7%8E%B0%E7%94%A8%E6%88%B7%E8%BF%9B%E7%A8%8B-%E4%BB%A3%E7%A0%81%E8%AF%A6%E8%A7%A3/"/>
      <url>/2023/01/06/%E5%AE%9E%E7%8E%B0%E7%94%A8%E6%88%B7%E8%BF%9B%E7%A8%8B-%E4%BB%A3%E7%A0%81%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p><a href="https://jyx-fyh.github.io/2022/12/26/%E5%AE%9E%E7%8E%B0%E7%94%A8%E6%88%B7%E8%BF%9B%E7%A8%8B/">-</a><br><code>userprog</code></p></blockquote><h3 id="font-color-red-TSSCGDT-font"><font color='red'>TSSCGDT</font></h3><p> <code>global.h</code> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//global.h</span></span><br><span class="line"><span class="comment">//=============================</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SELECTOR_U_CODE   ((5 &lt;&lt; 3) + (TI_GDT &lt;&lt; 2) + RPL3)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SELECTOR_U_DATA   ((6 &lt;&lt; 3) + (TI_GDT &lt;&lt; 2) + RPL3)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SELECTOR_U_STACK   SELECTOR_U_DATA</span></span><br><span class="line"><span class="comment">// ===============GDT=================</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>DESC_G_4K    1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>DESC_D_32    1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DESC_L     0<span class="comment">// 640</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DESC_AVL     0<span class="comment">// cpu0</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DESC_P     1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DESC_DPL_0   0</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DESC_DPL_1   1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DESC_DPL_2   2</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DESC_DPL_3   3</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DESC_S_CODE1       <span class="comment">// s1</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DESC_S_DATADESC_S_CODE</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DESC_S_SYS0       <span class="comment">// s0.</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DESC_TYPE_CODE8<span class="comment">// x=1,c=0,r=0,a=0 ,,,a0.</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DESC_TYPE_DATA  2<span class="comment">// x=0,e=0,w=1,a=0 ,,,a0.</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DESC_TYPE_TSS   9<span class="comment">// B0,</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GDT_ATTR_HIGH     ((DESC_G_4K &lt;&lt; 7) + (DESC_D_32 &lt;&lt; 6) + (DESC_L &lt;&lt; 5) + (DESC_AVL &lt;&lt; 4))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GDT_CODE_ATTR_LOW_DPL3 ((DESC_P &lt;&lt; 7) + (DESC_DPL_3 &lt;&lt; 5) + (DESC_S_CODE &lt;&lt; 4) + DESC_TYPE_CODE)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GDT_DATA_ATTR_LOW_DPL3 ((DESC_P &lt;&lt; 7) + (DESC_DPL_3 &lt;&lt; 5) + (DESC_S_DATA &lt;&lt; 4) + DESC_TYPE_DATA)</span></span><br><span class="line"><span class="comment">//================ TSS===================</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TSS_DESC_D  0</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TSS_ATTR_HIGH ((DESC_G_4K &lt;&lt; 7) + (TSS_DESC_D &lt;&lt; 6) + (DESC_L &lt;&lt; 5) + (DESC_AVL &lt;&lt; 4) + 0x0)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TSS_ATTR_LOW ((DESC_P &lt;&lt; 7) + (DESC_DPL_0 &lt;&lt; 5) + (DESC_S_SYS &lt;&lt; 4) + DESC_TYPE_TSS)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SELECTOR_TSS ((4 &lt;&lt; 3) + (TI_GDT &lt;&lt; 2 ) + RPL0)</span></span><br><span class="line"><span class="comment">//================ GDT =====================</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">gdt_desc</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">uint16_t</span> limit_low_word;</span><br><span class="line">    <span class="type">uint16_t</span> base_low_word;</span><br><span class="line">    <span class="type">uint8_t</span>  base_mid_byte;</span><br><span class="line">    <span class="type">uint8_t</span>  attr_low_byte;</span><br><span class="line">    <span class="type">uint8_t</span>  limit_high_attr_high;</span><br><span class="line">    <span class="type">uint8_t</span>  base_high_byte;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li> 3~5  5 GDT  5  6 <strong><font color='orange'></font></strong> <strong><font color='orange'><u> 0 EIP  CS</u></font></strong> <br> <code>loader.s</code>  GDT  TSS  <code>loader.s</code> <br><img src="/2022/img/image-20230103153548106.png" style="zoom:100%;" /></li><li> <code>loader.s</code>  GDT  C  GDT GDT  TSS  <code>gdt_struct</code> <a href="https://jyx-fyh.github.io/2022/10/31/%E5%85%A8%E5%B1%80%E6%8F%8F%E8%BF%B0%E7%AC%A6%E8%A1%A8%E6%A6%82%E8%BF%B0/">GDT</a> </li></ul><p> <code>tss.c</code> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">xdt_ptr</span> <span class="title">gdt_operand</span>;</span></span><br><span class="line"><span class="type">static</span> <span class="type">uint16_t</span> tss_slt;</span><br><span class="line"><span class="comment">/* tss */</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">tss</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">uint32_t</span> backlink;</span><br><span class="line">    <span class="type">uint32_t</span>* esp0;</span><br><span class="line">    <span class="type">uint32_t</span> ss0;</span><br><span class="line">    <span class="type">uint32_t</span>* esp1;</span><br><span class="line">    <span class="type">uint32_t</span> ss1;</span><br><span class="line">    <span class="type">uint32_t</span>* esp2;</span><br><span class="line">    <span class="type">uint32_t</span> ss2;</span><br><span class="line">    <span class="type">uint32_t</span> cr3;</span><br><span class="line">    <span class="type">uint32_t</span> (*eip) (<span class="type">void</span>);</span><br><span class="line">    <span class="type">uint32_t</span> eflags;</span><br><span class="line">    <span class="type">uint32_t</span> eax;</span><br><span class="line">    <span class="type">uint32_t</span> ecx;</span><br><span class="line">    <span class="type">uint32_t</span> edx;</span><br><span class="line">    <span class="type">uint32_t</span> ebx;</span><br><span class="line">    <span class="type">uint32_t</span> esp;</span><br><span class="line">    <span class="type">uint32_t</span> ebp;</span><br><span class="line">    <span class="type">uint32_t</span> esi;</span><br><span class="line">    <span class="type">uint32_t</span> edi;</span><br><span class="line">    <span class="type">uint32_t</span> es;</span><br><span class="line">    <span class="type">uint32_t</span> cs;</span><br><span class="line">    <span class="type">uint32_t</span> ss;</span><br><span class="line">    <span class="type">uint32_t</span> ds;</span><br><span class="line">    <span class="type">uint32_t</span> fs;</span><br><span class="line">    <span class="type">uint32_t</span> gs;</span><br><span class="line">    <span class="type">uint32_t</span> ldt;</span><br><span class="line">    <span class="type">uint32_t</span> trace;</span><br><span class="line">    <span class="type">uint32_t</span> io_base;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">tss</span> <span class="title">tss</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* tssesp0pthread0 */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">update_tss_esp</span><span class="params">(<span class="keyword">struct</span> task_struct* pthread)</span></span><br><span class="line">&#123;</span><br><span class="line">    tss.esp0 = (<span class="type">uint32_t</span>*)((<span class="type">uint32_t</span>)pthread + PG_SIZE);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* gdt */</span></span><br><span class="line"><span class="type">static</span> <span class="keyword">struct</span> gdt_desc <span class="title function_">make_gdt_desc</span><span class="params">(<span class="type">uint32_t</span>* desc_addr, <span class="type">uint32_t</span> limit, <span class="type">uint8_t</span> attr_low, <span class="type">uint8_t</span> attr_high)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span> desc_base = (<span class="type">uint32_t</span>)desc_addr;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">gdt_desc</span> <span class="title">desc</span>;</span></span><br><span class="line">    desc.limit_low_word = limit &amp; <span class="number">0x0000ffff</span>;</span><br><span class="line">    desc.base_low_word = desc_base &amp; <span class="number">0x0000ffff</span>;</span><br><span class="line">    desc.base_mid_byte = ((desc_base &amp; <span class="number">0x00ff0000</span>) &gt;&gt; <span class="number">16</span>);</span><br><span class="line">    desc.attr_low_byte = (<span class="type">uint8_t</span>)(attr_low);</span><br><span class="line">    desc.limit_high_attr_high = (((limit &amp; <span class="number">0x000f0000</span>) &gt;&gt; <span class="number">16</span>) + (<span class="type">uint8_t</span>)(attr_high));</span><br><span class="line">    desc.base_high_byte = desc_base &gt;&gt; <span class="number">24</span>;</span><br><span class="line">    <span class="keyword">return</span> desc;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* gdttssgdt */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">tss_init</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    put_str(<span class="string">&quot;tss_init start\n&quot;</span>,DEFUALT);</span><br><span class="line">    <span class="type">uint32_t</span> tss_size = <span class="keyword">sizeof</span>(tss);</span><br><span class="line">    <span class="built_in">memset</span>(&amp;tss, <span class="number">0</span>, tss_size);</span><br><span class="line">    tss.ss0 = SELECTOR_K_STACK;</span><br><span class="line">    tss.io_base = tss_size;</span><br><span class="line"><span class="comment">/* gdt0x910,tss4,0x910+0x20 */</span></span><br><span class="line">    <span class="comment">/* gdtdpl0TSS */</span></span><br><span class="line">   *((<span class="keyword">struct</span> gdt_desc*)<span class="number">0xc0000930</span>)  = make_gdt_desc((<span class="type">uint32_t</span>*)&amp;tss, tss_size - <span class="number">1</span>, TSS_ATTR_LOW, TSS_ATTR_HIGH);</span><br><span class="line">    <span class="comment">/* gdtdpl3 */</span></span><br><span class="line">    *((<span class="keyword">struct</span> gdt_desc*)<span class="number">0xc0000938</span>) = make_gdt_desc((<span class="type">uint32_t</span>*)<span class="number">0</span>, <span class="number">0xfffff</span>, GDT_CODE_ATTR_LOW_DPL3, GDT_ATTR_HIGH);</span><br><span class="line">    *((<span class="keyword">struct</span> gdt_desc*)<span class="number">0xc0000940</span>) = make_gdt_desc((<span class="type">uint32_t</span>*)<span class="number">0</span>, <span class="number">0xfffff</span>, GDT_DATA_ATTR_LOW_DPL3, GDT_ATTR_HIGH);</span><br><span class="line">    <span class="comment">/* gdt 16limit 32 */</span></span><br><span class="line">    load_xdt(&amp;gdt_operand,<span class="number">8</span> * <span class="number">7</span> - <span class="number">1</span>,<span class="number">0xc0000910</span>);</span><br><span class="line">    tss_slt = SELECTOR_TSS;</span><br><span class="line">    <span class="keyword">asm</span> <span class="title function_">volatile</span> <span class="params">(<span class="string">&quot;lgdt gdt_operand&quot;</span>)</span>;</span><br><span class="line">    <span class="keyword">asm</span> <span class="title function_">volatile</span> <span class="params">(<span class="string">&quot;ltr tss_slt&quot;</span>)</span>;</span><br><span class="line">    put_str(<span class="string">&quot;tss_init and ltr done\n&quot;</span>,DEFUALT);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li> 4~33  TSS  C  C <strong><font color='orange'> .c  .h  .c .c</font></strong>  .c  .h  .c .c  .h  TSS  .c </li><li> 37 update_tss_esp()  TSS  esp0  pthread  TSS ESP0 </li><li> 61  TSS  io_base  TSS  TSS  IO </li><li> 62 GDT  0x910 <code>loader.s</code> <br><img src="/2022/img/image-20230105121240944.png" style="zoom:67%;" /></li><li> 69  load_xdt  IDTR global.h gdt_operand  GDT  gdt_operand  71  <code>lgdt</code>  GDTR gdt_operand  tss_slt  72  <code>ltr</code>  TSS  tss_slt  TR  TSS  TR </li></ul><h3 id="font-color-red--font"><font color='red'></font></h3><p><a href="https://jyx-fyh.github.io/2022/12/02/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/">-</a></p><p><strong><mark class="hl-label blue">task_struct</mark> </strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//:thread.h</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">task_struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">uint32_t</span>* self_kstack;      <span class="comment">// </span></span><br><span class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">task_status</span> <span class="title">status</span>;</span></span><br><span class="line">    <span class="type">char</span> name[<span class="number">16</span>];</span><br><span class="line">    <span class="type">uint8_t</span> priority;</span><br><span class="line">    <span class="type">uint8_t</span> ticks;              <span class="comment">// </span></span><br><span class="line">    <span class="type">uint32_t</span> elapsed_ticks;       <span class="comment">// cpucpu</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">list_elem</span> <span class="title">general_tag</span>;</span> <span class="comment">// general_tag</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">list_elem</span> <span class="title">all_list_tag</span>;</span><span class="comment">// all_list_tagthread_all_list</span></span><br><span class="line">    <span class="type">uint32_t</span>* pgdir;              <span class="comment">// </span></span><br><span class="line">    <span class="type">uint32_t</span> stack_magic;         <span class="comment">// ,</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">virtual_addr</span> <span class="title">userprog_vaddr</span>;</span>   <span class="comment">// </span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p> 14 </p><p><strong><mark class="hl-label blue"></mark> </strong><br> <a href="">-</a><br><img src="/2022/img/image-20230105154723658.png" style="zoom:67%;" /><br> 33 </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//:memory.c</span></span><br><span class="line"><span class="comment">//....</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// </span></span><br><span class="line">        <span class="keyword">struct</span> task_struct* cur = running_thread();</span><br><span class="line">        bit_idx_start = bitmap_scan(&amp;cur-&gt;userprog_vaddr.vaddr_bitmap, pg_cnt);</span><br><span class="line">        <span class="keyword">if</span> (bit_idx_start == <span class="number">-1</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">while</span>(cnt &lt; pg_cnt)</span><br><span class="line">            bitmap_set(&amp;cur-&gt;userprog_vaddr.vaddr_bitmap, bit_idx_start + cnt++, <span class="number">1</span>);</span><br><span class="line">        vaddr_start = cur-&gt;userprog_vaddr.vaddr_start + bit_idx_start * PG_SIZE;</span><br><span class="line">        <span class="comment">/*0xc0000000-PAGE_SIZE3start_process*/</span></span><br><span class="line">        assert((<span class="type">uint32_t</span>)vaddr_start &lt; (<span class="number">0xc0000000</span> - PG_SIZE)); </span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//....</span></span><br></pre></td></tr></table></figure><p></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//:memory.c</span></span><br><span class="line"><span class="comment">/* 4k, */</span></span><br><span class="line"><span class="type">void</span>* <span class="title function_">get_user_pages</span><span class="params">(<span class="type">uint32_t</span> pg_cnt)</span></span><br><span class="line">&#123;</span><br><span class="line">    lock_acquire(&amp;user_pool.lock);</span><br><span class="line">    <span class="type">void</span>* vaddr = malloc_page(PF_USER, pg_cnt);</span><br><span class="line">    <span class="built_in">memset</span>(vaddr, <span class="number">0</span>, pg_cnt * PG_SIZE);</span><br><span class="line">    lock_release(&amp;user_pool.lock);</span><br><span class="line">    <span class="keyword">return</span> vaddr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* vaddrpf, */</span></span><br><span class="line"><span class="type">void</span>* <span class="title function_">get_a_page</span><span class="params">(<span class="keyword">enum</span> pool_flags pf, <span class="type">uint32_t</span> vaddr)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">pool</span>* <span class="title">mem_pool</span> =</span> pf &amp; PF_KERNEL ? &amp;kernel_pool : &amp;user_pool;</span><br><span class="line">    lock_acquire(&amp;mem_pool-&gt;lock);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">task_struct</span>* <span class="title">cur</span> =</span> running_thread();</span><br><span class="line">    <span class="type">int32_t</span> bit_idx = <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* , */</span></span><br><span class="line">    <span class="keyword">if</span> (cur-&gt;pgdir != <span class="literal">NULL</span> &amp;&amp; pf == PF_USER)</span><br><span class="line">    &#123;</span><br><span class="line">        bit_idx = (vaddr - cur-&gt;userprog_vaddr.vaddr_start) / PG_SIZE;</span><br><span class="line">        assert(bit_idx &gt; <span class="number">0</span>);</span><br><span class="line">        bitmap_set(&amp;cur-&gt;userprog_vaddr.vaddr_bitmap, bit_idx, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (cur-&gt;pgdir == <span class="literal">NULL</span> &amp;&amp; pf == PF_KERNEL)</span><br><span class="line">    &#123;</span><br><span class="line"><span class="comment">/* ,kernel_vaddr. */</span></span><br><span class="line">        bit_idx = (vaddr - kernel_vaddr.vaddr_start) / PG_SIZE;</span><br><span class="line">        assert(bit_idx &gt; <span class="number">0</span>);</span><br><span class="line">        bitmap_set(&amp;kernel_vaddr.vaddr_bitmap, bit_idx, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        panic(<span class="string">&quot;get_a_page:not allow kernel alloc userspace or user alloc kernelspace by get_a_page&quot;</span>,__FILE__,__LINE__,__func__);</span><br><span class="line"></span><br><span class="line">    <span class="type">void</span>* page_phyaddr = palloc(mem_pool);</span><br><span class="line">    <span class="keyword">if</span> (page_phyaddr == <span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    page_table_add((<span class="type">void</span>*)vaddr, page_phyaddr);</span><br><span class="line">    lock_release(&amp;mem_pool-&gt;lock);</span><br><span class="line">    <span class="keyword">return</span> (<span class="type">void</span>*)vaddr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*  */</span></span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">addr_v2p</span><span class="params">(<span class="type">uint32_t</span> vaddr)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span>* pte = pte_ptr(vaddr);</span><br><span class="line"><span class="comment">/* (*pte),</span></span><br><span class="line"><span class="comment"> * 12+vaddr12 */</span></span><br><span class="line">    <span class="keyword">return</span> ((*pte &amp; <span class="number">0xfffff000</span>) + (vaddr &amp; <span class="number">0x00000fff</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>get_user_pages  get_kernel_page <a href="https://jyx-fyh.github.io/2022/12/08/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86-%E8%BF%9B%E9%98%B6-%E5%88%86%E9%85%8D%E9%A1%B5%E5%86%85%E5%AD%98/">-</a></p><blockquote><p>  A  58  B  B  58  A  1  CPU AB   </p></blockquote><p> pool </p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">pool</span>                      //</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">bitmap</span> <span class="title">pool_bitmap</span>;</span> <span class="comment">// ,</span></span><br><span class="line">    <span class="type">uint32_t</span> phy_addr_start; <span class="comment">// </span></span><br><span class="line">    <span class="type">uint32_t</span> pool_size;     <span class="comment">// </span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">lock</span> <span class="title">lock</span>;</span>            <span class="comment">// </span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li><li><p> 13  get_a_page  get_kernel_page  get_user_page  0xc0000000 </p></li><li><p>addr_v2p  2  to  addr_v_to_p vaddr </p></li></ul><p><strong><mark class="hl-label blue"></mark> </strong><br></p><p> eflags  global  eflags </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//:global.h</span></span><br><span class="line"><span class="comment">//...</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> EFLAGS_MBS(1 &lt;&lt; 1)        <span class="comment">// ,1</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> EFLAGS_IF_1(1 &lt;&lt; 9)        <span class="comment">// if1,</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> EFLAGS_IF_00               <span class="comment">// if0,</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> EFLAGS_IOPL_3(3 &lt;&lt; 12)   <span class="comment">// IOPL3,IO</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> EFLAGS_IOPL_0(0 &lt;&lt; 12)   <span class="comment">// IOPL0</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DIV_ROUND_UP(X, STEP) ((X + STEP - 1) / (STEP)) <span class="comment">//,2/3=1</span></span></span><br></pre></td></tr></table></figure><p><strong><font color='orange'></font></strong> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//:process.c</span></span><br><span class="line"><span class="keyword">extern</span> <span class="class"><span class="keyword">struct</span> <span class="title">list</span> <span class="title">thread_ready_list</span>;</span></span><br><span class="line"><span class="keyword">extern</span> <span class="class"><span class="keyword">struct</span> <span class="title">list</span> <span class="title">thread_all_list</span>;</span></span><br><span class="line"><span class="type">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">intr_stack</span>* <span class="title">proc_stack</span>;</span></span><br><span class="line"><span class="type">static</span> <span class="type">uint32_t</span> pagedir_phy_addr;</span><br><span class="line"><span class="type">void</span> <span class="title function_">intr_exit</span><span class="params">()</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">start_process</span><span class="params">(<span class="type">void</span>* filename_)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">void</span>* function = filename_;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">task_struct</span>* <span class="title">cur</span> =</span> running_thread();</span><br><span class="line">    cur-&gt;self_kstack += <span class="keyword">sizeof</span>(<span class="keyword">struct</span> thread_stack);   <span class="comment">//thread_stack,intr_stack</span></span><br><span class="line">    proc_stack = (<span class="keyword">struct</span> intr_stack*)cur-&gt;self_kstack; <span class="comment">//</span></span><br><span class="line">    proc_stack-&gt;edi = proc_stack-&gt;esi = proc_stack-&gt;ebp = proc_stack-&gt;esp_dummy = <span class="number">0</span>;</span><br><span class="line">    proc_stack-&gt;ebx = proc_stack-&gt;edx = proc_stack-&gt;ecx = proc_stack-&gt;eax = <span class="number">0</span>;</span><br><span class="line">    proc_stack-&gt;gs = <span class="number">0</span>;          <span class="comment">// ,,0</span></span><br><span class="line">    proc_stack-&gt;ds = proc_stack-&gt;es = proc_stack-&gt;fs = SELECTOR_U_DATA;</span><br><span class="line">    proc_stack-&gt;eip = function; <span class="comment">// </span></span><br><span class="line">    proc_stack-&gt;cs = SELECTOR_U_CODE;</span><br><span class="line">    proc_stack-&gt;eflags = (EFLAGS_IOPL_0 | EFLAGS_MBS | EFLAGS_IF_1);</span><br><span class="line">    proc_stack-&gt;esp = (<span class="type">void</span>*)((<span class="type">uint32_t</span>)get_a_page(PF_USER, USER_STACK3_VADDR) + PG_SIZE) ;</span><br><span class="line">    proc_stack-&gt;ss = SELECTOR_U_DATA;</span><br><span class="line">    <span class="keyword">asm</span> <span class="title function_">volatile</span><span class="params">(<span class="string">&quot;mov esp,proc_stack&quot;</span>)</span>;</span><br><span class="line">    <span class="keyword">asm</span> <span class="title function_">volatile</span><span class="params">(<span class="string">&quot;jmp intr_exit&quot;</span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*  */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">page_dir_activate</span><span class="params">(<span class="keyword">struct</span> task_struct* p_thread)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/********************************************************</span></span><br><span class="line"><span class="comment">     * ,</span></span><br><span class="line"><span class="comment">     * , ,</span></span><br><span class="line"><span class="comment">     * ,</span></span><br><span class="line"><span class="comment">     ********************************************************/</span></span><br><span class="line">    <span class="comment">/* ,0x100000 */</span></span><br><span class="line">    pagedir_phy_addr = <span class="number">0x100000</span>;  <span class="comment">// ,</span></span><br><span class="line">    <span class="keyword">if</span> (p_thread-&gt;pgdir != <span class="literal">NULL</span>)  <span class="comment">// </span></span><br><span class="line">        pagedir_phy_addr = addr_v2p((<span class="type">uint32_t</span>)p_thread-&gt;pgdir);</span><br><span class="line">    <span class="comment">/* cr3, */</span></span><br><span class="line">    <span class="keyword">asm</span> <span class="title function_">volatile</span> <span class="params">(<span class="string">&quot;mov eax,pagedir_phy_addr&quot;</span>)</span>;</span><br><span class="line">    <span class="keyword">asm</span> <span class="title function_">volatile</span> <span class="params">(<span class="string">&quot;mov cr3,eax&quot;</span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ,tssesp00 */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">process_activate</span><span class="params">(<span class="keyword">struct</span> task_struct* p_thread)</span></span><br><span class="line">&#123;</span><br><span class="line">    assert(p_thread != <span class="literal">NULL</span>);</span><br><span class="line">    <span class="comment">/*  */</span></span><br><span class="line">    page_dir_activate(p_thread);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 0,tss0,esp0 */</span></span><br><span class="line">    <span class="keyword">if</span> (p_thread-&gt;pgdir)</span><br><span class="line">        <span class="comment">/* esp0*/</span></span><br><span class="line">        update_tss_esp(p_thread);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ,pde,</span></span><br><span class="line"><span class="comment"> * ,-1 */</span></span><br><span class="line"><span class="type">uint32_t</span>* <span class="title function_">create_page_dir</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/* , */</span></span><br><span class="line">    <span class="type">uint32_t</span>* page_dir_vaddr = get_kernel_pages(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (page_dir_vaddr == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        console_put_str(<span class="string">&quot;create_page_dir: get_kernel_page failed!&quot;</span>,FT_RED);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/************************** 1    *************************************/</span></span><br><span class="line">    <span class="comment">/*  page_dir_vaddr + 0x300*4 768 */</span></span><br><span class="line">    <span class="built_in">memcpy</span>((<span class="type">uint32_t</span>*)((<span class="type">uint32_t</span>)page_dir_vaddr + <span class="number">0x300</span>*<span class="number">4</span>), (<span class="type">uint32_t</span>*)(<span class="number">0xfffff000</span>+<span class="number">0x300</span>*<span class="number">4</span>), <span class="number">1024</span>);</span><br><span class="line">    <span class="comment">/************************** 2   **********************************/</span></span><br><span class="line">    <span class="type">uint32_t</span> new_page_dir_phy_addr = addr_v2p((<span class="type">uint32_t</span>)page_dir_vaddr);</span><br><span class="line">    <span class="comment">/* , */</span></span><br><span class="line">    page_dir_vaddr[<span class="number">1023</span>] = new_page_dir_phy_addr | PG_US_U | PG_RW_W | PG_P_1;</span><br><span class="line">    <span class="keyword">return</span> page_dir_vaddr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*  */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">create_user_vaddr_bitmap</span><span class="params">(<span class="keyword">struct</span> task_struct* user_prog)</span></span><br><span class="line">&#123;</span><br><span class="line">    user_prog-&gt;userprog_vaddr.vaddr_start = USER_VADDR_START;</span><br><span class="line">    <span class="type">uint32_t</span> bitmap_pg_cnt = DIV_ROUND_UP((<span class="number">0xc0000000</span> - USER_VADDR_START) / PG_SIZE / <span class="number">8</span> , PG_SIZE);</span><br><span class="line">    user_prog-&gt;userprog_vaddr.vaddr_bitmap.bits = get_kernel_pages(bitmap_pg_cnt);</span><br><span class="line">    user_prog-&gt;userprog_vaddr.vaddr_bitmap.btmp_bytes_len = (<span class="number">0xc0000000</span> - USER_VADDR_START) / PG_SIZE / <span class="number">8</span>;</span><br><span class="line">    bitmap_init(&amp;user_prog-&gt;userprog_vaddr.vaddr_bitmap);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*  */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">process_execute</span><span class="params">(<span class="type">void</span>* filename, <span class="type">char</span>* name)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/** pcb,, **/</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">task_struct</span>* <span class="title">thread</span> =</span> get_kernel_pages(<span class="number">1</span>);</span><br><span class="line">    init_thread(thread, name, DEFUALT_PRIO);</span><br><span class="line">    create_user_vaddr_bitmap(thread);</span><br><span class="line">    thread_create(thread, start_process, filename);<span class="comment">//start_process(filename)</span></span><br><span class="line">    thread-&gt;pgdir = create_page_dir();</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">intr_status</span> <span class="title">old_status</span> =</span> intr_disable();</span><br><span class="line">    assert(!elem_find(&amp;thread_ready_list, &amp;thread-&gt;general_tag));</span><br><span class="line">    list_append(&amp;thread_ready_list, &amp;thread-&gt;general_tag);</span><br><span class="line">    assert(!elem_find(&amp;thread_all_list, &amp;thread-&gt;all_list_tag));</span><br><span class="line">    list_append(&amp;thread_all_list, &amp;thread-&gt;all_list_tag);</span><br><span class="line">    intr_set_status(old_status);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>start_process proc_stack </p></li><li><p> 9 <strong></strong> </p></li><li><p> 15  <strong><font color='orange'></font></strong> gs  0 GDT  0 </p></li><li><p> 20  get_a_page()  3GB </p><blockquote><p></p></blockquote></li><li><p> 23 intr_exit  <code>interrupt.s</code>  23  <code>iret</code> <code>iret</code> </p></li><li><p> 27 page_dir_active schedule() </p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//:thread.c</span></span><br><span class="line"><span class="comment">//......</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">task_struct</span>* <span class="title">next</span> =</span> elem2entry(<span class="keyword">struct</span> task_struct, general_tag, thread_tag);</span><br><span class="line">    next-&gt;status = TASK_RUNNING;</span><br><span class="line">    process_activate(next);</span><br><span class="line">    switch_to(cur, next);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><u>(swtich_to)</u></strong> <a href=""></a> Linux <strong><u></u></strong> <strong><font color='gree'>(thread_start)  (process_execute)</font></strong>  () task_struct  pgdir NULL  NULL NULL<br><strong> 40  cr3 </strong> <a href="https://jyx-fyh.github.io/2022/11/16/%E5%8A%A0%E8%BD%BD%E5%86%85%E6%A0%B8-%E4%BB%A3%E7%A0%81%E8%AF%A6%E8%A7%A3/"></a> 0x1500 0x1500  1MB  3GB <a href="https://jyx-fyh.github.io/2022/11/13/%E5%BC%80%E5%90%AF%E5%88%86%E9%A1%B5-%E4%BB%A3%E7%A0%81%E8%AF%A6%E8%A7%A3/">-</a> 0x1500 1MB  3GB  40  1MB  1MB  1MB  3GB  128MB  1MB  0xc0001500 3GB </p>  <figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#:makefile</span></span><br><span class="line"><span class="variable">$(BUILD)</span>/kernel.bin: <span class="variable">$(KERNEL)</span></span><br><span class="line">ld  -m elf_i386 <span class="variable">$^</span> -o <span class="variable">$@</span> -Ttext 0xc0001500</span><br></pre></td></tr></table></figure><blockquote><p> Ttext Bug </p></blockquote></li><li><p> 51  TSS  ESP0</p></li><li><p> 58  create_page_dir()1<strong> <strong>2</strong><u> 768~1022 </u></strong> <a href="https://jyx-fyh.github.io/2022/11/13/%E5%BC%80%E5%90%AF%E5%88%86%E9%A1%B5-%E4%BB%A3%E7%A0%81%E8%AF%A6%E8%A7%A3/">-</a>3 1023 <a href="https://jyx-fyh.github.io/2022/11/13/%E5%BC%80%E5%90%AF%E5%88%86%E9%A1%B5-%E4%BB%A3%E7%A0%81%E8%AF%A6%E8%A7%A3/">-</a><strong><u></u></strong> </p><blockquote><p> 3~4GB  0~3GB <br>1u_prog_au_prog_b main.c  kernel.bin 3~4GB  3<strong></strong> <br><img src="/2022/img/image-20230106150001512.png" style="zoom:67%;" /></p><p>2</p><div class="mermaid-wrap"><pre class="mermaid-src" hidden>  &gt; graph LR&gt; A{}--&gt;B{}--&gt;C{}--&gt;D{EIP}&gt;   </pre></div><p> <code>0x08048000</code> <strong><font color='orange'> <code>0x08048000~0x08049000</code> </font></strong> <br></p></blockquote></li><li><p> 78 create_user_vaddr_bitmap()  USER_VADDR_START  <code>0x08048000</code> </p></li><li><p> 88  process_execute()  fork  fork </p></li></ul><p></p><p><img src="/2022/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE33-1672725867793-2.png" alt=""></p><h3 id="font-color-red--font"><font color='red'></font></h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//:main.c</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">k_thread_a</span><span class="params">(<span class="type">void</span>*)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">k_thread_b</span><span class="params">(<span class="type">void</span>*)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">u_prog_a</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">u_prog_b</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">int</span> test_var_a = <span class="number">0</span>, test_var_b = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">kernel_main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    init_all();</span><br><span class="line"></span><br><span class="line">    thread_start(<span class="string">&quot;k_thread_a&quot;</span>, <span class="number">31</span>, k_thread_a, <span class="string">&quot;argA &quot;</span>);</span><br><span class="line">    thread_start(<span class="string">&quot;k_thread_b&quot;</span>, <span class="number">31</span>, k_thread_b, <span class="string">&quot;argB &quot;</span>);</span><br><span class="line">    process_execute(u_prog_a, <span class="string">&quot;user_prog_a&quot;</span>);</span><br><span class="line">    process_execute(u_prog_b, <span class="string">&quot;user_prog_b&quot;</span>);</span><br><span class="line">    intr_enable();</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*  */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">u_prog_a</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">        test_var_a++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*  */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">u_prog_b</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">        test_var_b++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*  */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">k_thread_a</span><span class="params">(<span class="type">void</span>* arg)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span>* para = arg;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        console_put_int(test_var_a,FT_RED,HEX);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*  */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">k_thread_b</span><span class="params">(<span class="type">void</span>* arg)</span> &#123;</span><br><span class="line">    <span class="type">char</span>* para = arg;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">        console_put_int(test_var_b,FT_YELLOW,HEX);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><div id="dplayer4" class="dplayer hexo-tag-dplayer-mark" style="margin-bottom: 20px;"></div><script>(function(){var player = new DPlayer({"container":document.getElementById("dplayer4"),"theme":"#FADFA3","lang":"zh-cn//","screenshot":true,"hotkey":true,"preload":"auto","volume":0.9,"video":{"url":"/2022/video/userpro.mp4","pic":"/2022/image/1.jpg"},"danmaku":{"id":"9E2E3368B56CD123BB4","api":"https://api.prprpr.me/dplayer/","token":"tokendemo","maximum":1000,"addition":["['https://api.prprpr.me/dplayer/v3/bilibili?aid=4157142']"]}});window.dplayers||(window.dplayers=[]);window.dplayers.push(player);})()</script><br> Bug </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//:console.c</span></span><br><span class="line"><span class="comment">//....</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">console_put_char</span><span class="params">(<span class="type">uint8_t</span> char_asci,<span class="type">uint8_t</span> clr)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//console_acquire();</span></span><br><span class="line">    CLI;</span><br><span class="line">    put_char(char_asci,clr);</span><br><span class="line">    STI;</span><br><span class="line">    <span class="comment">//console_release();</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//....</span></span><br></pre></td></tr></table></figure><p></p><div id="dplayer5" class="dplayer hexo-tag-dplayer-mark" style="margin-bottom: 20px;"></div><script>(function(){var player = new DPlayer({"container":document.getElementById("dplayer5"),"theme":"#FADFA3","lang":"zh-cn//","screenshot":true,"hotkey":true,"preload":"auto","volume":0.9,"video":{"url":"/2022/video/userpro1.mp4","pic":"/2022/image/1.jpg"},"danmaku":{"id":"9E2E3368B56CD123BB4","api":"https://api.prprpr.me/dplayer/","token":"tokendemo","maximum":1000,"addition":["['https://api.prprpr.me/dplayer/v3/bilibili?aid=4157142']"]}});window.dplayers||(window.dplayers=[]);window.dplayers.push(player);})()</script><p><br>print  console  ring0  0xd <br><img src="/2022/img/image-20230112092402708.png" alt=""><br> test_var_btest_var_a </p><p> 4GB <br><img src="/2022/img/image-20230112155046604.png" alt=""><br> 3GB </p><p></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/26/%E5%AE%9E%E7%8E%B0%E7%94%A8%E6%88%B7%E8%BF%9B%E7%A8%8B/"/>
      <url>/2022/12/26/%E5%AE%9E%E7%8E%B0%E7%94%A8%E6%88%B7%E8%BF%9B%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p><strong>()<a href="https://jyx-fyh.github.io/2022/11/26/%E7%89%B9%E6%9D%83%E7%BA%A7%E5%85%A8%E9%9D%A2%E5%89%96%E6%9E%90/">TSS/LDT/GATE</a> <a href="https://jyx-fyh.github.io/2022/11/21/%E5%8A%A0%E5%85%A5%E4%B8%AD%E6%96%AD/"></a></strong> <a href="https://markrepo.github.io/kernel/2018/08/22/memory/"></a><br><a href="https://jyx-fyh.github.io/2023/01/06/%E5%AE%9E%E7%8E%B0%E7%94%A8%E6%88%B7%E8%BF%9B%E7%A8%8B-%E4%BB%A3%E7%A0%81%E8%AF%A6%E8%A7%A3/">-</a></p></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong><font color='gree'></font></strong> </p><h3 id="font-color-red--font"><font color='red'></font></h3><p> <a href="https://jyx-fyh.github.io/2022/11/26/%E7%89%B9%E6%9D%83%E7%BA%A7%E5%85%A8%E9%9D%A2%E5%89%96%E6%9E%90/">TSS/LDT/GATE</a>  TSS  LDT  TSS  LDT  <strong><font color='orange'>Intel  TSS  LDT </font></strong>  TSS  LDT <br>CPU <strong></strong> 1 + 2call / jmp + </p><p><strong><mark class="hl-label blue">+</mark> </strong><br> int  IDT <br><strong></strong></p><ol><li><p> TSS </p><blockquote><p>schedule<br><img src="/2022/img/IMG_0536(20221127-173936).PNG" alt=""><br> 0x20 0x20 Linux)</p></blockquote></li><li><p> TSS  GDT  TSS </p></li><li><p> TSS  P  1 0  TSS </p></li><li><p> TR  TSS  TSS </p></li><li><p> TSS </p></li><li><p> TSS  TR  CPU </p></li><li><p> B  1<a href="https://jyx-fyh.github.io/2022/11/26/%E7%89%B9%E6%9D%83%E7%BA%A7%E5%85%A8%E9%9D%A2%E5%89%96%E6%9E%90/">TSS/LDT/GATE</a> </p></li><li><p> NT   1<a href="https://jyx-fyh.github.io/2022/11/21/%E5%8A%A0%E5%85%A5%E4%B8%AD%E6%96%AD/"></a></p></li><li><p> TSS  TSS  <code>TSS</code> </p></li><li><p></p></li></ol><p><strong></strong></p><ol><li> <code>iret</code>  NT  1</li><li> NT  0 </li><li> TSS  B  0 </li><li> TSS </li><li> TSS  <code>TSS</code>  TR </li><li> TR  TSS </li></ol><p><strong><mark class="hl-label blue">calljmp</mark> </strong><br> IDT  GDT  LDT  calljmp call  jmp <strong> call </strong>  jmp <strong><font color='orange'> B  0</font></strong>  <code>call 0x0018:0x1234</code>  call </p><ol><li><code>0x0018</code>  GDT  3  TSS  <code>0x1234</code> </li><li> P  0 </li><li> S  TYPE  B  1 </li><li> CPL  TSS  RPL  TSS  DPL RPLCPLDPL <a href="https://jyx-fyh.github.io/2022/11/26/%E7%89%B9%E6%9D%83%E7%BA%A7%E5%85%A8%E9%9D%A2%E5%89%96%E6%9E%90/"></a> </li><li> TR  TSS </li><li> TSS  TR </li><li> TSS </li><li> NT  1 iret </li><li> TSS  TSS  <code>TSS</code> </li><li> B  1 <strong><u> B  1</u></strong> </li><li></li></ol><p></p><p>jmp  call  10  B <strong><u> jmp  B  0</u></strong> <br>CPU </p><h3 id="font-color-red--font"><font color='red'></font></h3><p> Intel  TSS LDT Linux  TSS</p><ul><li><p><strong><font color='gree'>I/O </font></strong><br>TSS  I/O </p><blockquote><p> IO </p></blockquote></li><li><p><strong><font color='gree'> TSS  SS0  ESP0 </font></strong><br><a href="https://jyx-fyh.github.io/2022/11/21/%E5%8A%A0%E5%85%A5%E4%B8%AD%E6%96%AD/"></a><strong><u><font color='orange'> TSS </font></u></strong> CPU  <u><strong></strong></u> </p></li></ul><p><strong><u>Linux  TSS  TSS TSS  ESP0</u></strong> </p><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong>Windows  API  CreateProgress  CreateThread <font color='orange'> Linux task task_struct </font><a href="https://jyx-fyh.github.io/2022/12/03/%E7%BA%BF%E7%A8%8B%E5%9F%BA%E7%A1%80/"></a></strong> <strong><font color='red'><u></u></font></strong> </p><p> Linux <br></p><ol><li><strong> <code>thread_start()</code> </strong></li><li><strong> <code>thread_start()</code>  get_kernel_page()  PCB </strong></li><li><strong> <code>init_thread()</code> task_struct</strong></li><li><strong> <code>thread_create()</code> </strong></li><li><strong></strong></li></ol><p><strong>start_progress</strong> <br><img src="/2022/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE33-1672725867793-2.png" alt=""></p><p></p><ol><li> 3 ring3 ring0</li><li><a href="https://jyx-fyh.github.io/2022/11/26/%E7%89%B9%E6%9D%83%E7%BA%A7%E5%85%A8%E9%9D%A2%E5%89%96%E6%9E%90/"></a>retf, iret/iretd<br><img src="/2022/img/image-20230103141410952.png" style="zoom:67%;" /></li><li> ring0 </li></ol><p> ring0  ring3  <code>iret</code> <u> start_progress()  start_progress  <code>iret</code>  ring0 -&gt; ring3</u></p><p> CPU <code>iret</code>  CPU </p><h3 id="font-color-red--font"><font color='red'></font></h3><p><img src="/2022/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE34-1672909464756-2.png" alt="34"><br><strong> Linux (2.4)</strong> </p><ul><li><p>3GB~4GB </p></li><li><p> 8MB<a href="https://www.tiehichi.site/2020/10/22/Linux%E8%BF%9B%E7%A8%8B%E6%A0%88%E7%A9%BA%E9%97%B4%E5%A4%A7%E5%B0%8F/#%E5%86%85%E6%A0%B8%E6%A0%88">Linux - Tiehichis Blog</a> C </p></li><li><p>.soA  math B math  math </p></li><li><p></p></li><li><p>.bss </p></li><li><p>.data  .rodata </p></li><li><p>.text IA-32  <code>0x08048000</code>  <code>0x00000000</code>  128M </p><blockquote><p> <code>0x08048000</code> <a href="">Linker And Loader</a><br> 386  <code>0x08048000</code> 0x08000000 386  0x00400000 <a href="https://www.cnblogs.com/l2017/p/11879310.html">0x08048000</a></p></blockquote></li></ul><p> <strong></strong> </p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/23/%E9%94%81%E6%9C%BA%E5%88%B6%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0/"/>
      <url>/2022/12/23/%E9%94%81%E6%9C%BA%E5%88%B6%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p><a href="https://jyx-fyh.github.io/2022/12/22/%E9%94%81%E6%9C%BA%E5%88%B6/"></a><br><code>lock</code></p></blockquote><p></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//thread.c</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">thread_block</span><span class="params">(<span class="keyword">enum</span> task_status stat)</span></span><br><span class="line">&#123;</span><br><span class="line">    assert(((stat == TASK_BLOCKED) || (stat == TASK_WAITING) || (stat == TASK_HANGING)));</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">intr_status</span> <span class="title">old_status</span> =</span> intr_disable();</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">task_struct</span>* <span class="title">cur_thread</span> =</span> running_thread();</span><br><span class="line">    cur_thread-&gt;status = stat;</span><br><span class="line">    schedule();                  <span class="comment">//</span></span><br><span class="line">    intr_set_status(old_status); <span class="comment">//</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">thread_unblock</span><span class="params">(<span class="keyword">struct</span> task_struct* pthread)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">intr_status</span> <span class="title">old_status</span> =</span> intr_disable();</span><br><span class="line">    assert(((pthread-&gt;status == TASK_BLOCKED) || (pthread-&gt;status == TASK_WAITING) || (pthread-&gt;status == TASK_HANGING)));</span><br><span class="line">    <span class="keyword">if</span> (pthread-&gt;status != TASK_READY)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (elem_find(&amp;thread_ready_list, &amp;pthread-&gt;general_tag))</span><br><span class="line">            panic(<span class="string">&quot;thread_unblock: blocked thread in ready_list\n&quot;</span>,__FILE__,__LINE__,__func__);</span><br><span class="line">        list_push(&amp;thread_ready_list, &amp;pthread-&gt;general_tag);    <span class="comment">// ,</span></span><br><span class="line">        pthread-&gt;status = TASK_READY;</span><br><span class="line">    &#125;</span><br><span class="line">    intr_set_status(old_status);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li> 4  TASK_BLOCKEDTASK_WAITINGTASK_HANGING </li><li> 20  list_push  list_append </li><li>thread_block() </li></ul><p></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//sync.h</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">semaphore</span>  //</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">uint8_t</span>  value;       <span class="comment">//</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">list</span> <span class="title">waiters</span>;</span>  <span class="comment">//</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">lock</span>       //</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span>   <span class="title">task_struct</span>* <span class="title">holder</span>;</span>    <span class="comment">// </span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span>   <span class="title">semaphore</span> <span class="title">semaphore</span>;</span>    <span class="comment">// </span></span><br><span class="line">    <span class="type">uint32_t</span> holder_repeat_nr;    <span class="comment">// </span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">sema_init</span><span class="params">(<span class="keyword">struct</span> semaphore* psema, <span class="type">uint8_t</span> value)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">sema_down</span><span class="params">(<span class="keyword">struct</span> semaphore* psema)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">sema_up</span><span class="params">(<span class="keyword">struct</span> semaphore* psema)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">lock_init</span><span class="params">(<span class="keyword">struct</span> lock* plock)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">lock_acquire</span><span class="params">(<span class="keyword">struct</span> lock* plock)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">lock_release</span><span class="params">(<span class="keyword">struct</span> lock* plock)</span>;</span><br></pre></td></tr></table></figure><ul><li><code>holder_repeat_nr</code>  12</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//sync.c</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">sema_init</span><span class="params">(<span class="keyword">struct</span> semaphore* psema, <span class="type">uint8_t</span> value)</span> &#123;</span><br><span class="line">    psema-&gt;value = value;       <span class="comment">// </span></span><br><span class="line">    list_init(&amp;psema-&gt;waiters); <span class="comment">//</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* plock */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">lock_init</span><span class="params">(<span class="keyword">struct</span> lock* plock)</span> &#123;</span><br><span class="line">    plock-&gt;holder = <span class="literal">NULL</span>;</span><br><span class="line">    plock-&gt;holder_repeat_nr = <span class="number">0</span>;</span><br><span class="line">    sema_init(&amp;plock-&gt;semaphore, <span class="number">1</span>);  <span class="comment">// 1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* down */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">sema_down</span><span class="params">(<span class="keyword">struct</span> semaphore* psema)</span> &#123;</span><br><span class="line"><span class="comment">/*  */</span></span><br><span class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">intr_status</span> <span class="title">old_status</span> =</span> intr_disable();</span><br><span class="line">    <span class="keyword">while</span>(psema-&gt;value == <span class="number">0</span>)<span class="comment">// value0,</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">/* waiters */</span></span><br><span class="line">        <span class="keyword">if</span> (elem_find(&amp;psema-&gt;waiters, &amp;running_thread()-&gt;general_tag))</span><br><span class="line">        &#123;</span><br><span class="line">            panic(<span class="string">&quot;sema_down: thread blocked has been in waiters_list\n&quot;</span>,__FILE__,__LINE__,__func__);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">/* 0,, */</span></span><br><span class="line">        list_append(&amp;psema-&gt;waiters, &amp;running_thread()-&gt;general_tag);</span><br><span class="line">        thread_block(TASK_BLOCKED);    <span class="comment">// ,</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">/* value1,,*/</span></span><br><span class="line">    psema-&gt;value--;</span><br><span class="line">    assert(psema-&gt;value == <span class="number">0</span>);</span><br><span class="line"><span class="comment">/*  */</span></span><br><span class="line">    intr_set_status(old_status);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* up */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">sema_up</span><span class="params">(<span class="keyword">struct</span> semaphore* psema)</span> &#123;</span><br><span class="line"><span class="comment">/* , */</span></span><br><span class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">intr_status</span> <span class="title">old_status</span> =</span> intr_disable();</span><br><span class="line">    assert(psema-&gt;value == <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (!list_empty(&amp;psema-&gt;waiters)) &#123;</span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">task_struct</span>* <span class="title">thread_blocked</span> =</span> elem2entry(<span class="keyword">struct</span> task_struct, general_tag, list_pop(&amp;psema-&gt;waiters));</span><br><span class="line">        thread_unblock(thread_blocked);</span><br><span class="line">    &#125;</span><br><span class="line">    psema-&gt;value++;</span><br><span class="line">    assert(psema-&gt;value == <span class="number">1</span>);</span><br><span class="line"><span class="comment">/*  */</span></span><br><span class="line">    intr_set_status(old_status);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* plock */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">lock_acquire</span><span class="params">(<span class="keyword">struct</span> lock* plock)</span> &#123;</span><br><span class="line"><span class="comment">/* */</span></span><br><span class="line">    <span class="keyword">if</span> (plock-&gt;holder != running_thread()) &#123;</span><br><span class="line">        sema_down(&amp;plock-&gt;semaphore);    <span class="comment">// P,</span></span><br><span class="line">        plock-&gt;holder = running_thread();</span><br><span class="line">        plock-&gt;holder_repeat_nr = <span class="number">1</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        plock-&gt;holder_repeat_nr++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* plock */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">lock_release</span><span class="params">(<span class="keyword">struct</span> lock* plock)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (plock-&gt;holder_repeat_nr &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        plock-&gt;holder_repeat_nr--;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    plock-&gt;holder = <span class="literal">NULL</span>;   <span class="comment">// V</span></span><br><span class="line">    plock-&gt;holder_repeat_nr = <span class="number">0</span>;</span><br><span class="line">    sema_up(&amp;plock-&gt;semaphore);   <span class="comment">// V,</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p> 60  holder_repeat_nr  1 sema_down </p><blockquote><p><strong></strong><br> sema_down </p></blockquote><p> holder_repeat_nr++  holder_repeat_nr--  sema_up </p></li><li><p> 70 <strong> sema_up </strong>  A  sema_up  holder  B  B  A  B  B  A  CPU holder B </p></li><li><p> 19  while  if A  down  B  B  A  C  A  C A <br> if  thread.c  20  C  A  if </p><blockquote><p> thread_ready_list </p></blockquote></li></ul><p> assert  assert  assert </p><h3 id="font-color-red--font"><font color='red'></font></h3><p>emm</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">lock</span> <span class="title">console_lock</span>;</span>    <span class="comment">// </span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*  */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">console_init</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    lock_init(&amp;console_lock);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">console_acquire</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    lock_acquire(&amp;console_lock);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">console_release</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    lock_release(&amp;console_lock);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">console_put_str</span><span class="params">(<span class="type">char</span>* str, <span class="type">uint8_t</span> clr)</span></span><br><span class="line">&#123;</span><br><span class="line">    console_acquire();</span><br><span class="line">    put_str(str,clr);</span><br><span class="line">    console_release();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">console_put_char</span><span class="params">(<span class="type">uint8_t</span> char_asci,<span class="type">uint8_t</span> clr)</span></span><br><span class="line">&#123;</span><br><span class="line">    console_acquire();</span><br><span class="line">    put_char(char_asci,clr);</span><br><span class="line">    console_release();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">console_put_int</span><span class="params">(<span class="type">uint32_t</span> num,<span class="type">uint8_t</span> clr,<span class="type">uint8_t</span> radix)</span></span><br><span class="line">&#123;</span><br><span class="line">    console_acquire();</span><br><span class="line">    put_int(num,clr,radix);</span><br><span class="line">    console_release();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">console_put_uint</span><span class="params">(<span class="type">uint32_t</span> num,<span class="type">uint8_t</span> clr,<span class="type">uint8_t</span> radix)</span></span><br><span class="line">&#123;</span><br><span class="line">    console_acquire();</span><br><span class="line">    put_uint(num,clr,radix);</span><br><span class="line">    console_release();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><div id="dplayer10" class="dplayer hexo-tag-dplayer-mark" style="margin-bottom: 20px;"></div><script>(function(){var player = new DPlayer({"container":document.getElementById("dplayer10"),"theme":"#FADFA3","lang":"zh-cn//","screenshot":true,"hotkey":true,"preload":"auto","volume":0.9,"video":{"url":"/2022/video/lock.mp4","pic":"/2022/image/1.jpg"},"danmaku":{"id":"9E2E3368B56CD123BB4","api":"https://api.prprpr.me/dplayer/","token":"tokendemo","maximum":1000,"addition":["['https://api.prprpr.me/dplayer/v3/bilibili?aid=4157142']"]}});window.dplayers||(window.dplayers=[]);window.dplayers.push(player);})()</script><p></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/22/%E9%94%81%E6%9C%BA%E5%88%B6/"/>
      <url>/2022/12/22/%E9%94%81%E6%9C%BA%E5%88%B6/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="font-color-red--font"><font color='red'></font></h3><p><a href="https://jyx-fyh.github.io/2022/12/16/%E7%BA%BF%E7%A8%8B%E8%BF%9B%E9%98%B6/"> -  - </a> <code>put_str()</code>  <code>STI</code>  <code>CLI</code>  GP  <strong></strong> </p><ol><li>k_thread_a  put_char  p </li><li> k_thread_a  k_thread_b </li><li>k_thread_b  k_thread_a  p </li><li>k_thread_b  k_thread_a </li></ol><p> GP </p><ul><li><p><strong><font color='gree'></font></strong>  <strong><u></u></strong> </p><blockquote><p><strong></strong></p></blockquote></li><li><p><strong><font color='gree'></font></strong> </p></li><li><p><strong><font color='gree'></font></strong> <br> P1  P2  aP1  a  1P2  a  2 a a </p></li></ul><p> put_char put_char  k_thread_a  k_thread_b <strong><u></u></strong> </p><p></p><h3 id="font-color-red--font"><font color='red'></font></h3><p> A  B  A  B  B  A  A  B </p><p><strong><mark class="hl-label blue"></mark> </strong></p><p> if_feed </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//thread_A</span></span><br><span class="line"><span class="keyword">if</span>(if_feed == <span class="literal">false</span>)&#123;</span><br><span class="line">    feed fish;</span><br><span class="line">    if_feed = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//thread_B</span></span><br><span class="line"><span class="keyword">if</span>(if_feed == <span class="literal">false</span>)&#123;</span><br><span class="line">    feed fish;</span><br><span class="line">    if_feed = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><br><img src="/2022/img/29.png" style="zoom:67%;" /><br>AB </p><p><strong><mark class="hl-label blue"></mark> </strong></p><p></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//thread_A</span></span><br><span class="line">noteA = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">if</span>(noteB == <span class="literal">false</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(if_feed==<span class="literal">false</span>)</span><br><span class="line">        feed fish;</span><br><span class="line">&#125;</span><br><span class="line">noteA = <span class="literal">false</span>;</span><br><span class="line"><span class="comment">//==================</span></span><br><span class="line"><span class="comment">//thread_B</span></span><br><span class="line">noteB = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">if</span>(noteA == <span class="literal">false</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(if_feed==<span class="literal">false</span>)</span><br><span class="line">        feed fish;</span><br><span class="line">&#125;</span><br><span class="line">noteB = <span class="literal">false</span>;</span><br></pre></td></tr></table></figure><p> AB </p><img src="/2022/img/30.png" style="zoom:80%;" /><p><strong><mark class="hl-label blue"></mark> </strong></p><p></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//thread_A</span></span><br><span class="line">noteA = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">while</span>(noteB == <span class="literal">true</span>)&#123;&#125;</span><br><span class="line"><span class="keyword">if</span>(noteB == <span class="literal">false</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(if_feed==<span class="literal">false</span>)</span><br><span class="line">        feed fish;</span><br><span class="line">&#125;</span><br><span class="line">noteA = <span class="literal">false</span>;</span><br><span class="line"><span class="comment">//================</span></span><br><span class="line"><span class="comment">//thread_B</span></span><br><span class="line">noteB = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">if</span>(noteA == <span class="literal">false</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(if_feed==<span class="literal">false</span>)</span><br><span class="line">        feed fish;</span><br><span class="line">&#125;</span><br><span class="line">noteB = <span class="literal">false</span>;</span><br></pre></td></tr></table></figure><p></p><ol><li></li><li> CPU  A  while  CPU </li><li></li></ol><p><strong><mark class="hl-label blue"></mark> </strong><br> 23 </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//thread_A</span></span><br><span class="line">lock();</span><br><span class="line"><span class="keyword">if</span>(if_feed == <span class="literal">false</span>)</span><br><span class="line">&#123;</span><br><span class="line">    feed fish;</span><br><span class="line">    if_feed = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line">unlock();</span><br><span class="line"><span class="comment">//thread_B</span></span><br><span class="line">lock();</span><br><span class="line"><span class="keyword">if</span>(if_feed == <span class="literal">false</span>)</span><br><span class="line">&#123;</span><br><span class="line">    feed fish;</span><br><span class="line">    if_feed = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line">unlock();</span><br></pre></td></tr></table></figure><p> A  B  CPU </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//thread_A</span></span><br><span class="line">lock();</span><br><span class="line"><span class="keyword">if</span>(noteB == <span class="literal">false</span>)</span><br><span class="line">    noteA = <span class="literal">true</span>;</span><br><span class="line">unlock();</span><br><span class="line"><span class="keyword">if</span>(noteB == <span class="literal">false</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(if_feed == <span class="literal">false</span>)</span><br><span class="line">        feed fish;</span><br><span class="line">    noteA = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//==================</span></span><br><span class="line"><span class="comment">//thread_A</span></span><br><span class="line">lock();</span><br><span class="line"><span class="keyword">if</span>(noteA == <span class="literal">false</span>)</span><br><span class="line">    noteB = <span class="literal">true</span>;</span><br><span class="line">unlock();</span><br><span class="line"><span class="keyword">if</span>(noteA == <span class="literal">false</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(if_feed == <span class="literal">false</span>)</span><br><span class="line">        feed fish;</span><br><span class="line">    noteB = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><font color='orange'></font></strong> <strong><font color='orange'> CPU CPU </font></strong>  <strong><font color='orange'></font></strong>  <strong><font color='orange'></font></strong> </p><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong></strong> 12</p><p><strong></strong> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> N 100  <span class="comment">//</span></span></span><br><span class="line"><span class="type">int</span> count = <span class="number">0</span>; <span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">producer</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(count == N)</span><br><span class="line">            sleep();         <span class="comment">//</span></span><br><span class="line">        count++;</span><br><span class="line">        <span class="keyword">if</span>(count == <span class="number">1</span>)</span><br><span class="line">            wakeup(consumer);<span class="comment">//</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">consumer</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(count == <span class="number">0</span>)</span><br><span class="line">            sleep();         <span class="comment">//</span></span><br><span class="line">        count--;</span><br><span class="line">        <span class="keyword">if</span>(count == N<span class="number">-1</span>)     <span class="comment">//count==N-1,</span></span><br><span class="line">            wakeup(producer);<span class="comment">//</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><strong>wakeup()  thread_ready_list </strong></p></blockquote><p><strong><font color='red'></font></strong></p><blockquote><p></p></blockquote><p> count=0<u></u>CPU  count=1 thread_ready_list  sleep()</p><p>OK CPU  sleep <strong><font color='gree'></font></strong> </p><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong> 0  1 </strong>  updown </p><p><strong><font color='orange'>up</font></strong> 1 12<br><strong><font color='orange'>down</font></strong> 1 02 0 13 0</p><blockquote><p> Dijkstra  up  down  PV  Proberen  Verhogen </p></blockquote><p><strong><u><font color='orange'>down up </font></u></strong> <strong> 1 0</strong></p><p></p><h3 id="font-color-red--font"><font color='red'></font></h3><p></p><ul><li><strong></strong></li><li><strong></strong></li><li><strong></strong></li></ul><h3 id="font-color-red--font"><font color='red'></font></h3><p><br><img src="/2022/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE31.png" alt=""><br> CPU<br><img src="/2022/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE32.png" alt=""><br> CPU <strong></strong> </p><blockquote><p></p></blockquote><p></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>--</title>
      <link href="/2022/12/16/%E7%BA%BF%E7%A8%8B%E8%BF%9B%E9%98%B6/"/>
      <url>/2022/12/16/%E7%BA%BF%E7%A8%8B%E8%BF%9B%E9%98%B6/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p><a href="https://jyx-fyh.github.io/2022/12/03/%E7%BA%BF%E7%A8%8B%E5%9F%BA%E7%A1%80/">--</a><br><code>thread-schedule</code></p></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><ul><li><strong><font color='gree'></font></strong><br></li><li><strong><font color='gree'></font></strong><br> <code>thread.c</code>  <code>thread.h</code> </li><li><strong><font color='gree'></font></strong><br></li></ul><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong><mark class="hl-label blue">thread.h</mark> </strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//thread.h</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">task_struct</span> </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">uint32_t</span>* self_kstack;      </span><br><span class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">task_status</span> <span class="title">status</span>;</span></span><br><span class="line">    <span class="type">char</span> name[<span class="number">16</span>];</span><br><span class="line">    <span class="type">uint8_t</span> priority;</span><br><span class="line">    <span class="type">uint8_t</span> ticks;              </span><br><span class="line">    <span class="type">uint32_t</span> elapsed_ticks;       </span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">list_elem</span> <span class="title">general_tag</span>;</span> </span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">list_elem</span> <span class="title">all_list_tag</span>;</span></span><br><span class="line">    <span class="type">uint32_t</span>* pgdir;              </span><br><span class="line">    <span class="type">uint32_t</span> stack_magic;         </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>thread.h  <code>task_struct</code>  </p><ul><li><strong>ticks</strong>  priority ticks  1 0  CPU </li><li><strong>elapsed_ticks</strong>  CPU  ticks ticks  0  CPUelapsed_ticks  ticks </li><li><strong>general_tag</strong> <font color='orange'><u></u> tag  thread_ready_list </font> tag  task_struct  tag  task_struct tag  task_struct  task_struct <br><img src="/2022/img/image-20221217171337120.png" alt="tagPCB" style="zoom:67%;" /></li><li><strong>all_list_tag</strong> thread_all_list  all_list_tag  thread_all_list </li><li><strong>pgdir</strong> pgdir pgdir  NULL pgdir  CR2 </li></ul><p><strong><mark class="hl-label blue">thread.c</mark> </strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> PG_SIZE 4096</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">task_struct</span>* <span class="title">main_thread</span>;</span>    <span class="comment">// PCB</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">list</span> <span class="title">thread_ready_list</span>;</span>    <span class="comment">// </span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">list</span> <span class="title">thread_all_list</span>;</span>    <span class="comment">// </span></span><br><span class="line"><span class="type">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">list_elem</span>* <span class="title">thread_tag</span>;</span><span class="comment">// </span></span><br><span class="line"><span class="type">static</span> <span class="type">uint32_t</span> tmp_esp;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* pcb */</span></span><br><span class="line"><span class="keyword">struct</span> task_struct* <span class="title function_">running_thread</span><span class="params">()</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">asm</span> <span class="title function_">volatile</span><span class="params">(<span class="string">&quot;mov tmp_esp,esp&quot;</span>)</span>;</span><br><span class="line">    <span class="comment">/* esppcb */</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">struct</span> task_struct*)(tmp_esp &amp; <span class="number">0xfffff000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* kernel_threadfunction(func_arg) */</span></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">kernel_thread</span><span class="params">(thread_func* function, <span class="type">void</span>* func_arg)</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">/* function,, */</span></span><br><span class="line">    intr_enable();</span><br><span class="line">    function(func_arg);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* thread_stack,thread_stack */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">thread_create</span><span class="params">(<span class="keyword">struct</span> task_struct* pthread, thread_func function, <span class="type">void</span>* func_arg)</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/* ,thread.h */</span></span><br><span class="line">    pthread-&gt;self_kstack -= <span class="keyword">sizeof</span>(<span class="keyword">struct</span> intr_stack);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* ,thread.h */</span></span><br><span class="line">    pthread-&gt;self_kstack -= <span class="keyword">sizeof</span>(<span class="keyword">struct</span> thread_stack);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">thread_stack</span>* <span class="title">kthread_stack</span> =</span> (<span class="keyword">struct</span> thread_stack*)pthread-&gt;self_kstack;</span><br><span class="line">    kthread_stack-&gt;eip = kernel_thread;</span><br><span class="line">    kthread_stack-&gt;function = function;</span><br><span class="line">    kthread_stack-&gt;func_arg = func_arg;</span><br><span class="line">    kthread_stack-&gt;ebp = kthread_stack-&gt;ebx = kthread_stack-&gt;esi = kthread_stack-&gt;edi = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*  */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">init_thread</span><span class="params">(<span class="keyword">struct</span> task_struct* pthread, <span class="type">char</span>* name, <span class="type">int</span> prio)</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">memset</span>(pthread, <span class="number">0</span>, <span class="keyword">sizeof</span>(*pthread));</span><br><span class="line">    <span class="built_in">strcpy</span>(pthread-&gt;name, name);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (pthread == main_thread)</span><br><span class="line">        pthread-&gt;status = TASK_RUNNING;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        pthread-&gt;status = TASK_READY;</span><br><span class="line">    </span><br><span class="line">    pthread-&gt;self_kstack = (<span class="type">uint32_t</span>*)((<span class="type">uint32_t</span>)pthread + PG_SIZE);</span><br><span class="line">    pthread-&gt;priority = prio;</span><br><span class="line">    pthread-&gt;ticks = prio;</span><br><span class="line">    pthread-&gt;elapsed_ticks = <span class="number">0</span>;</span><br><span class="line">    pthread-&gt;pgdir = <span class="literal">NULL</span>;</span><br><span class="line">    pthread-&gt;stack_magic = <span class="number">0x19870916</span>;  <span class="comment">// </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> task_struct* <span class="title function_">thread_start</span><span class="params">(<span class="type">char</span>* name, <span class="type">int</span> prio, thread_func function, <span class="type">void</span>* func_arg)</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">task_struct</span>* <span class="title">thread</span> =</span> get_kernel_pages(<span class="number">1</span>);</span><br><span class="line">    init_thread(thread, name, prio);</span><br><span class="line">    thread_create(thread, function, func_arg);</span><br><span class="line">    <span class="comment">/*  */</span></span><br><span class="line">    assert(!elem_find(&amp;thread_ready_list, &amp;thread-&gt;general_tag));</span><br><span class="line">    <span class="comment">/*  */</span></span><br><span class="line">    list_append(&amp;thread_ready_list, &amp;thread-&gt;general_tag);</span><br><span class="line">    <span class="comment">/*  */</span></span><br><span class="line">    assert(!elem_find(&amp;thread_all_list, &amp;thread-&gt;all_list_tag));</span><br><span class="line">    <span class="comment">/*  */</span></span><br><span class="line">    list_append(&amp;thread_all_list, &amp;thread-&gt;all_list_tag);</span><br><span class="line">    <span class="keyword">return</span> thread;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* kernelmain */</span></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">make_main_thread</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">/* main,guide.Smov esp,0xc009f000,</span></span><br><span class="line"><span class="comment">pcb,0xc009e000,get_kernel_page*/</span></span><br><span class="line">    main_thread = running_thread();</span><br><span class="line">    init_thread(main_thread, <span class="string">&quot;main&quot;</span>, <span class="number">31</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* main,thread_ready_list,</span></span><br><span class="line"><span class="comment"> * thread_all_list. */</span></span><br><span class="line">    assert(!elem_find(&amp;thread_all_list, &amp;main_thread-&gt;all_list_tag));</span><br><span class="line">    list_append(&amp;thread_all_list, &amp;main_thread-&gt;all_list_tag);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*  */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">schedule</span><span class="params">()</span> </span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    assert(intr_get_status() == INTR_OFF);</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">task_struct</span>* <span class="title">cur</span> =</span> running_thread();</span><br><span class="line">    <span class="keyword">if</span> (cur-&gt;status == TASK_RUNNING)    <span class="comment">// ,,</span></span><br><span class="line">    &#123;  </span><br><span class="line">        assert(!elem_find(&amp;thread_ready_list, &amp;cur-&gt;general_tag));</span><br><span class="line">        list_append(&amp;thread_ready_list, &amp;cur-&gt;general_tag);</span><br><span class="line">        cur-&gt;ticks = cur-&gt;priority;     <span class="comment">// tickspriority;</span></span><br><span class="line">        cur-&gt;status = TASK_READY;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ,</span></span><br><span class="line">    &#125;</span><br><span class="line">    assert(!list_empty(&amp;thread_ready_list));</span><br><span class="line">    thread_tag = <span class="literal">NULL</span>;  </span><br><span class="line">    </span><br><span class="line">    <span class="comment">//thread_ready_list,cpu.</span></span><br><span class="line">    thread_tag = list_pop(&amp;thread_ready_list);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">task_struct</span>* <span class="title">next</span> =</span> elem2entry(<span class="keyword">struct</span> task_struct, general_tag, thread_tag);</span><br><span class="line">    next-&gt;status = TASK_RUNNING;</span><br><span class="line">    switch_to(cur, next);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*  */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">thread_init</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line">    put_str(<span class="string">&quot;thread_init start\n&quot;</span>,DEFUALT);</span><br><span class="line">    list_init(&amp;thread_ready_list);</span><br><span class="line">    list_init(&amp;thread_all_list);</span><br><span class="line"><span class="comment">/* main */</span></span><br><span class="line">    make_main_thread();</span><br><span class="line">    put_str(<span class="string">&quot;thread_init done\n&quot;</span>,DEFUALT);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><ol><li><strong> <code>thread_init()</code>  main </strong></li><li><strong> <code>thread_start()</code> </strong><br><strong>1 <code>init_thread()</code> </strong><br><strong>2 <code>thread_create()</code> </strong><br><strong>3 thread_ready_list  thread_all_list </strong></li><li><strong></strong></li></ol><p></p><ul><li><p> 12  esp  C  tmp_esp </p></li><li><p> 14  PCB  PCB  esp  PCB </p></li><li><p> 21  <code>function()</code> <code>schedule()</code>  <code>function()</code>  <strong><u>iret</u></strong>  <code>IF</code>  0 CPU <strong><font color='orange'></font></strong> </p></li><li><p> 68 <strong> thread_ready_list  CPU </strong>  thread_all_list </p></li><li><p> 77  CPU <strong>kernel_main</strong>  <code>guide.s</code> </p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[BITS 32]</span><br><span class="line">extern kernel_main</span><br><span class="line">global _start</span><br><span class="line">section .text</span><br><span class="line">_start:</span><br><span class="line">    mov esp, 0xc009f000</span><br><span class="line">    jmp kernel_main</span><br></pre></td></tr></table></figure><p> 6 <strong> esp  PCB  0xc009f00  esp  PCB</strong> </p></li><li><p> 92 <code>schedule()</code>  <code>thread_block()</code> <strong><font color='orange'> <code>schedule()</code>  CPU </font></strong>  <code>switch_to</code> </p></li><li><p> 109  idle  assert </p></li><li><p> 114 <code>elem2entry()</code>  general_tag  all_list_tag  task_strcut </p></li></ul><p></p><h3 id="font-color-red--font"><font color='red'></font></h3><p> <strong><font color='red'>Round-RobinRR</font></strong> FIFO thread_ready_list  CPU  RUNNING thread_ready_list  thread_all_list </p><p><strong></strong></p><ol><li><strong></strong></li><li><strong> <code>schedule()</code></strong></li><li><strong><code>schedule()</code>  <code>switch_to()</code></strong></li></ol><p><strong><mark class="hl-label blue">1.</mark> </strong><br><a href="https://jyx-fyh.github.io/2022/11/26/%E5%8A%A0%E5%85%A5%E4%B8%AD%E6%96%AD-%E4%BB%A3%E7%A0%81%E8%AF%A6%E8%A7%A3/"></a> <code>general_intr_handler()</code> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//idt.c</span></span><br><span class="line"><span class="comment">//.......</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">register_handler</span><span class="params">(<span class="type">uint8_t</span> vector_no, intr_handler function)</span></span><br><span class="line">&#123;</span><br><span class="line">    interrupt_handler_table[vector_no] = function;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//timer.c</span></span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span> ticks;          <span class="comment">// ticks</span></span><br><span class="line"><span class="comment">/*  */</span></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">intr_timer_handler</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">task_struct</span>* <span class="title">cur_thread</span> =</span> running_thread();</span><br><span class="line"></span><br><span class="line">    assert(cur_thread-&gt;stack_magic == <span class="number">0x19870916</span>);  <span class="comment">// </span></span><br><span class="line"></span><br><span class="line">    cur_thread-&gt;elapsed_ticks++;                    <span class="comment">// cpu</span></span><br><span class="line">    ticks++;  <span class="comment">//,</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (cur_thread-&gt;ticks == <span class="number">0</span>)                     <span class="comment">// cpu</span></span><br><span class="line">        schedule();</span><br><span class="line">    <span class="keyword">else</span>                                            <span class="comment">// -1</span></span><br><span class="line">        cur_thread-&gt;ticks--;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">timer_init</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    put_str(<span class="string">&quot;timer_init start...\n&quot;</span>,DEFUALT);</span><br><span class="line">    frequency_set(CONTRER0_PORT, COUNTER0_NO, READ_WRITE_LATCH, COUNTER_MODE, COUNTER0_VALUE);</span><br><span class="line">    register_handler(<span class="number">0x20</span>, intr_timer_handler);  </span><br><span class="line">    put_str(<span class="string">&quot;timer_init done: Clock interrupt frequency increased to 100Hz\n&quot;</span>,DEFUALT);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li> ticks </li><li> 14 <strong>cur_thread-&gt;ticks == 0 <u></u></strong>  <code>schedule()</code> </li><li> 25 </li></ul><p><strong><mark class="hl-label blue">schedule()</mark> </strong></p><p></p><p><strong><mark class="hl-label blue">switch_to</mark> </strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[bits 32]</span><br><span class="line">section .text</span><br><span class="line">global switch_to</span><br><span class="line">switch_to:</span><br><span class="line">   ;</span><br><span class="line">   push esi</span><br><span class="line">   push edi</span><br><span class="line">   push ebx</span><br><span class="line">   push ebp</span><br><span class="line"></span><br><span class="line">   mov eax, [esp + 20]     ; cur, cur = [esp+20]</span><br><span class="line">   mov [eax], esp          ; esp</span><br><span class="line">                           </span><br><span class="line">                           </span><br><span class="line">;------------------    ----------------</span><br><span class="line">   mov eax, [esp + 24]     ; next, next = [esp+24]</span><br><span class="line">   mov esp, [eax]          ; esp</span><br><span class="line">                           </span><br><span class="line">   pop ebp</span><br><span class="line">   pop ebx</span><br><span class="line">   pop edi</span><br><span class="line">   pop esi</span><br><span class="line">   ret                     ;kernel_thread</span><br><span class="line">                           ;schedule</span><br></pre></td></tr></table></figure><ul><li> esiediebxebp <a href="https://jyx-fyh.github.io/2022/12/03/%E7%BA%BF%E7%A8%8B%E5%9F%BA%E7%A1%80/">--</a></li><li> cur  next  task_struct <strong> task_struct  self_kstack cur  next  self_kstack</strong> <strong><font color='orange'>self_kstack  esp </font></strong> </li></ul><p><strong><code>switch_to</code> </strong> </p><p><img src="/2022/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE28-1671258856847-2.png" alt=""></p><ol><li><p> kernel_main() esp  kernel_main  PCB <strong></strong>  <code>schedule()</code>  <code>switch_to()</code> <code>switch_to()</code>  esp  kernel_main  self_kstack </p><blockquote><p> cur   <code>thread_stack</code>  <code>schedule()</code>  <code>thread_stack</code>  <code>intr_stack</code> <code>intr_stack</code>  kernel_main()  esp  0xc009f000 </p></blockquote></li><li><p> <code>mov esp,[eax]</code> <strong><font color='orange'> <code>thread_create()</code> </font></strong> </p><blockquote><p> <code>thread_create()</code>  self_kstack  pop  ret </p></blockquote></li><li><p> pop  ret eip  <code>kernel_thread()</code>  <code>function()</code> </p></li><li><p> <code>switch_to()</code> <strong><font color='orange'></font></strong></p><blockquote><p><strong><font color='orange'> 3  4  eip  3  eip  <code>kernel_thread()</code>  4  eip  <code>schedule()</code>  <code>switch_to()</code>  eip  <code>schedule()</code></font></strong> <br> <code>function()</code>  <code>iret</code> </p></blockquote></li><li><p> <code>switch_to()</code> <code>mov esp,[eax]</code> </p></li><li><p> pop  ret <code>switch_to()</code> <code>schedule()</code>  kernel_main() </p></li><li><p></p></li><li><p> eip  <code>schedule()</code>  kernel_thread </p></li><li><p>pop  ret <code>switch_to()</code> <code>schedule()</code> </p><blockquote><p><code>kernel_thread()</code>  <code>switch_to</code>  <code>kernel_thread()</code> <strong><font color='orange'> kernel_thread() </font></strong> <strong><u> return </u></strong>  <code>thread_exit()</code>  <code>while(1)</code> </p></blockquote></li></ol><blockquote><p><strong> <code>ret</code>  kernel_thread() </strong><br><code>switch_to</code>  <code>ret</code>  <code>kernel_thread()</code>  <code>schedule()</code> <strong><font color='orange'> <code>ret</code>  ret  kernel_thread ret  schedule call  schedule  <code>ret</code>  <code>call</code>  <code>kernel_thread()</code> </font></strong></p></blockquote><div id="dplayer8" class="dplayer hexo-tag-dplayer-mark" style="margin-bottom: 20px;"></div><script>(function(){var player = new DPlayer({"container":document.getElementById("dplayer8"),"theme":"#FADFA3","lang":"zh-cn//","screenshot":true,"hotkey":true,"preload":"auto","volume":0.9,"video":{"url":"/2022/video/thread_exit.mp4","pic":"/2022/image/1.jpg"},"danmaku":{"id":"9E2E3368B56CD123BB4","api":"https://api.prprpr.me/dplayer/","token":"tokendemo","maximum":1000,"addition":["['https://api.prprpr.me/dplayer/v3/bilibili?aid=4157142']"]}});window.dplayers||(window.dplayers=[]);window.dplayers.push(player);})()</script><p> while  <code>STI</code>  <code>CLI</code>  <code>put_str()</code> </p><div id="dplayer9" class="dplayer hexo-tag-dplayer-mark" style="margin-bottom: 20px;"></div><script>(function(){var player = new DPlayer({"container":document.getElementById("dplayer9"),"theme":"#FADFA3","lang":"zh-cn//","screenshot":true,"hotkey":true,"preload":"auto","volume":0.9,"video":{"url":"/2022/video/thread_intr.mp4","pic":"/2022/image/1.jpg"},"danmaku":{"id":"9E2E3368B56CD123BB4","api":"https://api.prprpr.me/dplayer/","token":"tokendemo","maximum":1000,"addition":["['https://api.prprpr.me/dplayer/v3/bilibili?aid=4157142']"]}});window.dplayers||(window.dplayers=[]);window.dplayers.push(player);})()</script><p> <code>STI</code>  <code>CLI</code>  0xd </p><p> <code>interrupt.s</code> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//interrupt.s</span></span><br><span class="line">%macro VECTOR <span class="number">2</span></span><br><span class="line">INTERRUPT_ENTRY_%<span class="number">1</span>:        ;entry</span><br><span class="line">    %<span class="number">2</span></span><br><span class="line">    push ds</span><br><span class="line">    push es</span><br><span class="line">    push fs</span><br><span class="line">    push gs</span><br><span class="line">    pushad</span><br><span class="line"></span><br><span class="line">    mov al,<span class="number">0x20</span>            ;EOI</span><br><span class="line">    out <span class="number">0xa0</span>,al            ;</span><br><span class="line">    out <span class="number">0x20</span>,al            ;</span><br><span class="line"></span><br><span class="line">    push dword %<span class="number">1</span></span><br><span class="line">    call [interrupt_handler_table + %<span class="number">1</span>*<span class="number">4</span>]</span><br><span class="line">    add esp, <span class="number">4</span>             ;</span><br><span class="line"></span><br><span class="line">    popad</span><br><span class="line">    pop gs</span><br><span class="line">    pop fs</span><br><span class="line">    pop es</span><br><span class="line">    pop ds</span><br><span class="line"></span><br><span class="line">    add esp,<span class="number">4</span>   ;error_code,</span><br><span class="line">    iret   ;,<span class="number">32</span>iretd</span><br></pre></td></tr></table></figure><p> <code>interrupt.s</code> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">%macro VECTOR <span class="number">2</span></span><br><span class="line">INTERRUPT_ENTRY_%<span class="number">1</span>:        ;entry</span><br><span class="line">    %<span class="number">2</span></span><br><span class="line">    push ds</span><br><span class="line">    push es</span><br><span class="line">    push fs</span><br><span class="line">    push gs</span><br><span class="line">    pushad</span><br><span class="line"></span><br><span class="line">    push dword %<span class="number">1</span></span><br><span class="line">    call [interrupt_handler_table + %<span class="number">1</span>*<span class="number">4</span>]</span><br><span class="line">    add esp, <span class="number">4</span>             ;</span><br><span class="line"></span><br><span class="line">    popad</span><br><span class="line">    pop gs</span><br><span class="line">    pop fs</span><br><span class="line">    pop es</span><br><span class="line">    pop ds</span><br><span class="line"></span><br><span class="line">    mov al,<span class="number">0x20</span>            ;EOI</span><br><span class="line">    out <span class="number">0xa0</span>,al            ;</span><br><span class="line">    out <span class="number">0x20</span>,al            ;</span><br><span class="line"></span><br><span class="line">    add esp,<span class="number">4</span>   ;error_code,</span><br><span class="line">    iret   ;,<span class="number">32</span>iretd</span><br></pre></td></tr></table></figure><p> EOI (11) <code>iret</code>  CPU  IF  CPU<code>function()</code>)<strong><font color='orange'>8259A  CPU  EOI </font></strong>  11  EOI </p><h3 id="font-color-red--font"><font color='red'></font></h3><p></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//list.h</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> offset(struct_type,member) (int)(&amp;((struct_type*)0)-&gt;member)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> elem2entry(struct_type, struct_member_name, elem_ptr) \</span></span><br><span class="line"><span class="meta">        (struct_type*)((int)elem_ptr - offset(struct_type, struct_member_name))</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">list_elem</span> </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">list_elem</span>* <span class="title">prev</span>;</span>  <span class="comment">// </span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">list_elem</span>* <span class="title">next</span>;</span>  <span class="comment">// </span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">list</span> </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">list_elem</span> <span class="title">head</span>;</span>   <span class="comment">//</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">list_elem</span> <span class="title">tail</span>;</span>   <span class="comment">//</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//function,list_traversal</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="title function_">bool</span> <span class="params">(function)</span><span class="params">(<span class="keyword">struct</span> list_elem*, <span class="type">int</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">list_init</span> <span class="params">(<span class="keyword">struct</span> <span class="built_in">list</span>*)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">list_insert_before</span><span class="params">(<span class="keyword">struct</span> list_elem* before, <span class="keyword">struct</span> list_elem* elem)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">list_push</span><span class="params">(<span class="keyword">struct</span> <span class="built_in">list</span>* plist, <span class="keyword">struct</span> list_elem* elem)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">list_iterate</span><span class="params">(<span class="keyword">struct</span> <span class="built_in">list</span>* plist)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">list_append</span><span class="params">(<span class="keyword">struct</span> <span class="built_in">list</span>* plist, <span class="keyword">struct</span> list_elem* elem)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">list_remove</span><span class="params">(<span class="keyword">struct</span> list_elem* pelem)</span>;</span><br><span class="line"><span class="keyword">struct</span> list_elem* <span class="title function_">list_pop</span><span class="params">(<span class="keyword">struct</span> <span class="built_in">list</span>* plist)</span>;</span><br><span class="line"><span class="type">bool</span> <span class="title function_">list_empty</span><span class="params">(<span class="keyword">struct</span> <span class="built_in">list</span>* plist)</span>;</span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">list_len</span><span class="params">(<span class="keyword">struct</span> <span class="built_in">list</span>* plist)</span>;</span><br><span class="line"><span class="keyword">struct</span> list_elem* <span class="title function_">list_traversal</span><span class="params">(<span class="keyword">struct</span> <span class="built_in">list</span>* plist, function func, <span class="type">int</span> arg)</span>;</span><br><span class="line"><span class="type">bool</span> <span class="title function_">elem_find</span><span class="params">(<span class="keyword">struct</span> <span class="built_in">list</span>* plist, <span class="keyword">struct</span> list_elem* obj_elem)</span>;</span><br></pre></td></tr></table></figure><ul><li><p><code>offset</code> </p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="type">int</span>)(&amp;((struct_type*)<span class="number">0</span>)-&gt;member)</span><br></pre></td></tr></table></figure><p> 0  struct_type* <strong><u> struct_type  0x0000 </u></strong>  0x0000 </p></li><li><p><code>elem2entry</code>  tag  tag </p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">task_struct</span>* <span class="title">next</span> =</span> elem2entry(<span class="keyword">struct</span> task_struct, general_tag, thread_tag); <span class="comment">//thread.c114</span></span><br></pre></td></tr></table></figure><blockquote><p></p></blockquote></li><li><p>list  head  head  tail </p><blockquote><p><strong></strong> <br></p></blockquote></li><li><p> 19  <code>list_traversal()</code>  typedef 30 </p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> list_elem* <span class="title function_">list_traversal</span><span class="params">(<span class="keyword">struct</span> <span class="built_in">list</span>* plist, <span class="type">bool</span> (func)(<span class="keyword">struct</span> list_elem*, <span class="type">int</span>), <span class="type">int</span> arg)</span>;</span><br></pre></td></tr></table></figure><p><code>list_traversal()</code> </p></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//list.c</span></span><br><span class="line"><span class="comment">/* list */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">list_init</span> <span class="params">(<span class="keyword">struct</span> <span class="built_in">list</span>* <span class="built_in">list</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">list</span>-&gt;head.prev = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="built_in">list</span>-&gt;head.next = &amp;<span class="built_in">list</span>-&gt;tail;</span><br><span class="line">    <span class="built_in">list</span>-&gt;tail.prev = &amp;<span class="built_in">list</span>-&gt;head;</span><br><span class="line">    <span class="built_in">list</span>-&gt;tail.next = <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* elembefore */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">list_insert_before</span><span class="params">(<span class="keyword">struct</span> list_elem* before, <span class="keyword">struct</span> list_elem* elem)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">intr_status</span> <span class="title">old_status</span> =</span> intr_disable();</span><br><span class="line">    before-&gt;prev-&gt;next = elem;</span><br><span class="line">    elem-&gt;prev = before-&gt;prev;</span><br><span class="line">    elem-&gt;next = before;</span><br><span class="line">    before-&gt;prev = elem;</span><br><span class="line">    intr_set_status(old_status);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*  */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">list_push</span><span class="params">(<span class="keyword">struct</span> <span class="built_in">list</span>* plist, <span class="keyword">struct</span> list_elem* elem)</span></span><br><span class="line">&#123;</span><br><span class="line">    list_insert_before(plist-&gt;head.next, elem);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*  */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">list_append</span><span class="params">(<span class="keyword">struct</span> <span class="built_in">list</span>* plist, <span class="keyword">struct</span> list_elem* elem)</span></span><br><span class="line">&#123;</span><br><span class="line">    list_insert_before(&amp;plist-&gt;tail, elem); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* pelem */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">list_remove</span><span class="params">(<span class="keyword">struct</span> list_elem* pelem)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">intr_status</span> <span class="title">old_status</span> =</span> intr_disable();</span><br><span class="line">    pelem-&gt;prev-&gt;next = pelem-&gt;next;</span><br><span class="line">    pelem-&gt;next-&gt;prev = pelem-&gt;prev;</span><br><span class="line">    intr_set_status(old_status);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ,pop */</span></span><br><span class="line"><span class="keyword">struct</span> list_elem* <span class="title function_">list_pop</span><span class="params">(<span class="keyword">struct</span> <span class="built_in">list</span>* plist)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">list_elem</span>* <span class="title">elem</span> =</span> plist-&gt;head.next;</span><br><span class="line">    list_remove(elem);</span><br><span class="line">    <span class="keyword">return</span> elem;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* obj_elem,true,false */</span></span><br><span class="line"><span class="type">bool</span> <span class="title function_">elem_find</span><span class="params">(<span class="keyword">struct</span> <span class="built_in">list</span>* plist, <span class="keyword">struct</span> list_elem* obj_elem)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">list_elem</span>* <span class="title">elem</span> =</span> plist-&gt;head.next;</span><br><span class="line">    <span class="keyword">while</span> (elem != &amp;plist-&gt;tail)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (elem == obj_elem)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        elem = elem-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* plistelemargfunc,</span></span><br><span class="line"><span class="comment"> * argfuncelem.</span></span><br><span class="line"><span class="comment"> * ,</span></span><br><span class="line"><span class="comment"> * ,NULL. */</span></span><br><span class="line"><span class="keyword">struct</span> list_elem* <span class="title function_">list_traversal</span><span class="params">(<span class="keyword">struct</span> <span class="built_in">list</span>* plist, function func, <span class="type">int</span> arg)</span> &#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">list_elem</span>* <span class="title">elem</span> =</span> plist-&gt;head.next;</span><br><span class="line">    <span class="keyword">if</span> (list_empty(plist))</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">while</span> (elem != &amp;plist-&gt;tail)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (func(elem, arg))   </span><br><span class="line">            <span class="keyword">return</span> elem;</span><br><span class="line">        elem = elem-&gt;next;     </span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*  */</span></span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">list_len</span><span class="params">(<span class="keyword">struct</span> <span class="built_in">list</span>* plist)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">list_elem</span>* <span class="title">elem</span> =</span> plist-&gt;head.next;</span><br><span class="line">    <span class="type">uint32_t</span> length = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (elem != &amp;plist-&gt;tail)</span><br><span class="line">    &#123;</span><br><span class="line">        length++;</span><br><span class="line">        elem = elem-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> length;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ,true,false */</span></span><br><span class="line"><span class="type">bool</span> <span class="title function_">list_empty</span><span class="params">(<span class="keyword">struct</span> <span class="built_in">list</span>* plist)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> (plist-&gt;head.next == &amp;plist-&gt;tail ? <span class="literal">true</span> : <span class="literal">false</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>--</title>
      <link href="/2022/12/08/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86-%E8%BF%9B%E9%98%B6-%E5%88%86%E9%85%8D%E9%A1%B5%E5%86%85%E5%AD%98/"/>
      <url>/2022/12/08/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86-%E8%BF%9B%E9%98%B6-%E5%88%86%E9%85%8D%E9%A1%B5%E5%86%85%E5%AD%98/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p><a href="https://jyx-fyh.github.io/2022/12/02/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/">--</a><br><code>memory-alloc</code></p></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><p> malloc malloc  malloc </p><p>^_^<br><img src="/2022/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE22.png" alt=""><br></p><h3 id="font-color-red--font"><font color='red'></font></h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//memory.h</span></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">pool_flags</span> &#123;</span></span><br><span class="line">   PF_KERNEL = <span class="number">1</span>,    <span class="comment">// </span></span><br><span class="line">   PF_USER = <span class="number">2</span>     <span class="comment">// </span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">virtual_addr</span> &#123;</span>          </span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">bitmap</span> <span class="title">vaddr_bitmap</span>;</span>  <span class="comment">// </span></span><br><span class="line">    <span class="type">uint32_t</span> vaddr_start;        <span class="comment">// </span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">pool</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">bitmap</span> <span class="title">pool_bitmap</span>;</span> <span class="comment">// /</span></span><br><span class="line">    <span class="type">uint32_t</span> phy_addr_start; <span class="comment">// </span></span><br><span class="line">    <span class="type">uint32_t</span> pool_size;     <span class="comment">// </span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PG_P_1  1<span class="comment">// </span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PG_P_0  0<span class="comment">// </span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PG_RW_R  0<span class="comment">// R/W , /</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PG_RW_W  2<span class="comment">// R/W , //</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PG_US_S  0<span class="comment">// U/S , </span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PG_US_U  4<span class="comment">// U/S , </span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span>  <span class="title function_">mem_init</span><span class="params">()</span>;</span><br><span class="line"><span class="type">void</span>* <span class="title function_">get_kernel_pages</span><span class="params">(<span class="type">uint32_t</span> pg_cnt)</span>;</span><br><span class="line"><span class="type">void</span>* <span class="title function_">malloc_page</span><span class="params">(<span class="keyword">enum</span> pool_flags pf, <span class="type">uint32_t</span> pg_cnt)</span>;</span><br><span class="line"><span class="type">void</span>  <span class="title function_">malloc_init</span><span class="params">()</span>;</span><br><span class="line"><span class="type">uint32_t</span>* <span class="title function_">pte_ptr</span><span class="params">(<span class="type">uint32_t</span> vaddr)</span>;</span><br><span class="line"><span class="type">uint32_t</span>* <span class="title function_">pde_ptr</span><span class="params">(<span class="type">uint32_t</span> vaddr)</span>;</span><br></pre></td></tr></table></figure><ul><li>pool_flags </li><li> 18~23 //<br><img src="/2022/img/IMG_0526(20221115-170651)-1670564791259-2.png" alt="" style="zoom:67%;" /><br><a href="https://jyx-fyh.github.io/2022/11/13/%E5%BC%80%E5%90%AF%E5%88%86%E9%A1%B5%E6%9C%BA%E5%88%B6/"></a></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//memory.c</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PG_SIZE 4096</span></span><br><span class="line"><span class="comment">/***************   ********************</span></span><br><span class="line"><span class="comment">* 0xc009f0000xc009e000pcb.</span></span><br><span class="line"><span class="comment">* 128M, 0xc009a000,</span></span><br><span class="line"><span class="comment">* 4,512M */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MEM_BITMAP_BASE 0xc009a000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PDE_IDX(addr) ((addr &amp; 0xffc00000) &gt;&gt; 22) <span class="comment">//addr,addr&gt;&gt;22</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PTE_IDX(addr) ((addr &amp; 0x003ff000) &gt;&gt; 12) <span class="comment">//addr</span></span></span><br><span class="line"><span class="comment">/* 0xc00000003G. 0x1000001M, */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> K_HEAP_START   0xc0100000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MEM_SIZE_ADDR  0x90c</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">pool</span> <span class="title">kernel_pool</span>, <span class="title">user_pool</span>;</span>      <span class="comment">// </span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">virtual_addr</span> <span class="title">kernel_vaddr</span>;</span>        <span class="comment">// </span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* pfpg_cnt,</span></span><br><span class="line"><span class="comment"> * , NULL */</span></span><br><span class="line"><span class="type">static</span> <span class="type">void</span>* <span class="title function_">vaddr_get</span><span class="params">(<span class="keyword">enum</span> pool_flags pf, <span class="type">uint32_t</span> pg_cnt)</span> </span><br><span class="line">&#123;</span><br><span class="line">   <span class="type">int</span> vaddr_start = <span class="number">0</span>, bit_idx_start = <span class="number">-1</span>;</span><br><span class="line">   <span class="type">uint32_t</span> cnt = <span class="number">0</span>;</span><br><span class="line">   <span class="keyword">if</span> (pf == PF_KERNEL) </span><br><span class="line">   &#123;</span><br><span class="line">      bit_idx_start  = bitmap_scan(&amp;kernel_vaddr.vaddr_bitmap, pg_cnt);</span><br><span class="line">      <span class="keyword">if</span> (bit_idx_start == <span class="number">-1</span>) </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">      <span class="keyword">while</span>(cnt &lt; pg_cnt)       <span class="comment">//1,</span></span><br><span class="line">        bitmap_set(&amp;kernel_vaddr.vaddr_bitmap, bit_idx_start + cnt++, <span class="number">1</span>);</span><br><span class="line">      vaddr_start = kernel_vaddr.vaddr_start + bit_idx_start * PG_SIZE;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">   &#123;</span><br><span class="line">      <span class="comment">// ,</span></span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> (<span class="type">void</span>*)vaddr_start;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* vaddrpte*/</span></span><br><span class="line"><span class="type">uint32_t</span>* <span class="title function_">pte_ptr</span><span class="params">(<span class="type">uint32_t</span> vaddr)</span> </span><br><span class="line">&#123;</span><br><span class="line">   <span class="type">uint32_t</span>* pte = (<span class="type">uint32_t</span>*)(<span class="number">0xffc00000</span> + ((vaddr &amp; <span class="number">0xffc00000</span>) &gt;&gt; <span class="number">10</span>) + PTE_IDX(vaddr) * <span class="number">4</span>);</span><br><span class="line">   <span class="keyword">return</span> pte;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* vaddrpde */</span></span><br><span class="line"><span class="type">uint32_t</span>* <span class="title function_">pde_ptr</span><span class="params">(<span class="type">uint32_t</span> vaddr)</span> </span><br><span class="line">&#123;</span><br><span class="line">   <span class="comment">/* 0xfffff */</span></span><br><span class="line">   <span class="type">uint32_t</span>* pde = (<span class="type">uint32_t</span>*)((<span class="number">0xfffff000</span>) + PDE_IDX(vaddr) * <span class="number">4</span>);</span><br><span class="line">   <span class="keyword">return</span> pde;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* m_pool1,</span></span><br><span class="line"><span class="comment"> * ,NULL */</span></span><br><span class="line"><span class="type">static</span> <span class="type">void</span>* <span class="title function_">palloc</span><span class="params">(<span class="keyword">struct</span> pool* m_pool)</span> </span><br><span class="line">&#123;</span><br><span class="line">   <span class="comment">/*  */</span></span><br><span class="line">   <span class="type">int</span> bit_idx = bitmap_scan(&amp;m_pool-&gt;pool_bitmap, <span class="number">1</span>); <span class="comment">// </span></span><br><span class="line">   <span class="keyword">if</span> (bit_idx == <span class="number">-1</span> ) </span><br><span class="line">      <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">   bitmap_set(&amp;m_pool-&gt;pool_bitmap, bit_idx, <span class="number">1</span>);       <span class="comment">// bit_idx1</span></span><br><span class="line">   <span class="type">uint32_t</span> page_phyaddr = ((bit_idx * PG_SIZE) + m_pool-&gt;phy_addr_start);</span><br><span class="line">   <span class="keyword">return</span> (<span class="type">void</span>*)page_phyaddr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* _vaddr_page_phyaddr */</span></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">page_table_add</span><span class="params">(<span class="type">void</span>* _vaddr, <span class="type">void</span>* _page_phyaddr)</span> </span><br><span class="line">&#123;</span><br><span class="line">   <span class="type">uint32_t</span>  vaddr = (<span class="type">uint32_t</span>)_vaddr;</span><br><span class="line">   <span class="type">uint32_t</span>  page_phyaddr = (<span class="type">uint32_t</span>)_page_phyaddr;</span><br><span class="line">   <span class="type">uint32_t</span>* pde = pde_ptr(vaddr);</span><br><span class="line">   <span class="type">uint32_t</span>* pte = pte_ptr(vaddr);</span><br><span class="line"></span><br><span class="line"><span class="comment">/************************      *************************</span></span><br><span class="line"><span class="comment"> * *pte,pdepde*pte,</span></span><br><span class="line"><span class="comment"> * page_fault*pde0,*pteelse*pde</span></span><br><span class="line"><span class="comment"> * *********************************************************/</span></span><br><span class="line">   <span class="comment">/* P1, */</span></span><br><span class="line">   <span class="keyword">if</span> (*pde &amp; <span class="number">0x00000001</span>)           <span class="comment">//0P,</span></span><br><span class="line">   &#123;                            <span class="comment">//()</span></span><br><span class="line">      *pte = (page_phyaddr | PG_US_U | PG_RW_W | PG_P_1);  <span class="comment">// US=1,RW=1,P=1</span></span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">else</span>                             <span class="comment">//,. </span></span><br><span class="line">   &#123;  </span><br><span class="line">      <span class="comment">/*  */</span></span><br><span class="line">      <span class="type">uint32_t</span> pde_phyaddr = (<span class="type">uint32_t</span>)palloc(&amp;kernel_pool); <span class="comment">//</span></span><br><span class="line">      *pde = (pde_phyaddr | PG_US_U | PG_RW_W | PG_P_1);     <span class="comment">//</span></span><br><span class="line">      <span class="comment">/* pde_phyaddr0,</span></span><br><span class="line"><span class="comment">       * ,.</span></span><br><span class="line"><span class="comment">       * pde,pte20.</span></span><br><span class="line"><span class="comment">       * ptepde,</span></span><br><span class="line"><span class="comment">       * 120pde*/</span></span><br><span class="line">      <span class="built_in">memset</span>((<span class="type">void</span>*)((<span class="type">int</span>)pte &amp; <span class="number">0xfffff000</span>), <span class="number">0</span>, PG_SIZE);    <span class="comment">//</span></span><br><span class="line">      assert(!(*pte &amp; <span class="number">0x00000001</span>));</span><br><span class="line">      *pte = (page_phyaddr | PG_US_U | PG_RW_W | PG_P_1);    <span class="comment">//</span></span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* pg_cnt,,NULL */</span></span><br><span class="line"><span class="type">void</span>* <span class="title function_">malloc_page</span><span class="params">(<span class="keyword">enum</span> pool_flags pf, <span class="type">uint32_t</span> pg_cnt)</span> &#123;</span><br><span class="line">   assert(pg_cnt &gt; <span class="number">0</span> &amp;&amp; pg_cnt &lt; <span class="number">3840</span>);       <span class="comment">//3840=15MB</span></span><br><span class="line"><span class="comment">/***********   malloc_page:   ***********</span></span><br><span class="line"><span class="comment">      1vaddr_get</span></span><br><span class="line"><span class="comment">      2palloc</span></span><br><span class="line"><span class="comment">      3page_table_add</span></span><br><span class="line"><span class="comment">***************************************************************/</span></span><br><span class="line">   <span class="type">void</span>* vaddr_start = vaddr_get(pf, pg_cnt);</span><br><span class="line">   <span class="keyword">if</span> (vaddr_start == <span class="literal">NULL</span>) </span><br><span class="line">      <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">   <span class="type">uint32_t</span> vaddr = (<span class="type">uint32_t</span>)vaddr_start, cnt = pg_cnt;</span><br><span class="line">   <span class="class"><span class="keyword">struct</span> <span class="title">pool</span>* <span class="title">mem_pool</span> =</span> pf &amp; PF_KERNEL ? &amp;kernel_pool : &amp;user_pool;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/* ,,*/</span></span><br><span class="line">   <span class="keyword">while</span> (cnt-- &gt; <span class="number">0</span>) </span><br><span class="line">   &#123;</span><br><span class="line">      <span class="type">void</span>* page_phyaddr = palloc(mem_pool);      <span class="comment">//palloc</span></span><br><span class="line">      <span class="keyword">if</span> (page_phyaddr == <span class="literal">NULL</span>)   <span class="comment">// </span></span><br><span class="line">      &#123;  </span><br><span class="line">          <span class="comment">//,</span></span><br><span class="line">          <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      page_table_add((<span class="type">void</span>*)vaddr, page_phyaddr); <span class="comment">//  </span></span><br><span class="line">      vaddr += PG_SIZE;                          <span class="comment">// </span></span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> vaddr_start;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* pg_cnt,,NULL */</span></span><br><span class="line"><span class="type">void</span>* <span class="title function_">get_kernel_pages</span><span class="params">(<span class="type">uint32_t</span> pg_cnt)</span> &#123;</span><br><span class="line">   <span class="type">void</span>* vaddr =  malloc_page(PF_KERNEL, pg_cnt);</span><br><span class="line">   <span class="keyword">if</span> (vaddr != <span class="literal">NULL</span>)  <span class="comment">// ,0</span></span><br><span class="line">      <span class="built_in">memset</span>(vaddr, <span class="number">0</span>, pg_cnt * PG_SIZE);</span><br><span class="line">   <span class="keyword">return</span> vaddr;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//==========mem_pool_initmem_init,,=====================</span></span><br></pre></td></tr></table></figure><p></p><ul><li><p> 41  PTE <a href="">-</a></p></li><li><p> 57 <strong></strong>  A  58  B  B  58 <strong> A  1  CPU AB </strong> <strong><font color='orange'></font></strong> </p></li><li><p> vaddr_get()  palloc()  100  malloc_page()  <strong></strong>  115  while()  58  1 </p></li><li><p><strong><u><font color='gree'> 79~96 </font></u></strong> <br>1 79  vaddr <u></u> 79  if <strong> 133 </strong>  get_kernel_pages()  0133 P  0 P  P=0<br>2 85 <strong><font color='orange'></font></strong> /<strong></strong><br>3 93  0 P=0 pde_phyadd </p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">memset</span>(pde_phyadd, <span class="number">0</span>, PG_SIZE);</span><br></pre></td></tr></table></figure><p><strong><font color='orange'> pde_phyadd </font></strong>  pde_phyadd 87 <code>(void*)((int)pte &amp; 0xfffff000)</code>  pde_phyadd </p><blockquote><p> 0<a href="https://jyx-fyh.github.io/2022/11/13/%E5%BC%80%E5%90%AF%E5%88%86%E9%A1%B5-%E4%BB%A3%E7%A0%81%E8%AF%A6%E8%A7%A3/">-</a> loader.s  122 </p></blockquote><blockquote><p><a href="https://jyx-fyh.github.io/2022/11/13/%E5%BC%80%E5%90%AF%E5%88%86%E9%A1%B5%E6%9C%BA%E5%88%B6/"></a></p></blockquote><blockquote><p> 1MB  1GB 769~1022</p></blockquote></li><li><p>vaddr_get()palloc()page_table_add()  malloc_page() </p></li></ul><p><img src="/2022/img/image-20221211151606411.png" alt=""></p><p>OK</p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/12/05/%E8%AF%A6%E8%A7%A3%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C%E5%87%BD%E6%95%B0/"/>
      <url>/2022/12/05/%E8%AF%A6%E8%A7%A3%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C%E5%87%BD%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p><code>string</code></p></blockquote><p> memcpymemset  strcpystrcat </p><p><strong><mark class="hl-label blue">memset</mark> </strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">memset</span><span class="params">(<span class="type">void</span>* dst, <span class="type">char</span> var, <span class="type">unsigned</span> <span class="type">int</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">    assert(dst != <span class="literal">NULL</span>);</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span>* tmp = dst;</span><br><span class="line">    <span class="keyword">while</span>((size--) &gt; <span class="number">0</span>)</span><br><span class="line">        *tmp++ = var;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><font color='orange'><code>void*</code> </font></strong>  <code>unsigned char* tmp</code>  <code>void* dst</code> tmp  1 </p><blockquote><p> <code>++</code>  <code>--</code> <br></p></blockquote><p><strong><mark class="hl-label blue">memcpy</mark> </strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">memcpy</span><span class="params">(<span class="type">void</span>* dst, <span class="type">void</span>* src, <span class="type">unsigned</span> <span class="type">int</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">    assert(dst != <span class="literal">NULL</span>);</span><br><span class="line">    assert(src != <span class="literal">NULL</span>);</span><br><span class="line">    src = (<span class="type">char</span> *)src + size - <span class="number">1</span>;</span><br><span class="line">    dst = (<span class="type">char</span> *)dst + size - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(size--)</span><br><span class="line">    &#123;</span><br><span class="line">        *(<span class="type">char</span> *)dst = *(<span class="type">char</span> *)src;</span><br><span class="line">        dst = (<span class="type">char</span> *)dst - <span class="number">1</span>;</span><br><span class="line">        src = (<span class="type">char</span> *)src - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><ol><li> <code>assert(dst!=NULL &amp;&amp; src!=NULL)</code> <br> dst  src </li><li> <strong><font color='orange'></font></strong> <a href="https://jyx-fyh.github.io/2022/06/19/memcpy%E4%B8%8Ememmove%E7%9A%84%E5%8C%BA%E5%88%AB/">memcpymemmove</a> </li></ol><p><strong><mark class="hl-label blue">memcpy</mark> </strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">memcmp</span><span class="params">(<span class="type">const</span> <span class="type">void</span>* mem1, <span class="type">const</span> <span class="type">void</span>* mem2, <span class="type">unsigned</span> <span class="type">int</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">    assert(mem1 != <span class="literal">NULL</span>);</span><br><span class="line">    assert(mem2 != <span class="literal">NULL</span>);</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span>* tmp1 = mem1;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span>* tmp2 = mem2;</span><br><span class="line">    <span class="keyword">while</span>((size++) &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(*tmp1 != *tmp2)</span><br><span class="line">            <span class="keyword">return</span> *tmp1 &gt; *tmp2 ? <span class="number">1</span> : <span class="number">-1</span>;</span><br><span class="line">        tmp1++;</span><br><span class="line">        tmp2++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><mark class="hl-label blue">strcpy</mark> </strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span>* <span class="title function_">strcpy</span><span class="params">(<span class="type">char</span>* dst,<span class="type">const</span> <span class="type">char</span>* src)</span></span><br><span class="line">&#123;</span><br><span class="line">    assert(dst != <span class="literal">NULL</span>);</span><br><span class="line">    assert(src != <span class="literal">NULL</span>);</span><br><span class="line">    <span class="keyword">if</span>(dst == src)</span><br><span class="line">        <span class="keyword">return</span> src;</span><br><span class="line">    <span class="type">char</span>* tmp = dst;</span><br><span class="line">    <span class="keyword">while</span>((*dst++ = *src++) != <span class="string">&#x27;\0&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> tmp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li> src  const </li><li> 5 </li><li> 8  <code>*src</code> </li></ul><p><br><img src="/2022/img/image-20221205235315941.png" alt=""></p><p></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span>* <span class="title function_">strcpy</span><span class="params">(<span class="type">char</span>* dst, <span class="type">const</span> <span class="type">char</span>* src)</span></span><br><span class="line">&#123;</span><br><span class="line">    assert(dst != <span class="literal">NULL</span>);</span><br><span class="line">    assert(src != <span class="literal">NULL</span>);</span><br><span class="line">    <span class="keyword">if</span>(dst == src)</span><br><span class="line">        <span class="keyword">return</span> src;</span><br><span class="line">    <span class="built_in">memcpy</span>(dst,src,<span class="built_in">strlen</span>(src)+<span class="number">1</span>); <span class="comment">//+1&#x27;\0&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> dst;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2022/img/image-20221205235435072.png" alt=""></p><p><strong><mark class="hl-label blue">strlen</mark> </strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">int</span> <span class="title function_">strlen</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* str)</span></span><br><span class="line">&#123;</span><br><span class="line">    assert(str != <span class="literal">NULL</span>);</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span>* tmp = str;</span><br><span class="line">    <span class="keyword">while</span>(*tmp++);</span><br><span class="line">    <span class="keyword">return</span> tmp-str<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> -1 </p><blockquote><p> 1<code>while(*tmp) tmp++;</code>  1 </p></blockquote><p><strong><mark class="hl-label blue">strcmp</mark> </strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">strcmp</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* dst, <span class="type">const</span> <span class="type">char</span>* src)</span></span><br><span class="line">&#123;</span><br><span class="line">    assert(dst != <span class="literal">NULL</span>);</span><br><span class="line">    assert(src != <span class="literal">NULL</span>);</span><br><span class="line">    <span class="keyword">while</span>(*dst != <span class="string">&#x27;\0&#x27;</span> &amp;&amp; *dst==*src)</span><br><span class="line">    &#123;</span><br><span class="line">        dst++;</span><br><span class="line">        src++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> *dst &lt; *src ? <span class="number">-1</span> : *dst &gt; *src;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> 10  01-1</p><p><strong><mark class="hl-label blue">strchrstrrchr</mark> </strong><br>strchr  <strong>str</strong>  <strong>c</strong> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span>* <span class="title function_">strchr</span><span class="params">(<span class="type">const</span> <span class="type">char</span> * str,<span class="type">char</span> ch)</span></span><br><span class="line">&#123;</span><br><span class="line">    assert(str != <span class="literal">NULL</span>);</span><br><span class="line">    <span class="keyword">while</span> (*str &amp;&amp; *str != ch)</span><br><span class="line">        str++;</span><br><span class="line">    <span class="keyword">if</span> (*str == ch)</span><br><span class="line">        <span class="keyword">return</span> str;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>strrchr  <strong>str</strong>  <strong>c</strong> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span>* <span class="title function_">strrchr</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* str,<span class="type">char</span> ch)</span></span><br><span class="line">&#123;</span><br><span class="line">    assert(str != <span class="literal">NULL</span>);</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span>* last_char = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">while</span> (*str != <span class="number">0</span>) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (*str == ch) </span><br><span class="line">            last_char = str;</span><br><span class="line">        str++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (<span class="type">char</span>*)last_char;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><mark class="hl-label blue">strcat</mark> </strong><br>string-concatenate</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span>* <span class="title function_">strcat</span><span class="params">(<span class="type">char</span>* dst, <span class="type">const</span> <span class="type">char</span>* src)</span></span><br><span class="line">&#123;</span><br><span class="line">    assert(dst != <span class="literal">NULL</span>);</span><br><span class="line">    assert(src != <span class="literal">NULL</span>);</span><br><span class="line">    <span class="comment">//strcpystrcat</span></span><br><span class="line">    <span class="built_in">strcpy</span> (dst + <span class="built_in">strlen</span> (dst), src);</span><br><span class="line">    <span class="keyword">return</span> dst;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><mark class="hl-label blue">strchrs</mark> </strong><br>string-char-reserch</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">int</span> <span class="title function_">strchrs</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* src, <span class="type">char</span> ch)</span></span><br><span class="line">&#123;</span><br><span class="line">    assert(src != <span class="literal">NULL</span>);</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span>* tmp = src;</span><br><span class="line">    <span class="keyword">while</span>(*tmp)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(*tmp == ch)</span><br><span class="line">            cnt++;</span><br><span class="line">        tmp++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>--</title>
      <link href="/2022/12/03/%E7%BA%BF%E7%A8%8B%E5%9F%BA%E7%A1%80/"/>
      <url>/2022/12/03/%E7%BA%BF%E7%A8%8B%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p><a href="https://blog.csdn.net/qq_26442553/article/details/78729793"></a><a href="https://cloud.tencent.com/developer/article/1688297"></a><br><code>thread</code></p></blockquote><p></p><h3 id="font-color-red--font"><font color='red'></font></h3><ul><li><strong><font color='gree'></font></strong><br></li><li><strong><font color='gree'></font></strong><br> CPU <strong></strong> </li><li><strong><font color='gree'>PCB</font></strong><br>//</li><li><strong><font color='gree'></font></strong><br></li><li><strong><font color='gree'></font></strong><br></li></ul><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong><mark class="hl-label blue"></mark> </strong><br><strong></strong> <strong> CPU  CPU </strong> </p><blockquote><p><strong></strong> </p></blockquote><p><strong></strong> <br><strong></strong> </p><p><strong><mark class="hl-label blue"></mark> </strong></p><p><a href="https://www.zhihu.com/question/19732473/answer/241673170"></a> </p><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong><u> CPU </u></strong>  CPU  A  func()  func()  A  A A A  CPU  A  CPU  func() </p><p><strong><u></u></strong> </p><ul><li><p> <strong><font color='gree'></font></strong> <strong><font color='gree'> CPU </font></strong> </p></li><li><p><strong><font color='gree'></font></strong> <u></u><strong><font color='gree'></font></strong> </p><blockquote><p> 4GB </p></blockquote></li><li><p><u></u></p></li><li><p><strong><font color='gree'>=+</font></strong> </p></li></ul><blockquote><p><strong><font color='red'>Window  API  CreateProgress  CreateThread  Linux task task_struct task_struct </font></strong> </p></blockquote><p> func()  CPU <strong></strong>  CPU  Linux  C </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span>  </span></span><br><span class="line"><span class="type">void</span> *<span class="title function_">ThreadFun</span><span class="params">(<span class="type">void</span> *arg)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (arg == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;arg is NULL\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, (<span class="type">char</span>*)arg);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> res;</span><br><span class="line">    <span class="type">char</span> * url = <span class="string">&quot;http://c.biancheng.net&quot;</span>;</span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="type">pthread_t</span> myThread1,myThread2;</span><br><span class="line">    <span class="comment">// myThread1 </span></span><br><span class="line">    res = pthread_create(&amp;myThread1, <span class="literal">NULL</span>, ThreadFun, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="keyword">if</span> (res != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p> pthread_create() </p></blockquote><p><strong><mark class="hl-label blue"></mark> </strong></p><ul><li></li><li></li><li></li><li></li></ul><blockquote><p></p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td></td><td></td></tr><tr><td></td><td></td></tr><tr><td></td><td></td></tr><tr><td></td><td></td></tr><tr><td></td><td></td></tr><tr><td></td><td></td></tr></tbody></table></blockquote><h3 id="font-color-red-PCB-font"><font color='red'>PCB</font></h3><p>PCB(Process Control Block)<strong><u>PCB </u></strong> PCB </p><table><thead><tr><th></th><th><strong></strong></th><th></th><th>PID</th><th></th><th></th><th><strong></strong></th><th></th></tr></thead></table><p> PCB </p><ul><li><p><strong>PCB </strong> <strong><font color='orange'> PCB PCB  PCB PID</font></strong>  <a href="https://jyx-fyh.github.io/2022/12/02/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/"></a></p><blockquote><p><strong><font color='gree'> ring0  ring3 </font></strong>  PCB  PCB <u></u></p><ul><li></li><li> PCB  PCB  free</li></ul></blockquote></li><li><p> PCB <strong><font color='gree'>Linux  task_struct  NULL</font></strong>  CR2 </p></li><li><p><strong><u></u></strong>  A  CPU  1 0  CPU <strong> CPU </strong> </p></li><li><p><strong><font color='gree'> PCB </font></strong> </p></li><li><p><strong>PID</strong>  PID <strong>PID </strong> PID </p></li><li><p><strong><font color='gree'>(running)(ready)(blocked)</font></strong>  (running)(ready)(blocked)(waiting)(hanging)(dead)</p><blockquote><p></p></blockquote></li></ul><h3 id="font-color-red--font"><font color='red'></font></h3><p> Linux  task_struct </p><blockquote><p></p></blockquote><p><strong><mark class="hl-label blue"></mark> </strong><br><strong></strong></p><ol><li><p></p><blockquote><p> CPU  CPU</p></blockquote></li><li><p></p></li><li><p> CPU </p></li></ol><p><strong></strong></p><ol><li></li><li></li><li></li></ol><p><strong><mark class="hl-label blue"></mark> </strong><br><strong></strong></p><ol><li></li><li></li></ol><p><strong></strong></p><ol><li> CPU </li><li></li></ol><p><strong><mark class="hl-label blue"></mark> </strong><br><strong><u></u></strong>  5  5  2  3 </p><img src="/2022/img/IMG_0564(20221216-100357).PNG" style="zoom:67%;" /><ol><li></li><li></li><li></li></ol><p><strong></strong></p><h3 id="font-color-red--font"><font color='red'></font></h3><p> <strong><font color='orange'><u></u></font></strong>  thread.h</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//thread.h</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">void</span> <span class="title function_">thread_func</span><span class="params">(<span class="type">void</span>*)</span>; <span class="comment">//typedef</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">task_status</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    TASK_RUNNING,</span><br><span class="line">    TASK_READY,</span><br><span class="line">    TASK_BLOCKED,</span><br><span class="line">    TASK_WAITING,</span><br><span class="line">    TASK_HANGING,</span><br><span class="line">    TASK_DIED</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">intr_stack</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">uint32_t</span> vec_num;</span><br><span class="line">    <span class="type">uint32_t</span> edi;</span><br><span class="line">    <span class="type">uint32_t</span> esi;</span><br><span class="line">    <span class="type">uint32_t</span> ebp;</span><br><span class="line">    <span class="type">uint32_t</span> esp_dummy;</span><br><span class="line">    <span class="type">uint32_t</span> ebx;</span><br><span class="line">    <span class="type">uint32_t</span> edx;</span><br><span class="line">    <span class="type">uint32_t</span> ecx;</span><br><span class="line">    <span class="type">uint32_t</span> eax;</span><br><span class="line">    <span class="type">uint32_t</span> gs;</span><br><span class="line">    <span class="type">uint32_t</span> fs;</span><br><span class="line">    <span class="type">uint32_t</span> es;</span><br><span class="line">    <span class="type">uint32_t</span> ds;</span><br><span class="line">    <span class="comment">//------CPU------------</span></span><br><span class="line">    <span class="type">uint32_t</span> err_code;</span><br><span class="line">    <span class="type">void</span> (*eip) (<span class="type">void</span>);</span><br><span class="line">    <span class="type">uint32_t</span> cs;</span><br><span class="line">    <span class="type">uint32_t</span> eflags;</span><br><span class="line">    <span class="comment">//-----------</span></span><br><span class="line">    <span class="type">void</span>* esp;</span><br><span class="line">    <span class="type">uint32_t</span> ss;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">thread_stack</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">uint32_t</span> ebp;</span><br><span class="line">    <span class="type">uint32_t</span> ebx;</span><br><span class="line">    <span class="type">uint32_t</span> edi;</span><br><span class="line">    <span class="type">uint32_t</span> esi;</span><br><span class="line"></span><br><span class="line">    <span class="type">void</span> (*eip) (thread_func* func, <span class="type">void</span>* func_arg);</span><br><span class="line">    <span class="type">void</span>* unused_retaddr;</span><br><span class="line">    thread_func* function;</span><br><span class="line">    <span class="type">void</span>* func_arg;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* pcb, */</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">task_struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">uint32_t</span>* self_kstack;   <span class="comment">//</span></span><br><span class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">task_status</span> <span class="title">status</span>;</span> <span class="comment">//</span></span><br><span class="line">    <span class="type">uint8_t</span> priority;        <span class="comment">//</span></span><br><span class="line">    <span class="type">char</span> name[<span class="number">16</span>];           <span class="comment">//</span></span><br><span class="line">    <span class="type">uint32_t</span> stack_magic;    <span class="comment">//PCB</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">thread_create</span><span class="params">(<span class="keyword">struct</span> task_struct* pthread, thread_func function, <span class="type">void</span>* func_arg)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">init_thread</span><span class="params">(<span class="keyword">struct</span> task_struct* pthread, <span class="type">char</span>* name, <span class="type">int</span> prio)</span>;</span><br><span class="line"><span class="keyword">struct</span> task_struct* <span class="title function_">thread_start</span><span class="params">(<span class="type">char</span>* name, <span class="type">int</span> prio, thread_func function, <span class="type">void</span>* func_arg)</span>;</span><br></pre></td></tr></table></figure><ul><li><p> 4  task_status (running)(ready)(blocked)(waiting)(hanging)(dead) </p></li><li><p> 14  <code>interrupt.s</code> </p><p><img src="/2022/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE25.png" alt=""><br><strong> <code>intr_stack</code> </strong> </p><p>1<br>2 SS  ESP<strong><u></u></strong> </p></li><li><p> 39 <br>1 ebpebxediesi  ABI<a href="https://jyx-fyh.github.io/2022/11/16/%E6%B5%85%E6%9E%90C%E5%92%8C%E6%B1%87%E7%BC%96%E6%B7%B7%E5%90%88%E7%BC%96%E7%A8%8B/">C</a><br>2</p><ul><li><p>eip eip  kernel_thread()  kernel_thread </p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">kernel_thread</span><span class="params">(thread_func* function, <span class="type">void</span>* func_arg)</span>&#123;</span><br><span class="line">    function(func_arg);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>unused_retaddr kernel_thread()  <code>call</code>  <code>ret</code>  <code>ret</code> <u>kernel_thread()  <code>switch.s</code>  <code>ret</code> </u> <strong>kernel_thread()  C C  call  call call</strong>  kernel_thread() </p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">push  func_arg</span><br><span class="line">push  function</span><br><span class="line">call  kernel_thread </span><br><span class="line">;------------------kernel_thread</span><br><span class="line">push  [esp-8]</span><br><span class="line">call  function</span><br></pre></td></tr></table></figure><p> <code>[esp-8]</code>  func_arg <strong><u> 8  function </u></strong>  <code>ret</code>  <code>call</code>  kernel_thread()  call </p><blockquote><p> kernel_thread() </p></blockquote></li><li><p>function  func_arg <strong>(function) void</strong>* <strong><font color='gree'></font></strong></p></li></ul></li><li><p> 53  task_struct  stack_magic  PCB  PCB  PCB  task_struct <br><img src="/2022/img/26.png" style="zoom:80%;" /><br> task_struct  stack_magic stack_magic  stack_magic </p></li></ul><p> thread.c</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//thread.c</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PG_SIZE 4096</span></span><br><span class="line"><span class="type">static</span> <span class="type">uint32_t</span>* <span class="built_in">stack</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">kernel_thread</span><span class="params">(thread_func* function, <span class="type">void</span>* func_arg)</span></span><br><span class="line">&#123;</span><br><span class="line">    function(func_arg);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">thread_create</span><span class="params">(<span class="keyword">struct</span> task_struct* pthread, thread_func function, <span class="type">void</span>* func_arg)</span></span><br><span class="line">&#123;</span><br><span class="line">    pthread-&gt;self_kstack -= <span class="keyword">sizeof</span>(<span class="keyword">struct</span> intr_stack);</span><br><span class="line">    pthread-&gt;self_kstack -= <span class="keyword">sizeof</span>(<span class="keyword">struct</span> thread_stack);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">thread_stack</span>* <span class="title">kthread_stack</span> =</span> (<span class="keyword">struct</span> thread_stack*)pthread-&gt;self_kstack;</span><br><span class="line">    kthread_stack-&gt;eip = kernel_thread;</span><br><span class="line">    kthread_stack-&gt;function = function;</span><br><span class="line">    kthread_stack-&gt;func_arg = func_arg;</span><br><span class="line">    kthread_stack-&gt;ebp = kthread_stack-&gt;ebx = kthread_stack-&gt;esi = kthread_stack-&gt;edi = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">init_thread</span><span class="params">(<span class="keyword">struct</span> task_struct* pthread, <span class="type">char</span>* name, <span class="type">int</span> prio)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">memset</span>(pthread, <span class="number">0</span>, <span class="keyword">sizeof</span>(*pthread));</span><br><span class="line">    <span class="built_in">strcpy</span>(pthread-&gt;name, name);</span><br><span class="line">    pthread-&gt;status = TASK_RUNNING;</span><br><span class="line">    pthread-&gt;priority = prio;</span><br><span class="line">    pthread-&gt;self_kstack = (<span class="type">uint32_t</span>*)((<span class="type">uint32_t</span>)pthread + PG_SIZE); <span class="comment">//PCB,</span></span><br><span class="line">    pthread-&gt;stack_magic = <span class="number">0x19870916</span>;  <span class="comment">// </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* prio,name,function(func_arg) */</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">*  name:</span></span><br><span class="line"><span class="comment">*  prio:</span></span><br><span class="line"><span class="comment">*  function:</span></span><br><span class="line"><span class="comment">*  func_arg:</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line"><span class="keyword">struct</span> task_struct* <span class="title function_">thread_start</span><span class="params">(<span class="type">char</span>* name, <span class="type">int</span> prio, thread_func function, <span class="type">void</span>* func_arg)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">task_struct</span>* <span class="title">thread</span> =</span> get_kernel_pages(<span class="number">1</span>); <span class="comment">//pcb,pcb</span></span><br><span class="line">    init_thread(thread, name, prio);</span><br><span class="line">    thread_create(thread, function, func_arg);</span><br><span class="line">    <span class="built_in">stack</span> = thread-&gt;self_kstack;</span><br><span class="line">    <span class="keyword">asm</span> <span class="title function_">volatile</span><span class="params">(<span class="string">&quot;mov esp,stack&quot;</span>)</span>;</span><br><span class="line">    <span class="keyword">asm</span> <span class="title function_">volatile</span><span class="params">(<span class="string">&quot;pop ebp&quot;</span>)</span>;</span><br><span class="line">    <span class="keyword">asm</span> <span class="title function_">volatile</span><span class="params">(<span class="string">&quot;pop ebx&quot;</span>)</span>;</span><br><span class="line">    <span class="keyword">asm</span> <span class="title function_">volatile</span><span class="params">(<span class="string">&quot;pop edi&quot;</span>)</span>;</span><br><span class="line">    <span class="keyword">asm</span> <span class="title function_">volatile</span><span class="params">(<span class="string">&quot;pop esi&quot;</span>)</span>;</span><br><span class="line">    <span class="keyword">asm</span> <span class="title function_">volatile</span><span class="params">(<span class="string">&quot;ret&quot;</span>)</span>;</span><br><span class="line">    <span class="keyword">return</span> thread;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><font color='gree'></font></strong></p><ol><li><strong> <code>thread_start()</code> </strong></li><li><strong> <code>thread_start()</code>  PCB </strong></li><li><strong> <code>init_thread()</code> </strong></li><li><strong> <code>thread_create()</code> </strong></li><li><strong></strong></li></ol><p></p><ul><li><p> 40  PCB <strong><u></u></strong> </p></li><li><p> 1213  self_stack  self_stack <strong><font color='orange'> inr_stack </font></strong> </p></li><li><p> 18  0</p></li><li><p> 44  esp  stack <a href="https://jyx-fyh.github.io/2022/11/30/%E5%BA%95%E5%B1%82%E5%89%96%E6%9E%90assert%E6%96%AD%E8%A8%80/">assert</a> 44 <strong></strong>  4  pop esp  eip eip  <code>thread_create()</code>  <code>kernel_thread()</code>  <code>ret</code> <code>kernel_thread()</code>  <code>function()</code> <br><img src="/2022/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE27.png" alt=""></p><blockquote><p></p></blockquote></li><li><p><code>thread_create()</code>  void  void ok printf</p></li></ul><p><img src="/2022/img/image-20221216210636536.png" alt=""></p><p><a href="https://jyx-fyh.github.io/2022/12/16/%E7%BA%BF%E7%A8%8B%E8%BF%9B%E9%98%B6/">--</a> </p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>--</title>
      <link href="/2022/12/02/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/"/>
      <url>/2022/12/02/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p><code>memory</code></p></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong></strong> <br><img src="/2022/img/v2-4c9fcddd65b35e84c4c6783aaeee3826_720w.jpg" alt=""></p><p></p><ol><li><strong><font color='orange'> BIOS </font></strong><br> BIOS </li><li><strong><font color='orange'></font></strong><br></li><li><strong><font color='orange'></font></strong><br></li><li><strong><font color='orange'></font></strong><br></li></ol><h3 id="font-color-red--font"><font color='red'></font></h3><p> BIOS  BIOS BIOS <strong> loader.s  BIOS </strong> </p><blockquote><p><strong> BIOS </strong> </p><ol><li>BIOS IVT <code>int</code>  IVT  <code>int</code>  IDT IVT </li><li>BIOS  16  32 </li></ol></blockquote><p>Linux  0x15  BIOS </p><ul><li>EAX = 0xE820 </li><li>AX   = 0xE801  4GB </li><li>AH   = 0x88      64 MB </li></ul><blockquote><p> EAX  AX </p></blockquote><p> 100 KB 0x88  177  0x88 <br><img src="/2022/img/IMG_0561(20221206-184055).PNG" alt=""><br><strong></strong></p><ul><li><strong>0x88  1 MB 1MB </strong></li><li> AX  1KB  1 </li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">total_mem_bytes dd 0</span><br><span class="line">;-----------------  int 15h ah = 0x88 ,64M  ----------</span><br><span class="line">.e801_failed_so_try88:</span><br><span class="line">   ;int 15axkb</span><br><span class="line">   mov  ah, 0x88</span><br><span class="line">   int  0x15</span><br><span class="line">   jc .error_hlt     ;CF0</span><br><span class="line">   and eax,0x0000FFFF;1024,1MB(1024KB)</span><br><span class="line"></span><br><span class="line">   ;16ax,32.16dx16ax</span><br><span class="line">   mov cx, 0x400     ;0x4001024,axbyte</span><br><span class="line">   mul cx</span><br><span class="line">   shl edx, 16       ;dx16</span><br><span class="line">   or edx, eax       ;16edx,32</span><br><span class="line">   add edx,0x100000  ;0x881MB,1MB</span><br><span class="line"></span><br><span class="line">.mem_get_ok:</span><br><span class="line">   mov [total_mem_bytes], edx ;bytetotal_mem_bytes</span><br><span class="line">   jmp prepare       ;,</span><br><span class="line"></span><br><span class="line">.error_hlt:          ;</span><br><span class="line">   hlt</span><br></pre></td></tr></table></figure><p> <code>total_mem_bytes</code>  memory.c  C  <code>global</code>  <code>total_mem_bytes</code>  C  <code>extern total_mem_bytes</code>  loader.o  makefile </p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">KERNEL=build/guide.o  build/print.o  build/main.o build/interrupt.o build/idt.o build/port_io.o \</span><br><span class="line">       build/timer.o  build/intrmgr.o  build/debug.o  build/string.o  build/memory.o  build/bitmap.o \</span><br><span class="line"><span class="variable">$(BUILD)</span>/kernel.bin: <span class="variable">$(KERNEL)</span></span><br><span class="line">ld  -m elf_i386 <span class="variable">$^</span> -o <span class="variable">$@</span> -Ttext 0x00001500</span><br></pre></td></tr></table></figure><p> loader.s  loader.s kernel.bin  loader  <code>total_mem_bytes</code> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SECTION loader vstart=BASE_ADDR              ;</span><br><span class="line">    program_length  dd program_end           ;[0x00]</span><br><span class="line">    ;</span><br><span class="line">    code_entry      dw start-BASE_ADDR       ;[0x04]</span><br><span class="line">                    dd section.loader.start  ;[0x06]</span><br><span class="line">    realloc_tbl_len dw 0                     ;0</span><br><span class="line">;=========================================================</span><br><span class="line">;,0x90c.0xc12</span><br><span class="line">    total_mem_bytes dd 0</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">;BASE_ADDR=0X900</span><br><span class="line">;dd=4bytes, dw=2bytes</span><br><span class="line">BASE_ADDR+4+2+4+2=0x90c</span><br></pre></td></tr></table></figure><p><code>total_mem_bytes</code>  0x90c  32MB 0x2000000<br><img src="/2022/img/image-20221207201205263.png" alt=""></p><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong><u></u></strong>  8259A  IRQ  4KB 4KB <strong><font color='orange'> 1 0 </font></strong> <br><img src="/2022/img/IMG_0562(20221206-193514).PNG" style="zoom:67%;" /></p><p></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">bitmap</span> &#123;</span></span><br><span class="line">    <span class="type">uint32_t</span> btmp_bytes_len;</span><br><span class="line"><span class="comment">/* ,,, */</span></span><br><span class="line">    <span class="type">uint8_t</span>* bits;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li><code>btmp_bytes_len</code>  btmp_bytes_len*32 </li><li><code>bits</code> <strong> <code>bits</code> </strong> </li></ul><p> <code>bits</code>  <code>uint8_t*</code>  1  1 <br></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">bitmap_init</span><span class="params">(<span class="keyword">struct</span> bitmap* btmp)</span>;</span><br><span class="line"><span class="type">bool</span> <span class="title function_">bitmap_scan_test</span><span class="params">(<span class="keyword">struct</span> bitmap* btmp, <span class="type">uint32_t</span> bit_idx)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">bitmap_set</span><span class="params">(<span class="keyword">struct</span> bitmap* btmp, <span class="type">uint32_t</span> bit_idx, <span class="type">int8_t</span> value)</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">bitmap_apply</span><span class="params">(<span class="keyword">struct</span> bitmap* btmp, <span class="type">uint32_t</span> cnt)</span>;</span><br></pre></td></tr></table></figure><ul><li><code>bitmap_init</code> <strong><u> btmp  0</u></strong> </li><li><code>bitmap_scan_test</code>  <code>bit_idx</code>  1 <code>bitmap_apply</code> </li><li><code>bitmap_set</code>  <code>bit_idx</code>  0/1 </li><li><code>bitmap_apply</code> <u></u> <code>cnt</code> () -1 </li></ul><p></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//bitmap.c</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BITMAP_MASK 7</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">bitmap_init</span><span class="params">(<span class="keyword">struct</span> bitmap* btmp)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">memset</span>(btmp-&gt;bits, <span class="number">0</span>, btmp-&gt;btmp_bytes_len);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* bit_idx1,1truefalse */</span></span><br><span class="line"><span class="type">bool</span> <span class="title function_">bitmap_scan_test</span><span class="params">(<span class="keyword">struct</span> bitmap* btmp, <span class="type">uint32_t</span> bit_idx)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span> byte_idx = bit_idx / <span class="number">8</span>;    <span class="comment">// ,</span></span><br><span class="line">    <span class="type">uint32_t</span> bit_odd  = bit_idx % <span class="number">8</span>;    <span class="comment">// ,</span></span><br><span class="line">    <span class="keyword">return</span> (btmp-&gt;bits[byte_idx] &amp; (BITMAP_MASK &gt;&gt; bit_odd));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* cnt,-1 */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">bitmap_apply</span><span class="params">(<span class="keyword">struct</span> bitmap* btmp, <span class="type">uint32_t</span> cnt)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span> idx_byte = <span class="number">0</span>; <span class="comment">// </span></span><br><span class="line"><span class="comment">/* , */</span></span><br><span class="line">    <span class="keyword">while</span> (( <span class="number">0xff</span> == btmp-&gt;bits[idx_byte]) &amp;&amp; (idx_byte &lt; btmp-&gt;btmp_bytes_len))</span><br><span class="line">    &#123;</span><br><span class="line"><span class="comment">/* 1,0xff,, */</span></span><br><span class="line">        idx_byte++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    assert(idx_byte &lt; btmp-&gt;btmp_bytes_len);</span><br><span class="line">    <span class="keyword">if</span> (idx_byte == btmp-&gt;btmp_bytes_len)</span><br><span class="line">    &#123;  <span class="comment">// </span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">     * ,*/</span></span><br><span class="line">    <span class="type">int</span> idx_bit = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">/* btmp-&gt;bits[idx_byte] */</span></span><br><span class="line">    <span class="keyword">while</span> ((<span class="type">uint8_t</span>)(BITMAP_MASK &gt;&gt; idx_bit) &amp; btmp-&gt;bits[idx_byte])</span><br><span class="line">        idx_bit++;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> bit_idx_start = idx_byte * <span class="number">8</span> + idx_bit;    <span class="comment">// </span></span><br><span class="line">    <span class="keyword">if</span> (cnt == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> bit_idx_start;</span><br><span class="line"></span><br><span class="line">    <span class="type">uint32_t</span> bit_left = (btmp-&gt;btmp_bytes_len * <span class="number">8</span> - bit_idx_start);  <span class="comment">// </span></span><br><span class="line">    <span class="type">uint32_t</span> next_bit = bit_idx_start + <span class="number">1</span>;</span><br><span class="line">    <span class="type">uint32_t</span> count = <span class="number">1</span>;      <span class="comment">// </span></span><br><span class="line"></span><br><span class="line">    bit_idx_start = <span class="number">-1</span>;      <span class="comment">// -1,</span></span><br><span class="line">    <span class="keyword">while</span> ((bit_left--) &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!(bitmap_scan_test(btmp, next_bit)))  <span class="comment">// next_bit0</span></span><br><span class="line">            count++;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (count == cnt)     <span class="comment">//cnt</span></span><br><span class="line">        &#123;</span><br><span class="line">            bit_idx_start = next_bit - cnt + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        next_bit++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> bit_idx_start;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* btmpbit_idxvalue */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">bitmap_set</span><span class="params">(<span class="keyword">struct</span> bitmap* btmp, <span class="type">uint32_t</span> bit_idx, <span class="type">int8_t</span> value)</span></span><br><span class="line">&#123;</span><br><span class="line">    assert(value == <span class="number">1</span>);</span><br><span class="line">    assert(value == <span class="number">0</span>);</span><br><span class="line">    <span class="type">uint32_t</span> byte_idx = bit_idx / <span class="number">8</span>;    <span class="comment">// ,</span></span><br><span class="line">    <span class="type">uint32_t</span> bit_odd  = bit_idx % <span class="number">8</span>;    <span class="comment">// ,</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 1,,0*/</span></span><br><span class="line">    <span class="keyword">if</span> (value)    <span class="comment">// value1</span></span><br><span class="line">        btmp-&gt;bits[byte_idx] |= (BITMAP_MASK &gt;&gt; bit_odd);</span><br><span class="line">    <span class="keyword">else</span>          <span class="comment">// 0</span></span><br><span class="line">        btmp-&gt;bits[byte_idx] &amp;= ~(BITMAP_MASK &gt;&gt; bit_odd);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><ul><li><p> 13 </p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> BITMAP_MASK 1</span></span><br><span class="line"><span class="comment">//.......</span></span><br><span class="line"><span class="keyword">return</span> (btmp-&gt;bits[byte_idx] &amp; (BITMAP_MASK &lt;&lt; bit_odd));</span><br><span class="line"><span class="comment">//.......</span></span><br></pre></td></tr></table></figure><p><br><img src="/2022/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE23.png" alt=""></p><p><br><img src="/2022/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE21.png" alt=""></p></li><li><p> 41  cnt==1  cnt=1 cnt  1  cnt=1 </p><blockquote><p></p></blockquote></li><li><p> 54 cnt  cnt </p></li></ul><p></p><blockquote><p><a href="https://blog.csdn.net/qq_22238021/article/details/80175461">-CSDN</a></p></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong><mark class="hl-label blue"></mark> </strong></p><p></p><blockquote><p><strong> 4KB </strong> </p></blockquote><p><strong><mark class="hl-label blue"></mark> </strong><br></p><ol><li><strong><font color='orange'></font></strong></li><li><strong><font color='orange'></font></strong></li></ol><p> 4GB <u></u></p><ul><li><p><u><strong></strong></u> </p></li><li><p> 4GB <strong><u></u></strong> </p><blockquote><p><strong><font color='orange'></font></strong></p></blockquote></li></ul><p></p><ul><li></li><li><u></u></li></ul><p></p><p><strong><font color='gree'>123</font></strong> <br><strong><font color='red'></font></strong>  <strong></strong> </p><p><strong><mark class="hl-label blue"></mark> </strong><br><br><img src="/2022/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE20.png" alt=""></p><p></p><ul><li><p> 1 MB  1MB  1MB <a href="https://jyx-fyh.github.io/2022/11/13/%E5%BC%80%E5%90%AF%E5%88%86%E9%A1%B5-%E4%BB%A3%E7%A0%81%E8%AF%A6%E8%A7%A3/">-</a></p></li><li><p> 1MB  <strong><font color='orange'> 1MB </font></strong>  1MB  1</p></li><li><p>PCB (Process Control Block, )pid PCB  PCB </p><ul><li><p><strong><u>PCB </u></strong>  PCB  0xXXXXX000 0xXXXXXfff </p><blockquote><p> 0x9f000~0x9fbff <br><img src="/2022/img/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2phZGVzaHU=,size_16,color_FFFFFF,t_70-1670387128776-1.png" alt=""><br> 0x7E00~0x9FBFF  PCB  0x9E000~0x9FBFF  PCB  0x9F000~0x9FBFF </p></blockquote></li><li><p><strong>PCB  0xXXXXXfff / <u>ring0 </u></strong>  PCB  ring0<strong><u> PCB</u></strong>  PCBguide.s esp  PCB  <code>mov esp,0x9f000</code> </p><blockquote><p><strong>PCB </strong></p></blockquote></li></ul></li><li><p><a href="https://jyx-fyh.github.io/2022/11/13/%E5%BC%80%E5%90%AF%E5%88%86%E9%A1%B5%E6%9C%BA%E5%88%B6/"></a> 1MB  1MB~2MB <u></u><strong><font color='orange'>/</font></strong> </p></li><li><p> 2MB <strong><font color='orange'> 30MB <u></u>(15MB)/</font></strong>  15MB kernel_pool 15MB  15MB user_pool 4GB </p></li><li><p> 0x9a000~0x9e000  32MB 0x5a0 </p></li></ul><p><strong><mark class="hl-label blue"></mark> </strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//memory.h</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">virtual_addr</span> &#123;</span>          </span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">bitmap</span> <span class="title">vaddr_bitmap</span>;</span>  <span class="comment">// </span></span><br><span class="line">    <span class="type">uint32_t</span> vaddr_start;        <span class="comment">// </span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">pool</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">bitmap</span> <span class="title">pool_bitmap</span>;</span> <span class="comment">// /</span></span><br><span class="line">    <span class="type">uint32_t</span> phy_addr_start; <span class="comment">// </span></span><br><span class="line">    <span class="type">uint32_t</span> pool_size;     <span class="comment">// </span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li><code>virtual_addr</code> <u></u></li><li><code>pool</code> <u></u> <code>pool</code>  <code>virtual_addr</code>  pool_size OS32MB 4GB virtual_addr </li><li></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//memory.c</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PG_SIZE 4096</span></span><br><span class="line"><span class="comment">/***************   ********************</span></span><br><span class="line"><span class="comment">* 0xc009f0000xc009e000pcb.</span></span><br><span class="line"><span class="comment">* 128M, 0xc009a000,</span></span><br><span class="line"><span class="comment">* 4,512M */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MEM_BITMAP_BASE 0xc009a000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 0xc00000003G. 0x1000001M, */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> K_HEAP_START 0xc0100000</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MEM_SIZE_ADDR  0x90c</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">pool</span> <span class="title">kernel_pool</span>, <span class="title">user_pool</span>;</span>      <span class="comment">// </span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">virtual_addr</span> <span class="title">kernel_vaddr</span>;</span>        <span class="comment">// </span></span><br><span class="line"><span class="comment">/*  */</span></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">mem_pool_init</span><span class="params">(<span class="type">uint32_t</span> all_mem)</span> &#123;</span><br><span class="line">    put_str(<span class="string">&quot;\nmem_pool_init start...\n&quot;</span>,DEFUALT);</span><br><span class="line">    <span class="type">uint32_t</span> page_table_size = PG_SIZE * <span class="number">256</span>;         <span class="comment">// 256,</span></span><br><span class="line">    <span class="type">uint32_t</span> used_mem = page_table_size + <span class="number">0x100000</span>;   <span class="comment">// 1M+/</span></span><br><span class="line">    <span class="type">uint32_t</span> free_mem = all_mem - used_mem;</span><br><span class="line">    <span class="type">uint16_t</span> all_free_pages = free_mem / PG_SIZE;     <span class="comment">// 14k,4k,</span></span><br><span class="line">    <span class="comment">// 1</span></span><br><span class="line">    <span class="type">uint16_t</span> kernel_free_pages = all_free_pages / <span class="number">2</span>;  <span class="comment">// </span></span><br><span class="line">    <span class="type">uint16_t</span> user_free_pages = all_free_pages - kernel_free_pages;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">    ,*/</span></span><br><span class="line">    <span class="type">uint32_t</span> kbm_length = kernel_free_pages / <span class="number">8</span>;      <span class="comment">// Kernel BitMap,,</span></span><br><span class="line">    <span class="type">uint32_t</span> ubm_length = user_free_pages   / <span class="number">8</span>;      <span class="comment">// User BitMap.</span></span><br><span class="line"></span><br><span class="line">    <span class="type">uint32_t</span> kp_start = used_mem;                     <span class="comment">// Kernel Pool start,</span></span><br><span class="line">    <span class="type">uint32_t</span> up_start = kp_start + kernel_free_pages * PG_SIZE;  <span class="comment">// User Pool start,</span></span><br><span class="line"></span><br><span class="line">    kernel_pool.phy_addr_start = kp_start;</span><br><span class="line">    user_pool.phy_addr_start   = up_start;</span><br><span class="line"></span><br><span class="line">    kernel_pool.pool_size = PG_SIZE * kernel_free_pages;</span><br><span class="line">    user_pool.pool_size  = PG_SIZE * user_free_pages  ;</span><br><span class="line"></span><br><span class="line">    kernel_pool.pool_bitmap.btmp_bytes_len = kbm_length;</span><br><span class="line">    user_pool.pool_bitmap.btmp_bytes_len   = ubm_length;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*********       ***********</span></span><br><span class="line"><span class="comment">    *   </span></span><br><span class="line"><span class="comment">    *   </span></span><br><span class="line"><span class="comment">    *   </span></span><br><span class="line"><span class="comment">    *   .</span></span><br><span class="line"><span class="comment">    *   ************************************************/</span></span><br><span class="line">    <span class="comment">// 0xc009f000,.(70K)</span></span><br><span class="line">    <span class="comment">// 32M2k.MEM_BITMAP_BASE(0xc009a000).</span></span><br><span class="line">    kernel_pool.pool_bitmap.bits = (<span class="type">void</span>*)MEM_BITMAP_BASE;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*  */</span></span><br><span class="line">    user_pool.pool_bitmap.bits = (<span class="type">void</span>*)(MEM_BITMAP_BASE + kbm_length);</span><br><span class="line">    <span class="comment">/********************  **********************/</span></span><br><span class="line">    put_str(<span class="string">&quot;\nkernel_pool_bitmap_start:        &quot;</span>,DEFUALT);</span><br><span class="line">    put_uint((<span class="type">uint32_t</span>)kernel_pool.pool_bitmap.bits,DEFUALT,HEX);</span><br><span class="line">    put_str(<span class="string">&quot;\nkernel_pool_bitmap_end:          &quot;</span>,DEFUALT);</span><br><span class="line">    put_uint((<span class="type">uint32_t</span>)kernel_pool.pool_bitmap.bits + kernel_pool.pool_bitmap.btmp_bytes_len,DEFUALT,HEX);</span><br><span class="line">    put_str(<span class="string">&quot;\nkernel_pool_phy_addr_start:      &quot;</span>,DEFUALT);</span><br><span class="line">    put_uint(kernel_pool.phy_addr_start,DEFUALT,HEX);</span><br><span class="line">    put_str(<span class="string">&quot;\nkernel_pool_phy_addr_end:        &quot;</span>,DEFUALT);</span><br><span class="line">    put_uint(kernel_pool.phy_addr_start + kernel_pool.pool_size,DEFUALT,HEX);</span><br><span class="line">    put_str(<span class="string">&quot;\nuser_pool_bitmap_start:          &quot;</span>,DEFUALT);</span><br><span class="line"></span><br><span class="line">    put_uint((<span class="type">uint32_t</span>)user_pool.pool_bitmap.bits,DEFUALT,HEX);</span><br><span class="line">    put_str(<span class="string">&quot;\nuser_pool_bitmap_end:            &quot;</span>,DEFUALT);</span><br><span class="line">    put_uint((<span class="type">uint32_t</span>)user_pool.pool_bitmap.bits + user_pool.pool_bitmap.btmp_bytes_len,DEFUALT,HEX);</span><br><span class="line">    put_str(<span class="string">&quot;\nuser_pool_phy_addr_start:        &quot;</span>,DEFUALT);</span><br><span class="line">    put_uint(user_pool.phy_addr_start,DEFUALT,HEX);</span><br><span class="line">    put_str(<span class="string">&quot;\nuser_pool_phy_addr_end:          &quot;</span>,DEFUALT);</span><br><span class="line">    put_uint(user_pool.phy_addr_start + user_pool.pool_size,DEFUALT,HEX);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 0*/</span></span><br><span class="line">    bitmap_init(&amp;kernel_pool.pool_bitmap);</span><br><span class="line">    bitmap_init(&amp;user_pool.pool_bitmap);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* ,*/</span></span><br><span class="line">    <span class="comment">// ,</span></span><br><span class="line">    kernel_vaddr.vaddr_bitmap.btmp_bytes_len = kbm_length;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* ,*/</span></span><br><span class="line">    kernel_vaddr.vaddr_bitmap.bits = (<span class="type">void</span>*)(MEM_BITMAP_BASE + kbm_length + ubm_length);</span><br><span class="line">    kernel_vaddr.vaddr_start = K_HEAP_START;</span><br><span class="line">    put_str(<span class="string">&quot;\nkernel_vaddr.vaddr_bitmap.start: &quot;</span>,DEFUALT);</span><br><span class="line">    put_uint((<span class="type">uint32_t</span>)kernel_vaddr.vaddr_bitmap.bits,DEFUALT,HEX);</span><br><span class="line">    put_str(<span class="string">&quot;\nkernel_vaddr.vaddr_bitmap.end:   &quot;</span>,DEFUALT);</span><br><span class="line">    put_uint((<span class="type">uint32_t</span>)kernel_vaddr.vaddr_bitmap.bits + kernel_vaddr.vaddr_bitmap.btmp_bytes_len,DEFUALT,HEX);</span><br><span class="line"></span><br><span class="line">    bitmap_init(&amp;kernel_vaddr.vaddr_bitmap);</span><br><span class="line">    put_str(<span class="string">&quot;\nmem_pool_init done\n&quot;</span>,DEFUALT);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*  */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">mem_init</span><span class="params">()</span> &#123;</span><br><span class="line">    put_str(<span class="string">&quot;mem_init start...\n&quot;</span>,DEFUALT);</span><br><span class="line">    <span class="type">uint32_t</span> mem_bytes_total = *((<span class="type">uint32_t</span>*)MEM_SIZE_ADDR);</span><br><span class="line">    put_str(<span class="string">&quot;memory size:&quot;</span>,DEFUALT);</span><br><span class="line">    put_uint(mem_bytes_total,DEFUALT,HEX);</span><br><span class="line">    mem_pool_init(mem_bytes_total);</span><br><span class="line">    put_str(<span class="string">&quot;\nmem_init done\n&quot;</span>,DEFUALT);</span><br><span class="line">&#125;<span class="comment">/*  */</span></span><br></pre></td></tr></table></figure><p></p><ul><li><p> 12 <code>MEM_SIZE_ADDR</code>  0x90c  98  <code>mem_pool_init()</code> </p></li><li><p> 19  <code>PG_SIZE*256</code> 1 1 20768 0  1 3 769~1022  254  254  <code>4096*(1+1+254)=PG_SIZE*256</code> </p><blockquote><p> 769~1022  254  4096 <a href="https://jyx-fyh.github.io/2022/11/13/%E5%BC%80%E5%90%AF%E5%88%86%E9%A1%B5-%E4%BB%A3%E7%A0%81%E8%AF%A6%E8%A7%A3/">-</a> 769~1022 </p></blockquote></li><li><p> 35 <strong> 2MB </strong>  2MB 0~1MB 1~2MB </p></li><li><p> 86  <code>K_HEAP_START</code>  0xc0100000 <a href="https://jyx-fyh.github.io/2022/11/13/%E5%BC%80%E5%90%AF%E5%88%86%E9%A1%B5-%E4%BB%A3%E7%A0%81%E8%AF%A6%E8%A7%A3/">-</a><strong> 1GB  1MB  1MB  0x0~0xc0100000  1MB 0xc0100000 </strong>  <code>K_HEAP_START</code> <strong><font color='gree'><u></u></font></strong> <strong> 0x9a000 </strong></p></li></ul><p><img src="/2022/img/image-20221208113835640.png" alt=""></p><p><a href="https://jyx-fyh.github.io/2022/12/08/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86-%E8%BF%9B%E9%98%B6-%E5%88%86%E9%85%8D%E9%A1%B5%E5%86%85%E5%AD%98/">--</a></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C###</title>
      <link href="/2022/11/30/C%E8%AF%AD%E8%A8%80%E4%B8%AD%E7%9A%84-%E5%92%8C/"/>
      <url>/2022/11/30/C%E8%AF%AD%E8%A8%80%E4%B8%AD%E7%9A%84-%E5%92%8C/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="font-color-red--font"><font color='red'>#</font></h3><p>C <code>#</code> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> STR(x)  #x</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> age=<span class="number">18</span>;</span><br><span class="line">    <span class="built_in">printf</span>(STR(age)); <span class="comment">//age,18</span></span><br><span class="line">    <span class="built_in">printf</span>(STR(<span class="number">18</span>));  <span class="comment">//18</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>/</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> warn(expr)  printf(#expr)</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> a=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> b=<span class="number">0</span>;</span><br><span class="line">warn(a==<span class="number">0</span>);    <span class="comment">//&quot;a==0&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> assert <a href="https://jyx-fyh.github.io/2022/11/30/%E5%BA%95%E5%B1%82%E5%89%96%E6%9E%90assert%E6%96%AD%E8%A8%80/">assert</a></p><p><strong> <code>#</code> </strong> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> warn(expr)  printf(#expr)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  3.14</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    warn(==<span class="number">3.14</span>); <span class="comment">//&quot;==3.14&quot;&quot;3.14==3.14&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _warn(expr)  printf(#expr)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> warn(expr)   _warn(expr)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  3.14</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    warn(==<span class="number">3.14</span>); <span class="comment">//&quot;3.14==3.14&quot;&quot;==3.14&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> warn(expr)  expr </p><h3 id="font-color-red--font"><font color='red'>##</font></h3><p><code>##</code> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> ponit(x,y) x##.##y </span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%f&quot;</span>,point(<span class="number">12</span>,<span class="number">32</span>));  <span class="comment">//12.32</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong></strong> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> TOSTR(x) #x</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> CONT(a,b) TOSTR(a)##TOSTR(b)</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(CONT(<span class="number">12</span>,<span class="number">32</span>)); <span class="comment">//&quot;1232&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Window  <code>##</code> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifdef</span> _UNICODE</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  TEXT(x) L##x</span></span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  TEXT(x) x</span></span><br></pre></td></tr></table></figure><p> <code>_UNICODE</code>  <code>TEXT(&quot;hello&quot;)</code>  <code>&quot;hello&quot; </code>  <code>L&quot;hellp</code> </p><blockquote><p><code>L&quot;str&quot;</code>  C/C++ </p></blockquote><p><code>#</code>  <code>##</code> </p>]]></content>
      
      
      <categories>
          
          <category> C </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>assert</title>
      <link href="/2022/11/30/%E5%BA%95%E5%B1%82%E5%89%96%E6%9E%90assert%E6%96%AD%E8%A8%80/"/>
      <url>/2022/11/30/%E5%BA%95%E5%B1%82%E5%89%96%E6%9E%90assert%E6%96%AD%E8%A8%80/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p><a href="https://jyx-fyh.github.io/2022/06/20/assert-%E4%B8%8Eif/">assertif</a> <a href="https://jyx-fyh.github.io/2022/11/30/C%E8%AF%AD%E8%A8%80%E4%B8%AD%E7%9A%84-%E5%92%8C/">C###</a><br><code>assert</code></p></blockquote><p> assert <a href="https://jyx-fyh.github.io/2022/06/20/assert-%E4%B8%8Eif/">assertif</a>  OS  assert  assert </p><p> assert </p><p><strong><font color='gree'>1</font></strong>  assert  assert  <code>while(1)</code> <strong><font color='orange'> <code>while(1)</code> </font></strong> <strong><font color='orange'></font></strong> </p><div id="dplayer6" class="dplayer hexo-tag-dplayer-mark" style="margin-bottom: 20px;"></div><script>(function(){var player = new DPlayer({"container":document.getElementById("dplayer6"),"theme":"#FADFA3","lang":"zh-cn//","screenshot":true,"hotkey":true,"preload":"auto","volume":0.9,"video":{"url":"/2022/video/assert.mp4","pic":"/2022/image/1.jpg"},"danmaku":{"id":"9E2E3368B56CD123BB4","api":"https://api.prprpr.me/dplayer/","token":"tokendemo","maximum":1000,"addition":["['https://api.prprpr.me/dplayer/v3/bilibili?aid=4157142']"]}});window.dplayers||(window.dplayers=[]);window.dplayers.push(player);})()</script><blockquote><p> assert  A  assert B  <code>cli</code>  ring0 </p></blockquote><p><strong><font color='gree'>2</font></strong> <code>__FILE__</code> <code>__FUNC__</code> <code>__LINE__</code>  assert </p><p> <code>debug.h</code> <code>debug.c</code> <code>intrmgr.c</code> </p><p><strong><mark class="hl-label blue">intrmgr</mark> </strong><br><code>intrmgr</code>  <code>interrupt manager</code> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;../include/interrupt.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;../include/system.h&quot;</span></span></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> EFLAGS=<span class="number">0</span>;</span><br><span class="line"><span class="comment">//interrupt.h</span></span><br><span class="line"><span class="keyword">enum</span> intr_status <span class="title function_">intr_enable</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(INTR_ON==intr_get_status())</span><br><span class="line">        <span class="keyword">return</span> INTR_ON;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        STI;</span><br><span class="line">        <span class="keyword">return</span> INTR_OFF;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">enum</span> intr_status <span class="title function_">intr_disable</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(INTR_OFF==intr_get_status())</span><br><span class="line">        <span class="keyword">return</span> INTR_OFF;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        CLI;</span><br><span class="line">        <span class="keyword">return</span> INTR_ON;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">enum</span> intr_status <span class="title function_">intr_get_status</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">asm</span> <span class="title function_">volatile</span><span class="params">(<span class="string">&quot;pushf; pop EFLAGS&quot;</span>)</span>; <span class="comment">//eflags</span></span><br><span class="line">    <span class="keyword">return</span> (EFLAGS_IF &amp; EFLAGS) ? INTR_ON:INTR_OFF;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">enum</span> intr_status <span class="title function_">intr_set_status</span><span class="params">(<span class="keyword">enum</span> intr_status st)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> INTR_ON &amp; st ? intr_enable() : intr_disable();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li><p> 29 <code>intr_get_status()</code>  29  <code>pushf</code>  EFLAGS  EFLAGS  C </p><blockquote><p><a href="https://jyx-fyh.github.io/2022/10/27/%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E7%BA%A6%E5%AE%9A/"></a> EBP </p></blockquote><p> 30 EFLAGS_IF  interrupt.h </p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> EFLAGS_IF  (1&lt;&lt;9)      <span class="comment">//eflagsif</span></span></span><br></pre></td></tr></table></figure></li><li><p><code>intr_enable()</code>  <code>intr_disable()</code> </p></li><li><p><code>intr_set_status()</code> </p></li></ul><p><strong><mark class="hl-label blue">debug.h</mark> </strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> OSLEARNING_DEBUG_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> OSLEARNING_DEBUG_H</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">panic</span><span class="params">(<span class="type">char</span>* err_msg, <span class="type">char</span>* file_name, <span class="type">int</span> line, <span class="type">char</span>* func)</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> NDEBUG</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> assert(expression) ((void)0)</span></span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> assert(expr) \</span></span><br><span class="line"><span class="meta">    <span class="keyword">if</span>(expr)&#123;&#125;       \</span></span><br><span class="line"><span class="meta">    <span class="keyword">else</span>&#123;            \</span></span><br><span class="line"><span class="meta">    panic(#expr, __FILE__, __LINE__, __func__);&#125;</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">//OSLEARNING_DEBUG_H</span></span></span><br></pre></td></tr></table></figure><ul><li><p>assert  Debug release assert  Debug  NDEBUG  assert  Debug assert  7~10 </p><blockquote><p> Debug <br>1 GCC  <code>-D</code>  NDEBUG</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -DNDEBUG</span><br></pre></td></tr></table></figure><p>2 debug.h  2  <code>#define NDEBUG</code></p></blockquote></li><li><p> 10  <code>#</code> <a href="https://jyx-fyh.github.io/2022/11/30/C%E8%AF%AD%E8%A8%80%E4%B8%AD%E7%9A%84-%E5%92%8C/">C###</a> </p></li><li><p> <code>\</code> </p></li><li><p><code>__FILE__</code> <code>__FUNC__</code> <code>__LINE__</code> </p></li></ul><p><strong><mark class="hl-label blue">debug.c</mark> </strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;../include/debug.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;../include/interrupt.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;../include/print.h&quot;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">panic</span><span class="params">(<span class="type">char</span>* err_msg, <span class="type">char</span>* file_name, <span class="type">int</span> line, <span class="type">char</span>* func)</span></span><br><span class="line">&#123;</span><br><span class="line">    intr_disable();  <span class="comment">//</span></span><br><span class="line">    put_str(<span class="string">&quot;\n===============================&quot;</span>,BG_BLACK+FT_RED);</span><br><span class="line">    put_str(<span class="string">&quot;\ndebug error:&quot;</span>,BG_BLACK+FT_RED);</span><br><span class="line">    put_str(<span class="string">&quot;\nFileName: &quot;</span>,BG_BLACK+FT_RED);</span><br><span class="line">    put_str(file_name,BG_BLACK+FT_RED);</span><br><span class="line">    put_str(<span class="string">&quot;\nFunction: &quot;</span>,BG_BLACK+FT_RED);</span><br><span class="line">    put_str(func,BG_BLACK+FT_RED);</span><br><span class="line">    put_str(<span class="string">&quot;\nLine:     &quot;</span>,BG_BLACK+FT_RED);</span><br><span class="line">    put_int(line,BG_BLACK+FT_RED,DEC);</span><br><span class="line">    put_str(<span class="string">&quot;\nmessage:  &quot;</span>,BG_BLACK+FT_RED);</span><br><span class="line">    put_str(err_msg,BG_BLACK+FT_RED);</span><br><span class="line">    put_str(<span class="string">&quot;\n===============================&quot;</span>,BG_BLACK+FT_RED);</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>);       <span class="comment">//</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><div id="dplayer7" class="dplayer hexo-tag-dplayer-mark" style="margin-bottom: 20px;"></div><script>(function(){var player = new DPlayer({"container":document.getElementById("dplayer7"),"theme":"#FADFA3","lang":"zh-cn//","screenshot":true,"hotkey":true,"preload":"auto","volume":0.9,"video":{"url":"/2022/video/assert_debug.mp4","pic":"/2022/image/1.jpg"},"danmaku":{"id":"9E2E3368B56CD123BB4","api":"https://api.prprpr.me/dplayer/","token":"tokendemo","maximum":1000,"addition":["['https://api.prprpr.me/dplayer/v3/bilibili?aid=4157142']"]}});window.dplayers||(window.dplayers=[]);window.dplayers.push(player);})()</script>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>(LDT/TSS/GATE)</title>
      <link href="/2022/11/26/%E7%89%B9%E6%9D%83%E7%BA%A7%E5%85%A8%E9%9D%A2%E5%89%96%E6%9E%90/"/>
      <url>/2022/11/26/%E7%89%B9%E6%9D%83%E7%BA%A7%E5%85%A8%E9%9D%A2%E5%89%96%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>x86<a href="https://hackmd.io/@0xff07/HJ5FO4xXc">SegmentationAndPrivilege</a> <a href="https://www.scs.stanford.edu/05au-cs240c/lab/i386/s07_02.htm">80386 Programmers Reference Manual</a></p></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><p><u></u> GDT  GDT </p><p><strong> 0123 </strong> 0 ,  12  3 <br><img src="/2022/img/IMG_0535(20221127-095601).PNG" alt="ring"></p><blockquote><p></p></blockquote><h3 id="font-color-red-LDT-font"><font color='red'>LDT</font></h3><p>LDT GDT  LDT LDT </p><blockquote><p><a href="https://jyx-fyh.github.io/2022/11/13/%E5%BC%80%E5%90%AF%E5%88%86%E9%A1%B5%E6%9C%BA%E5%88%B6/"></a><strong></strong> </p></blockquote><p>LDT  GDT </p><ol><li><p> LDT CPU  GDT </p></li><li><p>GDT  0 LDT  0 </p><blockquote><p>CPU  0<u></u> LDT TI  1 LDT  0 </p></blockquote></li><li><p>GDT  <code>lgdt</code>  GDTR LDT  <code>lldt</code>  <code>LDTR</code>  GDTR LDTR  16  GDT </p></li></ol><p><strong><font color='orange'>LDTR  GDT (LDT) LDT </font></strong>LDT  GDT  LDTR <br><img src="/2022/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE17.png" alt=""></p><blockquote><p>TI  0 GDT LDT <br> LDTR  48  LDT  GDT  LDT </p></blockquote><p>LDTR <a href="https://jyx-fyh.github.io/2022/10/31/%E5%85%A8%E5%B1%80%E6%8F%8F%E8%BF%B0%E7%AC%A6%E8%A1%A8%E6%A6%82%E8%BF%B0/"></a>32  CPU  16 ()(,CPU)LDTR <strong><font color='orange'> GDT  LDT </font></strong> GDT /<br><img src="/2022/img/IMG_0502(20221101-114007)-1669466423582-5.png" alt=" LDT"></p><blockquote><p>GDT </p></blockquote><p>(Current Task)<strong><font color='gree'> LDTR </font></strong> LDTR  LDT LDTR  LDTR  TSS </p><h3 id="font-color-red-TSS-font"><font color='red'>TSS</font></h3><p><strong> (Task State Segment, TSS )</strong> TTS <u> 104 </u> I/O TSS <br><img src="/2022/img/2C2361DFB1D1643813669F6D50FF92C5.png" alt=""></p><blockquote><p><strong><font color='pink'> 96  LDT LDTR </font></strong> </p></blockquote><p>TSS  32 <u></u> TSS <u></u> TSS  TSS CPU  TSS  LDT <strong><font color='orange'> TR(Task Register)  TSS</font></strong>  TSS TR  TR  TSS  TR  TSS TSS TR <br><img src="/2022/img/fig7-3.gif" alt=""></p><p>TR  16  BASE  TSS LIMIT  TSS  I/O  TR  TSS <br><img src="/2022/img/fig7-2.gif" alt=""></p><blockquote><ul><li><strong>TSS  GDT </strong>  TR  TI  1</li><li><strong>LIMIT  103 103 </strong> </li><li>YTPE  B  B  1 B  1 call  B  1 B  1 call  eflags  NT  <a href="https://jyx-fyh.github.io/2022/11/21/%E5%8A%A0%E5%85%A5%E4%B8%AD%E6%96%AD/"></a> </li></ul></blockquote><p>TSS  16 16  TTS  16  <strong><font color='orange'>TTS </font></strong> <strong><font color='orange'> LDT TSS  GDT ( TSS  GDT )</font></strong> </p><blockquote><p><strong>Linux  TSS TSS OS  Linux </strong> <a href="https://jyx-fyh.github.io/2022/12/26/%E5%AE%9E%E7%8E%B0%E7%94%A8%E6%88%B7%E8%BF%9B%E7%A8%8B/"></a> </p></blockquote><p> <code>ltr</code>  TSS  TR </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ltr 16/16</span><br></pre></td></tr></table></figure><p> CPU  TR </p><p> I/O  TSS </p><h3 id="font-color-red--font"><font color='red'></font></h3><p><u></u><strong></strong> </p><ol><li><strong><font color='gree'></font></strong> </li><li><strong><font color='gree'> GATE </font></strong> </li></ol><p></p><p><strong><mark class="hl-label blue"></mark> </strong><br> type <br><img src="/2022/img/image-20221101105041738-1669515483779-2.png" alt=""><br> C <strong><font color='orange'></font></strong> <strong><font color='orange'>(CPL)()DPL</font></strong> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CPLDPL</span><br></pre></td></tr></table></figure><blockquote><p><strong><font color='red'>retf, iret/iretd</font></strong> </p></blockquote><p><strong><font color='orange'>() DPL (CPL)</font></strong>  3  0 (CPL) 3 0 </p><blockquote><p></p></blockquote><p><strong><mark class="hl-label blue">(GATE)</mark> </strong><br><strong><font color='gree'></font></strong> <strong></strong> <br><strong><u></u></strong>  <code>call</code>  <code>jmp</code> <strong><font color='orange'>call jmp  CPL</font></strong>  <code>retf</code> <u> GDT/LDT </u><br><strong><u></u></strong>  <code>int</code> Linux <a href="https://jyx-fyh.github.io/2022/11/21/%E5%8A%A0%E5%85%A5%E4%B8%AD%E6%96%AD/">IDT</a><strong><font color='orange'><u>eflags  IF cli</u></font></strong>  <code>iret/iretd</code> <u> IDT</u> </p><p><strong><u></u></strong>  <code>int3</code> <strong><font color='orange'><u>eflags  IF </u></font></strong> <u> IDT</u> <br><strong><u></u></strong>  call  jmp  TSS <u> GDT/LDT/IDT </u></p><h3 id="font-color-red-GATE-font"><font color='red'>GATE</font></h3><p><strong><font color='red'> CPU </font></strong> <br><img src="/2022/img/IMG_0539(20221127-174054).PNG" alt=""><br><img src="/2022/img/IMG_0538(20221127-174029).PNG" alt=""><br><img src="/2022/img/IMG_0537(20221127-174008).PNG" alt=""><br><img src="/2022/img/IMG_0536(20221127-173936).PNG" alt=""><br>)<strong><u></u><u></u></strong> <strong><font color='orange'>CPU </font></strong> <code>call 0x9:0x1000</code>  9  CPU  <code>0x1000</code> </p><blockquote><p> LDTR </p></blockquote><p><strong><font color='orange'> GDTLDTIDT  GDTLDT  IDT </font></strong>  GDTLDT  <code>call</code> <code>jmp</code>  IDT  <code>int</code> </p><p>GATE <strong>(CPL) DPL()</strong> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CPLDPL</span><br></pre></td></tr></table></figure><p><strong><u> DPL</u></strong> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CPLDPL</span><br></pre></td></tr></table></figure><p><img src="/2022/img/IMG_0543(20221127-230944).PNG" alt=""></p><blockquote><p><strong></strong></p><ul><li></li><li></li><li>iret</li></ul><p><strong></strong></p><p><strong><font color='orange'></font></strong> </p></blockquote><p> RPL<strong></strong> </p><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong><font color='orange'></font></strong> <br><strong>1<font color='gree'></font></strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CPL=DPL </span><br><span class="line">RPL=DPL</span><br></pre></td></tr></table></figure><p> <code>jmp 0x0012:0x2000</code> </p><p><strong>2<font color='gree'></font></strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CPLDPL  //,,CPLDPL;,DPL</span><br><span class="line">RPLDPL</span><br></pre></td></tr></table></figure><p></p><p><strong>3<font color='gree'></font></strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DPLCPLDPL</span><br><span class="line">RPLDPL</span><br></pre></td></tr></table></figure><blockquote><p><strong> call  jmp  RPL  RPL <u> RPL</u> </strong> <a href="https://jyx-fyh.github.io/2022/11/21/%E5%8A%A0%E5%85%A5%E4%B8%AD%E6%96%AD/">IDT</a></p></blockquote><p><strong>4<font color='gree'></font></strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CPLDPL</span><br><span class="line">RPLDPL</span><br></pre></td></tr></table></figure><p>CPU </p><p><strong>5<font color='gree'></font></strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CPL=DPL</span><br><span class="line">RPL=DPL</span><br></pre></td></tr></table></figure><p> TSS  <code>ss</code> </p><p> RPL  RPLCPLDPL </p><h3 id="font-color-red--RPL-CPL-DPL-font"><font color='red'> RPL, CPL ,DPL</font></h3><p><strong><mark class="hl-label blue">DPL</mark> </strong><br>DPLDescriptor Privilege Level GDT/LDT/IDT <u>DPL DPL </u></p><p><strong><mark class="hl-label blue">CPL</mark> </strong><br>CPLCurrent Privilege Level<u> DPL</u>  CPL <strong> CPL  CS  RPL CS.RPL CPL=CS.RPL </strong></p><p><strong><mark class="hl-label blue">RPL</mark> </strong><br>RPLRequest Privilege Leve 2 <strong> RPL </strong> </p><blockquote><p><strong>RPL </strong> <strong><u></u></strong>  CPL=RPL</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">;0</span><br><span class="line">mov eax,0x0009  </span><br><span class="line">mov ds,eax</span><br></pre></td></tr></table></figure><p><strong> CPL  0 ds  RPL  0 0</strong>  RPL <strong><font color='orange'>GDT/LDT/IDT RPL </font></strong> <strong><font color='orange'>RPL </font></strong>  ds  0 ds  RPL  0  <code>arpl</code> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">arpl /16, 16</span><br><span class="line">;</span><br><span class="line">arpl ,CS</span><br></pre></td></tr></table></figure><p>pdf  245  RPL </p></blockquote><p> RPL  RPL  RPL </p><p><strong><mark class="hl-label blue">RPL</mark> </strong><br><u> RPL </u> 3 ring 3CPL  3  0 dsCPL=DPL<strong></strong><br><img src="/2022/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE19.png" alt=""><br><strong><font color='orange'></font></strong> ring 3)(ring 0))<strong><font color='orange'></font></strong>  RPL RPL  <strong><u></u></strong>  RPL  RPL=0) cs, eip  cs  RPL CPL)<strong><u> <code>arpl</code>  RPL  CPL RPL </u></strong>  RPL  3  ds  <code>CPL&lt;=DPL</code>  <code>RPL&lt;=DPL</code> RPL=3DPL=0)</p><p><strong> RPL  <code>arpl</code>  RPL </strong> <strong>CPL  RPL</strong> </p><blockquote><p><strong></strong>  OS <a href="https://jyx-fyh.github.io/2022/11/21/%E5%8A%A0%E5%85%A5%E4%B8%AD%E6%96%AD/">IDT</a></p></blockquote><hr><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong></strong>  0  3 <strong><font color='orange'></font></strong> </p><blockquote><p></p><ol><li><strong></strong></li><li></li><li></li></ol></blockquote><p> 0  0  3  3  4  4 <strong><u> TSS  3  TSS  ring3  TSS  ring3 </u></strong>  4  ring3  3  012  ring0 <u></u></p><p><strong><font color='gree'>1</font></strong>  ring3 ring0 call  ring3 <br><img src="/2022/img/IMG_0544(20221128-145006).PNG" alt="" style="zoom:67%;" /><br><strong><font color='gree'>2</font></strong> call <br><strong><font color='gree'>3</font></strong>  CPL=0 TSS  SS0  SP0<u></u> SS_old  SP_old<br><img src="/2022/img/IMG_0545(20221128-150757).PNG" alt="" style="zoom:50%;" /><br><strong><font color='gree'>4</font></strong>  8 <br><img src="/2022/img/IMG_0546(20221128-151203).PNG" style="zoom: 50%;" /></p><blockquote><p> CPU </p></blockquote><p><strong><font color='gree'>5</font></strong>  CS  EIP<br><img src="/2022/img/IMG_0547(20221128-153129).PNG" alt="" style="zoom:50%;" /></p><blockquote><p> CS CS  CS </p></blockquote><p><strong><u> ring0  ring0  34  5  CS  EIP</u></strong>  retf <br><strong><font color='gree'>1</font></strong>  EIP_old  CS_old  eip  cs  </p><blockquote><p></p><ol><li>retf  CS </li><li><strong>retf()iret/iretd() </strong>  retf  retf  retf  call  retf </li><li> CSEIP  23 </li></ol></blockquote><p><strong><font color='gree'>2</font></strong>  ESP_new  ESP_old <br><strong><font color='gree'>3</font></strong>  1  ESP_old  SS_old  esp  ss <br><strong><font color='gree'>4</font></strong>  DSESFS  GS  DPL  CPL () 0 </p><p> 4 ring 0 DS/ES/FS/GS DS/ES/FS/GS <strong> DS/ES/FS/GS  0 0  GDT  0  0 </strong> <strong> CPU  0x0d (#GP General Protection)</strong>  GDT  0  LDT  0 </p><blockquote><p><strong></strong> </p></blockquote><blockquote><p></p><ol><li> EFLAGS </li><li>4</li></ol><p><a href="https://jyx-fyh.github.io/2022/11/21/%E5%8A%A0%E5%85%A5%E4%B8%AD%E6%96%AD/">IDT</a></p></blockquote><p></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>-</title>
      <link href="/2022/11/26/%E5%8A%A0%E5%85%A5%E4%B8%AD%E6%96%AD-%E4%BB%A3%E7%A0%81%E8%AF%A6%E8%A7%A3/"/>
      <url>/2022/11/26/%E5%8A%A0%E5%85%A5%E4%B8%AD%E6%96%AD-%E4%BB%A3%E7%A0%81%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p><a href="https://jyx-fyh.github.io/2022/11/21/%E5%8A%A0%E5%85%A5%E4%B8%AD%E6%96%AD/"></a> <a href="https://jyx-fyh.github.io/2022/06/19/%E7%BB%93%E6%9E%84%E4%BD%93%E5%AF%B9%E9%BD%90/"></a><br><code>interrupt</code></p></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><p> 0~0x2f  <code>interrupt.s</code>  <strong></strong>  <code>interrupt_entry_table</code>  <code>idt.c</code> </p><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong><mark class="hl-label blue">interrupt.s</mark> </strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line">[bits 32]</span><br><span class="line">%define ERROR_CODE nop     ; cpu,,.</span><br><span class="line">%define ZERO push 0        ; cpu,,0</span><br><span class="line"></span><br><span class="line">extern interrupt_handler_table ;</span><br><span class="line"></span><br><span class="line">%macro VECTOR 2</span><br><span class="line">INTERRUPT_ENTRY_%1:        ;entry</span><br><span class="line">    %2</span><br><span class="line">    push ds</span><br><span class="line">    push es</span><br><span class="line">    push fs</span><br><span class="line">    push gs</span><br><span class="line">    pushad</span><br><span class="line"></span><br><span class="line">    push dword %1</span><br><span class="line">    call [interrupt_handler_table + %1*4]  ;</span><br><span class="line">    add esp, 4             ;</span><br><span class="line"></span><br><span class="line">    popad</span><br><span class="line">    pop gs</span><br><span class="line">    pop fs</span><br><span class="line">    pop es</span><br><span class="line">    pop ds</span><br><span class="line"></span><br><span class="line">    mov al,0x20            ;EOI</span><br><span class="line">    out 0xa0,al            ;</span><br><span class="line">    out 0x20,al            ;</span><br><span class="line"></span><br><span class="line">    add esp,4   ;error_code,</span><br><span class="line">    iret   ;,32iretd</span><br><span class="line">%endmacro</span><br><span class="line"></span><br><span class="line">;;;;;;;;;;;;;;;;;;;;;;;;</span><br><span class="line">VECTOR 0x00, ZERO        ;divide by zero</span><br><span class="line">VECTOR 0x01, ZERO        ;debug</span><br><span class="line">VECTOR 0x02, ZERO        ;non maskable interrupt</span><br><span class="line">VECTOR 0x03, ZERO        ;breakpoint</span><br><span class="line">VECTOR 0x04, ZERO        ;overflow</span><br><span class="line">VECTOR 0x05, ZERO        ;bound range exceeded</span><br><span class="line">VECTOR 0x06, ZERO        ;invalid opcode</span><br><span class="line">VECTOR 0x07, ZERO        ;device not avilable</span><br><span class="line">VECTOR 0x08, ERROR_CODE  ;double fault</span><br><span class="line">VECTOR 0x09, ZERO        ;coprocessor segment overrun</span><br><span class="line">VECTOR 0x0a, ERROR_CODE  ;invalid TSS</span><br><span class="line">VECTOR 0x0b, ERROR_CODE  ;segment not present</span><br><span class="line">VECTOR 0x0c, ZERO        ;stack segment fault</span><br><span class="line">VECTOR 0x0d, ERROR_CODE  ;general protection fault</span><br><span class="line">VECTOR 0x0e, ERROR_CODE  ;page fault</span><br><span class="line">VECTOR 0x0f, ZERO        ;reserved</span><br><span class="line">VECTOR 0x10, ZERO        ;x87 floating point exception</span><br><span class="line">VECTOR 0x11, ERROR_CODE  ;alignment check</span><br><span class="line">VECTOR 0x12, ZERO        ;machine check</span><br><span class="line">VECTOR 0x13, ZERO        ;SIMD Floating - Point Exception</span><br><span class="line">VECTOR 0x14, ZERO        ;Virtualization Exception</span><br><span class="line">VECTOR 0x15, ZERO        ;Control Protection Exception</span><br><span class="line">VECTOR 0x16, ZERO        ;reserved</span><br><span class="line">VECTOR 0x17, ZERO        ;reserved</span><br><span class="line">VECTOR 0x18, ERROR_CODE  ;reserved</span><br><span class="line">VECTOR 0x19, ZERO        ;reserved</span><br><span class="line">VECTOR 0x1a, ERROR_CODE  ;reserved</span><br><span class="line">VECTOR 0x1b, ERROR_CODE  ;reserved</span><br><span class="line">VECTOR 0x1c, ZERO        ;reserved</span><br><span class="line">VECTOR 0x1d, ERROR_CODE  ;reserved</span><br><span class="line">VECTOR 0x1e, ERROR_CODE  ;reserved</span><br><span class="line">VECTOR 0x1f, ZERO        ;reserved</span><br><span class="line">VECTOR 0x20, ZERO        ;clock </span><br><span class="line">VECTOR 0x21, ZERO        ;</span><br><span class="line">VECTOR 0x22, ZERO        ;</span><br><span class="line">VECTOR 0x23, ZERO        ;2</span><br><span class="line">VECTOR 0x24, ZERO        ;1</span><br><span class="line">VECTOR 0x25, ZERO        ;2</span><br><span class="line">VECTOR 0x26, ZERO        ;</span><br><span class="line">VECTOR 0x27, ZERO        ;1</span><br><span class="line">VECTOR 0x28, ZERO        ;rtc</span><br><span class="line">VECTOR 0x29, ZERO        ;</span><br><span class="line">VECTOR 0x2a, ZERO        ;</span><br><span class="line">VECTOR 0x2b, ZERO        ;</span><br><span class="line">VECTOR 0x2c, ZERO        ;ps/2</span><br><span class="line">VECTOR 0x2d, ZERO        ;fpu</span><br><span class="line">VECTOR 0x2e, ZERO        ;</span><br><span class="line">VECTOR 0x2f, ZERO        ;</span><br><span class="line"></span><br><span class="line">;;;;;;;;;;;;;;;;;;;</span><br><span class="line">global interrupt_entry_table</span><br><span class="line">interrupt_entry_table:</span><br><span class="line">    dd INTERRUPT_ENTRY_0x00</span><br><span class="line">    dd INTERRUPT_ENTRY_0x01</span><br><span class="line">    dd INTERRUPT_ENTRY_0x02</span><br><span class="line">    dd INTERRUPT_ENTRY_0x03</span><br><span class="line">    dd INTERRUPT_ENTRY_0x04</span><br><span class="line">    dd INTERRUPT_ENTRY_0x05</span><br><span class="line">    dd INTERRUPT_ENTRY_0x06</span><br><span class="line">    dd INTERRUPT_ENTRY_0x07</span><br><span class="line">    dd INTERRUPT_ENTRY_0x08</span><br><span class="line">    dd INTERRUPT_ENTRY_0x09</span><br><span class="line">    dd INTERRUPT_ENTRY_0x0a</span><br><span class="line">    dd INTERRUPT_ENTRY_0x0b</span><br><span class="line">    dd INTERRUPT_ENTRY_0x0c</span><br><span class="line">    dd INTERRUPT_ENTRY_0x0d</span><br><span class="line">    dd INTERRUPT_ENTRY_0x0e</span><br><span class="line">    dd INTERRUPT_ENTRY_0x0f</span><br><span class="line">    dd INTERRUPT_ENTRY_0x10</span><br><span class="line">    dd INTERRUPT_ENTRY_0x11</span><br><span class="line">    dd INTERRUPT_ENTRY_0x12</span><br><span class="line">    dd INTERRUPT_ENTRY_0x13</span><br><span class="line">    dd INTERRUPT_ENTRY_0x14</span><br><span class="line">    dd INTERRUPT_ENTRY_0x15</span><br><span class="line">    dd INTERRUPT_ENTRY_0x16</span><br><span class="line">    dd INTERRUPT_ENTRY_0x17</span><br><span class="line">    dd INTERRUPT_ENTRY_0x18</span><br><span class="line">    dd INTERRUPT_ENTRY_0x19</span><br><span class="line">    dd INTERRUPT_ENTRY_0x1a</span><br><span class="line">    dd INTERRUPT_ENTRY_0x1b</span><br><span class="line">    dd INTERRUPT_ENTRY_0x1c</span><br><span class="line">    dd INTERRUPT_ENTRY_0x1d</span><br><span class="line">    dd INTERRUPT_ENTRY_0x1e</span><br><span class="line">    dd INTERRUPT_ENTRY_0x1f</span><br><span class="line">    dd INTERRUPT_ENTRY_0x20</span><br><span class="line">    dd INTERRUPT_ENTRY_0x21</span><br><span class="line">    dd INTERRUPT_ENTRY_0x22</span><br><span class="line">    dd INTERRUPT_ENTRY_0x23</span><br><span class="line">    dd INTERRUPT_ENTRY_0x24</span><br><span class="line">    dd INTERRUPT_ENTRY_0x25</span><br><span class="line">    dd INTERRUPT_ENTRY_0x26</span><br><span class="line">    dd INTERRUPT_ENTRY_0x27</span><br><span class="line">    dd INTERRUPT_ENTRY_0x28</span><br><span class="line">    dd INTERRUPT_ENTRY_0x29</span><br><span class="line">    dd INTERRUPT_ENTRY_0x2a</span><br><span class="line">    dd INTERRUPT_ENTRY_0x2b</span><br><span class="line">    dd INTERRUPT_ENTRY_0x2c</span><br><span class="line">    dd INTERRUPT_ENTRY_0x2d</span><br><span class="line">    dd INTERRUPT_ENTRY_0x2e</span><br><span class="line">    dd INTERRUPT_ENTRY_0x2f</span><br></pre></td></tr></table></figure><p> C  C </p><ol><li></li><li> EOI </li><li></li></ol><p> C  C  C </p><p></p><ul><li><p> 5 <code>interrupt_handler_table</code>  <code>idt.c</code> </p></li><li><p> 7 <code>%macro VECTOR 2</code>  <code>equ</code>  <code>%macro</code> </p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">%macro  </span><br><span class="line">........</span><br><span class="line"></span><br><span class="line">........</span><br><span class="line">%endmacro</span><br></pre></td></tr></table></figure><p> <code>%</code>  8  9  VECTOR 35~82 <strong><code>interrupt.s</code>  0x30  8~31 </strong> </p></li><li><p> 8 </p></li><li><p> 9  <code>ZERO</code>  <code>push 0</code>  <code>ERROR_CODE</code>  <code>nop</code>  35~82 <strong><font color='orange'>CPU CPU (nop)CPU </font></strong>  0<a href="https://jyx-fyh.github.io/2022/11/21/%E5%8A%A0%E5%85%A5%E4%B8%AD%E6%96%AD/"></a></p></li><li><p> 10~14  17  C  CPU <a href="https://jyx-fyh.github.io/2022/11/21/%E5%8A%A0%E5%85%A5%E4%B8%AD%E6%96%AD/"></a></p></li><li><p> 16 </p></li><li><p> 17 interrupt_handler_table  idt.c  4  4 </p></li><li><p> 18 <a href="https://jyx-fyh.github.io/2022/10/27/%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E7%BA%A6%E5%AE%9A/"></a></p></li><li><p> 26~28  EOI  8259A <a href="https://jyx-fyh.github.io/2022/11/29/%E4%B8%AD%E6%96%AD%E6%8E%A7%E5%88%B6%E5%99%A8-8259a/">8259A</a> </p></li><li><p> 30 </p></li><li><p> 86~134  <code>interrupt_entry_table[]</code>  <code>dit.c</code> </p></li></ul><p><strong><mark class="hl-label blue">global.h</mark> </strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//global.h</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> OSLEARNING_GLOBAL_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> OSLEARNING_GLOBAL_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> RPL0  0</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> RPL1  1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> RPL2  2</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> RPL3  3</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TI_GDT 0</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TI_LDT 1</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SELECTOR_K_CODE   ((1 &lt;&lt; 3) + (TI_GDT &lt;&lt; 2) + RPL0)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SELECTOR_K_DATA   ((2 &lt;&lt; 3) + (TI_GDT &lt;&lt; 2) + RPL0)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SELECTOR_K_STACK   SELECTOR_K_DATA</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SELECTOR_K_VIDEO   ((3 &lt;&lt; 3) + (TI_GDT &lt;&lt; 2) + RPL0)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//================IDTP================</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> IDT_DESC_P_ON 1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> IDT_DESC_P_OFF 0</span></span><br><span class="line"><span class="comment">//================IDTDPL==============</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> IDT_DESC_DPL0   0       <span class="comment">//03</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> IDT_DESC_DPL3   3</span></span><br><span class="line"><span class="comment">//==========stype=================</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> IDT_DESC_GATE   0xE     <span class="comment">// S=0(),TYPE=1110(32)</span></span></span><br><span class="line"><span class="comment">//============================================</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">gate_desc</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">short</span> offset_L;       <span class="comment">//  0 ~ 15 </span></span><br><span class="line">    <span class="type">short</span> selector;       <span class="comment">// </span></span><br><span class="line">    <span class="type">char</span> reserved ;       <span class="comment">// </span></span><br><span class="line">    <span class="type">char</span> s_type :<span class="number">5</span>;       <span class="comment">// :///</span></span><br><span class="line">    <span class="type">char</span> DPL    :<span class="number">2</span>;       <span class="comment">//  int </span></span><br><span class="line">    <span class="type">char</span> present:<span class="number">1</span>;       <span class="comment">// </span></span><br><span class="line">    <span class="type">short</span> offset_H;       <span class="comment">//  16 ~ 31 </span></span><br><span class="line">&#125; __attribute__((packed));<span class="comment">//</span></span><br><span class="line"><span class="comment">//=================GDT/IDT=================</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">xdt_ptr</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">short</span>   limit;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span>     base;</span><br><span class="line">&#125;__attribute__((packed));</span><br><span class="line"><span class="comment">//======GDT/LDT===========</span></span><br><span class="line"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">void</span> <span class="title function_">load_xdt</span><span class="params">(<span class="keyword">struct</span> xdt_ptr* p, <span class="type">unsigned</span> <span class="type">short</span> limit, <span class="type">unsigned</span> <span class="type">int</span> base)</span></span><br><span class="line">&#123;</span><br><span class="line">    p-&gt;base=base;</span><br><span class="line">    p-&gt;limit=limit;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">//OSLEARNING_GLOBAL_H</span></span></span><br></pre></td></tr></table></figure><ul><li> <code>gate_desc</code> <br>1 <code>s_type</code> <code>DPL</code> <code>present</code>  char <br>2 <code>__attribute__((packed))</code> **<font color='orange'></font>** <a href="https://jyx-fyh.github.io/2022/06/19/%E7%BB%93%E6%9E%84%E4%BD%93%E5%AF%B9%E9%BD%90/"></a> </li><li><code>xdt_ptr</code>  IDTR/GDTR  IDTR GDTR </li></ul><p><strong><mark class="hl-label blue">idt.c</mark> </strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;../include/interrupt.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;../include/global.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;../include/print.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;../include/system.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">xdt_ptr</span> <span class="title">idt_ptr</span> ;</span></span><br><span class="line"><span class="type">static</span> <span class="type">char</span>*  interrupt_name[IDT_DESC_CNT];</span><br><span class="line"><span class="type">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">gate_desc</span> <span class="title">idt</span>[<span class="title">IDT_DESC_CNT</span>];</span>                 <span class="comment">//idt-</span></span><br><span class="line"><span class="keyword">extern</span> intr_handler interrupt_entry_table[IDT_DESC_CNT];   <span class="comment">//interrupt.s,</span></span><br><span class="line">       intr_handler interrupt_handler_table[IDT_DESC_CNT]; <span class="comment">//</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">make_idt_desc</span><span class="params">(<span class="keyword">struct</span> gate_desc* p_desc, <span class="type">unsigned</span> <span class="type">char</span> DPL, intr_handler function)</span> &#123;</span><br><span class="line">    p_desc-&gt;offset_L = (<span class="type">unsigned</span> <span class="type">int</span>)function &amp; <span class="number">0x0000FFFF</span>;       <span class="comment">//16offset_L</span></span><br><span class="line">    p_desc-&gt;offset_H = ((<span class="type">unsigned</span> <span class="type">int</span>)function&gt;&gt;<span class="number">16</span>) &amp; <span class="number">0x0000FFFF</span>; <span class="comment">//16offset_L</span></span><br><span class="line">    p_desc-&gt;selector = SELECTOR_K_CODE;</span><br><span class="line">    p_desc-&gt;reserved = <span class="number">0</span>;</span><br><span class="line">    p_desc-&gt;s_type   = IDT_DESC_GATE;</span><br><span class="line">    p_desc-&gt;DPL      = DPL;</span><br><span class="line">    p_desc-&gt;present  = IDT_DESC_P_ON;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">idt_desc_init</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; IDT_DESC_CNT; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        make_idt_desc(&amp;idt[i],  IDT_DESC_DPL0, interrupt_entry_table[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    put_str(<span class="string">&quot;idt is done\n&quot;</span>,BG_BLACK+FT_YELLOW);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 8259A */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">pic_init</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*  */</span></span><br><span class="line">    outb (PIC_M_CTRL, <span class="number">0x11</span>);   <span class="comment">// ICW1: ,8259, ICW4.</span></span><br><span class="line">    outb (PIC_M_DATA, <span class="number">0x20</span>);   <span class="comment">// ICW2: 0x20,IR[0-7]  0x20 ~ 0x27.</span></span><br><span class="line">    outb (PIC_M_DATA, <span class="number">0x04</span>);   <span class="comment">// ICW3: IR2.</span></span><br><span class="line">    outb (PIC_M_DATA, <span class="number">0x01</span>);   <span class="comment">// ICW4: 8086, EOI</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/*  */</span></span><br><span class="line">    outb (PIC_S_CTRL, <span class="number">0x11</span>);<span class="comment">// ICW1: ,8259, ICW4.</span></span><br><span class="line">    outb (PIC_S_DATA, <span class="number">0x28</span>);<span class="comment">// ICW2: 0x28,IR[8-15]  0x28 ~ 0x2F.</span></span><br><span class="line">    outb (PIC_S_DATA, <span class="number">0x02</span>);<span class="comment">// ICW3: IR2</span></span><br><span class="line">    outb (PIC_S_DATA, <span class="number">0x01</span>);<span class="comment">// ICW4: 8086, EOI</span></span><br><span class="line">    <span class="comment">/* IR0, */</span></span><br><span class="line">    outb (PIC_M_DATA, <span class="number">0xfe</span>);</span><br><span class="line">    outb (PIC_S_DATA, <span class="number">0xff</span>);</span><br><span class="line">    put_str(<span class="string">&quot;pic_init done\n&quot;</span>,BG_BLACK+FT_RED);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">idt_init</span><span class="params">()</span> &#123;</span><br><span class="line">    put_str(<span class="string">&quot;idt_init start\n&quot;</span>,BG_BLACK+FT_YELLOW);</span><br><span class="line">    idt_desc_init();         <span class="comment">//</span></span><br><span class="line">    general_handler_regist();    <span class="comment">//</span></span><br><span class="line">    pic_init();             <span class="comment">//8259A</span></span><br><span class="line">    load_xdt(&amp;idt_ptr,IDT_DESC_CNT*<span class="number">8</span><span class="number">-1</span>,idt); <span class="comment">//limit=size-1</span></span><br><span class="line">    <span class="comment">/* idt */</span></span><br><span class="line">    <span class="keyword">asm</span> <span class="title function_">volatile</span><span class="params">(<span class="string">&quot;lidt idt_ptr&quot;</span>)</span>;</span><br><span class="line">    put_str(<span class="string">&quot;idt_init done\n&quot;</span>,BG_BLACK+FT_YELLOW);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">general_intr_handler</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> vec_num)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(vec_num==<span class="number">0x27</span> || vec_num==<span class="number">0x2f</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    put_str(<span class="string">&quot;\ninterrupt &quot;</span>,BG_BLACK+FT_RED);</span><br><span class="line">    put_int(vec_num, BG_BLACK+FT_RED,HEX);</span><br><span class="line">    put_str(<span class="string">&quot; occur: &quot;</span>,BG_BLACK+FT_RED);</span><br><span class="line">    put_str(interrupt_name[vec_num],BG_BLACK+FT_RED);</span><br><span class="line">    put_int(time, BG_BLACK+FT_RED,DEC);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">general_handler_regist</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;IDT_DESC_CNT;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        interrupt_handler_table[i]= general_intr_handler;   <span class="comment">//</span></span><br><span class="line">        interrupt_name[i]=<span class="string">&quot;unknown&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    interrupt_name[<span class="number">0</span>]    = <span class="string">&quot;Divide Error\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">1</span>]    = <span class="string">&quot;Debug Exception\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">2</span>]    = <span class="string">&quot;NMI Interrupt\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">3</span>]    = <span class="string">&quot;Breakpoint Exception\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">4</span>]    = <span class="string">&quot;Overflow Exception\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">5</span>]    = <span class="string">&quot;BOUND Range Exceeded Exception\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">6</span>]    = <span class="string">&quot;Invalid Opcode Exception\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">7</span>]    = <span class="string">&quot;Device Not Available Exception\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">8</span>]    = <span class="string">&quot;Double Fault Exception\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">9</span>]    = <span class="string">&quot;Coprocessor Segment Overrun\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0xa</span>]  = <span class="string">&quot;Invalid TSS Exception\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0xb</span>]  = <span class="string">&quot;Segment Not Present\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0xc</span>]  = <span class="string">&quot;Stack Fault Exception\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0xd</span>]  = <span class="string">&quot;General Protection Exception\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0xe</span>]  = <span class="string">&quot;Page-Fault Exception\n&quot;</span>;</span><br><span class="line">    <span class="comment">//interrupt_name[15]  15intel</span></span><br><span class="line">    interrupt_name[<span class="number">0x10</span>] = <span class="string">&quot;x87 FPU Floating-Point Error\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0x11</span>] = <span class="string">&quot;Alignment Check Exception\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0x12</span>] = <span class="string">&quot;Machine-Check Exception\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0x13</span>] = <span class="string">&quot;SIMD Floating-Point Exception\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0x14</span>] = <span class="string">&quot;Virtualization Exception\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0x15</span>] = <span class="string">&quot;Control Protection Exception\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0x16</span>] = <span class="string">&quot;reserved interrupt-unknown\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0x17</span>] = <span class="string">&quot;reserved interrupt-unknown\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0x18</span>] = <span class="string">&quot;reserved interrupt-unknown\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0x19</span>] = <span class="string">&quot;reserved interrupt-unknown\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0x1a</span>] = <span class="string">&quot;reserved interrupt-unknown\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0x1b</span>] = <span class="string">&quot;reserved interrupt-unknown\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0x1c</span>] = <span class="string">&quot;reserved interrupt-unknown\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0x1d</span>] = <span class="string">&quot;reserved interrupt-unknown\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0x1e</span>] = <span class="string">&quot;reserved interrupt-unknown\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0x1f</span>] = <span class="string">&quot;reserved interrupt-unknown\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0x20</span>] = <span class="string">&quot;Clock interrupt\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0x21</span>] = <span class="string">&quot;Keyboard interrupt\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0x22</span>] = <span class="string">&quot;Clock interrupt\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0x23</span>] = <span class="string">&quot;Cascade\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0x24</span>] = <span class="string">&quot;Unknown\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0x25</span>] = <span class="string">&quot;Unknown\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0x26</span>] = <span class="string">&quot;Unknown\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0x27</span>] = <span class="string">&quot;Unknown\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0x28</span>] = <span class="string">&quot;RTC\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0x29</span>] = <span class="string">&quot;Relocation\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0x2a</span>] = <span class="string">&quot;Reserved\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0x2b</span>] = <span class="string">&quot;Reserved\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0x2c</span>] = <span class="string">&quot;Unknown\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0x2d</span>] = <span class="string">&quot;FPU Exception\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0x2e</span>] = <span class="string">&quot;Disk interrupt\n&quot;</span>;</span><br><span class="line">    interrupt_name[<span class="number">0x2f</span>] = <span class="string">&quot;Reserved\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>make_idt_desc() <u></u><code>typedef void* intr_handler</code>  interrupt.h </li><li>idt_desc_init()  IDT </li><li>pic_init()  8259A <strong></strong>  outb()  <code>port_io.s</code>  <code>interrupt.h</code> </li><li>general_intr_handler() <strong><font color='orange'> register_handler() </font></strong><strong>0x27  0x2f </strong> </li><li> general_handler_regist()  interrupt_handler_table  general_intr_handler </li></ul><p></p><p><img src="/2022/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE0.png" alt=""><br><img src="/2022/img/image-20221201140151874.png" alt=""></p><p></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>/IDT</title>
      <link href="/2022/11/21/%E5%8A%A0%E5%85%A5%E4%B8%AD%E6%96%AD/"/>
      <url>/2022/11/21/%E5%8A%A0%E5%85%A5%E4%B8%AD%E6%96%AD/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p><a href="https://jyx-fyh.github.io/2022/11/26/%E7%89%B9%E6%9D%83%E7%BA%A7%E5%85%A8%E9%9D%A2%E5%89%96%E6%9E%90/"></a><br><a href="https://blog.csdn.net/wlf_go/article/details/80319417"></a> <a href="https://blog.csdn.net/WriteAnything_/article/details/119205756">Bochs</a> X86</p></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong><font color='orange'></font></strong><br> CPU <strong></strong>  CPU <strong></strong> <strong></strong> CPU <strong></strong> <strong></strong> CPU<strong></strong> <strong></strong> </p><h3 id="font-color-red--font"><font color='red'></font></h3><ul><li><p><strong><font color='orange'></font></strong></p></li><li><p><strong>()</strong></p></li><li><p><strong>CPU</strong> CPU  <strong><u></u></strong> </p></li><li><p><strong></strong></p><blockquote><p></p></blockquote></li></ul><h3 id="font-color-red--font"><font color='red'></font></h3><img src="/2022/img/14-1669431386307-9.png" alt="" style="zoom:80%;" /><ul><li><p><strong><font color='gree'></font></strong>  CPU <strong></strong></p><ul><li><p><strong><font color='gree'></font></strong> <u></u> CPU CPU  eflags  IF  0 CPU IF  1 <strong><font color='red'>IF </font></strong> </p><blockquote><p> <code>sti/cli</code>  IF  1/0 </p></blockquote></li><li><p><strong><font color='gree'></font></strong> <u>CPU</u> </p></li></ul></li><li><p><strong><font color='gree'></font></strong>  CPU </p><ul><li><p><strong><font color='gree'>(trap)</font></strong> <u></u><strong><font color='red'> API </font></strong> <strong> <code>int</code>  <code>int 0x80</code></strong> </p><blockquote><p> Linux  trap int 0x80 </p></blockquote></li><li><p><strong><font color='gree'>(Abort)</font></strong>  IDTGDT </p></li><li><p><strong><font color='gree'>(fault)</font></strong>  CPU <strong> boundint3</strong> <u></u></p><ol><li><p><strong>bound</strong>  5 </p> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bound r16,m16</span><br><span class="line">bound r32,m32</span><br></pre></td></tr></table></figure><p>r16/r32 m32/m16 () 0x5 </p></li><li><p><strong>ud2</strong> CPU  6 </p></li></ol><blockquote><p><u></u></p><ol><li>into 4  eflags  OF  1 1</li><li>int3 3  int3  int 3</li></ol><p>into  int3 </p></blockquote></li></ul></li></ul><p><strong><font color='red'> EIP EIP <u></u>  EIP </font></strong> <strong><font color='red'></font></strong> page fault fault into/int3  trap  fault <br><img src="/2022/img/image-202211252258470191.png" alt=""><br> div <strong></strong> <br><img src="/2022/img/image-20221125230745566-1669431365728-6.png" alt=""></p><blockquote><p> <code>interrupt</code> </p></blockquote><p><br><img src="/2022/img/image-20221125231200731-1669431362976-4.png" alt=""></p><p> INTR(interrupt)  NMI(Non Maskable Interrupt)  CPU <strong> INTR  eflags  IF  NMI </strong> <br><img src="/2022/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE15-1669431351849-2.png" alt=""><br><strong><font color='orange'> 0x2</font></strong> </p><p><strong><font color='gree'> CPU (8259A)</font></strong> <strong>CPU  1 2 3 4</strong></p><h3 id="font-color-red-IDT-font"><font color='red'>IDT</font></h3><p><strong>Interrupt Descriptor TableIDT</strong>  <strong><u></u></strong>  CPU  IDT </p><blockquote><p> <strong>Interrupt Vector TableIVT</strong>  IDT </p><ul><li><u>IVT  4  IDT  8 </u></li><li>IVT  0x0000~0x03FF  IDT  IDTR </li><li>IVT  BIOS  IDT </li></ul><p><strong><font color='orange'>BIOS </font></strong>  16  32  IVT<a href="https://jyx-fyh.github.io/2022/10/01/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/"></a> </p></blockquote><p><strong><u></u><u></u><u></u></strong> <a href="https://jyx-fyh.github.io/2022/11/26/%E7%89%B9%E6%9D%83%E7%BA%A7%E5%85%A8%E9%9D%A2%E5%89%96%E6%9E%90/"></a> </p><p>IDT  GDT </p><ol><li>GDT  0 IDT  0  0 </li><li>GDT TSSLDT/ IDT //</li><li>GDT  8192 <strong> IDT  256 </strong>  IDTR  13 </li><li>GDT  IDT  0~19  CPU</li></ol><p>IDT  IDTR  GDTR  IDTR </p><p><img src="/2022/img/2%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE-1669635127754-1.png" alt=""><br> <code>lidt</code> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">lidt 48</span><br><span class="line">;lidt [idt_ptr]</span><br></pre></td></tr></table></figure><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong>CPU <font color='orange'></font></strong> <br><img src="/2022/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE163.png" alt=""></p><ul><li><strong>EXT(External Event)</strong>  1  NMI</li><li><strong>IDT</strong>  1 (IDT) 0  GDT  LDT </li><li><strong>TI</strong> <u> IDT  0 </u> 1  GDT 0  LDT </li></ul><p><strong><font color='orange'> iret/iretd CPU </font></strong> <strong><font color='red'>() iret/iretd </font></strong> </p><div id="dplayer0" class="dplayer hexo-tag-dplayer-mark" style="margin-bottom: 20px;"></div><script>(function(){var player = new DPlayer({"container":document.getElementById("dplayer0"),"autoplay":true,"theme":"#FADFA3","loop":true,"lang":"zh-cn//","screenshot":true,"hotkey":true,"preload":"auto","volume":0.9,"video":{"url":"/2022/video/error_code.mp4","pic":"/2022/image/1.jpg"},"danmaku":{"id":"9E2E3368B56CD123BB4","api":"https://api.prprpr.me/dplayer/","token":"tokendemo","maximum":1000,"addition":["['https://api.prprpr.me/dplayer/v3/bilibili?aid=4157142']"]}});window.dplayers||(window.dplayers=[]);window.dplayers.push(player);})()</script><p><strong><font color='orange'> CPU  int n </font></strong> </p><div id="dplayer1" class="dplayer hexo-tag-dplayer-mark" style="margin-bottom: 20px;"></div><script>(function(){var player = new DPlayer({"container":document.getElementById("dplayer1"),"theme":"#FADFA3","lang":"zh-cn//","screenshot":true,"hotkey":true,"preload":"auto","volume":0.9,"video":{"url":"/2022/video/positive_intr.mp4","pic":"/2022/image/1.jpg"},"danmaku":{"id":"9E2E3368B56CD123BB4","api":"https://api.prprpr.me/dplayer/","token":"tokendemo","maximum":1000,"addition":["['https://api.prprpr.me/dplayer/v3/bilibili?aid=4157142']"]}});window.dplayers||(window.dplayers=[]);window.dplayers.push(player);})()</script><p><strong> 0~32 </strong></p><h3 id="font-color-red--font"><font color='red'></font></h3><blockquote><p><a href="https://jyx-fyh.github.io/2022/11/26/%E7%89%B9%E6%9D%83%E7%BA%A7%E5%85%A8%E9%9D%A2%E5%89%96%E6%9E%90/"></a> </p></blockquote><p><strong><font color='gree'>1</font></strong> CPU  IDT <br><strong><font color='gree'>2</font></strong> <strong><font color='orange'> RPL</font></strong> <br>a <code>int n</code> <code>int3</code> <code>into</code> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DPLCPLDPL</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>b()</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DPLCPL</span><br></pre></td></tr></table></figure><blockquote><p><strong> DPL </strong><br><a href="https://jyx-fyh.github.io/2022/11/26/%E7%89%B9%E6%9D%83%E7%BA%A7%E5%85%A8%E9%9D%A2%E5%89%96%E6%9E%90/"></a></p></blockquote><p><strong><font color='gree'>3</font></strong> <strong> cs</strong>  SS  ESP SS_old  ESP_old TSS  ESP_old  SS_old<br><img src="/2022/img/IMG_0548(20221129-094330).PNG" alt="" style="zoom:67%;" /></p><blockquote><p><strong> SS  ESP</strong></p></blockquote><p><strong><font color='gree'>4</font></strong>  EFLAGS  EFLAGS  NT  TF  <strong><font color='orange'> EFLAGS </font></strong> <strong> IF /IF </strong> <br><strong><font color='gree'>5</font></strong>  CS_old  EIP_old <br><img src="/2022/img/IMG_0549(20221129-095315).PNG" style="zoom: 50%;" /><br><strong><font color='gree'>6</font></strong> <br><img src="/2022/img/IMG_0550(20221129-095535).PNG" style="zoom:50%;" /><br><strong><font color='gree'>7</font></strong>  <code>iret/iretd</code> <br><strong><font color='gree'>8</font></strong>  DS/FS/GS/ES  DPL  CPL <a href="https://jyx-fyh.github.io/2022/11/26/%E7%89%B9%E6%9D%83%E7%BA%A7%E5%85%A8%E9%9D%A2%E5%89%96%E6%9E%90/"></a></p><p></p><p><strong><mark class="hl-label blue"> IF </mark> </strong></p><ul><li> IF  GP 0xd</li><li> IF </li><li> IF  CPU</li></ul><p><strong><mark class="hl-label blue"> TF </mark> </strong><br>TFTrap Flag CPU  TF  1 0x1 0x1 Debug<a href="https://jyx-fyh.github.io/2022/10/01/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/"></a> TF=1 CPUTF=1 CPU  TF  0 </p><p><strong><mark class="hl-label blue"> NT </mark> </strong><br>NTNext Task Flag1 TSS  TSS <a href="https://jyx-fyh.github.io/2022/11/26/%E7%89%B9%E6%9D%83%E7%BA%A7%E5%85%A8%E9%9D%A2%E5%89%96%E6%9E%90/"></a>2 EFLAGS  NT  1 <strong><font color='orange'> <code>iret</code> </font></strong>  <code>iret</code>  NT <strong> NT=0 iret  NT=1 iret </strong> </p><p><strong><mark class="hl-label blue"></mark> </strong><br><strong><font color='red'> CPU  iret/iretd </font></strong> </p><p></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>/</title>
      <link href="/2022/11/20/%E5%AE%9E%E7%8E%B0%E7%B3%BB%E7%BB%9F%E6%89%93%E5%8D%B0%E5%87%BD%E6%95%B0/"/>
      <url>/2022/11/20/%E5%AE%9E%E7%8E%B0%E7%B3%BB%E7%BB%9F%E6%89%93%E5%8D%B0%E5%87%BD%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="font-color-red--font"><font color='red'></font></h3><ol><li><p> <code>put_char()</code> <strong><u></u></strong> </p></li><li><p> <code>put_str()</code>  <code>put_char()</code> </p></li><li><p> <code>put_int()</code>  <code>put_str()</code> <strong><u> 32 </u></strong> </p></li><li><p> <code>printf()</code> </p><blockquote><p>(printf)</p></blockquote></li></ol><p><strong></strong> </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">radix</span>&#123;</span>HEX=<span class="number">16</span>,DEC=<span class="number">10</span>&#125;;</span><br><span class="line">put_char(<span class="type">char</span>, <span class="type">unsigned</span> <span class="type">char</span>);  <span class="comment">//1:;  2:</span></span><br><span class="line">put_str(<span class="type">char</span>*, <span class="type">unsigned</span> <span class="type">char</span>);  <span class="comment">//1:; 2:</span></span><br><span class="line">put_int(<span class="type">int</span>, <span class="type">unsigned</span> <span class="type">char</span>, <span class="keyword">enum</span> radix); <span class="comment">//1:; 2:; 3:</span></span><br></pre></td></tr></table></figure><p></p><h3 id="font-color-red--font"><font color='red'></font></h3><p> <code>0xb8000</code> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mov ax,0xb8000  ;0xb80000xb800</span><br><span class="line">mov gs,ax</span><br><span class="line">mov [gs:0],&#x27;w&#x27;</span><br><span class="line">mov [gs:2],&#x27;o&#x27;</span><br><span class="line">mov [gs:4],&#x27;w&#x27;</span><br><span class="line">mov [gs:6],&#x27;!&#x27;</span><br></pre></td></tr></table></figure><p></p><ol><li></li><li></li></ol><p></p><blockquote><p><strong></strong>  BIOS  BIOS </p></blockquote><p> <u>CGAEGAVGA</u> Intel  0~65535<strong></strong> </p><p>1<strong>Address Register</strong> 2<strong>Data Register</strong> <strong><u><font color='orange'>Address Register Data Register </font></u></strong> </p><blockquote><p><strong>CGA</strong> 402516  <u>802516</u> 3202004  6402002 <br><strong>EGA</strong> () CGA  VGA <br><strong>VGA</strong> VGA 640480 </p></blockquote><p><img src="/2022/img/IMG_0533(20221124-233242).PNG" alt=""><br></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">;</span><br><span class="line">   mov dx, 0x03d4  ;</span><br><span class="line">   mov al, 0x0e   ;8</span><br><span class="line">   out dx, al</span><br><span class="line">   mov dx, 0x03d5  ;0x3d5</span><br><span class="line">   in al, dx   ;8</span><br><span class="line">   mov ah, al</span><br><span class="line"></span><br><span class="line">   ;8</span><br><span class="line">   mov dx, 0x03d4</span><br><span class="line">   mov al, 0x0f</span><br><span class="line">   out dx, al</span><br><span class="line">   mov dx, 0x03d5</span><br><span class="line">   in al, dx       ;ax</span><br></pre></td></tr></table></figure><p> 8  al  16  ax </p><h3 id="font-color-red-print-char-font"><font color='red'>print_char</font></h3><p> C  put_char </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line">;------------------------   put_char   -----------------------------</span><br><span class="line">;:1</span><br><span class="line">;-------------------------------------------------------------------</span><br><span class="line">TI_GDT equ  0</span><br><span class="line">RPL0  equ   0</span><br><span class="line">SELECTOR_VIDEO equ (0x0003&lt;&lt;3) + TI_GDT + RPL0</span><br><span class="line">global put_char</span><br><span class="line"></span><br><span class="line">section .text</span><br><span class="line">put_char:</span><br><span class="line">   pushad              ;32</span><br><span class="line">   mov ax, SELECTOR_VIDEO ;gs,,gs</span><br><span class="line">   mov gs, ax</span><br><span class="line"></span><br><span class="line">;;;;;;;;;   ;;;;;;;;;</span><br><span class="line">   ;8</span><br><span class="line">   mov dx, 0x03d4  ;</span><br><span class="line">   mov al, 0x0e   ;8</span><br><span class="line">   out dx, al</span><br><span class="line">   mov dx, 0x03d5  ;0x3d5</span><br><span class="line">   in al, dx   ;8</span><br><span class="line">   mov ah, al</span><br><span class="line"></span><br><span class="line">   ;8</span><br><span class="line">   mov dx, 0x03d4</span><br><span class="line">   mov al, 0x0f</span><br><span class="line">   out dx, al</span><br><span class="line">   mov dx, 0x03d5</span><br><span class="line">   in al, dx</span><br><span class="line"></span><br><span class="line">   mov bx, ax                 ;bx</span><br><span class="line">   ;</span><br><span class="line">   mov ecx, [esp + 36]      ;pushad4832,4,esp+36</span><br><span class="line">   mov edx, [esp + 40]        ;</span><br><span class="line">   cmp cl, 0xd                ;CR()0x0d,LF()0x0a</span><br><span class="line">   jz .is_carriage_return</span><br><span class="line">   cmp cl, 0xa</span><br><span class="line">   jz .is_line_feed</span><br><span class="line"></span><br><span class="line">   cmp cl, 0x8                ;backspaceascii8</span><br><span class="line">   jz .is_backspace</span><br><span class="line">   jmp .put_other             ;</span><br><span class="line">;backspace:</span><br><span class="line">;backspace,.</span><br><span class="line">;backspace,,,</span><br><span class="line">;,0</span><br><span class="line">.is_backspace:</span><br><span class="line">   dec bx</span><br><span class="line">   shl bx,1</span><br><span class="line">   mov byte [gs:bx], 0x20     ;0</span><br><span class="line">   inc bx</span><br><span class="line">   mov byte [gs:bx], 0x07     ;</span><br><span class="line">   shr bx,1</span><br><span class="line">   jmp .set_cursor</span><br><span class="line">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><br><span class="line"> .put_other:</span><br><span class="line">   shl bx, 1  ; 2,2,</span><br><span class="line">   mov [gs:bx], cl  ; ascii</span><br><span class="line">   inc bx</span><br><span class="line">   mov byte [gs:bx],dl        ; </span><br><span class="line">   shr bx, 1  ; </span><br><span class="line">   inc bx                     ; </span><br><span class="line">   cmp bx, 2000</span><br><span class="line">   jl .set_cursor             ; 2000,,</span><br><span class="line">                              ; (2000)</span><br><span class="line"> .is_line_feed:               ; linuxlinux\n</span><br><span class="line"> .is_carriage_return:         ; \n\rlinux\n</span><br><span class="line">                              </span><br><span class="line">   xor dx, dx                 ; dx16,0.</span><br><span class="line">   mov ax, bx                 ; ax16.</span><br><span class="line">   mov si, 80                  </span><br><span class="line">   div si                     </span><br><span class="line">   sub bx, dx                 ; 80</span><br><span class="line">                              </span><br><span class="line"> .is_CRLF_end:                ; CRLF</span><br><span class="line">   add bx, 80</span><br><span class="line">   cmp bx, 2000</span><br><span class="line">   jl .set_cursor</span><br><span class="line"></span><br><span class="line">;0~24,1~240~23,24</span><br><span class="line"> .roll_screen:                ; </span><br><span class="line">   cld</span><br><span class="line">   mov ecx, 960               ; 2000-80=1920,1920*2=3840.4,3840/4=960</span><br><span class="line">   mov esi, 0xb80a0          ; 1</span><br><span class="line">   mov edi, 0xb8000           ; 0</span><br><span class="line">   rep movsd</span><br><span class="line"></span><br><span class="line">;</span><br><span class="line">   mov ebx, 3840              ; = 1920 * 2</span><br><span class="line">   mov ecx, 80                ;80(160),1(2),80</span><br><span class="line"> .cls:</span><br><span class="line">   mov word [gs:ebx], 0x0720  ;0x0720</span><br><span class="line">   add ebx, 2</span><br><span class="line">   loop .cls</span><br><span class="line">   mov bx,1920                ;1920,.</span><br><span class="line"></span><br><span class="line"> .set_cursor:</span><br><span class="line">;bx</span><br><span class="line">;;;;;;; 1 8 ;;;;;;;;</span><br><span class="line">   mov dx, 0x03d4             ;</span><br><span class="line">   mov al, 0x0e               ;8</span><br><span class="line">   out dx, al</span><br><span class="line">   mov dx, 0x03d5             ;0x3d5</span><br><span class="line">   mov al, bh</span><br><span class="line">   out dx, al</span><br><span class="line"></span><br><span class="line">;;;;;;; 2 8 ;;;;;;;;;</span><br><span class="line">   mov dx, 0x03d4</span><br><span class="line">   mov al, 0x0f</span><br><span class="line">   out dx, al</span><br><span class="line">   mov dx, 0x03d5</span><br><span class="line">   mov al, bl</span><br><span class="line">   out dx, al</span><br><span class="line"> .put_char_done:</span><br><span class="line">   popad</span><br><span class="line">   ret</span><br></pre></td></tr></table></figure><p>()</p><ul><li> 7,8  GS=0  CPU 0</li><li> 28,29  esp  <code>push ebp</code>  <code>mov ebp,esp</code>  ebp </li><li> 77,81 <code>cld</code>  <code>rep movsd</code> <a href="https://jyx-fyh.github.io/2022/10/01/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/"></a> </li></ul><p> put_char </p><h3 id="font-color-red-put-str-font"><font color='red'>put_str</font></h3><p><code>put_str</code>   <code>put_char</code> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">;--------------------------------------------</span><br><span class="line">;put_str put_char0</span><br><span class="line">;--------------------------------------------</span><br><span class="line">;1: 2:</span><br><span class="line">;</span><br><span class="line">global put_str</span><br><span class="line">put_str:</span><br><span class="line">;ebxecx,</span><br><span class="line">   push ebx</span><br><span class="line">   push ecx</span><br><span class="line">   push edx</span><br><span class="line">   xor ecx, ecx           ; ecx,</span><br><span class="line">   mov ebx, [esp + 16]    ; </span><br><span class="line">   mov edx, [esp + 20]    ; </span><br><span class="line">.goon:</span><br><span class="line">   mov cl, [ebx]</span><br><span class="line">   cmp cl, 0              ; ,</span><br><span class="line">   jz .str_over</span><br><span class="line">   push edx               ; </span><br><span class="line">   push ecx               ; put_char</span><br><span class="line">   call put_char</span><br><span class="line">   add esp, 8             ; </span><br><span class="line">   inc ebx                ; ebx</span><br><span class="line">   jmp .goon</span><br><span class="line">.str_over:</span><br><span class="line">   pop edx</span><br><span class="line">   pop ecx</span><br><span class="line">   pop ebx</span><br><span class="line"></span><br><span class="line">   ret</span><br></pre></td></tr></table></figure><ul><li> 13,14  ebp <a href="https://jyx-fyh.github.io/2022/10/27/%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E7%BA%A6%E5%AE%9A/"></a> </li><li> 22 <a href="https://jyx-fyh.github.io/2022/10/27/%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E7%BA%A6%E5%AE%9A/"></a> </li></ul><h3 id="font-color-red-put-int-font"><font color='red'>put_int</font></h3><p>put_str  put_char  put_int </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">;====================put_int===========================================</span><br><span class="line">;1  2 ;3:</span><br><span class="line">section .data</span><br><span class="line">buffer times 12 db 0     ;</span><br><span class="line">sign db 0                ;</span><br><span class="line"></span><br><span class="line">section .text</span><br><span class="line">global put_int</span><br><span class="line">put_int:</span><br><span class="line">    push ebp             ;</span><br><span class="line">    mov ebp,esp          ;ebp</span><br><span class="line">    pushad               ;</span><br><span class="line"></span><br><span class="line">    mov eax,[ebp+8]      ;1</span><br><span class="line">    mov ebx,eax          ;</span><br><span class="line">    mov byte [sign],1    ;</span><br><span class="line">    mov edi,11           ;edi,buffer[11]</span><br><span class="line">    mov esi,buffer       ;esi,buffer[0]</span><br><span class="line">    mov cl,31            ;1,cl</span><br><span class="line">    shr eax,cl           ;31,</span><br><span class="line">    cmp eax,1            ;1,</span><br><span class="line">    jne  .positive       ;,.positive</span><br><span class="line"></span><br><span class="line">.negative:</span><br><span class="line">    mov byte [sign],0    ;0,</span><br><span class="line">    not ebx              </span><br><span class="line">    inc ebx              ;1,,,.positive</span><br><span class="line"></span><br><span class="line">.positive:</span><br><span class="line">    mov ax,bx</span><br><span class="line">    mov cl,16</span><br><span class="line">    shr ebx,cl</span><br><span class="line">    mov dx,bx            ;116dx,16ax</span><br><span class="line">.loop:</span><br><span class="line">    mov cx,[ebp+16]      ;</span><br><span class="line">    call divdw           ;:ax:16  dx:16  cx:|cx: ax:16 dx:16</span><br><span class="line">    sub edi,1            ;</span><br><span class="line">    cmp cl,10            ;cx16clcl</span><br><span class="line">    jb  .dec             ;101016</span><br><span class="line">.hex:</span><br><span class="line">    add cl,&#x27;a&#x27;-10        ;(16)</span><br><span class="line">    jmp .@2</span><br><span class="line">.dec:</span><br><span class="line">    add cl,&#x27;0&#x27;           ;</span><br><span class="line">.@2:</span><br><span class="line">    mov [esi+edi],cl     ;</span><br><span class="line">    mov cl,16            </span><br><span class="line">    mov bx,dx</span><br><span class="line">    shl ebx,cl</span><br><span class="line">    mov bx,ax            ;4ebx</span><br><span class="line">    cmp ebx,0            </span><br><span class="line">    jne .loop            ;0,</span><br><span class="line"></span><br><span class="line">.@1:</span><br><span class="line">    mov cx,[ebp+16]      ;160x</span><br><span class="line">    cmp cx,16</span><br><span class="line">    jne .sign            ;10</span><br><span class="line">    sub edi,1</span><br><span class="line">    mov byte [esi+edi],&#x27;x&#x27;</span><br><span class="line">    sub edi,1</span><br><span class="line">    mov byte [esi+edi],&#x27;0&#x27;</span><br><span class="line"></span><br><span class="line">.sign:</span><br><span class="line">    mov al,[sign]</span><br><span class="line">    cmp al,0</span><br><span class="line">    jne .@3              ;.@3</span><br><span class="line">    sub edi,1</span><br><span class="line">    mov byte [esi+edi],&#x27;-&#x27;</span><br><span class="line">.@3:</span><br><span class="line">    push dword [ebp+12]</span><br><span class="line">    add  esi,edi</span><br><span class="line">    push esi</span><br><span class="line">    call put_str</span><br><span class="line">    add esp,8</span><br><span class="line"></span><br><span class="line">    popad</span><br><span class="line">    pop ebp              ;</span><br><span class="line">    ret</span><br><span class="line">;============================</span><br><span class="line">;ax:16  dx:16  cx:</span><br><span class="line">;cx: ax:16 dx:16</span><br><span class="line">divdw:</span><br><span class="line">    push ax</span><br><span class="line">    mov ax,dx</span><br><span class="line">    mov dx,0</span><br><span class="line">    div cx               ;div,ax,dx</span><br><span class="line">    mov bx,ax</span><br><span class="line">    pop ax</span><br><span class="line">    div cx</span><br><span class="line">    mov cx,dx</span><br><span class="line">    mov dx,bx</span><br><span class="line">    ret</span><br></pre></td></tr></table></figure><p></p><ul><li><p> buffer <br><img src="/2022/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE.13png.png" alt=""></p></li><li><p> 10,11  ebp  10 </p></li><li><p> 39  <code>div</code>  divdw  div  <strong><font color='orange'></font></strong>  CPU div  16  32  DX  AX  AX DX 100000 1  AX divdw divdw </p></li><li><p> 0  C  abcd  00 </p><blockquote><p><code>\n</code> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data db&quot;wow!\n&quot;</span><br></pre></td></tr></table></figure><p> <code>\n</code>  <code>\</code>  <code>n</code>  <code>\n</code>   ASCII  <code>0x8</code> </p></blockquote></li><li><p> [ebp+18][ebp+12][ebp+16] 4  <code>put_int(int, unsigned char, enum radix);</code>  char  1 <strong><font color='red'>C  char  short  int 4 </font></strong> <a href="https://jyx-fyh.github.io/2022/11/16/%E6%B5%85%E6%9E%90C%E5%92%8C%E6%B1%87%E7%BC%96%E6%B7%B7%E5%90%88%E7%BC%96%E7%A8%8B/">C</a> </p></li></ul><p>IDT<br><img src="/2022/img/image-20221125162813996.png" alt=""><br> CPU  0 </p><p><br><img src="/2022/img/image-20221125161434097.png" alt=""></p><p></p><blockquote><p> put_int </p></blockquote><blockquote><p> 2GB  put_uint put_int  <code>memory</code> </p></blockquote><h3 id="font-color-red-divdw-font"><font color='red'>divdw</font></h3><p><br><strong><font color='orange'><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mi mathvariant="normal">/</mi><mi>n</mi><mo>=</mo><mo stretchy="false">(</mo><mi>H</mi><mo>&lt;</mo><mo>&lt;</mo><mn>16</mn><mo>+</mo><mi>L</mi><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>n</mi><mo>=</mo><mo stretchy="false">(</mo><mi>H</mi><mi mathvariant="normal">/</mi><mi>n</mi><mo stretchy="false">)</mo><mo>&lt;</mo><mo>&lt;</mo><mn>16</mn><mo>+</mo><mo stretchy="false">(</mo><mi>L</mi><mi mathvariant="normal">/</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">X/n=(H&lt;&lt;16+L)/n=(H/n)&lt;&lt;16+(L/n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mord">/</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">16</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord">/</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">16</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">L</span><span class="mord">/</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></font></strong></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>=</mo><mi>X</mi><mo>&gt;</mo><mo>&gt;</mo><mn>16</mn><mo separator="true">,</mo><mi>L</mi><mo>=</mo><mi>X</mi><mi mathvariant="normal">%</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mn>16</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">H=X&gt;&gt;16,L=X\%(2^{16})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord">16</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mord">%</span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">16</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p><p></p><ol><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo stretchy="false">!</mo><mo>=</mo><mo stretchy="false">(</mo><mi>X</mi><mo>&gt;</mo><mo>&gt;</mo><mn>16</mn><mo stretchy="false">)</mo><mo>&lt;</mo><mo>&lt;</mo><mn>16</mn></mrow><annotation encoding="application/x-tex">X!=(X&gt;&gt;16)&lt;&lt;16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">!</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">16</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">16</span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><mo stretchy="false">(</mo><mi>X</mi><mo>&gt;</mo><mo>&gt;</mo><mn>16</mn><mo stretchy="false">)</mo><mo>&lt;</mo><mo>&lt;</mo><mn>16</mn><mo>+</mo><mi>X</mi><mi mathvariant="normal">%</mi><msup><mn>2</mn><mn>16</mn></msup></mrow><annotation encoding="application/x-tex">X=(X&gt;&gt;16)&lt;&lt;16+X\%2^{16}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">16</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">16</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8697em;vertical-align:-0.0556em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mord">%</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">16</span></span></span></span></span></span></span></span></span></span></span></span>  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><mo stretchy="false">(</mo><mi>H</mi><mo>&lt;</mo><mo>&lt;</mo><mn>16</mn><mo>+</mo><mi>L</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">X=(H&lt;&lt;16+L)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">16</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mclose">)</span></span></span></span> </li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>H</mi><mo>&lt;</mo><mo>&lt;</mo><mn>16</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">(H&lt;&lt;16)/n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">16</span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathnormal">n</span></span></span></span>  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>H</mi><mi mathvariant="normal">/</mi><mi>n</mi><mo stretchy="false">)</mo><mo>&lt;</mo><mo>&lt;</mo><mn>16</mn></mrow><annotation encoding="application/x-tex">(H/n)&lt;&lt;16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord">/</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">16</span></span></span></span> <br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>H</mi><mo>&lt;</mo><mo>&lt;</mo><mn>16</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>n</mi><mo>=</mo><mo stretchy="false">(</mo><mi>H</mi><mo></mo><mn>65536</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>n</mi><mo>=</mo><mi>H</mi><mo></mo><mn>65536</mn><mi mathvariant="normal">/</mi><mi>n</mi><mo>=</mo><mo stretchy="false">(</mo><mi>H</mi><mi mathvariant="normal">/</mi><mi>n</mi><mo stretchy="false">)</mo><mo></mo><mn>65536</mn><mo>=</mo><mo stretchy="false">(</mo><mi>H</mi><mi mathvariant="normal">/</mi><mi>n</mi><mo stretchy="false">)</mo><mo>&gt;</mo><mo>&gt;</mo><mn>16</mn></mrow><annotation encoding="application/x-tex">(H&lt;&lt;16)/n=(H*65536)/n=H*65536/n=(H/n)*65536=(H/n)&gt;&gt;16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">16</span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">65536</span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">65536/</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord">/</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">65536</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord">/</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">16</span></span></span></span><br></li></ol><p> X/n  H/n  L/n </p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>-</title>
      <link href="/2022/11/16/%E5%8A%A0%E8%BD%BD%E5%86%85%E6%A0%B8-%E4%BB%A3%E7%A0%81%E8%AF%A6%E8%A7%A3/"/>
      <url>/2022/11/16/%E5%8A%A0%E8%BD%BD%E5%86%85%E6%A0%B8-%E4%BB%A3%E7%A0%81%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p><a href="https://jyx-fyh.github.io/2022/11/16/%E6%B5%85%E6%9E%90C%E5%92%8C%E6%B1%87%E7%BC%96%E6%B7%B7%E5%90%88%E7%BC%96%E7%A8%8B/">C</a><a href="https://jyx-fyh.github.io/2022/10/09/makefile%E5%85%A5%E9%97%A8/">makefile</a><br><code>load-kernel</code></p></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><p><br><img src="/2022/img/image-20221116184755024.png" alt="/main.c"><br> <code>open-page</code>  <code>/kernel/main.c</code> () <code>/src/guide.s</code> <img src="/2022/img/image-20221116190141563.png" alt="guide.s"></p><p>loader.s   <code>load-kernel</code>  <code>open-page</code> <br><img src="/2022/img/image-20221116191353841.png" alt=""><br><code>load-kernel</code>  KERNEL_ADDR <strong>loader </strong> </p><blockquote><p>loader  GDT  loader  GDT</p></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><p>main.c  mbr.s  loader.s  main.c  main.bin  main.bin  KERNEL_ADDR  guide.s  kernel_main<strong> main.bin  kernel_main </strong> kernel_main <strong> main.bin </strong>  main.bin kernel_main  char* <code>char*</code>  15 <code>4+4+15=23</code>  loader  23  loader  mbr  C  main.c  main.s <strong><u> main.s </u></strong>  guide.s (guide)</p><blockquote><p>guide.s  kernel_main  _start </p></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><p> main.c  guide.s  makefile()</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">BUILD= ./build</span><br><span class="line">SRC=./src</span><br><span class="line"></span><br><span class="line">CFLAGS:= -m32           <span class="comment"># 32 </span></span><br><span class="line">CFLAGS+= -masm=intel    <span class="comment"># intel</span></span><br><span class="line">CFLAGS+= -fno-builtin   <span class="comment">#  gcc </span></span><br><span class="line">CFLAGS+= -nostdinc      <span class="comment"># </span></span><br><span class="line">CFLAGS+= -fno-pic       <span class="comment">#   position independent code</span></span><br><span class="line">CFLAGS+= -fno-pie       <span class="comment">#  position independent executable</span></span><br><span class="line">CFLAGS+= -nostdlib      <span class="comment"># </span></span><br><span class="line">CFLAGS+= -fno-stack-protector  <span class="comment"># </span></span><br><span class="line">CFLAGS:=<span class="variable">$(<span class="built_in">strip</span> <span class="variable">$(CFLAGS)</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$(BUILD)</span>/pure_kernel.bin: <span class="variable">$(BUILD)</span>/kernel.bin</span><br><span class="line">objcopy -O binary <span class="variable">$(BUILD)</span>/kernel.bin <span class="variable">$@</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$(BUILD)</span>/kernel.bin: <span class="variable">$(BUILD)</span>/guide.o <span class="variable">$(BUILD)</span>/main.o</span><br><span class="line">ld -m elf_i386 <span class="variable">$^</span> -o <span class="variable">$@</span> -Ttext 0x00001500</span><br><span class="line"></span><br><span class="line"><span class="variable">$(BUILD)</span>/main.o: ./kernel/main.c</span><br><span class="line">gcc <span class="variable">$(CFLAGS)</span> -g -c <span class="variable">$&lt;</span> -o <span class="variable">$@</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$(BUILD)</span>/guide.o: <span class="variable">$(SRC)</span>/guide.s</span><br><span class="line">nasm -f elf32 -g <span class="variable">$&lt;</span> -o <span class="variable">$@</span></span><br></pre></td></tr></table></figure><ul><li><p> 24~25  guide.s  guide.o() </p><ul><li><code>-f</code>  <code>elf32</code> <strong> gcc  elf </strong> </li><li><code>-g</code> <strong><font color='orange'></font></strong> ()</li><li><code>-o</code> </li></ul></li><li><p> 21~22  main.c  main.o() </p><ul><li><code>$(CFLAGS)</code>  gcc <strong></strong>  gcc  main.c  .c  .o </li><li><code>-g</code> </li><li><code>-c</code> </li><li><code>-o</code> </li></ul></li><li><p> 17~18  guide.o  main.o </p><ul><li><p><code>-m</code>  elf_i386 </p></li><li><p><code>-Ttext</code>  loader.inc  <code>KERNEL_ADDR</code>  0x1500 0x1500<strong><font color='red'> vstart </font></strong>  vstart  <a href="https://jyx-fyh.github.io/2022/10/23/%E5%89%96%E6%9E%90%E9%87%8D%E5%AE%9A%E4%BD%8D%E2%80%94%E2%80%94%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD%E5%99%A8/"></a></p><blockquote><p><strong><font color='gree'></font></strong>  0  0  768  <strong></strong>  0x1500  0xc0001500 </p></blockquote></li></ul></li><li><p> 14~15  kernel.bin  pure_kernel.bin </p><blockquote><p> kernel.bin  ELF  CPU  CPU  objcopy  pure_kernel.bin  CPU  objcopy <a href="https://www.jianshu.com/p/beef56fec4ba">objcopy</a> </p></blockquote><ul><li><code>-O binary</code> </li></ul></li></ul><blockquote><p></p></blockquote><p><strong><font color='red'> <code>_start</code> objcopy pure_kernel.bin  <code>guide.s</code> <code>_start</code> </font></strong>  <code>call kernel_main</code> -Ttext 0x1500 <code>call kernel_main</code>  0x1500  0x1500  loader  <code>call SELECTOR_CODE:KERNEL_ADDR</code>  0x1500 </p><p> pure_kernel.bin  <code>call kernel_main</code>  pure_kernel.bin <img src="/2022/img/image-20221117002754476.png" alt=""><br> <code>E8 02</code>  <code>call kernel_main</code> </p><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong><mark class="hl-label blue">count</mark> </strong><br> loader.inc <br><img src="/2022/img/image-20221117092239137.png" alt="loader.inc"><br> makefile </p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">./$(DISK):<span class="variable">$(BUILD)</span>/mbr.bin <span class="variable">$(BUILD)</span>/loader.bin <span class="variable">$(BUILD)</span>/pure_kernel.bin</span></span><br><span class="line">bximage -q -hd=16 -func=create -sectsize=512 -imgmode=flat <span class="variable">$@</span></span><br><span class="line">dd if=<span class="variable">$(BUILD)</span>/mbr.bin of=<span class="variable">$@</span> bs=512  conv=notrunc</span><br><span class="line">dd if=<span class="variable">$(BUILD)</span>/loader.bin of=<span class="variable">$@</span> bs=512  seek=2 conv=notrunc</span><br><span class="line">dd if=<span class="variable">$(BUILD)</span>/pure_kernel.bin of=<span class="variable">$@</span> bs=512 seek=50 count=200 conv=notrunc</span><br></pre></td></tr></table></figure><p>seek=50  50  50 (0) inc  <code>count=200</code>  200  count count  count</p><p><strong><mark class="hl-label blue"></mark> </strong><br> kernel_main  0xb8000  480 2580  80 25  2000  ASCII (,) 4  <code>0xb8000+8023</code>  <code>0xb8000+480</code> </p><blockquote><p>0xb8000 </p></blockquote><p><strong><mark class="hl-label blue">charshort</mark> </strong><br> kernel_main() <br><img src="/2022/img/image-20221119165243020.png" style="zoom:67%;" /><br> 11  0x2 </p><h3 id="font-color-red--font"><font color='red'></font></h3><p><code>-Ttext 0x1500</code>  <code>-Ttext 0xc0001500</code> </p><p><img src="/2022/img/image-20221117094137891.png" alt=""><br></p><blockquote><p> makefile clean --&gt; all --&gt; bochs</p></blockquote>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C/ABI</title>
      <link href="/2022/11/16/%E6%B5%85%E6%9E%90C%E5%92%8C%E6%B1%87%E7%BC%96%E6%B7%B7%E5%90%88%E7%BC%96%E7%A8%8B/"/>
      <url>/2022/11/16/%E6%B5%85%E6%9E%90C%E5%92%8C%E6%B1%87%E7%BC%96%E6%B7%B7%E5%90%88%E7%BC%96%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p><a href="https://jyx-fyh.github.io/2022/11/16/%E5%8A%A0%E8%BD%BD%E5%86%85%E6%A0%B8-%E4%BB%A3%E7%A0%81%E8%AF%A6%E8%A7%A3/"></a></p><p><a href="https://jyx-fyh.github.io/2022/10/27/%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E7%BA%A6%E5%AE%9A/"></a><br><a href="https://jyx-fyh.github.io/2022/11/16/%E5%8A%A0%E8%BD%BD%E5%86%85%E6%A0%B8-%E4%BB%A3%E7%A0%81%E8%AF%A6%E8%A7%A3/">-</a></p></blockquote><h3 id="font-color-red-C-font"><font color='red'>C</font></h3><p><strong><mark class="hl-label blue"></mark> </strong><br></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//cprint.c</span></span><br><span class="line"><span class="keyword">extern</span> <span class="type">void</span> <span class="title function_">asm_print</span><span class="params">(<span class="type">char</span> *, <span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">c_print</span><span class="params">(<span class="type">char</span>* str)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> len = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (str[len++]);</span><br><span class="line">asm_print(str, len);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">;asm_print.s</span><br><span class="line">[bits 32]</span><br><span class="line">section .data</span><br><span class="line">str: db &quot;asm_print say hi youyifeng!&quot;,0xa,0x00 </span><br><span class="line">;0x0a0x00</span><br><span class="line">;whileNULL</span><br><span class="line">str_len equ $-str</span><br><span class="line"></span><br><span class="line">section .text</span><br><span class="line">extern c_print       ;c_print</span><br><span class="line">global _start</span><br><span class="line"></span><br><span class="line">_start:</span><br><span class="line">push str_len</span><br><span class="line">push str</span><br><span class="line"></span><br><span class="line">call c_print</span><br><span class="line">add esp,8        ;cdecl,()</span><br><span class="line">mov eax,1        ;1,Linux</span><br><span class="line">int 0x80</span><br><span class="line"></span><br><span class="line">global asm_print ;asm_print</span><br><span class="line">asm_print:</span><br><span class="line">push ebp         ;</span><br><span class="line">mov ebp,esp      ;ebp</span><br><span class="line">mov eax,4        ;4:ebx,ecx,edx</span><br><span class="line">mov ebx,1        ;3012</span><br><span class="line">mov ecx,[ebp+8]  ;len </span><br><span class="line">mov edx,[ebp+12] ;  char *str</span><br><span class="line">int 0x80         ;0x80</span><br><span class="line">pop ebp          ;ebp</span><br><span class="line">ret</span><br></pre></td></tr></table></figure><p> cprint.c </p><ol><li> 2 extern  asm_print  c_print  asm_print  asm_print <strong><font color='orange'></font></strong>  extern </li><li> 2 asm_print  char*  int  asm_print.s 14,15  push asm_print <strong></strong>  char*  int <strong><font color='red'></font></strong>  <code>char* ptr</code>  ptr  ptr  1(1) <code>int* ptr</code>  ptr  ptr  4 </li></ol><p><strong><font color='red'>C  char  short  int 4 </font></strong>  C <br><img src="/2022/img/image-20221125152130185.png" style="zoom:67%;" /></p><p><br><img src="/2022/img/image-20221125152228134.png" style="zoom:80%;" /></p><p> b  eax  4  <code>push 3</code> 32  4 <br><img src="/2022/img/image-20221125153009512.png" alt=""><br> 1  word  b  shortmovsx </p><p> asm_print.s </p><ol><li><p> 2 <code>[bits 32]</code>  32 <a href="https://jyx-fyh.github.io/2022/10/31/32%E4%BD%8D%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%E6%A6%82%E8%A7%88/">32</a> </p></li><li><p> 10  c_print  extern </p></li><li><p> 11 <code>global</code> <code>_start</code> </p></li><li><p> 22  asm_print  cprint.c  cprint()  asm_print </p></li><li><p> 14,15  c_print </p></li><li><p> 18  c_print()  C  cdecl<a href="https://jyx-fyh.github.io/2022/10/27/%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E7%BA%A6%E5%AE%9A/"></a></p><blockquote><p> c_print()  stdcall __stdcall</p></blockquote></li><li><p> 24,25 <a href="https://jyx-fyh.github.io/2022/10/27/%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E7%BA%A6%E5%AE%9A/"></a> </p></li><li><p> 30 0x80  Linux  eax </p></li></ol><p><strong></strong> </p><ul><li> <code>glbal</code>  <code>extern</code> </li><li> C  <code>extern</code> </li></ul><p><strong><mark class="hl-label blue"></mark> </strong><br></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gcc -m32 -c cprint.c -o cprint.o</span><br><span class="line">nasm -f elf32 asm_print.s -o asm_print.o</span><br></pre></td></tr></table></figure><p><code>-m32</code>  <code>-f elf32</code>  32  ELF </p><p><strong><mark class="hl-label blue"></mark> </strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ld -m elf_i386 asm_print.o cprint.o -o print</span><br></pre></td></tr></table></figure><p><code>-m elf_i386</code>  print </p><p><strong><mark class="hl-label blue"></mark> </strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./print</span><br><span class="line">asm_print say hi youyifeng!</span><br></pre></td></tr></table></figure><h3 id="font-color-red-ELF-font"><font color='red'>ELF</font></h3><p> asm_print.o  cprint.o <strong><font color='orange'> _start ()</font></strong> <code>-e</code> </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#main</span></span><br><span class="line">ld -m -e main elf_i386 asm_print.o cprint.o -o <span class="built_in">print</span></span><br></pre></td></tr></table></figure><p> ELF  ELF <a href="https://jyx-fyh.github.io/2022/10/23/%E5%89%96%E6%9E%90%E9%87%8D%E5%AE%9A%E4%BD%8D%E2%80%94%E2%80%94%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD%E5%99%A8/"></a> <strong>ELF </strong> <strong>Linux  ELF ELF  header+ body </strong> CPU <strong> ELF CPU </strong> ELF </p><p><a href="https://jyx-fyh.github.io/2022/11/16/%E5%8A%A0%E8%BD%BD%E5%86%85%E6%A0%B8-%E4%BB%A3%E7%A0%81%E8%AF%A6%E8%A7%A3/"></a> </p><h3 id="font-color-red-ABI--font"><font color='red'>ABI </font></h3><p>ABIApplication Binary InterfaceABI</p><ul><li></li><li></li><li></li><li>ABI</li></ul><p> ABI  Intel386 <u></u> epbebxesiediesp <strong><u><font color='gree'></font></u></strong>  C  C  C  pushad  popad </p><ol><li><strong>eax </strong> </li><li><strong>esp <a href="https://jyx-fyh.github.io/2022/10/27/%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E7%BA%A6%E5%AE%9A/"></a> esp </strong> </li></ol><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> b = <span class="number">2</span>;</span><br><span class="line"><span class="type">int</span> c = add(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">int add(int a, int b)                   </span><br><span class="line">&#123;</span><br><span class="line">00FB1750  push        ebp  </span><br><span class="line">00FB1751  mov         ebp,esp  </span><br><span class="line">00FB1753  sub         esp,0C0h  </span><br><span class="line">00FB1759  push        ebx  </span><br><span class="line">00FB175A  push        esi  </span><br><span class="line">00FB175B  push        edi  </span><br><span class="line">00FB175C  mov         edi,ebp  </span><br><span class="line">00FB175E  xor         ecx,ecx  </span><br><span class="line">00FB1760  mov         eax,0CCCCCCCCh  </span><br><span class="line">00FB1765  rep stos    dword ptr es:[edi]  </span><br><span class="line">00FB1767  mov         ecx,offset _206B94B3_@c (0FBC000h)  </span><br><span class="line">00FB176C  call        @__CheckForDebuggerJustMyCode@4 (0FB130Ch)  </span><br><span class="line">return a + b;</span><br><span class="line">00FB1771  mov         eax,dword ptr [a]  ;[ebp+8]</span><br><span class="line">00FB1774  add         eax,dword ptr [b]  ;[ebp+0Ch]</span><br><span class="line">&#125;</span><br><span class="line">00FB1777  pop         edi  </span><br><span class="line">00FB1778  pop         esi  </span><br><span class="line">00FB1779  pop         ebx  </span><br><span class="line">00FB177A  add         esp,0C0h  </span><br><span class="line">00FB1780  cmp         ebp,esp  </span><br><span class="line">00FB1782  call        __RTC_CheckEsp (0FB1235h)  ;(ebp==esp)</span><br><span class="line">00FB1787  mov         esp,ebp  </span><br><span class="line">00FB1789  pop         ebp  </span><br><span class="line">00FB178A  ret  </span><br></pre></td></tr></table></figure><p> 3678 </p><p></p>]]></content>
      
      
      <categories>
          
          <category> C </category>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>-</title>
      <link href="/2022/11/13/%E5%BC%80%E5%90%AF%E5%88%86%E9%A1%B5-%E4%BB%A3%E7%A0%81%E8%AF%A6%E8%A7%A3/"/>
      <url>/2022/11/13/%E5%BC%80%E5%90%AF%E5%88%86%E9%A1%B5-%E4%BB%A3%E7%A0%81%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p><a href=""></a><br> <code>open-page</code> </p></blockquote><p><strong><mark class="hl-label blue">boot.inc</mark> </strong><br><code>boot.inc</code> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">;===================</span><br><span class="line">PAGE_DIR_POS    equ  0x00100000            ;1MB</span><br><span class="line">PAGE_TABLE_POS  equ  PAGE_DIR_POS + 4096   ;</span><br><span class="line">;==============================</span><br><span class="line">PG_P     equ   1b</span><br><span class="line">PG_RW_R equ  00b</span><br><span class="line">PG_RW_W equ  10b</span><br><span class="line">PG_US_S equ  000b</span><br><span class="line">PG_US_U equ  100b</span><br></pre></td></tr></table></figure><ul><li> GDT <strong></strong>  <code>0x100000</code> </li><li> 4KB 4096 (0x1000)</li></ul><p><br><img src="/2022/img/9.png" style="zoom:67%;" /></p><p><strong><mark class="hl-label blue">loader.s</mark> </strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br></pre></td><td class="code"><pre><span class="line">;loader.s</span><br><span class="line">;%include &quot;boot.inc&quot;</span><br><span class="line">;%include &quot;loader.inc&quot;</span><br><span class="line"></span><br><span class="line">SECTION loader vstart=BASE_ADDR              ;</span><br><span class="line">    program_length  dd program_end           ;[0x00]</span><br><span class="line">    ;</span><br><span class="line">    code_entry      dw start-BASE_ADDR       ;[0x04]</span><br><span class="line">                    dd section.loader.start  ;[0x06]</span><br><span class="line">    realloc_tbl_len dw 0                     ;0</span><br><span class="line">;=========================================================</span><br><span class="line">;GDT</span><br><span class="line">;0</span><br><span class="line">    GDT_BASE        dd    0x00000000</span><br><span class="line">                    dd    0x00000000</span><br><span class="line">;1CODE</span><br><span class="line">    DESC_CODE       dd    0x0000FFFF</span><br><span class="line">                    dd    DESC_CODE_HIGH4</span><br><span class="line">;2DATA</span><br><span class="line">    DESC_DATA       dd    0x0000FFFF</span><br><span class="line">                    dd    DESC_DATA_HIGH4</span><br><span class="line">;3VIDEO</span><br><span class="line">    DESC_VIDEO      dd    0x80000007</span><br><span class="line">                    dd    DESC_VIDEO_HIGH4</span><br><span class="line"></span><br><span class="line">    GDT_SIZE        equ   $ - GDT_BASE</span><br><span class="line">    GDT_LIMIT       equ   GDT_SIZE - 1</span><br><span class="line">;GDT</span><br><span class="line">    gdt_ptr         dw    GDT_LIMIT</span><br><span class="line">                    dd    GDT_BASE</span><br><span class="line"></span><br><span class="line">    SELECTOR_CODE   equ   ((DESC_CODE - GDT_BASE)/8)&lt;&lt;3 + TI_GDT + RPL0</span><br><span class="line">    SELECTOR_DATA   equ   ((DESC_DATA - GDT_BASE)/8)&lt;&lt;3 + TI_GDT + RPL0</span><br><span class="line">    SELECTOR_VIDEO  equ   ((DESC_VIDEO- GDT_BASE)/8)&lt;&lt;3 + TI_GDT + RPL0</span><br><span class="line"></span><br><span class="line">    loader_msg      db    &#x27;r&#x27;,11000010b,&#x27;e&#x27;,11000010b,&#x27;a&#x27;,11000010b,&#x27;l&#x27;,11000010b,&#x27;-&#x27;,11000010b</span><br><span class="line">                    db    &#x27;m&#x27;,11000010b,&#x27;o&#x27;,11000010b,&#x27;d&#x27;,11000010b,&#x27;e&#x27;,11000010b</span><br><span class="line">;=======================================================</span><br><span class="line"></span><br><span class="line">start: ;</span><br><span class="line">mov ax,0             ;loader,</span><br><span class="line">mov ds,ax            ;0</span><br><span class="line">mov es,ax</span><br><span class="line">mov ss,ax</span><br><span class="line">mov gs,ax</span><br><span class="line">mov fs,ax</span><br><span class="line">print:</span><br><span class="line">mov ax,0xb800        ;</span><br><span class="line">mov es,ax</span><br><span class="line">mov si,loader_msg    ;ds:si</span><br><span class="line">mov di,0             ;es:di</span><br><span class="line">mov cx,18            ;9,18</span><br><span class="line">cld</span><br><span class="line">rep movsb</span><br><span class="line">;========================================================</span><br><span class="line">;1.A20</span><br><span class="line">;2.GDT</span><br><span class="line">;3.PE=1</span><br><span class="line">prepare:</span><br><span class="line">;</span><br><span class="line">    cli</span><br><span class="line">;A20</span><br><span class="line">    in   al,0x92</span><br><span class="line">    or   al,0000_0010B</span><br><span class="line">    out  0x92,al</span><br><span class="line">;GDT</span><br><span class="line">    mov  ax,0</span><br><span class="line">    mov  ds,ax</span><br><span class="line">    lgdt [gdt_ptr]</span><br><span class="line">;CR001</span><br><span class="line">    mov  eax,cr0</span><br><span class="line">    or   eax,0x0000_0001</span><br><span class="line">    mov  cr0,eax</span><br><span class="line">;</span><br><span class="line">    jmp  dword SELECTOR_CODE:p_mode_start ;,CODE</span><br><span class="line">;======================================================</span><br><span class="line">[bits 32]</span><br><span class="line">p_mode_start:</span><br><span class="line">    mov ax,SELECTOR_DATA</span><br><span class="line">    mov ds,ax</span><br><span class="line">    mov es,ax</span><br><span class="line">    mov ss,ax</span><br><span class="line">    mov esp,BASE_ADDR       ;BASE_ADDR</span><br><span class="line">    mov ax,SELECTOR_VIDEO</span><br><span class="line">    mov gs,ax</span><br><span class="line"></span><br><span class="line">    mov byte [gs:160],&#x27;p&#x27;   ;</span><br><span class="line">    mov byte [gs:161],11000010b</span><br><span class="line">    </span><br><span class="line">call setup_page</span><br><span class="line">sgdt [gdt_ptr]          ;store gdt,GDTRgdt_ptr</span><br><span class="line">mov  ebx,[gdt_ptr+2]    ;ebxGDT</span><br><span class="line"></span><br><span class="line">;38,24~314</span><br><span class="line">or dword [ebx+8*3+4],0xc0000000   ;c</span><br><span class="line"></span><br><span class="line">;gdt0xc0000000</span><br><span class="line">add dword [gdt_ptr + 2], 0xc0000000</span><br><span class="line"></span><br><span class="line">add esp, 0xc0000000     ;</span><br><span class="line"></span><br><span class="line">mov eax, PAGE_DIR_POS   ;cr3</span><br><span class="line">mov cr3, eax</span><br><span class="line"></span><br><span class="line">mov eax, cr0            ;cr0pg(31)</span><br><span class="line">or eax, 0x80000000</span><br><span class="line">mov cr0, eax</span><br><span class="line"></span><br><span class="line">;,gdt</span><br><span class="line">lgdt [gdt_ptr]          ; </span><br><span class="line"></span><br><span class="line">mov byte [gs:320], &#x27;V&#x27;  ;</span><br><span class="line">mov byte [gs:322], &#x27;i&#x27;     </span><br><span class="line">mov byte [gs:324], &#x27;r&#x27;     </span><br><span class="line">mov byte [gs:326], &#x27;t&#x27;     </span><br><span class="line">mov byte [gs:328], &#x27;u&#x27;     </span><br><span class="line">mov byte [gs:330], &#x27;a&#x27;     </span><br><span class="line">mov byte [gs:332], &#x27;l&#x27;     </span><br><span class="line">jmp $</span><br><span class="line"></span><br><span class="line">;=======================================================</span><br><span class="line">;,4bytes,1024,4KB</span><br><span class="line">setup_page:</span><br><span class="line">mov ecx,1024</span><br><span class="line">mov esi,0</span><br><span class="line">.clear:</span><br><span class="line">mov dword [PAGE_DIR_POS+esi],0</span><br><span class="line">add esi,4</span><br><span class="line">loop .clear</span><br><span class="line"></span><br><span class="line">;,</span><br><span class="line">.create_PDE:</span><br><span class="line">mov eax,PAGE_TABLE_POS       ;eax0</span><br><span class="line">mov ebx,eax                  ;</span><br><span class="line"></span><br><span class="line">;00xc0004MB,</span><br><span class="line">;1GB4MB3GB4MB</span><br><span class="line">;</span><br><span class="line">or  eax, PG_US_U | PG_RW_W | PG_P        ;,RW,PGUS1</span><br><span class="line">mov [PAGE_DIR_POS + 0*4], eax            ;0,0~4MB</span><br><span class="line">mov [PAGE_DIR_POS + 768*4], eax          ;768,3GB~3GB+4MB</span><br><span class="line"></span><br><span class="line">mov eax, PAGE_DIR_POS</span><br><span class="line">or  eax, PG_US_U | PG_RW_W | PG_P</span><br><span class="line">mov [PAGE_DIR_POS + 1023*4], eax ;(1023)</span><br><span class="line"></span><br><span class="line">;0(PTE)</span><br><span class="line">mov ecx,256                      ;1M/4KB=256</span><br><span class="line">mov esi,0</span><br><span class="line">mov edx,PG_US_U | PG_RW_W | PG_P ;7,US=1,RW=1,P=1;12~310,mov</span><br><span class="line">.create_PTE:</span><br><span class="line">mov [PAGE_TABLE_POS+4*esi],edx</span><br><span class="line">add edx,4096                     ;,4KB</span><br><span class="line">inc esi</span><br><span class="line">loop .create_PTE                 </span><br><span class="line"></span><br><span class="line">;1GB</span><br><span class="line">mov eax,PAGE_TABLE_POS+4096*1    ;eax1</span><br><span class="line">or  eax,PG_US_U | PG_RW_W | PG_P ;US,RWP1</span><br><span class="line">mov ecx, 254                     ;769~1022,1023</span><br><span class="line">mov esi, 769                     ;769</span><br><span class="line">.create_kernel_pde:</span><br><span class="line">mov ebx,PAGE_DIR_POS</span><br><span class="line">mov [ebx+esi*4], eax</span><br><span class="line">inc esi</span><br><span class="line">add eax, 4096</span><br><span class="line">loop .create_kernel_pde</span><br><span class="line">ret</span><br><span class="line">;========================================================</span><br><span class="line">program_end  equ  $-BASE_ADDR</span><br></pre></td></tr></table></figure><p><u></u><u></u><u></u><u></u><a href=""></a>/</p><img src="/2022/img/IMG_0522(20221113-175513).PNG" style="zoom: 67%;" /><p> <code>setup_page</code>  123 </p><ol><li><p> 137 <code>PG_US_U | PG_RW_W | PG_P</code>  1 0 </p></li><li><p> 140  0  0  loader  loader  1MB  <code>CS : EIP</code>  1MB  loader <strong><font color='orange'></font></strong> <strong> 1MB  1MB </strong>  <code>CS:IP=0x0000:1002</code>  <code>0x00001002</code><u></u> <code>CS:IP=0x0000:1004</code>  <code>0x00001004</code> <a href=""></a> 0  0  0  <code>1</code>  1  <code>0x1000</code> (<u>147~155</u>) <code>0x04</code>  <code>0x00001004</code> </p></li><li><p> 141  0  768 <strong> 768  3GB~3GB+4MB 1MB  3GB  0  768 </strong> </p><blockquote><p><strong> 2, 3 1MB  1MB  147~155  1MB  1MB </strong></p></blockquote></li><li><p> 145 (1023)<strong><font color='orange'></font></strong>  <code>0xfffff000</code>  10  10  <code>0x3ff(1023)</code>  10  1023  10  <strong><u><font color='gree'> CPU </font></u> 12  0<font color='orange'></font></strong> <strong> <code>0xfffff000</code>  <code>0xfffffxxx</code>  <code>xxx</code>  <code>*4</code>  10  <code>0x3ff</code>  10 CPU  12  <code>*4</code> </strong> CPU  CPU  10 </p> <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> PDE_IDX(addr) ((addr &amp; 0xffc00000) &gt;&gt; 22) <span class="comment">//addr,addr&gt;&gt;22</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PTE_IDX(addr) ((addr &amp; 0x003ff000) &gt;&gt; 12) <span class="comment">//addr</span></span></span><br><span class="line"><span class="type">uint32_t</span>* pte = (<span class="type">uint32_t</span>*)(<span class="number">0xffc00000</span> + ((vaddr &amp; <span class="number">0xffc00000</span>) &gt;&gt; <span class="number">10</span>) + PTE_IDX(vaddr) * <span class="number">4</span>);</span><br><span class="line"><span class="comment">//ptevaddrPTE</span></span><br><span class="line"><span class="type">uint32_t</span>* pde = (<span class="type">uint32_t</span>*)((<span class="number">0xfffff000</span>) + PDE_IDX(vaddr) * <span class="number">4</span>);</span><br><span class="line"><span class="comment">//pdevaddrPDE</span></span><br></pre></td></tr></table></figure></li><li><p> 148  4MB  1MB 1MB </p></li><li><p> 157~168  1GB  1MB  1GB <strong><font color='gree'></font></strong>  1GB <strong> 768~1022  1023 </strong>  1GB <strong></strong></p><blockquote><p><a href="https://jyx-fyh.github.io/2022/12/02/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/"></a></p></blockquote></li></ol><p> <code>setup_page</code>  91~199 </p><ol><li> 91 <code>sgdt</code>  <code>store gdt</code>  GDTR (dump) GDTR  <code>lgdt</code>  <code>sgdt</code>  <code>gdt_ptr</code> </li><li> 95  3GB ()<strong></strong>  3GB </li><li> 98  GDT  3GB <strong> GDT GDT </strong> </li><li> 100 </li></ol><p><br><img src="/2022/img/image-20221115112336872.png" alt=""></p><p> C </p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/11/13/%E5%BC%80%E5%90%AF%E5%88%86%E9%A1%B5%E6%9C%BA%E5%88%B6/"/>
      <url>/2022/11/13/%E5%BC%80%E5%90%AF%E5%88%86%E9%A1%B5%E6%9C%BA%E5%88%B6/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p><a href="https://www.zhihu.com/question/436136392"></a> x86<br><a href="https://jyx-fyh.github.io/2022/11/13/%E5%BC%80%E5%90%AF%E5%88%86%E9%A1%B5-%E4%BB%A3%E7%A0%81%E8%AF%A6%E8%A7%A3/">-</a> </p></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><p> <strong></strong> <br><img src="/2022/img/IMG_0523(20221115-141809).PNG" style="zoom:67%;" /><br> 1  15MB  2 B  20MB  35MB  D  20MB+3KB 35MB <strong></strong>  D  A   C </p><p><strong></strong> <strong><font color='gree'></font></strong> <br><strong></strong>  20MB  15MB  <strong></strong> <strong><font color='orange'>()</font></strong> <br><img src="/2022/img/IMG_0524(20221115-150238).PNG" style="zoom: 67%;" /></p><p></p><ul><li><p><strong></strong> </p></li><li><p><strong></strong> </p><blockquote><p></p></blockquote></li><li><p><strong></strong> </p><blockquote><p>32  4G 64 </p></blockquote></li></ul><p></p><h3 id="font-color-red--font"><font color='red'></font></h3><p></p><p><strong><mark class="hl-label blue"></mark> </strong><br> 4KB <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>12</mn></msup></mrow><annotation encoding="application/x-tex">2^{12}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span></span></span></span></span></span></span></span>  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>20</mn></msup></mrow><annotation encoding="application/x-tex">2^{20}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">20</span></span></span></span></span></span></span></span></span></span></span></span>  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>32</mn></msup></mrow><annotation encoding="application/x-tex">2^{32}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">32</span></span></span></span></span></span></span></span></span></span></span></span>  4GB  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>20</mn></msup></mrow><annotation encoding="application/x-tex">2^{20}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">20</span></span></span></span></span></span></span></span></span></span></span></span> <br><img src="/2022/img/IMG_0525(20221115-155044).PNG" style="zoom:67%;" /></p><p><strong> 4  4MB</strong> ()<u> 32  20  12 </u> <code>0x92f11f23</code>  <code>0x92f11</code>  <code>0x92f11</code>  <strong><u></u></strong>  <code>0x20001</code>  12  <code>0xf23</code>  <code>0x20001f23</code> </p><blockquote><p><strong><font color='gree'> 4K </font></strong>  12  0 ()</p></blockquote><p><strong><mark class="hl-label blue"></mark> </strong><br> <strong><font color='red'></font></strong> <br><img src="/2022/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE10.png" alt=""><br>1024  1024  1024  4KB  <code>102410244KB=4GB</code>  32 <strong><font color='orange'> 10  10  12 </font></strong>  <code>0x1f25e9a2</code>  10  124 124 (0) A  10  1136 A  1136  <code>0xff120000</code>  12  <code>0x9a2</code>  <code>ff1209a2</code> </p><p><strong><mark class="hl-label blue"></mark> </strong><br><img src="/2022/img/IMG_0526(20221115-170651).PNG" style="zoom:80%;" /></p><ul><li><p> 31~12  20  4KB 4KB  12  0</p></li><li><p></p><ul><li><p><strong>AVL</strong> /CPU </p></li><li><p><strong>G</strong> Global1 0  TLB </p></li><li><p><strong>PAT</strong> PAT CPU  PAT=0  4KB PAT=1  4MB</p></li><li><p><strong>D</strong> Dirty<strong> CPU  D  1 <font color='orange'> D </font></strong></p><blockquote><p> D  1 / D  0 <strong></strong>  I/O </p></blockquote></li><li><p><strong>A</strong> Accessed A  P <a href="https://jyx-fyh.github.io/2022/10/31/%E5%85%A8%E5%B1%80%E6%8F%8F%E8%BF%B0%E7%AC%A6%E8%A1%A8%E6%A6%82%E8%BF%B0/"></a> </p></li><li><p><strong>PCD</strong> PCD  1 PCD  0 </p></li><li><p><strong>PWT</strong> PWT  1 PWT  0 </p><blockquote><p>PWTPCD80386</p></blockquote></li><li><p><strong>US</strong> User/Supervisor/ US  1  US  0 012 3 </p></li><li><p><strong>RW</strong> Read/Write RW  1  RW  0 </p></li><li><p><strong>P</strong> present P  1  P  0 <strong> A </strong> </p></li></ul></li></ul><h3 id="font-color-red--font"><font color='red'></font></h3><p></p><ul><li><p><strong><font color='orange'></font></strong> 4MB</p></li><li><p><strong><font color='orange'></font></strong> </p><blockquote><p></p></blockquote></li></ul><p></p><ul><li><p><strong><font color='orange'></font></strong> </p><blockquote><p><strong><font color='orange'> 31~12  4K </font></strong></p></blockquote></li><li><p><strong><font color='orange'></font></strong> <strong></strong> (4MB)</p><blockquote><p><strong><font color='gree'></font></strong> <a href="https://jyx-fyh.github.io/2022/11/13/%E5%BC%80%E5%90%AF%E5%88%86%E9%A1%B5-%E4%BB%A3%E7%A0%81%E8%AF%A6%E8%A7%A3/">-</a>0768~10221023<strong><u> 4KB </u></strong>  0 <strong></strong>  0 <a href="https://jyx-fyh.github.io/2022/12/08/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86-%E8%BF%9B%E9%98%B6-%E5%88%86%E9%85%8D%E9%A1%B5%E5%86%85%E5%AD%98/">--</a><br> i386  Linux </p></blockquote></li><li><p><strong><font color='orange'></font></strong>  P </p><blockquote><p>CPU </p></blockquote></li></ul><p> 3~5 </p><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong><font color='orange'> CR0  PG( 31 )  1 </font></strong> <br><img src="/2022/img/IMG_0516(20221102-163923)-1668327746253-1.png" alt=""></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mov eax, cr0                 </span><br><span class="line">or  eax, 0x80000000</span><br><span class="line">mov cr0, eax</span><br></pre></td></tr></table></figure><p><strong><font color='orange'> CR3 </font></strong>CR3 <br><img src="/2022/img/IMG_0520(20221113-163114).PNG" alt=""></p><p> PCD  PWT  0 </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov eax, PAGE_DIR_POS   ;(0x00100000)cr3</span><br><span class="line">mov cr3, eax</span><br></pre></td></tr></table></figure><p><strong>CR3 </strong></p><h3 id="font-color-red--font"><font color='red'></font></h3><ul><li></li><li></li><li></li><li></li><li><strong><font color='red'> 4GB </font></strong> </li></ul><h3 id="font-color-red-TLB-font"><font color='red'>TLB</font></h3><p></p><p> <strong>TLB(Translation Lookaside Buffer)</strong> <u></u> <br><img src="/2022/img/IMG_0527(20221116-151219).PNG" alt=""></p><p><strong> 20  TLB </strong> <strong> TLB</strong> </p><blockquote><p> TLB  TLB  TLB  TLB </p></blockquote><p>TLB TLB  TLB TLB <strong><font color='orange'>TLB  TLB  TLB </font></strong> TLB  TLB</p><ol><li><p> CR3  CR3  TLB </p></li><li><p> <code>invlpg</code>  TLB <code>invlpg [m]</code> </p><blockquote><p></p></blockquote></li></ol><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong><font color='orange'></font></strong> <u></u></p><p><strong><font color='gree'></font></strong> </p><blockquote><p><a href="https://jyx-fyh.github.io/2022/11/26/%E7%89%B9%E6%9D%83%E7%BA%A7%E5%85%A8%E9%9D%A2%E5%89%96%E6%9E%90/"></a></p></blockquote><p><strong> 4GB </strong> <strong><font color='orange'> 1 GB 3 GB</font></strong>  3~4GB  3~4GB <a href="https://jyx-fyh.github.io/2022/11/13/%E5%BC%80%E5%90%AF%E5%88%86%E9%A1%B5-%E4%BB%A3%E7%A0%81%E8%AF%A6%E8%A7%A3/">-</a></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>-</title>
      <link href="/2022/11/02/%E8%BF%9B%E5%85%A5%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F-%E4%BB%A3%E7%A0%81%E8%AF%A6%E8%A7%A3/"/>
      <url>/2022/11/02/%E8%BF%9B%E5%85%A5%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F-%E4%BB%A3%E7%A0%81%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p><strong><font color='orange'>MBR --&gt; Loader --&gt; Kernel</font></strong><br> MBR  Loader  [-]  Loader <a href="https://jyx-fyh.github.io/2022/10/23/%E5%89%96%E6%9E%90%E9%87%8D%E5%AE%9A%E4%BD%8D%E2%80%94%E2%80%94%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD%E5%99%A8/">-</a> ()</p></blockquote><blockquote><p> <code>protected-mode</code> </p></blockquote><p><strong><mark class="hl-label blue"></mark> </strong><br> MBR  <a href="https://jyx-fyh.github.io/2022/10/23/%E5%89%96%E6%9E%90%E9%87%8D%E5%AE%9A%E4%BD%8D%E2%80%94%E2%80%94%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD%E5%99%A8/"></a>  MBR </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">%include &quot;loader.inc&quot;</span><br><span class="line"></span><br><span class="line">SECTION mbr align=16 vstart=0x7c00                                     </span><br><span class="line">;........................................</span><br></pre></td></tr></table></figure><p> <code>loader.inc</code> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">;loader.inc</span><br><span class="line">BASE_ADDR    equ 0x900 ;0xFFFF,</span><br><span class="line">START_SECTOR equ 2     ;2(lba)</span><br></pre></td></tr></table></figure><p> <code>boot.inc</code> <br><img src="/2022/img/IMG_0499(20221101-085023).PNG" alt=" &amp; "></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">;boot.inc ,,</span><br><span class="line">;</span><br><span class="line">DESC_G_4K         equ   1000_0000_0000_0000_0000_0000B</span><br><span class="line">DESC_DB_32        equ    100_0000_0000_0000_0000_0000B </span><br><span class="line">DESC_L            equ     00_0000_0000_0000_0000_0000B</span><br><span class="line">DESC_AVL          equ      0_0000_0000_0000_0000_0000B</span><br><span class="line">DESC_LIMIT_CODE2  equ        1111_0000_0000_0000_0000B</span><br><span class="line">DESC_LIMIT_DATA2  equ        DESC_LIMIT_CODE2</span><br><span class="line">DESC_LIMIT_VIDEO2 equ        0000_0000_0000_0000_0000B</span><br><span class="line">DESC_P            equ             1000_0000_0000_0000B</span><br><span class="line">DESC_DPL_0        equ              000_0000_0000_0000B</span><br><span class="line">DESC_DPL_1        equ              010_0000_0000_0000B</span><br><span class="line">DESC_DPL_2        equ              100_0000_0000_0000B</span><br><span class="line">DESC_DPL_3        equ              110_0000_0000_0000B</span><br><span class="line">DESC_S_SYS        equ                0_0000_0000_0000B</span><br><span class="line">DESC_S_DATA       equ                1_0000_0000_0000B</span><br><span class="line">DESC_TYPE_CODE    equ                  1000_0000_0000B;1000</span><br><span class="line">DESC_TYPE_DATA    equ                  0010_0000_0000B;0010</span><br><span class="line"></span><br><span class="line">;(loader.s)</span><br><span class="line">DESC_CODE_HIGH4   equ   (0x00&lt;&lt;24) + DESC_G_4K + DESC_DB_32 + DESC_L + DESC_AVL +\</span><br><span class="line">                        DESC_LIMIT_CODE2 + DESC_P + DESC_DPL_0 + DESC_S_DATA +\</span><br><span class="line">                        DESC_TYPE_CODE + 0X00</span><br><span class="line">DESC_DATA_HIGH4   equ   (0x00&lt;&lt;24) + DESC_G_4K + DESC_DB_32 + DESC_L + DESC_AVL +\</span><br><span class="line">                        DESC_LIMIT_DATA2 + DESC_P + DESC_DPL_0 + DESC_S_DATA +\</span><br><span class="line">                        DESC_TYPE_DATA + 0X00</span><br><span class="line">DESC_VIDEO_HIGH4  equ   (0x00&lt;&lt;24) + DESC_G_4K + DESC_DB_32 + DESC_L + DESC_AVL +\</span><br><span class="line">                        DESC_LIMIT_VIDEO2 + DESC_P + DESC_DPL_0 + DESC_S_DATA +\</span><br><span class="line">                        DESC_TYPE_DATA + 0X0b</span><br><span class="line">;=====================</span><br><span class="line">RPL0   equ   00B</span><br><span class="line">RPL1   equ   01B</span><br><span class="line">RPL2   equ   10B</span><br><span class="line">RPL3   equ   11B</span><br><span class="line">TI_GDT equ   000B</span><br><span class="line">TI_LDT equ   100B</span><br></pre></td></tr></table></figure><p></p><ul><li></li><li> 7, 8  DATA  CODE  4  1 DATA  CODE 161 G=1 4KB 4GB 21,24  <code>0x00&lt;&lt;24</code>  0x004 0 DATA  CODE 160 0<strong><font color='orange'> 0 4GB</font></strong> </li><li> 29  0x0b <code>0xb8000~0xbffff</code> <strong><font color='orange'></font></strong>  0xb8000 b  4  26  0x0b <code>0xbffff-0xb8000=0x7fff</code>  4KB <code>0x7fff4KB=7</code>  4  4  0 </li><li> 15,16 SYS DATA <u> SYS </u>// DATA </li><li> DATA <a href="https://jyx-fyh.github.io/2022/11/01/%E5%86%85%E5%AD%98%E8%AE%BF%E9%97%AE%E4%BF%9D%E6%8A%A4%E4%B8%8E%E5%82%A8%E5%AD%98%E5%99%A8%E4%BF%9D%E6%8A%A4/"></a> </li><li><code>_</code> </li></ul><p><strong><mark class="hl-label blue">loader.s</mark> </strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">;loader.s</span><br><span class="line">%include &quot;boot.inc&quot;</span><br><span class="line">%include &quot;loader.inc&quot;</span><br><span class="line"></span><br><span class="line">SECTION loader vstart=BASE_ADDR              ; </span><br><span class="line">    program_length  dd program_end           ;[0x00]    </span><br><span class="line">    ;</span><br><span class="line">    code_entry      dw start-BASE_ADDR       ;[0x04]</span><br><span class="line">                    dd section.loader.start  ;[0x06] </span><br><span class="line">    realloc_tbl_len dw 0                     ;0</span><br><span class="line">;=========================================================</span><br><span class="line">;GDT</span><br><span class="line">;0</span><br><span class="line">    GDT_BASE        dd    0x00000000</span><br><span class="line">                    dd    0x00000000</span><br><span class="line">;1CODE</span><br><span class="line">    DESC_CODE       dd    0x0000FFFF</span><br><span class="line">                    dd    DESC_CODE_HIGH4</span><br><span class="line">;2DATA   </span><br><span class="line">    DESC_DATA       dd    0x0000FFFF</span><br><span class="line">                    dd    DESC_DATA_HIGH4</span><br><span class="line">;3VIDEO</span><br><span class="line">    DESC_VIDEO      dd    0x80000007</span><br><span class="line">                    dd    DESC_VIDEO_HIGH4</span><br><span class="line">    </span><br><span class="line">    GDT_SIZE        equ   $ - GDT_BASE</span><br><span class="line">    GDT_LIMIT       equ   GDT_SIZE - 1    </span><br><span class="line">;GDT</span><br><span class="line">    gdt_ptr         dw    GDT_LIMIT    </span><br><span class="line">                    dd    GDT_BASE</span><br><span class="line"></span><br><span class="line">    SELECTOR_CODE   equ   ((DESC_CODE - GDT_BASE)/8)&lt;&lt;3 + TI_GDT + RPL0</span><br><span class="line">    SELECTOR_DATA   equ   ((DESC_DATA - GDT_BASE)/8)&lt;&lt;3 + TI_GDT + RPL0</span><br><span class="line">    SELECTOR_VIDEO  equ   ((DESC_VIDEO- GDT_BASE)/8)&lt;&lt;3 + TI_GDT + RPL0</span><br><span class="line">    </span><br><span class="line">    loader_msg      db    &#x27;r&#x27;,11000010b,&#x27;e&#x27;,11000010b,&#x27;a&#x27;,11000010b,&#x27;l&#x27;,11000010b,&#x27;-&#x27;,11000010b</span><br><span class="line">                    db    &#x27;m&#x27;,11000010b,&#x27;o&#x27;,11000010b,&#x27;d&#x27;,11000010b,&#x27;e&#x27;,11000010b</span><br><span class="line">;=======================================================</span><br><span class="line"></span><br><span class="line">start: ;          </span><br><span class="line">mov ax,0             ;loader,</span><br><span class="line">mov ds,ax            ;0</span><br><span class="line">mov es,ax</span><br><span class="line">mov ss,ax</span><br><span class="line">mov gs,ax</span><br><span class="line">mov fs,ax</span><br><span class="line">print:</span><br><span class="line">mov ax,0xb800        ;</span><br><span class="line">mov es,ax</span><br><span class="line">mov si,loader_msg    ;ds:si</span><br><span class="line">mov di,0             ;es:di</span><br><span class="line">mov cx,18            ;9,18</span><br><span class="line">cld</span><br><span class="line">rep movsb</span><br><span class="line">;========================================================</span><br><span class="line">;1.A20</span><br><span class="line">;2.GDT</span><br><span class="line">;3.PE=1</span><br><span class="line">prepare: </span><br><span class="line">;</span><br><span class="line">    cli</span><br><span class="line">;A20</span><br><span class="line">    in   al,0x92</span><br><span class="line">    or   al,0000_0010B</span><br><span class="line">    out  0x92,al</span><br><span class="line">;GDT</span><br><span class="line">    mov  ax,0</span><br><span class="line">    mov  ds,ax</span><br><span class="line">    lgdt [gdt_ptr]</span><br><span class="line">;CR001</span><br><span class="line">    mov  eax,cr0</span><br><span class="line">    or   eax,0x0000_0001</span><br><span class="line">    mov  cr0,eax</span><br><span class="line">;</span><br><span class="line">    jmp  dword SELECTOR_CODE:p_mode_start ;,CODE</span><br><span class="line">;======================================================</span><br><span class="line">[bits 32]</span><br><span class="line">p_mode_start:</span><br><span class="line">    mov ax,SELECTOR_DATA</span><br><span class="line">    mov ds,ax</span><br><span class="line">    mov es,ax</span><br><span class="line">    mov ss,ax</span><br><span class="line">    mov esp,BASE_ADDR       ;BASE_ADDR</span><br><span class="line">    mov ax,SELECTOR_VIDEO</span><br><span class="line">    mov gs,ax</span><br><span class="line"></span><br><span class="line">    mov byte [gs:160],&#x27;p&#x27;</span><br><span class="line">    mov byte [gs:161],11000010b</span><br><span class="line">    jmp $</span><br><span class="line">;========================================================</span><br><span class="line">program_end  equ  $-BASE_ADDR </span><br></pre></td></tr></table></figure><p></p><ul><li><p> loader  <code>vstart</code> <a href="https://jyx-fyh.github.io/2022/10/23/%E5%89%96%E6%9E%90%E9%87%8D%E5%AE%9A%E4%BD%8D%E2%80%94%E2%80%94%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD%E5%99%A8/"></a> loader  0 </p><ol><li><p> 75  0CODE0 <code>p_mode_start</code> <code>p_mode_start</code>  loader  <code>vstart</code>  0 <code>p_mode_start</code>  79  172  <code>p_mode_start</code>  140(0x8C)  <code>p_mode_start=0x8C</code>  loader  0x900   <code>0x8C</code>   <code>0x98C</code>  <code>vstart=BASE_ADDR</code>  <code>p_mode_start</code>  0x900 </p></li><li><p> 30  GDT_BASEGDT_BASE  32 <strong>CPU  <code>GDT_BASE</code>  GDT </strong> </p><blockquote><p>vstart  <a href="https://jyx-fyh.github.io/2022/10/23/%E5%89%96%E6%9E%90%E9%87%8D%E5%AE%9A%E4%BD%8D%E2%80%94%E2%80%94%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD%E5%99%A8/"></a> </p></blockquote></li></ol></li><li><p> loader <strong><font color='pink'> loader  vstart </font></strong> </p></li><li><p> 8  <code>start-BASE_ADDR</code>  MBR (71) <code>jmp far [0x04]</code>  <code>jmp 0x900: </code>  start </p></li><li><p> 29  GDT  LIMIT  SIZE-10</p></li><li><p> 23 <code>(DESC_CODE - GDT_BASE)/8</code> 8<code>&lt;&lt;3</code> <br><img src="/2022/img/3-1667637847644-1.png" style="zoom:50%;" /></p></li><li><p> 61 <strong><font color='orange'>BIOS </font></strong></p></li><li><p> 87  VIDEO </p></li><li><p> <code>program_end equ $-BASE_ADDR</code> </p></li></ul><p> 41~46  ds  ds <code>ds:loader_msg</code>  12  loader  0xFFFF  16  loader_msg  0xFFFF loader_msg loader  50 <code>mov si,loader_msg-BASE_ADDR </code> <br><br><img src="/2022/img/image-20221105222138942.png" alt="image-20221105222138942"></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/11/02/%E8%BF%9B%E5%85%A5%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%E4%B8%89%E9%83%A8%E6%9B%B2/"/>
      <url>/2022/11/02/%E8%BF%9B%E5%85%A5%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%E4%B8%89%E9%83%A8%E6%9B%B2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p><a href="https://jyx-fyh.github.io/2022/11/02/%E8%BF%9B%E5%85%A5%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F-%E4%BB%A3%E7%A0%81%E8%AF%A6%E8%A7%A3/">-</a><br>x86</p></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><ul><li> A20 </li><li> GDT</li><li> CR0  PE  1</li><li></li><li></li></ul><blockquote><p> CR0 </p></blockquote><h3 id="font-color-red--A20--font"><font color='red'> A20 </font></h3><p>8086/8088 CPU  20  1MB  1MB  0  1MB  80286 CPU 24  16MB  80286  8086  20 CPU  A20 (21)(A20Gate) 1MB 24 </p><p>32 CPU  A20Gate  1MB  4GB</p><p> A20Gate <strong><font color='orange'> 0x92  1 (0) 1 </font></strong> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">in  a1,0x92       #</span><br><span class="line">or  al,0000_0010B #11</span><br><span class="line">out 0x92,al       #</span><br></pre></td></tr></table></figure><h3 id="font-color-red-GDT-font"><font color='red'>GDT</font></h3><p><strong><font color='orange'> <code>lgdt</code> (load gdt) GDT  GDTR</font></strong> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lgdt  gdt_ptr</span><br></pre></td></tr></table></figure><p><code>gdt_ptr</code>  GDT <strong> 48  32  GDT  16 </strong> <strong><font color='orange'> GDT </font></strong>  1MB GDT  1MB  GDT </p><h3 id="font-color-red--PE--1-font"><font color='red'> PE  1</font></h3><p>CR0  PE ( 0 ) 32 <a href="https://jyx-fyh.github.io/2022/10/31/32%E4%BD%8D%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%E6%A6%82%E8%A7%88/">32</a>CR0 <br><img src="/2022/img/IMG_0516(20221102-163923).PNG" alt=""><br><br><img src="/2022/img/image-20221102164337278.png" alt=""></p><p> 1  A20Gate </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mov eax,cr0</span><br><span class="line">or  eax,1</span><br><span class="line">mov cr0,eax</span><br></pre></td></tr></table></figure><p>CPU </p><h3 id="font-color-red--font"><font color='red'></font></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cli</span><br></pre></td></tr></table></figure><p><a href="https://www.zhihu.com/question/532841878">cli)</a></p><blockquote><p> BIOS </p></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><p>CPU  16  32 <a href="https://jyx-fyh.github.io/2022/10/31/32%E4%BD%8D%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%E6%A6%82%E8%A7%88/">32</a><a href="https://jyx-fyh.github.io/2022/10/30/%E5%A4%84%E7%90%86%E5%99%A8%E5%BE%AE%E6%9E%B6%E6%9E%84/"></a> <strong><font color='orange'> jmp </font></strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jmp dword SELECTOR_CODE:p_mode_start</span><br></pre></td></tr></table></figure><p><a href="https://jyx-fyh.github.io/2022/11/02/%E8%BF%9B%E5%85%A5%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F-%E4%BB%A3%E7%A0%81%E8%AF%A6%E8%A7%A3/">-</a> </p><blockquote><p> PE  1  16  PE  1 CS  D  0 16 </p></blockquote>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/11/01/%E5%86%85%E5%AD%98%E8%AE%BF%E9%97%AE%E4%BF%9D%E6%8A%A4%E4%B8%8E%E5%82%A8%E5%AD%98%E5%99%A8%E4%BF%9D%E6%8A%A4/"/>
      <url>/2022/11/01/%E5%86%85%E5%AD%98%E8%AE%BF%E9%97%AE%E4%BF%9D%E6%8A%A4%E4%B8%8E%E5%82%A8%E5%AD%98%E5%99%A8%E4%BF%9D%E6%8A%A4/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="font-color-red--font"><font color='red'></font></h3><p>CPU <br><strong><font color='gree'><u></u></font></strong></p><ol><li><p><strong></strong>  GDT  <code>8+7 &lt;= </code>  13</p></li><li><p><strong> 0</strong> <a href="https://jyx-fyh.github.io/2022/10/31/%E5%85%A8%E5%B1%80%E6%8F%8F%E8%BF%B0%E7%AC%A6%E8%A1%A8%E6%A6%82%E8%BF%B0/"> &amp; </a>GDT  0  DS,ES,FS,GS  0 CS,SS </p><blockquote><p> 0 CPU </p></blockquote></li></ol><p><strong><font color='gree'><u></u></font></strong></p><ol><li><strong> S  TYPE </strong>  <code>0000</code> </li><li><strong></strong> <br><img src="/2022/img/image-20221101211058505.png" style="zoom:80%;" /><br><br>1 CS<br>2 SS<br>3 DS, GS, ES, FS<br><strong> ROM CS  DS,ES,FS,GS </strong> </li><li><strong> P </strong>  P=0 11</li></ol><h3 id="font-color-red--font"><font color='red'></font></h3><p>EIP CPU  EIP <code>0&lt;=(EIP+-1)&lt;=</code>  <strong><code>=(+1)-1</code></strong> </p><h3 id="font-color-red--font"><font color='red'></font></h3><p><code>0&lt;=(EA+-1)&lt;=</code> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mov [0x2000],edx</span><br></pre></td></tr></table></figure><p> EA=0x2000 </p><h3 id="font-color-red--font"><font color='red'></font></h3><p><code>(ESP-)&gt;=</code> </p><p><br><img src="/2022/img/6%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE.png" alt=""><br> ESP  <code>0x7c00</code>  <code>0x7A00</code>  1  (E1)  <code>0x7C00~0x7A00</code>  ESP  <code>0x7A00</code>  POP  <code>0x7C00</code>  <code>0x7C00</code> CPU <strong><font color='orange'></font></strong><br> <code>0x00007c00</code>  <code>0x000FFFFE</code>  4KB G 1)  ESP  0  <code>FFFFEFFF</code>  ESP  <code>FFFFFFFF</code> CPU </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0xFFFFEFFFF&lt;=(ESP-)&lt;=0xFFFFFFFF</span><br></pre></td></tr></table></figure><p><code>=+ESP</code>  <strong></strong> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x00007C00 + 0xFFFFF000 = 0X00006C00</span><br></pre></td></tr></table></figure><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x00007C00 + 0xFFFFFFFF = 0X00007BFF</span><br></pre></td></tr></table></figure><p> <code>0x00006C00 ~ 0x00007BFF</code>  512   666  <strong><font color='orange'> ESP </font></strong> </p><p><strong></strong>  <code>0x7c00</code>  <code>0x7BFC~0x7BFF</code>  <code>0x7C00</code>  <code>0x7C00</code> </p><p></p><h3 id="font-color-red--font"><font color='red'></font></h3><p> int3</p><blockquote><p></p></blockquote><blockquote><p>x86</p></blockquote>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GDT&amp;&amp;</title>
      <link href="/2022/10/31/%E5%85%A8%E5%B1%80%E6%8F%8F%E8%BF%B0%E7%AC%A6%E8%A1%A8%E6%A6%82%E8%BF%B0/"/>
      <url>/2022/10/31/%E5%85%A8%E5%B1%80%E6%8F%8F%E8%BF%B0%E7%AC%A6%E8%A1%A8%E6%A6%82%E8%BF%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>() [+]  IA-32 <strong></strong> <strong>CPU </strong> </p><h3 id="font-color-red--font"><font color='red'></font></h3><p> <strong></strong> </p><img src="/2022/img/IMG_0499(20221101-085023).PNG" style="zoom: 67%;" /><ul><li><p> 32  20  80286  16  CPU <strong>CPU </strong> <strong></strong> <a href="https://jyx-fyh.github.io/2022/11/01/%E5%86%85%E5%AD%98%E8%AE%BF%E9%97%AE%E4%BF%9D%E6%8A%A4%E4%B8%8E%E5%82%A8%E5%AD%98%E5%99%A8%E4%BF%9D%E6%8A%A4/"></a><strong> <code>(+1)*-1</code></strong> (10) 16 <br><img src="/2022/img/1%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE.png" alt="/, "></p></li><li><p><strong>G</strong> G=0  1  64KBG=1  4KB 4GB</p></li><li><p><strong>D/B</strong>  / D=0  16  SP  IPD=1  32  ESP  EIP 80286  16 16  1</p></li><li><p><strong>L</strong> 64  64  0 </p></li><li><p><strong>AVL</strong>  Intel </p></li><li><p><strong>P</strong>  P  0 P  P  1<strong></strong> P  CPU </p></li><li><p><strong>DPL</strong> Descriptor Privilege LevelCPU  4 0123<strong></strong>  DPL=2 DPL  012 </p></li><li><p><strong>S</strong> S=0 S=1 //<strong>S  TYPE </strong> </p></li><li><p><strong>TYPE</strong>  4 <br><strong> S=1 </strong>  4  X, C ,R ,A/ 4  X, E ,W ,A<br><img src="/2022/img/image-20221101105041738.png" alt="" style="zoom: 67%;" /></p><ul><li>X/</li><li>E<strong></strong> </li><li>W</li><li>C(Conforming)C=0 C=1 <a href="https://jyx-fyh.github.io/2022/11/26/%E7%89%B9%E6%9D%83%E7%BA%A7%E5%85%A8%E9%9D%A2%E5%89%96%E6%9E%90/"></a> </li><li>R R <strong> R=1 ROM </strong>  CPU CPU </li><li>A A  0 1<strong> A  1  CPU  0 ()</strong></li></ul><p><strong> S=0 </strong> <br><img src="/2022/img/IMG_0502(20221101-114007).PNG" style="zoom: 67%;" /></p></li></ul><p> 8 </p><h3 id="font-color-red--font"><font color='red'></font></h3><p>8086 CPU IP <u> 32  CPU </u> CS  <strong></strong>  CPU <strong><font color='orange'> 20  0</font></strong> <u></u><u></u> CPU <strong> 32  CPU </strong> </p><blockquote><p>12*</p></blockquote><p><strong> 32  CPU <u></u> CPU </strong> <br><img src="/2022/img/IMG_0506(20221101-172536).PNG" alt=""><br>80386 (G)(20)(32)</p><p><strong><font color='orange'>32  CPU </font></strong> 32  CPU  16  cpu </p><h3 id="font-color-red-GDT-font"><font color='red'>GDT</font></h3><p>Global Descriptor Table<strong>GDT</strong> <strong><font color='orange'></font></strong> <strong>GDT </strong>  GDTCPU  <strong>GDTR</strong>  48 <br><img src="/2022/img/2.png" alt=""  /><br> GDT  GDT  1 <strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>16</mn></msup><mo>=</mo><mn>64</mn><mi>K</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">2^{16}=64KB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">16</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">64</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>  8  GDT  8192 </strong> </p><p>GDT  GDT  1MB  GDT  1MB  GDT  GDTR </p><p><strong><font color='orange'> <code>lgdt</code> (load gdt) GDT  GDTR</font></strong> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lgdt  gdt_ptr</span><br></pre></td></tr></table></figure><p><code>gdt_ptr</code>  GDT <strong> 48  32  GDT  16 </strong> </p><p><strong><font color='orange'>GDT  0 </font></strong>  0 </p><h3 id="font-color-red--font"><font color='red'></font></h3><p> GDT  CPU <br><img src="/2022/img/3.png" style="zoom: 67%;" /></p><ul><li><p> 13 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>13</mn></msup><mo>=</mo><mn>8192</mn></mrow><annotation encoding="application/x-tex">2^{13}=8192</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">13</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">8192</span></span></span></span>  GDT <code>8+GDT</code>  GDT </p></li><li><p>TITable IndicatorTI=0  GDT TI=1  LDT  0 </p></li><li><p>RPLRequest Privilege Leve</p><blockquote><p>RPLRCLRDL </p></blockquote></li></ul><h3 id="font-color-red--font"><font color='red'></font></h3><p><br><img src="/2022/img/4.png" style="zoom:67%;" /></p><h3 id="font-color-red--G--D-B--font"><font color='red'> G  D/B </font></h3><p>D/B  0  16  64KB  20  1  1MB CPU D/B  0 20  16  4KB</p><blockquote><p>x86</p></blockquote>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>32</title>
      <link href="/2022/10/31/32%E4%BD%8D%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%E6%A6%82%E8%A7%88/"/>
      <url>/2022/10/31/32%E4%BD%8D%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%E6%A6%82%E8%A7%88/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="font-color-red--font"><font color='red'></font></h3><ul><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><h3 id="font-color-red--font"><font color='red'></font></h3><p>Intel 32  IA-32 8086  16  32 <strong>16  32 </strong> </p><p>80286 <strong>80286  24  16 MB</strong> <strong><font color='gree'> [+] <u> IA-32 </u></font></strong> <strong><font color='orange'></font></strong> <strong><font color='orange'></font></strong>  16  16 MB<strong>80286  64KB</strong>  80286 </p><blockquote><p> 16  CPU </p></blockquote><p>80386  32  4GB  4GB<strong> IA-32 80386  [+] </strong>  32 ()80386  32 <u></u> </p><p><strong><font color='orange'> 32  CPU  16  CPU 32  CPU </font></strong> 32  CPU  16  32  CPU 32  32 <u> 32 </u>32 CPU </p><blockquote><p> 8086  32  CPU  8086 </p></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><p>IA-32 <strong></strong>IA-32  <strong> 4KB </strong> Linear  Address</p><p><strong><font color='orange'></font></strong> <strong><font color='orange'>Linear  Address</font></strong> </p><p><strong><font color='orange'></font></strong> IA-32 <strong> 4GB </strong>  4GB </p><blockquote><p><strong><font color='gree'></font></strong> </p></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><ol><li>16  8  32 eaxebxecxedxespebpediesi 32 12<strong>32  16 </strong>  16  16 </li><li> FLAGS  16  32  EFLAGS 16  16 </li><li> 16  16 <strong>FSGS</strong> </li><li><strong> 64 </strong> 12 3 CPU CPU</li></ol><h3 id="font-color-red--font"><font color='red'></font></h3><p><br><img src="/2022/img/IMG_0496(20221031-144326).PNG" style="zoom: 50%;" /><br>32  CPU <br><img src="/2022/img/IMG_0497(20221031-144451).PNG" style="zoom:50%;" /></p><p>32  <strong></strong>  ESP  <strong></strong> <u> SP  32  ESP </u> </p><h3 id="font-color-red--font"><font color='red'></font></h3><p>IA-32 </p><table><thead><tr><th></th><th></th><th></th><th></th><th></th></tr></thead></table><p> 16 32  32  16 <strong></strong> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">8B 50 02</span><br></pre></td></tr></table></figure><p> 16 </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mov dx,[bx+si+0x02]</span><br></pre></td></tr></table></figure><p> 32 </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mov edx,[eax+0x02]</span><br></pre></td></tr></table></figure><p><strong><font color='orange'></font></strong> 32 CPU  32  <code>8B 50 02</code> CPU  16  32  bits </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#[]</span><br><span class="line">bits 16</span><br><span class="line">[bits 16]</span><br><span class="line">bits 32</span><br><span class="line">[bits 32]</span><br></pre></td></tr></table></figure><p><strong><font color='orange'> [bits 16]</font></strong>   A  B  <code>0x66</code>  16 <code>inc ax</code> <code>0x40</code>  <code>inc eax</code>  <code>66 40</code> <strong> <code>0x66</code> </strong> </p><p><strong><font color='orange'> <code>mov ,</code>  16  32 </font></strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[bits 16]</span><br><span class="line">mov ds,ax</span><br><span class="line">[bits 32]</span><br><span class="line">mov ds,ax</span><br></pre></td></tr></table></figure><p> <code>8E D8</code> </p><h3 id="font-color-red--font"><font color='red'></font></h3><ul><li><p> shlshr  cl  32 </p></li><li><p><code>mul bx</code>  ax  dx  ax  32 <u> eax </u><br><code>mul ebx</code>  eax  edx eax <br><code>div bx</code>  dx  ax  ax dx <u>32 </u><br><code>div ebx</code>  edx eax eax edx</p></li><li><p> push </p><ul><li><p><br> 16  2 32  4 <strong> 8 </strong> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#</span><br><span class="line">push byte  0x1  #sp-=2</span><br><span class="line">push word  0x1  #sp-=2</span><br><span class="line">push dword 0x1  #sp-=4</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#</span><br><span class="line">push byte  0x1  #esp-=4</span><br><span class="line">push word  0x1  #esp-=2</span><br><span class="line">push dword 0x1  #esp-=4</span><br></pre></td></tr></table></figure></li><li><p><br></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#</span><br><span class="line">push es #sp-=2</span><br><span class="line">#</span><br><span class="line">push es #sp-=4</span><br></pre></td></tr></table></figure></li><li><p></p><p> 16  2 32  4</p></li></ul></li></ul><p></p><blockquote><p>x86<a href="https://blog.csdn.net/Zheng__Huang/article/details/122494192"></a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/10/30/%E5%A4%84%E7%90%86%E5%99%A8%E5%BE%AE%E6%9E%B6%E6%9E%84/"/>
      <url>/2022/10/30/%E5%A4%84%E7%90%86%E5%99%A8%E5%BE%AE%E6%9E%B6%E6%9E%84/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="font-color-red--font"><font color='red'></font></h3><p>CPU  (pipeline) <strong></strong> <strong></strong> </p><p>123 <strong><font color='orange'></font></strong> <br><img src="/2022/img/IMG_0489(20221030-190533).PNG" style="zoom:67%;" /></p><p> 3 <strong><font color='orange'></font></strong>  CPU <br><img src="/2022/img/IMG_0490(20221030-191339).PNG" style="zoom:67%;" /></p><p> CPU  32  <strong><font color='orange'></font></strong> </p><blockquote><p></p></blockquote><p><strong>CPU <u></u></strong>  jmpjmp <strong><font color='orange'> CPU  jmp </font></strong> </p><blockquote><p><strong><font color='gree'></font></strong><br><strong><u></u></strong></p></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><p>if, switch<strong><font color='orange'></font></strong> 1996  Pentium Pro <code>for(int i=0;i&lt;10;i++)</code> i  10 9  10 <br><strong> BTB (Branch Target Buffer)</strong>  BTB  CPU  BTB  BTB</p><h3 id="font-color-red--font"><font color='red'></font></h3><p>out-of-order execution CPU <strong><font color='orange'></font></strong> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov ax,[10]</span><br><span class="line">mov bx,ax</span><br></pre></td></tr></table></figure><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mov ax,[10]</span><br><span class="line">mov dx,ax</span><br><span class="line">mov bx,cx</span><br></pre></td></tr></table></figure><p> 3  12  [10] () cx  bx </p><p><strong><font color='orange'></font></strong> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mov eax,[0x10]</span><br><span class="line">push eax</span><br><span class="line">call func</span><br></pre></td></tr></table></figure><p><code>push eax</code> 1<code>sub esp,4</code> 2<code>mov [esp],eax</code>  <code>sub esp,4</code>  <code>sub esp,4</code>  <code>call func</code>  esp  4 eax CPU  CPU </p><h3 id="font-color-red--font"><font color='red'></font></h3><p> CPU <strong></strong> (DRAM)CPU  CPU </p><blockquote><p> SRAM MB</p></blockquote><p> CPU (DRAM)(SRAM)<strong><font color='orange'></font></strong> () CPU <u></u> <u></u> <strong></strong> <u></u> </p><p></p><p><img src="/2022/img/20220709092100-1667177627583-3.png" alt=""></p><h3 id="font-color-red--font"><font color='red'></font></h3><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mov eax,[mem1]</span><br><span class="line">shl eax,3</span><br><span class="line">mov [mem2],eax</span><br><span class="line">mov eax,[mem3]</span><br><span class="line">add eax,2</span><br><span class="line">mov [mem4],eax</span><br></pre></td></tr></table></figure><p> eax CPU  eax</p><blockquote><p></p></blockquote><p> mov  eax  eax  <strong><u></u></strong> </p><p></p><blockquote><p>x86</p></blockquote>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/10/30/%E8%AF%BB%E5%86%99%E7%A1%AC%E7%9B%98/"/>
      <url>/2022/10/30/%E8%AF%BB%E5%86%99%E7%A1%AC%E7%9B%98/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="font-color-red--font"><font color='red'></font></h3><ul><li><strong></strong></li><li><strong></strong></li><li><strong></strong></li><li><strong></strong></li><li><strong></strong></li><li><strong></strong></li></ul><h4 id="font-color-gree--font"><font color='gree'></font></h4><p>/5 0  1  2  3 <br><img src="/2022/img/01.jpg" style="zoom:67%;" /></p><blockquote><ul><li></li><li> 0 <strong> 0 </strong> </li><li>0 0  0  1  446 Bytes 64  0x55  0xaa0 63  FDISK  FORMAT</li></ul></blockquote><h4 id="font-color-gree--font"><font color='gree'></font></h4><p><strong></strong> <u></u> 512 <strong> 512 </strong> <br><img src="/2022/img/03.jpg" alt=""></p><blockquote><p></p></blockquote><h4 id="font-color-gree--font"><font color='gree'></font></h4><p>0 <strong></strong>  <br><img src="/2022/img/SouthEast.jpeg" alt=""><br><strong></strong>  0  0  1  0  2  0  0  0  0  1  0  2 <a href="#%E7%A1%AC%E7%9B%98%E8%AF%BB%E5%8F%96%E5%93%8D%E5%BA%94%E6%97%B6%E9%97%B4"></a></p><h3 id="font-color-red--font"><font color='red'></font></h3><p>    ()    </p><blockquote><p></p></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><ol><li>I/O315ms10ms</li><li> 7200rpm 5400rpm</li><li></li></ol><blockquote><p></p></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong><mark class="hl-label blue">CHS</mark> </strong><br><strong>CHS</strong> (Cylinder/Head/Sector)   CHS  8bit  10bit  6bit  512 Byte CHS  <code>256 * 1024 * 63 * 512B = 8064 MB</code>8.4GB<strong><u>CHS  1 </u></strong> </p><p><strong><mark class="hl-label blue">LBA</mark> </strong><br>CHS  LBA  LBA LBA  CHS  C/H/S //<strong><u>LBA  0 </u></strong> </p><h3 id="font-color-red---font"><font color='red'>/</font></h3><p>/  Windows NTFS  Linux  Ext4 block2481632642n<br>12</p><h3 id="font-color-red-page-font"><font color='red'>page</font></h3><p></p><h3 id="font-color-red--page-font"><font color='red'>/page</font></h3><ol><li> </li><li>/ </li><li>page </li></ol><p> &lt;= / &lt;= page</p><h3 id="font-color-red--font"><font color='red'></font></h3><p> I/O ()</p><p><br><strong>I/Opage</strong> 4k<strong></strong> <br>4KB8125B8*125B=4KB</p><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong></strong> <br><img src="/2022/img/1373708-20181204140705426-1630212745.png"  /><br><strong>(SSD)</strong> </p><h3 id="font-color-red-Linux--font"><font color='red'>Linux </font></h3><ol><li><p><strong></strong>  Bochs  bximg bool  bochs </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bximage -q -hd=16 -func=create -sectsize=512 -imgmode=flat ./build/hd.img</span><br></pre></td></tr></table></figure><p><br><code>-q</code> <br><code>-hd</code> <code>-fd</code>  16 <br><code>-func=create</code> <br><code>-imgmode</code>  flatsparsegrowing <br><code>-secsize</code>  MB <br><code>./build/hd.img</code> <br><strong> bximage </strong></p></li><li><p><strong></strong>  LInux  dd </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=./app.bin of=./hd.img bs=512 seek=100 conv=notrunc</span><br></pre></td></tr></table></figure><p></p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>if=</td><td></td></tr><tr><td>of=</td><td></td></tr><tr><td>ibs=bytes</td><td>bytesbytes</td></tr><tr><td>obs=bytes</td><td>bytesbytes</td></tr><tr><td>bs=bytes</td><td>/bytes</td></tr><tr><td>cbs=bytes</td><td>bytes</td></tr><tr><td>skip=blocks</td><td>blocks</td></tr><tr><td>seek=blocks</td><td>()blocks</td></tr><tr><td>count=blocks</td><td>blocksibs</td></tr><tr><td>conv=&lt;&gt;</td><td> 11  notrunc </td></tr></tbody></table></li></ol><blockquote><p><a href="https://www.cnblogs.com/whl320124/articles/10063813.html"></a><a href="http://www.daileinote.com/computer/sys_about/01"></a> <a href="https://blog.csdn.net/xd_1437/article/details/103253632"></a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>bochs</title>
      <link href="/2022/10/27/bochs%E4%BD%BF%E7%94%A8/"/>
      <url>/2022/10/27/bochs%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="font-color-red-bochs-font"><font color='red'>bochs</font></h3><p>bochs  bochs  X86  bochs  VMwareVirtuaboxbochs  PC ()bochs PCbochs <strong> bochs </strong> </p><h3 id="font-color-red-bochs-font"><font color='red'>bochs</font></h3><blockquote><p> Ubuntu  Bochs  Windows  <a href="https://jyx-fyh.github.io/2022/10/23/%E5%89%96%E6%9E%90%E9%87%8D%E5%AE%9A%E4%BD%8D%E2%80%94%E2%80%94%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD%E5%99%A8/"></a> </p></blockquote><ol><li><p> <a href="https://sourceforge.net/projects/bochs/files/bochs/2.7/">bochs</a>  2.7 <code>bochs-2.7.tar.gz</code>  2.7  bochs </p></li><li><p> bochs-2.7 </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install libx11-dev libc6-dev build-essential xorg-dev libgtk2.0-dev libreadline-dev</span><br></pre></td></tr></table></figure></li><li><p></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./configure --with-x11 --with-x --enable-all-optimizations --enable-readline --enable-debugger-gui --enable-x86-debugger --enable-a20-pin --enable-fast-function-calls --enable-debugger</span><br></pre></td></tr></table></figure></li><li><p></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make -j4 &amp;&amp; sudo make install</span><br></pre></td></tr></table></figure><p> bochs </p></li><li><p>bochsrc <br> bochs  bochsrc</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># configuration file generated by Bochs</span></span><br><span class="line">plugin_ctrl: unmapped=<span class="literal">true</span>, biosdev=<span class="literal">true</span>, speaker=<span class="literal">true</span>, extfpuirq=<span class="literal">true</span>, parallel=<span class="literal">true</span>, serial=<span class="literal">true</span></span><br><span class="line">config_interface: textconfig</span><br><span class="line"></span><br><span class="line"><span class="comment"># display_library: x</span></span><br><span class="line"><span class="comment"># gdbstub: enabled=1, port=1234, text_base=0, data_base=0, bss_base=0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">magic_break: enabled=1 </span><br><span class="line"><span class="comment">#gui</span></span><br><span class="line">display_library: x, options=<span class="string">&quot;gui_debug&quot;</span></span><br><span class="line"></span><br><span class="line">memory: host=32, guest=32</span><br><span class="line">romimage: file=<span class="string">&quot;/usr/local/share/bochs/BIOS-bochs-latest&quot;</span>, address=0x00000000, options=none</span><br><span class="line">vgaromimage: file=<span class="string">&quot;/usr/local/share/bochs/VGABIOS-lgpl-latest&quot;</span></span><br><span class="line">boot: disk</span><br><span class="line">floppy_bootsig_check: disabled=0</span><br><span class="line"><span class="comment"># no floppya</span></span><br><span class="line">floppya: image=<span class="string">&quot;a.img&quot;</span>, status=inserted</span><br><span class="line"><span class="comment"># no floppyb</span></span><br><span class="line">ata0: enabled=<span class="literal">true</span>, ioaddr1=0x1f0, ioaddr2=0x3f0, irq=14</span><br><span class="line">ata0-master: <span class="built_in">type</span>=disk, path=<span class="string">&quot;./build/hd.img&quot;</span>, mode=flat</span><br><span class="line">ata0-slave: <span class="built_in">type</span>=none</span><br><span class="line">ata1: enabled=<span class="literal">true</span>, ioaddr1=0x170, ioaddr2=0x370, irq=15</span><br><span class="line">ata1-master: <span class="built_in">type</span>=none</span><br><span class="line">ata1-slave: <span class="built_in">type</span>=none</span><br><span class="line">ata2: enabled=<span class="literal">false</span></span><br><span class="line">ata3: enabled=<span class="literal">false</span></span><br><span class="line">optromimage1: file=none</span><br><span class="line">optromimage2: file=none</span><br><span class="line">optromimage3: file=none</span><br><span class="line">optromimage4: file=none</span><br><span class="line">optramimage1: file=none</span><br><span class="line">optramimage2: file=none</span><br><span class="line">optramimage3: file=none</span><br><span class="line">optramimage4: file=none</span><br><span class="line">pci: enabled=1, chipset=i440fx</span><br><span class="line">vga: extension=vbe, update_freq=5, realtime=1</span><br><span class="line">cpu: count=1, ips=4000000, model=bx_generic, reset_on_triple_fault=1, cpuid_limit_winnt=0, ignore_bad_msrs=1, mwait_is_nop=0</span><br><span class="line">cpuid: level=6, stepping=3, model=3, family=6, vendor_string=<span class="string">&quot;GenuineIntel&quot;</span>, brand_string=<span class="string">&quot;              Intel(R) Pentium(R) 4 CPU        &quot;</span></span><br><span class="line">cpuid: mmx=<span class="literal">true</span>, apic=xapic, simd=sse2, sse4a=<span class="literal">false</span>, misaligned_sse=<span class="literal">false</span>, sep=<span class="literal">true</span></span><br><span class="line">cpuid: movbe=<span class="literal">false</span>, adx=<span class="literal">false</span>, aes=<span class="literal">false</span>, sha=<span class="literal">false</span>, xsave=<span class="literal">false</span>, xsaveopt=<span class="literal">false</span>, smep=<span class="literal">false</span></span><br><span class="line">cpuid: smap=<span class="literal">false</span>, mwait=<span class="literal">true</span></span><br><span class="line">print_timestamps: enabled=0</span><br><span class="line"><span class="comment"># no gdb stub</span></span><br><span class="line">port_e9_hack: enabled=0</span><br><span class="line">private_colormap: enabled=0</span><br><span class="line">clock: <span class="built_in">sync</span>=none, time0=<span class="built_in">local</span>, rtc_sync=0</span><br><span class="line"><span class="comment"># no cmosimage</span></span><br><span class="line"><span class="built_in">log</span>: -</span><br><span class="line">logprefix: %t%e%d</span><br><span class="line">debug: action=ignore</span><br><span class="line">info: action=report</span><br><span class="line">error: action=report</span><br><span class="line">panic: action=ask</span><br><span class="line">keyboard: <span class="built_in">type</span>=mf, serial_delay=250, paste_delay=100000, user_shortcut=none</span><br><span class="line">mouse: <span class="built_in">type</span>=ps2, enabled=<span class="literal">false</span>, toggle=ctrl+mbutton</span><br><span class="line">speaker: enabled=<span class="literal">true</span>, mode=system</span><br><span class="line">parport1: enabled=<span class="literal">true</span>, file=none</span><br><span class="line">parport2: enabled=<span class="literal">false</span></span><br><span class="line">com1: enabled=<span class="literal">true</span>, mode=null</span><br><span class="line">com2: enabled=<span class="literal">false</span></span><br><span class="line">com3: enabled=<span class="literal">false</span></span><br><span class="line">com4: enabled=<span class="literal">false</span></span><br></pre></td></tr></table></figure></li><li><p> mbr <a href="https://jyx-fyh.github.io/2022/10/23/%E5%89%96%E6%9E%90%E9%87%8D%E5%AE%9A%E4%BD%8D%E2%80%94%E2%80%94%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD%E5%99%A8/"></a></p></li></ol>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>\extern c</title>
      <link href="/2022/10/27/%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E7%BA%A6%E5%AE%9A/"/>
      <url>/2022/10/27/%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E7%BA%A6%E5%AE%9A/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p><a href="https://jyx-fyh.github.io/2022/10/01/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/"></a> <br><a href="https://blog.csdn.net/doubleintfloat/article/details/78522881">0xcc</a> <a href="https://blog.csdn.net/sap_jack/article/details/1041220">C/C++</a></p></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><div class="mermaid-wrap"><pre class="mermaid-src" hidden>  graph LR --&gt;  --&gt;  --&gt;  --&gt;  --&gt;   </pre></div><blockquote><p><strong></strong></p></blockquote><p> VS </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> b = <span class="number">2</span>;</span><br><span class="line"><span class="type">int</span> c = add(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">00041DB0  push        ebp               ;</span><br><span class="line">00041DB1  mov         ebp,esp           ;ebp</span><br><span class="line">00041DB3  sub         esp,0E4h          ;0x0E4H</span><br><span class="line">00041DB9  push        ebx               ;6,7,8</span><br><span class="line">00041DBA  push        esi  </span><br><span class="line">00041DBB  push        edi  </span><br><span class="line">00041DBC  lea         edi,[ebp-24h]     ;ebp-24hedi</span><br><span class="line">00041DBF  mov         ecx,9             ;stos</span><br><span class="line">00041DC4  mov         eax,0CCCCCCCCh    ;0xCCCCCCCC</span><br><span class="line">00041DC9  rep stos    dword ptr es:[edi];</span><br><span class="line"></span><br><span class="line">;---------------------------------vs</span><br><span class="line">00041DCB  mov         ecx,offset _206B94B3_@c (01AB000h)  </span><br><span class="line">00041DD0  call        @__CheckForDebuggerJustMyCode@4 (041307h)  </span><br><span class="line">;--------------------------------------------------------------</span><br><span class="line">int a = 1;</span><br><span class="line">00041DD5  mov         dword ptr [a],1   ;avs,,a[ebp-8]</span><br><span class="line">int b = 2;</span><br><span class="line">00041DDC  mov         dword ptr [b],2   ;b[ebp-14h]</span><br><span class="line">int c = add(1, 2);</span><br><span class="line">00041DE3  push        2                 ;</span><br><span class="line">00041DE5  push        1  </span><br><span class="line">00041DE7  call        _add (04139Dh)    </span><br><span class="line">00041DEC  add         esp,8             ;</span><br><span class="line">00041DEF  mov         dword ptr [c],eax ;c,c[ebp-20h]</span><br><span class="line">return 0;</span><br><span class="line">00041DF2  xor         eax,eax           ;0</span><br><span class="line">&#125;</span><br><span class="line">000A17E4  pop         edi  </span><br><span class="line">000A17E5  pop         esi  </span><br><span class="line">000A17E6  pop         ebx  </span><br><span class="line">000A17E7  add         esp,0E4h  </span><br><span class="line">000A17ED  cmp         ebp,esp  </span><br><span class="line">000A17EF  call        __RTC_CheckEsp (0A1235h)  </span><br><span class="line">000A17F4  mov         esp,ebp  </span><br><span class="line">000A17F6  pop         ebp  </span><br><span class="line">000A17F7  ret  </span><br><span class="line">;=============================================================</span><br><span class="line">int add(int a, int b)                   ;</span><br><span class="line">&#123;</span><br><span class="line">00FB1750  push        ebp  </span><br><span class="line">00FB1751  mov         ebp,esp  </span><br><span class="line">00FB1753  sub         esp,0C0h  </span><br><span class="line">00FB1759  push        ebx  </span><br><span class="line">00FB175A  push        esi  </span><br><span class="line">00FB175B  push        edi  </span><br><span class="line">00FB175C  mov         edi,ebp  </span><br><span class="line">00FB175E  xor         ecx,ecx  </span><br><span class="line">00FB1760  mov         eax,0CCCCCCCCh  </span><br><span class="line">00FB1765  rep stos    dword ptr es:[edi]  </span><br><span class="line">00FB1767  mov         ecx,offset _206B94B3_@c (0FBC000h)  </span><br><span class="line">00FB176C  call        @__CheckForDebuggerJustMyCode@4 (0FB130Ch)  </span><br><span class="line">return a + b;</span><br><span class="line">00FB1771  mov         eax,dword ptr [a]  ;[ebp+8]</span><br><span class="line">00FB1774  add         eax,dword ptr [b]  ;[ebp+0Ch]</span><br><span class="line">&#125;</span><br><span class="line">00FB1777  pop         edi  </span><br><span class="line">00FB1778  pop         esi  </span><br><span class="line">00FB1779  pop         ebx  </span><br><span class="line">00FB177A  add         esp,0C0h  </span><br><span class="line">00FB1780  cmp         ebp,esp  </span><br><span class="line">00FB1782  call        __RTC_CheckEsp (0FB1235h)  ;(ebp==esp)</span><br><span class="line">00FB1787  mov         esp,ebp  </span><br><span class="line">00FB1789  pop         ebp  </span><br><span class="line">00FB178A  ret  </span><br></pre></td></tr></table></figure><p></p><ol><li><p> 0xe4  0x24 </p></li><li><p> 0xcc </p><blockquote><p>x868086 INT 3,0XCC-858993460CPUbreak<strong>INT 3</strong> <strong>debug  0xcc </strong> </p></blockquote></li><li><p> 9  lea  mov </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">lea   edi,[ebp-24h]</span><br><span class="line">;=================================</span><br><span class="line">sub   ebp,24h</span><br><span class="line">mov   edi,ebp</span><br></pre></td></tr></table></figure></li><li><p> 12 stos eax  edi  edi  4 rep  ecx </p></li><li><p> 59 <strong><font color='gree'>eax </font></strong> </p></li><li><p> 10  ecx push ecx  ABI <a href="https://jyx-fyh.github.io/2022/11/16/%E6%B5%85%E6%9E%90C%E5%92%8C%E6%B1%87%E7%BC%96%E6%B7%B7%E5%90%88%E7%BC%96%E7%A8%8B/">C</a></p></li><li><p> 26  push <strong></strong>  __cdecl </p></li><li><p> 19215657  <strong><font color='gree'> EBP </font></strong>    EBP  EBP  ESP  EBP </p></li><li><p><strong> 36  <code>__RTC_CheckEsp</code>  ESP=EBP</strong> </p></li></ol><p> ESP EBP<br><img src="/2022/img/-1667179108102-1.png" style="zoom:67%;" /><br>EBP ()</p><h3 id="font-color-red--font"><font color='red'></font></h3><p>C/C++ </p><table><thead><tr><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><td>__stdcall (pascal)</td><td>Windows API</td><td></td><td></td></tr><tr><td>__cdel</td><td>C/C++<br /></td><td></td><td></td></tr><tr><td>__fastcall</td><td>Linux </td><td>32 ECX  EDX <br />64<br /></td><td>Linux:<br />Windows:</td></tr><tr><td>__thiscall</td><td>C++ </td><td>this ECX <br />this</td><td><br /></td></tr></tbody></table><p><strong><mark class="hl-label blue">C</mark> </strong></p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>cdecl</td><td>+  max()  <code>_max</code></td></tr><tr><td>stdcall</td><td>++@+  int max(int m, int n)  <code>_max@8</code></td></tr><tr><td>fastcall</td><td>@++@+ int add(int c,int b,int c)  <code>@add@12</code></td></tr></tbody></table><p><strong><mark class="hl-label blue">C++</mark> </strong><br>C++<strong><font color='gree'> Visual C++ </font></strong> _cdecl_fastcall_stdcall?_stdcall <code>@@YG</code>_cdecl <code>@@YA</code> _fastcall <code>@@YI</code>  <code>@Z</code> Z</p><table><thead><tr><th>X</th><th>D</th><th>E</th><th>F</th><th>H</th><th>I</th><th>J</th><th>K</th><th>M</th><th>N</th><th>_N</th><th>U</th></tr></thead><tbody><tr><td>void</td><td>char</td><td>unsigned char</td><td>short</td><td>int</td><td>unsigned int</td><td>long</td><td>unsigned long</td><td>float</td><td>double</td><td>bool</td><td>struct</td></tr></tbody></table><p><strong></strong> </p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><strong>int __cdecl add(int a, int b)</strong></td><td><strong>?add@@YGHHH@Z</strong></td></tr><tr><td><strong>int __fastcall sub(int a, int b)</strong></td><td><strong>?sub@@YIHHH@Z</strong></td></tr><tr><td><strong>int __stdcall mul(int a, int b)</strong></td><td><strong>?mul@@YAHHH@Z</strong></td></tr></tbody></table><p><strong><code>HHH</code></strong>  1  H  int 23  H  int</p><p><strong> PA  PB  const </strong> 00</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><em><em>int __cdecl add(int</em> a, int</em> b)**</td><td><strong>?sub@@YIHPBH0@Z</strong></td></tr><tr><td><em><em>int __fastcall sub(const int</em> a,const int</em> b)**</td><td><strong>?add@@YAHPAH0@Z</strong></td></tr></tbody></table><p><strong>U@@</strong> 00</p><table><thead><tr><th></th><th><strong></strong></th></tr></thead><tbody><tr><td><strong>int __cdecl add(stu a, stu b)</strong></td><td><strong>?add@@YAHUstu@@0@Z</strong></td></tr></tbody></table><p><strong><mark class="hl-label blue">C++</mark> </strong><br>@public <code>@@QAE</code> protected <code>@@IAE</code> private <code>@@AAE</code> const  <code>@@QBE</code> <code>@@IBE</code>  <code>@@ABE</code>  <code>AAH</code>  const  <code>ABH</code> </p><blockquote><p> Visual C++ gcc </p></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><p>()() __cdecl  __stdcall</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __stdcall <span class="title function_">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="number">00611750</span>  push        ebp  </span><br><span class="line"><span class="number">00611751</span>  mov         ebp,esp  </span><br><span class="line"><span class="number">00611753</span>  sub         esp,<span class="number">0</span>C0h  </span><br><span class="line"><span class="number">00611759</span>  push        ebx  </span><br><span class="line"><span class="number">0061175</span>A  push        esi  </span><br><span class="line"><span class="number">0061175B</span>  push        edi  </span><br><span class="line"><span class="number">0061175</span>C  mov         edi,ebp  </span><br><span class="line"><span class="number">0061175</span>E  xor         ecx,ecx  </span><br><span class="line"><span class="number">00611760</span>  mov         eax,<span class="number">0</span>CCCCCCCCh  </span><br><span class="line"><span class="number">00611765</span>  rep stos    dword ptr es:[edi]  </span><br><span class="line"><span class="number">00611767</span>  mov         ecx,offset _206B94B3_@c (<span class="number">061</span>C000h)  </span><br><span class="line"><span class="number">0061176</span>C  call        @__CheckForDebuggerJustMyCode@<span class="number">4</span> (<span class="number">061130</span>Ch)  </span><br><span class="line"><span class="keyword">return</span> a + b;</span><br><span class="line"><span class="number">00611771</span>  mov         eax,dword ptr [a]  </span><br><span class="line"><span class="number">00611774</span>  add         eax,dword ptr [b]  </span><br><span class="line">&#125;</span><br><span class="line"><span class="number">00611777</span>  pop         edi  </span><br><span class="line"><span class="number">00611778</span>  pop         esi  </span><br><span class="line"><span class="number">00611779</span>  pop         ebx  </span><br><span class="line"><span class="number">0061177</span>A  add         esp,<span class="number">0</span>C0h  </span><br><span class="line"><span class="number">00611780</span>  cmp         ebp,esp  </span><br><span class="line"><span class="number">00611782</span>  call        __RTC_CheckEsp (<span class="number">0611235</span>h)  </span><br><span class="line"><span class="number">00611787</span>  mov         esp,ebp  </span><br><span class="line"><span class="number">00611789</span>  pop         ebp  </span><br><span class="line"><span class="number">0061178</span>A  ret         <span class="number">8</span>  </span><br><span class="line"><span class="comment">//===========================================</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="number">006117</span>A0  push        ebp  </span><br><span class="line"><span class="number">006117</span>A1  mov         ebp,esp  </span><br><span class="line"><span class="number">006117</span>A3  sub         esp,<span class="number">0E4</span>h  </span><br><span class="line"><span class="number">006117</span>A9  push        ebx  </span><br><span class="line"><span class="number">006117</span>AA  push        esi  </span><br><span class="line"><span class="number">006117</span>AB  push        edi  </span><br><span class="line"><span class="number">006117</span>AC  lea         edi,[ebp<span class="number">-24</span>h]  </span><br><span class="line"><span class="number">006117</span>AF  mov         ecx,<span class="number">9</span>  </span><br><span class="line"><span class="number">006117B</span>4  mov         eax,<span class="number">0</span>CCCCCCCCh  </span><br><span class="line"><span class="number">006117B</span>9  rep stos    dword ptr es:[edi]  </span><br><span class="line"><span class="number">006117B</span>B  mov         ecx,offset _206B94B3_@c (<span class="number">061</span>C000h)  </span><br><span class="line"><span class="number">006117</span>C0  call        @__CheckForDebuggerJustMyCode@<span class="number">4</span> (<span class="number">061130</span>Ch)  </span><br><span class="line"><span class="type">int</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="number">006117</span>C5  mov         dword ptr [a],<span class="number">1</span>  </span><br><span class="line"><span class="type">int</span> b = <span class="number">2</span>;</span><br><span class="line"><span class="number">006117</span>CC  mov         dword ptr [b],<span class="number">2</span>  </span><br><span class="line"><span class="type">int</span> c = add(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line"><span class="number">006117</span>D3  push        <span class="number">2</span>  </span><br><span class="line"><span class="number">006117</span>D5  push        <span class="number">1</span>  </span><br><span class="line"><span class="number">006117</span>D7  call        _add@<span class="number">8</span> (<span class="number">0611104</span>h)  </span><br><span class="line"><span class="number">006117</span>DC  mov         dword ptr [c],eax  </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="number">006117</span>DF  xor         eax,eax  </span><br><span class="line">&#125;</span><br><span class="line"><span class="number">006117E1</span>  pop         edi  </span><br><span class="line"><span class="number">006117E2</span>  pop         esi  </span><br><span class="line"><span class="number">006117E3</span>  pop         ebx  </span><br><span class="line"><span class="number">006117E4</span>  add         esp,<span class="number">0E4</span>h  </span><br><span class="line"><span class="number">006117</span>EA  cmp         ebp,esp  </span><br><span class="line"><span class="number">006117</span>EC  call        __RTC_CheckEsp (<span class="number">0611235</span>h)  </span><br><span class="line"><span class="number">006117F</span>1  mov         esp,ebp  </span><br><span class="line"><span class="number">006117F</span>3  pop         ebp  </span><br><span class="line"><span class="number">006117F</span>4  ret  </span><br></pre></td></tr></table></figure><p> 27 <code>ret 8</code>  <code>ret</code>  ret </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pop  eip </span><br><span class="line">pop  cs</span><br><span class="line">add  esp,8</span><br></pre></td></tr></table></figure><p> <code>add esp,8</code> </p><h3 id="font-color-red-extern-c-font"><font color='red'>extern c</font></h3><p> C/C++ LNK 2001 C  C++  C++ C++Calling ConventionDecorated Name C++  <code>extern &quot;c&quot;</code> </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//func.h</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> cplusplus</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> extern <span class="string">&quot;c&quot;</span>&#123;</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">function</span><span class="params">(<span class="type">int</span>, <span class="type">int</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> cplusplus</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><p> C++  <code>func.h</code>  function()  C  func.lib  <code>extern &quot;c&quot;</code>  <code>extern &quot;c&quot;</code>  C++  function  <code>?function@@YIHHH@Z</code>  func.lib  C  function  <code>_function@8</code>  C++  func.lib  <code>?function@@YIHHH@Z</code>  <code>_function@8</code> </p>]]></content>
      
      
      <categories>
          
          <category> C </category>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>/vstart</title>
      <link href="/2022/10/23/%E5%89%96%E6%9E%90%E9%87%8D%E5%AE%9A%E4%BD%8D%E2%80%94%E2%80%94%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD%E5%99%A8/"/>
      <url>/2022/10/23/%E5%89%96%E6%9E%90%E9%87%8D%E5%AE%9A%E4%BD%8D%E2%80%94%E2%80%94%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p> <a href="https://jyx_aha.gitee.io/hexo/2022/10/01/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/"></a> <br>x86<br><br>x86<a href="https://blog.csdn.net/m0_37570820/article/details/79403382"></a></p></blockquote><p> nasm masm nasm  .bin .bin  CPU  elf  pe  <strong></strong>  masm nasm </p><h3 id="font-color-red-vstart--section-xxx-start--font"><font color='red'>vstart  section.xxx.start </font></h3><p><strong><mark class="hl-label blue"></mark> </strong><br> nasm </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#</span><br><span class="line">section code1 align=16</span><br><span class="line">mov ax,bx</span><br><span class="line">section code2 align=16</span><br><span class="line">mov bx,ax</span><br><span class="line">section data align=16</span><br><span class="line">db &#x27;hello&#x27;</span><br></pre></td></tr></table></figure><p> <code>align=16</code>  section  16 <br><img src="/2022/img/image-20221031090603921.png" alt=""></p><p> <code>code1</code>  <code>code2</code> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">section code2 align=16</span><br><span class="line">mov bx,ax</span><br><span class="line">section code1 align=16</span><br><span class="line">mov ax,bx</span><br><span class="line">section data align=16</span><br><span class="line">db &#x27;hello&#x27;</span><br></pre></td></tr></table></figure><p><br><img src="/2022/img/image-20221031090709540.png" alt=""><br> <strong><font color='orange'>.asm  .bin .bin  .asm </font></strong> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">section code1 align=16</span><br><span class="line">mov ax,s</span><br><span class="line">section data align=16</span><br><span class="line">s:db &#x27;hello&#x27;</span><br></pre></td></tr></table></figure><p><br><img src="/2022/img/image-20221031090803933.png" alt=""></p><p> <code>B8 10</code>  S  <code>0x10</code>  <strong><font color='orange'> .bin  .asm </font></strong> </p><p><strong><mark class="hl-label blue">vstart</mark> </strong><br></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">section code1 align=16</span><br><span class="line">mov ax,s</span><br><span class="line">section data align=16 vstart=0</span><br><span class="line">s:db &#x27;hello&#x27;</span><br></pre></td></tr></table></figure><p><br><img src="/2022/img/image-20221031090858316.png" alt=""><br><code>B8 10</code>  <code>B8 00</code> <code>vstart</code>  S  S  S  data  <strong><font color='red'><code>vstart</code> (.asm)</font></strong></p><p> vstart  vstart  <strong></strong> vstart  <strong></strong> xxx <strong><font color='orange'> vstart </font></strong> BIOS() MBR  <code>0000:7c00</code>  MBR  <code>vstart=7c00</code> <u> 1100:7c00</u> <strong> <code>vstart=0</code> () 16 </strong>  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">section code align=16 vstart=8</span><br><span class="line">s:</span><br><span class="line">push cs</span><br><span class="line">push s</span><br><span class="line">mov bp,sp</span><br><span class="line">jmp dword [bp]  ;ret</span><br></pre></td></tr></table></figure><p><code>0E 68 08 00 89 E5 66 FF 66 00</code>  <code>10000</code> <br><img src="/2022/img/image-20221025162254596-1667178594381-1.png" alt=""></p><p> <code>vstart=8</code>  S  8 6  jmp  <code>1000:8</code>  jmp  <code>1000:0</code> </p><blockquote><p><code>vstart=xxx</code>  <code>org xxx</code> </p></blockquote><p><strong><mark class="hl-label blue">section.xxx.start</mark> </strong><br><code>section.xxx.start</code> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">section data align=16 vstart=0</span><br><span class="line">msgdb&#x27;hello world&#x27;</span><br><span class="line">section code align=16 vstart=0</span><br><span class="line">mov ax,section.code.start</span><br></pre></td></tr></table></figure><p><img src="/2022/img/image-20221031091035242.png" alt=""><br><code>section.code.start=0x10</code>  code </p><h3 id="font-color-red--font"><font color='red'></font></h3><p></p><ol><li>1</li><li>2</li><li>3</li></ol><p> <strong></strong> </p><ol><li><strong></strong> </li><li><strong></strong>  <code>section.xxx.start</code> </li><li><strong></strong> </li></ol><h3 id="font-color-red--font"><font color='red'></font></h3><p> MBR  OBR</p><blockquote><p>MBR  OBR  BIOS  MBR MBR  OBR</p></blockquote><p><strong><mark class="hl-label blue">1.</mark> </strong><br>1(<code>START_SECTOR</code>)2(<code>BASE_ADDR</code>)</p><p></p><p><strong><mark class="hl-label blue">2.</mark> </strong><br> code_A  code_B  code_A  data_C </p><p><strong><mark class="hl-label blue">3.</mark> </strong></p><p> <code>section.xxx.start</code>  <code>BASE_ADDR</code> </p><p><strong><mark class="hl-label blue">4.</mark> </strong><br></p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line">;=================================================================</span><br><span class="line"> ;===============================================================================</span><br><span class="line">SECTION header vstart=0                     ; </span><br><span class="line">    program_length  dd program_end          ;[0x00]</span><br><span class="line">    </span><br><span class="line">    ;</span><br><span class="line">    code_entry      dw start                ;[0x04]</span><br><span class="line">                    dd section.code_1.start ;[0x06] </span><br><span class="line">    </span><br><span class="line">    realloc_tbl_len dw (header_end-code_1_segment)/4</span><br><span class="line">                                            ;[0x0a]</span><br><span class="line">    </span><br><span class="line">    ;           </span><br><span class="line">    code_1_segment  dd section.code_1.start ;[0x0c]</span><br><span class="line">    code_2_segment  dd section.code_2.start ;[0x10]</span><br><span class="line">    data_1_segment  dd section.data_1.start ;[0x14]</span><br><span class="line">    data_2_segment  dd section.data_2.start ;[0x18]</span><br><span class="line">    stack_segment   dd section.stack.start  ;[0x1c]</span><br><span class="line">    header_end:                </span><br><span class="line"> ;===============================================================================</span><br><span class="line"> ;code1hello</span><br><span class="line">SECTION code_1 align=16 vstart=0</span><br><span class="line">printh:           ;hello    </span><br><span class="line">push es</span><br><span class="line"></span><br><span class="line">mov ax,0xb800 ;</span><br><span class="line">mov es,ax</span><br><span class="line">mov si,0</span><br><span class="line">mov di,0</span><br><span class="line">mov cx,10</span><br><span class="line">cld</span><br><span class="line">rep movsb</span><br><span class="line"></span><br><span class="line">pop es</span><br><span class="line"></span><br><span class="line">ret</span><br><span class="line">start: ;</span><br><span class="line">mov ax,ds</span><br><span class="line">mov es,ax                  ;esheader,ds</span><br><span class="line">mov ax,es:[stack_segment]  ;</span><br><span class="line">mov ss,ax                    </span><br><span class="line">mov sp,stack_end   </span><br><span class="line"></span><br><span class="line">mov ax,es:[data_1_segment] ;</span><br><span class="line">mov ds,ax</span><br><span class="line"></span><br><span class="line">;</span><br><span class="line">mov ax,0x600  </span><br><span class="line">mov bx,0x700  </span><br><span class="line">mov cx,0  </span><br><span class="line">mov dx,0x184f    </span><br><span class="line">int 0x10  </span><br><span class="line">call printh    ;hello</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">push word es:[code_2_segment] ;worddword</span><br><span class="line">push printw   </span><br><span class="line">retf                     ;code_2</span><br><span class="line"></span><br><span class="line">stop:</span><br><span class="line">jmp $          ;</span><br><span class="line"></span><br><span class="line">;===============================================================================</span><br><span class="line"> ;code2&#x27;world&#x27;</span><br><span class="line">SECTION code_2 align=16 vstart=0</span><br><span class="line">printw:</span><br><span class="line"></span><br><span class="line">mov ax,es:[data_2_segment]</span><br><span class="line">mov ds,ax </span><br><span class="line">mov ax,0xb800</span><br><span class="line">mov es,ax</span><br><span class="line">mov si,0</span><br><span class="line">mov di,80;world</span><br><span class="line">mov cx,10</span><br><span class="line">cld</span><br><span class="line">rep movsb</span><br><span class="line"></span><br><span class="line">push word es:[code_1_segment]</span><br><span class="line">push stop</span><br><span class="line">retf           ;code_1</span><br><span class="line"></span><br><span class="line"> ;===============================================================================</span><br><span class="line">SECTION data_1 align=16 vstart=0 </span><br><span class="line">db &#x27;h&#x27;,00000111B</span><br><span class="line">db &#x27;e&#x27;,00000111B</span><br><span class="line">db &#x27;l&#x27;,00000111B</span><br><span class="line">db &#x27;l&#x27;,00000111B</span><br><span class="line">db &#x27;o&#x27;,00000111B</span><br><span class="line"> ;===============================================================================</span><br><span class="line">SECTION data_2 align=16 vstart=0 </span><br><span class="line">db &#x27;w&#x27;,11000010B</span><br><span class="line">db &#x27;o&#x27;,11000010B</span><br><span class="line">db &#x27;r&#x27;,11000010B</span><br><span class="line">db &#x27;l&#x27;,11000010B</span><br><span class="line">db &#x27;d&#x27;,11000010B</span><br><span class="line"> ;===============================================================================</span><br><span class="line">SECTION stack align=16 vstart=0</span><br><span class="line">times 256 db 0</span><br><span class="line">stack_end:</span><br><span class="line"> ;===============================================================================</span><br><span class="line">SECTION trail align=16 </span><br><span class="line">program_end:</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line">         BASE_ADDR     equ 0x10000       ;BASE_ADDR</span><br><span class="line">         START_SECTOR  equ 100           ;BASE_ADDR0</span><br><span class="line">                                         ;</span><br><span class="line">                                         ;                                    </span><br><span class="line">SECTION mbr align=16 vstart=0x7c00                                     </span><br><span class="line">         ; </span><br><span class="line">         mov ax,0      </span><br><span class="line">         mov ss,ax</span><br><span class="line">         mov sp,ax</span><br><span class="line">         </span><br><span class="line">         mov eax,BASE_ADDR               ;eax40</span><br><span class="line">         mov cl ,4                       ;cl</span><br><span class="line">         shr eax,cl                      </span><br><span class="line">         mov ds,ax                       ;DSES</span><br><span class="line">         mov es,ax                        </span><br><span class="line">    </span><br><span class="line">         ; </span><br><span class="line">         xor di,di</span><br><span class="line">         mov si,START_SECTOR             ; </span><br><span class="line">         xor bx,bx                       ;DS:0x0000 </span><br><span class="line">         call read_hard_disk_0</span><br><span class="line">      </span><br><span class="line">         ;</span><br><span class="line">         mov dx,[2]                      ;dxds </span><br><span class="line">         mov ax,[0]</span><br><span class="line">         mov bx,512                      ;512</span><br><span class="line">         div bx</span><br><span class="line">         cmp dx,0</span><br><span class="line">         jnz @1                          ;1 </span><br><span class="line">         dec ax                          ;1 </span><br><span class="line">   @1:</span><br><span class="line">         cmp ax,0                        ;512 </span><br><span class="line">         jz direct</span><br><span class="line">         </span><br><span class="line">         ;</span><br><span class="line">         push ds                         ;DS </span><br><span class="line"></span><br><span class="line">         mov cx,ax                       ;</span><br><span class="line">   @2:</span><br><span class="line">         mov ax,ds</span><br><span class="line">         add ax,0x20                     ;512</span><br><span class="line">         mov ds,ax  </span><br><span class="line">                              </span><br><span class="line">         xor bx,bx                       ;0x0000 </span><br><span class="line">         inc si                          ; </span><br><span class="line">         call read_hard_disk_0</span><br><span class="line">         loop @2                         ; </span><br><span class="line"></span><br><span class="line">         pop ds                          ; </span><br><span class="line">      </span><br><span class="line">         ; </span><br><span class="line">   direct:</span><br><span class="line">         mov eax,[0x06]</span><br><span class="line">         call calc_segment_base</span><br><span class="line">         mov [0x06],ax                   ; </span><br><span class="line">      </span><br><span class="line">         ;</span><br><span class="line">         mov cx,[0x0a]                   ;</span><br><span class="line">     cmp cx,0</span><br><span class="line">     jz  jmpToLoader                 ;0</span><br><span class="line">         mov bx,0x0c                     ;</span><br><span class="line">          </span><br><span class="line"> realloc:</span><br><span class="line">         mov eax,[bx]</span><br><span class="line">         call calc_segment_base</span><br><span class="line">         mov [bx],ax                     ;</span><br><span class="line">         add bx,4                        ;4 </span><br><span class="line">         loop realloc </span><br><span class="line"></span><br><span class="line"> jmpToLoader:     </span><br><span class="line">         jmp far [0x04]                  ;  </span><br><span class="line"> </span><br><span class="line">;-------------------------------------------------------------------------------</span><br><span class="line">read_hard_disk_0:                        ;</span><br><span class="line">                                         ;DI:SI=</span><br><span class="line">                                         ;      DS:BX=</span><br><span class="line">         push ax</span><br><span class="line">         push bx</span><br><span class="line">         push cx</span><br><span class="line">         push dx</span><br><span class="line">      </span><br><span class="line">         mov dx,0x1f2</span><br><span class="line">         mov al,1</span><br><span class="line">         out dx,al                       ;</span><br><span class="line"></span><br><span class="line">         inc dx                          ;0x1f3</span><br><span class="line">         mov ax,si</span><br><span class="line">         out dx,al                       ;LBA7~0</span><br><span class="line"></span><br><span class="line">         inc dx                          ;0x1f4</span><br><span class="line">         mov al,ah</span><br><span class="line">         out dx,al                       ;LBA15~8</span><br><span class="line"></span><br><span class="line">         inc dx                          ;0x1f5</span><br><span class="line">         mov ax,di</span><br><span class="line">         out dx,al                       ;LBA23~16</span><br><span class="line"></span><br><span class="line">         inc dx                          ;0x1f6</span><br><span class="line">         mov al,0xe0                     ;LBA28</span><br><span class="line">         or al,ah                        ;LBA27~24</span><br><span class="line">         out dx,al</span><br><span class="line"></span><br><span class="line">         inc dx                          ;0x1f7</span><br><span class="line">         mov al,0x20                     ;</span><br><span class="line">         out dx,al</span><br><span class="line"></span><br><span class="line">  .waits:</span><br><span class="line">         in al,dx</span><br><span class="line">         and al,0x88</span><br><span class="line">         cmp al,0x08</span><br><span class="line">         jnz .waits                      ; </span><br><span class="line"></span><br><span class="line">         mov cx,256                      ;</span><br><span class="line">         mov dx,0x1f0</span><br><span class="line">  .readw:</span><br><span class="line">         in ax,dx</span><br><span class="line">         mov [bx],ax</span><br><span class="line">         add bx,2</span><br><span class="line">         loop .readw</span><br><span class="line"></span><br><span class="line">         pop dx</span><br><span class="line">         pop cx</span><br><span class="line">         pop bx</span><br><span class="line">         pop ax</span><br><span class="line"></span><br><span class="line">         ret</span><br><span class="line">;-------------------------------------------------------------------------------</span><br><span class="line">calc_segment_base:                       ;16</span><br><span class="line">                                         ;eax20,40</span><br><span class="line">                                         ;AX=16 </span><br><span class="line">         add eax,BASE_ADDR</span><br><span class="line">     mov cl,4</span><br><span class="line">     shr eax,cl</span><br><span class="line">         ret</span><br><span class="line">;-------------------------------------------------------------------------------         </span><br><span class="line"> times 510-($-$$) db 0</span><br><span class="line"> db 0x55,0xaa</span><br></pre></td></tr></table></figure><p><strong><mark class="hl-label blue"></mark> </strong></p><blockquote><p> notepad++ .asm</p></blockquote><ul><li> section</li><li> 4  <code>program_end</code>  102  <code>vstart=0</code> </li><li> 39  ds  ds <strong></strong>  es  ds  data ( 45 )</li><li>58  code_2  retf  code_2 call  jmp  retf </li><li><strong><font color='gree'> <code>vstart=0</code> </font></strong></li><li><strong><font color='gree'> dd <code>section.xxx.start</code>  xxx  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>16</mn></msup><mo>=</mo><mn>64</mn><mi>K</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">2^{16}=64KB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">16</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">64</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>  4 32 <code>section.xxx.start</code>  4  0 <code>align=16</code>  16  0</font></strong></li></ul><p></p><p><strong><mark class="hl-label blue"></mark> </strong></p><ul><li>mbr  <code>vstart=0x7c00</code>  BIOS(MBR)  0x7c00 (0000:7c00)</li><li> 23  C  <code>equ</code>  <code>boot.inc</code> <code>%include 'boot.inc'</code>  linux </li><li> 24  520  512 1  8</li><li> 34  0x20 512  512  64KB 64KB</li><li> 11  32  <a href="https://jyx-fyh.github.io/2022/10/31/32%E4%BD%8D%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%E6%A6%82%E8%A7%88/"></a></li><li> 12  cl  <code>shr eax,4</code> </li></ul><p>x86137 131 </p><h3 id="font-color-red--font"><font color='red'></font></h3><blockquote><p> windows <a href="https://pan.baidu.com/s/1ycMfrsJCeKlMTki0yAagnA?pwd=gzwb"></a>gzwb</p></blockquote><p><strong><mark class="hl-label blue">Windows</mark> </strong><br>1 loader.asm  app.asm <br>2 nasm  .bin </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nasm -f bin app.asm -o app.bin</span><br><span class="line">nasm -f bin loader.asm -o loader.bin</span><br></pre></td></tr></table></figure><p>3 .bin  <code>fixvhdwt</code>  <code>LEECHUNG.vhd</code>  <code>loader.bin</code>  0  <code>app.bin</code>  100 <br>4 bochs  bochsdbg.exe<br><img src="/2022/img/image-20221031091508919.png" alt=""><br> 7  Boot Option  boot Drive1  disk <br>5) start <code>c</code>  hello world </p><p><strong><mark class="hl-label blue">Linux</mark> </strong></p><p>1 bochs <a href="https://jyx-fyh.github.io/2022/10/27/bochs%E4%BD%BF%E7%94%A8/">bochs</a> bochs </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bximage -q -hd=16 -func=create -sectsize=512 -imgmode=flat ./build/hd.img</span><br></pre></td></tr></table></figure><p>2 <code>bochsrc</code> </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ata0-master: <span class="built_in">type</span>=disk, path=<span class="string">&quot;./build/hd.img&quot;</span>, mode=flat</span><br></pre></td></tr></table></figure><p>3 bochs-2.7/build  <code>loader.s</code>  <code>app.s</code>  .bin </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nasm -f bin app.s -o app.bin</span><br><span class="line">nasm -f bin loader.s -o loader.bin</span><br></pre></td></tr></table></figure><p> <code>app.s</code>  <code>es:[xxx_segment]</code>  <code>[es:xxx_segment]</code>  nasm  LInux  Windows <br>4.bin </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=./loader.bin of=./hd.img bs=512 count=1 conv=notrunc</span><br><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=./app.bin of=./hd.img bs=512 count=1 seek=100 conv=notrunc  //app100</span><br></pre></td></tr></table></figure><p>5 bochs-2.7 </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bochs -f bochsrc</span><br></pre></td></tr></table></figure><p><br><img src="/2022/img/image-20221031091633667.png" alt=""><br> continue<br><img src="/2022/img/image-20221031091711096.png" alt=""><br>world  F </p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>make clean&amp;</title>
      <link href="/2022/10/09/make-clean%E7%9A%84%E5%BF%85%E8%A6%81%E6%80%A7/"/>
      <url>/2022/10/09/make-clean%E7%9A%84%E5%BF%85%E8%A6%81%E6%80%A7/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p> makefile</p></blockquote><p><strong> <code>make clean</code> </strong><br><strong><font color='orange'> <code>make clean</code></font></strong> </p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#######################mekefile</span></span><br><span class="line"><span class="keyword">vpath</span> %.c ./src</span><br><span class="line"><span class="section">calc.exe: main.c add.o</span></span><br><span class="line">gcc  ./src/main.c add.o -o calc.exe</span><br><span class="line"><span class="section">add.o: add.c</span></span><br><span class="line">gcc -c ./src/add.c -o add.o</span><br><span class="line"><span class="meta"><span class="keyword">.PHONY</span>: clean</span></span><br><span class="line"><span class="section">clean:</span></span><br><span class="line">rm -rf *.o</span><br><span class="line"><span class="comment">#######################main.c</span></span><br><span class="line"><span class="comment">#include &quot;../header/add.h&quot;</span></span><br><span class="line">int main() &#123;</span><br><span class="line">    int a=0;</span><br><span class="line">    int b=1;</span><br><span class="line">    int c=add(a,b);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#######################add.c</span></span><br><span class="line"><span class="comment">#include &quot;../header/add.h&quot;</span></span><br><span class="line">int add(int a,int b)&#123;</span><br><span class="line">    return a+b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#######################add.h</span></span><br><span class="line"><span class="comment">#ifndef UNTITLED_ADD_H</span></span><br><span class="line"><span class="comment">#define UNTITLED_ADD_H</span></span><br><span class="line">int add(int a,int b);</span><br><span class="line"><span class="comment">#endif //UNTITLED_ADD_H</span></span><br></pre></td></tr></table></figure><p> <code>make</code>  <code>make</code> <code>make: 'calc.exe' is up to date.</code>  add.h </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> UNTITLED_ADD_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> UNTITLED_ADD_H</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b,<span class="type">int</span> c)</span></span>;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">//UNTITLED_ADD_H</span></span></span><br></pre></td></tr></table></figure><p> <code>make</code> <code>make: 'calc.exe' is up to date.</code>  make  add.h  <code>make clean</code>  <code>make</code> <br><img src="../../public/2022/img/image-20221009185915392.png" alt=""></p><p> <code>make clean</code> </p><p></p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">vpath</span> %.c ./src</span><br><span class="line"><span class="keyword">vpath</span> %.h ./header</span><br><span class="line"><span class="section">calc.exe: main.c add.o</span></span><br><span class="line">gcc  ./src/main.c add.o -o calc.exe</span><br><span class="line"><span class="section">add.o: add.c add.h</span></span><br><span class="line">gcc -c ./src/add.c -o add.o</span><br><span class="line"><span class="meta"><span class="keyword">.PHONY</span>: clean</span></span><br><span class="line"><span class="section">clean:</span></span><br><span class="line">rm -rf *.o</span><br></pre></td></tr></table></figure><p> C  Makefile make gcc/g++ <code>gcc -MM file</code>  <code>file</code> </p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ gcc -MM ./src/main.c</span><br><span class="line"><span class="section">main.o: src/main.c  src/../header/add.h</span></span><br></pre></td></tr></table></figure><p><br><a href="https://seisman.github.io/how-to-write-makefile/rules.html">https://seisman.github.io/how-to-write-makefile/rules.html</a></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category> makefile </category>
          
      </categories>
      
      
        <tags>
            
            <tag> makefile </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>()</title>
      <link href="/2022/10/06/%E8%AF%A6%E8%A7%A3%E5%89%8D%E7%BC%80%E6%A0%91-%E5%AD%97%E5%85%B8%E6%A0%91/"/>
      <url>/2022/10/06/%E8%AF%A6%E8%A7%A3%E5%89%8D%E7%BC%80%E6%A0%91-%E5%AD%97%E5%85%B8%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p> N  <strong></strong> pass()end()<br><img src="/2022/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE-1665450930848-1.png" alt=""></p><p>0-a1-b2-c root <br>root  end  0 end root  pass <font color='orange'></font><font color='orange'></font> root  end ()</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> std::string;</span><br><span class="line"><span class="keyword">using</span> std::cout;</span><br><span class="line"><span class="keyword">using</span> std::endl;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> pass;</span><br><span class="line"><span class="type">int</span> end;</span><br><span class="line">node* nexts[<span class="number">26</span>];</span><br><span class="line"><span class="built_in">node</span>():<span class="built_in">pass</span>(<span class="number">0</span>), <span class="built_in">end</span>(<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++)</span><br><span class="line">nexts[i] = <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">trieTree</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">node* root;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">trieTree</span>()&#123;root = <span class="keyword">new</span> node;&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(string str)</span></span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">search</span><span class="params">(string str)</span></span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">prefixSearch</span><span class="params">(string str)</span></span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">delstr</span><span class="params">(string str, <span class="type">int</span> times)</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">trieTree::insert</span><span class="params">(string str)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(str.<span class="built_in">size</span>() == <span class="number">0</span>)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line">node* tmp = root;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; str.<span class="built_in">size</span>(); i++)</span><br><span class="line">&#123;</span><br><span class="line">n = str[i] - <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(tmp-&gt;nexts[n] == <span class="literal">NULL</span>)</span><br><span class="line">tmp-&gt;nexts[n] = <span class="keyword">new</span> node;</span><br><span class="line">tmp = tmp-&gt;nexts[n];</span><br><span class="line">tmp-&gt;pass++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(tmp-&gt;end == <span class="number">0</span>)</span><br><span class="line">root-&gt;end++;</span><br><span class="line">tmp-&gt;end++;</span><br><span class="line">root-&gt;pass++;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">trieTree::search</span><span class="params">(string str)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(str.<span class="built_in">size</span>() == <span class="number">0</span>)<span class="comment">//!!!</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">node* tmp = root;</span><br><span class="line"><span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; str.<span class="built_in">size</span>(); i++)</span><br><span class="line">&#123;</span><br><span class="line">n = str[i] - <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(tmp-&gt;nexts[n] == <span class="literal">NULL</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">tmp = tmp-&gt;nexts[n];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> tmp-&gt;end;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">trieTree::prefixSearch</span><span class="params">(string str)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(str.<span class="built_in">size</span>() == <span class="number">0</span>)<span class="comment">//!!!</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">node* tmp = root;</span><br><span class="line"><span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; str.<span class="built_in">size</span>(); i++)</span><br><span class="line">&#123;</span><br><span class="line">n = str[i] - <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(tmp-&gt;nexts[n] == <span class="literal">NULL</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">tmp = tmp-&gt;nexts[n];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> tmp-&gt;pass;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">trieTree::delstr</span><span class="params">(string str, <span class="type">int</span> times)</span><span class="comment">//times,0</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> counts = <span class="keyword">this</span>-&gt;<span class="built_in">search</span>(str);</span><br><span class="line"><span class="keyword">if</span>(counts == <span class="number">0</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> t = times == <span class="number">0</span> ? counts : (times &lt; counts ? times : counts);</span><br><span class="line">node* tmp = root;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; str.<span class="built_in">size</span>(); i++)</span><br><span class="line">&#123;</span><br><span class="line">n = str[i] - <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">tmp = tmp-&gt;nexts[n];</span><br><span class="line">tmp-&gt;pass -= t;</span><br><span class="line">&#125;</span><br><span class="line">tmp-&gt;end -= t;</span><br><span class="line"><span class="keyword">if</span>(t != counts)</span><br><span class="line"><span class="keyword">return</span> t;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; str.<span class="built_in">size</span>(); i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> k = <span class="number">0</span>;</span><br><span class="line">tmp = root;</span><br><span class="line"><span class="keyword">for</span>(; k &lt; str.<span class="built_in">size</span>()<span class="number">-1</span>-i; k++)</span><br><span class="line">&#123;</span><br><span class="line">n = str[k] - <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">tmp = tmp-&gt;nexts[n];</span><br><span class="line">&#125;</span><br><span class="line">n = str[k] - <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(tmp-&gt;nexts[n]-&gt;pass == <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">delete</span> tmp-&gt;nexts[n];</span><br><span class="line">tmp-&gt;nexts[n] = <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> counts;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/10/01/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/"/>
      <url>/2022/10/01/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="font-color-red--font"><font color='red'></font></h3><p> C++JavaPython  <code>01011001</code> 01  0  1 <br> 0  1 <strong><font color='orange'></font></strong> <br><img src="/2022/img/image-20221001232413430.png" alt="" style="zoom:67%;" /><br><strong></strong> <strong> CPU  CPU </strong>  <strong><font color='orange'></font></strong> </p><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong></strong>  <strong>Intel</strong>  <strong>AT&amp;T</strong>  X86 <strong>Intel  AT&amp;T </strong>  Windowsmasm  Intel AT&amp;T  Unix GNU  AT&amp;T<br><strong></strong>  <strong>(CISC)</strong>  <strong>(RISC)</strong>  <strong>X86</strong>  <strong>ARM</strong> RISC 95% ARM CISC  PC  PC  CPU(M1)  ARM </p><h3 id="font-color-red--font"><font color='red'></font></h3><ol><li><strong></strong>  <code>mov</code> </li><li><strong></strong>  <code>segment</code>  <code>end</code> </li><li><strong></strong>  <code>+</code>  <code>-</code> </li></ol><p><strong></strong> </p><h3 id="font-color-red-CPU-font"><font color='red'>CPU</font></h3><p>CPU </p><ol><li><strong></strong> </li><li><strong></strong> .</li><li><strong></strong> </li></ol><p> <strong></strong>  CPU  CPU  3 <br><img src="/2022/img/IMG_0463(20221012-154228).PNG" style="zoom:67%;" /></p><ol><li>CPU </li><li>CPU </li><li> CPU</li></ol><p><strong></strong>  0  1 32  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>32</mn></msup></mrow><annotation encoding="application/x-tex">2^{32}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">32</span></span></span></span></span></span></span></span></span></span></span></span> <br><strong><font color='orange'> CPU  CPU  32/64 () CPU </font></strong></p><p><strong>808080888028680386  1620243264KB1MB16MB4GB</strong> </p><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong><mark class="hl-label blue"></mark> </strong><br>CPU</p><p><strong><mark class="hl-label blue"></mark> </strong><br> CPU  CPU  CPU CPU <br><strong><mark class="hl-label blue"></mark> </strong><br></p><ol><li><strong>ROM (Read Only Memory)</strong> </li><li><strong>RAM (Random Access Memory)</strong>  </li></ol><p></p><ol><li><strong><font color='gree'></font></strong>  CPU <strong> RAM  RAM </strong></li><li><strong><font color='gree'> BIOS (Basic IO System)  ROM</font></strong> <font color='orange'>BIOS  ROM  BIOS  ROM  BIOS ROM  BIOS</font><strong> BIOS </strong> <strong>BIOS</strong> BIOS <ul><li></li><li></li><li> I/O </li><li></li></ul></li><li><strong><font color='gree'></font></strong>  RAM RAM ()</li></ol><img src="/2022/img/IMG_0465(20221012-172337).PNG" alt="" style="zoom: 67%;" /><h3 id="font-color-red--font"><font color='red'></font></h3><p>8086/8088 CPU Intel  8028680286  24  16 MB  16  64 KB 80386  32  4 GB  32  4GB </p><ol><li> 8086</li><li></li><li> 8086  8086 </li></ol><p>80286 CPU </p><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong><font color='red'>CPU </font></strong> <br><img src="/2022/img/IMG_0466(20221012-173407).PNG" style="zoom:67%;" /></p><p><strong>CPU </strong></p><p><br><img src="/2022/img/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2phZGVzaHU=,size_16,color_FFFFFF,t_70.png" alt=""></p><p>,<strong>DOS()DOSCPUDOSWindows 2000UnixCPUCPU</strong> <br><strong><font color='orange'>DOS<code>0:0200~0:02FF</code>  256 </font></strong></p><h3 id="font-color-red--font"><font color='red'></font></h3><ul><li>8 bits</li><li>2  16 bits</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>16</mn></msup><mo>=</mo><mn>64</mn><mi>K</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">2^{16}=64KB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">16</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">64</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>20</mn></msup><mo>=</mo><mn>1</mn><mi>M</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">2^{20}=1MB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">20</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">1</span><span class="mord mathnormal" style="margin-right:0.05017em;">MB</span></span></span></span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>24</mn></msup><mo>=</mo><mn>16</mn><mi>M</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">2^{24}=16MB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">24</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">16</span><span class="mord mathnormal" style="margin-right:0.05017em;">MB</span></span></span></span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>32</mn></msup><mo>=</mo><mn>4</mn><mi>G</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">2^{32}=4GB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">32</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">4</span><span class="mord mathnormal" style="margin-right:0.05017em;">GB</span></span></span></span></li><li> AX  0XFFEE AH  0XFFAL  0XEE</li><li></li></ul><h3 id="font-color-red-8086-font"><font color='red'>8086</font></h3><p><strong>8086 CPU 20  1 MB 1MB</strong>  8086 CPU 16  16  (1616)  16 <strong>8086  16  20 </strong>  <strong><font color='orange'>=16+16</font></strong> <br><img src="/2022/img/IMG_0467(20221012-193401).PNG" style="zoom:67%;" /><br></p><ol><li> 16  4 </li><li>16  16  16  10010H</li><li>10010H  1001H16+0  1000H16+0010H</li><li><strong> 16  64KB</strong></li><li><strong> 16 </strong>  data  14  1001:0 ~ 10001:Dcode  1002:0 </li></ol><h3 id="font-color-red--font"><font color='red'></font></h3><img src="/2022/img/IMG_0471(20221013-163812).PNG" style="zoom:80%;" /><ol><li><p><strong> [ ] BX/SI/DI/BP </strong></p></li><li><p><strong>BX  SIBX  DIBP  SIBP  DI</strong></p><blockquote><p>BX  BP DI  SI </p></blockquote></li><li><p><strong> BP SS</strong> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#</span><br><span class="line">mov ax,[bx+bp]</span><br><span class="line">mov ax,[si+di]</span><br></pre></td></tr></table></figure></li></ol><h3 id="font-color-red--font"><font color='red'></font></h3><ol><li><p> CS : IP </p><blockquote><p><strong> I/O </strong> </p></blockquote></li><li><p>IP = IP + </p><blockquote><p> CPU </p></blockquote></li><li><p></p></li></ol><p></p><h3 id="font-color-red--font"><font color='red'></font></h3><h4 id="font-color-gree--font"><font color='gree'></font></h4><p><strong></strong>  CPU  <strong>1 int 2 CPU ()</strong>  CPU </p><ol><li><p></p></li><li><p></p></li><li><p> into </p><blockquote><p> OF , OF=1 ,<u> 4 </u>, OF0  TF  IF </p></blockquote></li><li><p> int </p><blockquote><p> int NN </p></blockquote></li></ol><p><strong><mark class="hl-label blue"></mark> </strong><br>CPU  1  256 <br>CPU  <strong></strong> ( <strong>IVT</strong> )  CS:IP  <strong><font color='orange'> BIOS  <code>0000:0000 ~ 0000:03ff</code>  1024  <code>0000:0200~0000:02ff256</code></font></strong> PC 4  256 </p><blockquote><p>DOS BIOS  int 19h DOS <strong>DOS  int 21h  ah  <code>mov ax,4c00int 21h</code></strong>  </p></blockquote><p><strong><mark class="hl-label blue"></mark> </strong><br><strong> N  CS:IP CPU </strong>  CPU </p><ol><li> N</li><li>pushf</li><li>TF=0IF=0</li><li>push CS</li><li>push IP</li><li>IP=N4CS=N4+2</li></ol><p> cpu </p><p><strong><mark class="hl-label blue"></mark> </strong></p><ol><li></li><li></li><li></li><li>iret</li></ol><p><strong><mark class="hl-label blue"></mark> </strong><br>CPU  SS CPU  SS:SP  SS  SP  SS  SS:SP </p><p><strong><mark class="hl-label blue">int</mark> </strong><br><code>int n</code>  n int  call  int </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov ax,4c00h</span><br><span class="line">int 21h</span><br></pre></td></tr></table></figure><h4 id="font-color-gree--font"><font color='gree'></font></h4><p>CPU  <strong><font color='orange'>IF </font></strong>  IF=1IF=0 IF </p><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong><mark class="hl-label blue"></mark> </strong><br><strong>CPU </strong></p><ol><li><strong>CPU </strong></li><li><strong></strong></li><li><strong></strong></li></ol><p> CPU CPU CPU <font color='orange'></font> <a href="https://blog.ours1984.top/posts/iomp/#%E8%BE%B9%E9%99%85%E6%95%88%E5%BA%94"></a> </p><p><strong><mark class="hl-label blue"></mark> </strong><br> <code>in</code>  <code>out</code>  AX  AL  8  AL16  AX</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#60hal</span><br><span class="line">in al,60h</span><br><span class="line">#20h</span><br><span class="line">out 20h,al</span><br></pre></td></tr></table></figure><h3 id="font-color-red--font"><font color='red'></font></h3><p>8086 CPU  16  8086  CPU  8  <strong><font color='orange'> CPU  8086 8086 CPU AX, BX, CX, DX 8 </font></strong></p><p><strong><mark class="hl-label blue"></mark> </strong></p><p><strong>8 <font color='gree'>AXBXCXDXSIDISPBP</font></strong> <br><strong>AX</strong> (Accumulator)<br><strong>BX</strong> (Base Register)<br><strong>CX</strong> Count Register<br><strong>DX</strong> Data Register<br><strong>SI</strong>   (Source Index Register)<br><strong>DI</strong>  (Destination Index Register)<br><strong>BP</strong> (Base Pointer Register)<br><strong>SP</strong> (Stack Pointer Register)</p><p><strong><font color='gree'>AX , BX , CX , DX</font></strong> <strong></strong>  AX  AH  ALBX  BH  BL<strong>H L </strong><strong></strong></p><p><strong><font color='gree'>SI , DI , SP , BP</font></strong> <strong></strong> </p><p></p><ol><li>AX<ul><li><strong></strong>  8  16  AX  16  32 <font color='orange'> DX  AX </font></li><li><strong></strong>  8 <font color='orange'> AL AH</font> 16 <font color='orange'> AX DX</font></li><li><strong></strong>  8  AL  AX  16  AX <font color='orange'> DX  AX </font></li><li><strong></strong> </li></ul></li><li>BX<strong>[ ] BXSI DI  BP</strong>  Loop  [BX/SI/DI/BP]  <strong><font color='orange'> [BX/SI/DI]  DS[BP]  SS</font></strong></li><li>CX<ul><li>Loop </li><li><code>jcxz</code> </li><li> <code>rep</code> </li><li>CL  shl  shr </li></ul></li><li>DX AX</li><li>SI  BX, DS:SI , ES:DI </li><li>DI  BXSI DI  SI </li><li>BP BX <strong>BP  BP </strong> </li><li>SP[SP]  <strong>[SP]  SS</strong> BP  SP </li></ol><p><strong><mark class="hl-label blue"></mark> </strong><br><strong><font color='gree'>CS , DS , SS , ES</font></strong></p><ul><li><p>CS IP </p></li><li><p>DSBXBPSIDI <strong><font color='orange'>[BX/SI/DI]  DS</font></strong> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mov ax,[0]</span><br></pre></td></tr></table></figure></li><li><p>SS SP <strong>SS : SP </strong> </p></li><li><p>ES DS <strong>DS ES </strong>  movsb </p></li></ul><p><strong><font color='orange'>8086 CPU </font></strong> </p><p><strong><mark class="hl-label blue"></mark> </strong><br>flag <br><img src="/2022/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE-1665748273693-1.png" alt=""></p><ul><li>ZF addsubmuldivincorand 0 ZF = 10ZF = 00</li><li>PF 1  PF = 1PF = 0</li><li>SF1SF = 1SF = 0</li><li>CF <strong><font color='orange'></font></strong> </li><li>OFOF <strong><font color='orange'></font></strong> OF=1OF=0</li><li>DF movsbmovsw <strong>cld  DF  0std  1</strong>  movsb </li><li>IF <strong></strong>  IF=1 IF=0 IF <strong>sti  IF=1cli  IF=0</strong></li><li>TFTF=1TF=0</li><li>AF 3  4 (0)AF=1AF=0</li></ul><p><strong>movpushpop</strong>  debug <a href="#%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8"></a>   </p><p><strong><mark class="hl-label blue"></mark> </strong><br>IP  CS <strong>IP <font color='orange'></font></strong>CPU  CS:IP </p><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong><mark class="hl-label blue">mov</mark> </strong><br><code>mov</code>  <strong><font color='orange'><code>mov</code>  CSIP </font></strong> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mov ax,bx</span><br></pre></td></tr></table></figure><p><code>mov</code> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mov ,</span><br><span class="line">mov ,</span><br><span class="line">mov ,</span><br><span class="line">mov ,</span><br><span class="line">mov ,</span><br><span class="line">mov ,</span><br></pre></td></tr></table></figure><p> <code>mov ,</code>  <code>mov ,</code>  <strong><font color='orange'><code>mov ,</code> </font></strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov byte ptr[0],12h</span><br><span class="line">mov word ptr[0],1234h</span><br></pre></td></tr></table></figure><p><code>ptr</code>  <code>sub</code> <code>add</code> </p><p><strong><mark class="hl-label blue">jmp</mark> </strong></p><p><code>jmp</code> </p><ul><li><p><code>jmp :</code>  CS : IP</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">jmp 1000:0012</span><br><span class="line">#5</span><br><span class="line">mov cs,1000h</span><br><span class="line">mov ip,0012h</span><br></pre></td></tr></table></figure></li><li><p><code>jmp reg</code>   IP  reg </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">jmp ax</span><br><span class="line">#</span><br><span class="line">mov ip,ax</span><br></pre></td></tr></table></figure></li><li><p><code>jmp short /</code>  IP  -128~127<font color='orange'> jmp </font> <code>jmp short </code>  <code>IP=IP+8</code> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code,ss:stack</span><br><span class="line">stack segment</span><br><span class="line">db 16 dup(0)</span><br><span class="line">stack ends</span><br><span class="line">code segment</span><br><span class="line">mov ax,4c00h</span><br><span class="line">int 21h</span><br><span class="line">start:</span><br><span class="line">mov ax,1</span><br><span class="line">    inc ax</span><br><span class="line">jmp short start</span><br><span class="line">code ends</span><br><span class="line">end start</span><br></pre></td></tr></table></figure></li><li><p><code>jmp near ///</code>  <code>jmp short </code>  IP  -32768~32767 16 </p></li><li><p><code>jmp far /</code>  CS:IP </p></li><li><p><code>jmp word ptr </code> </p></li><li><p><code>jmp dword ptr </code> <strong></strong></p></li></ul><p><strong><mark class="hl-label blue">addsub</mark> </strong><br><code>add</code>  <code>sub</code>  <code>mov</code> </p><p><strong><mark class="hl-label blue">poppush</mark> </strong><br><code>push ax</code> 1<code>SP = SP - 2</code>       2<code>mov SS:[SP],ax</code> </p><p><code>pop ax</code>   1<code>mov ax,SS:[SP]</code> 2<code>SP = SP + 2</code> </p><p><strong></strong></p><ol><li><strong><font color='orange'>8086 </font></strong></li><li><strong><font color='orange'><code>push 12</code> </font></strong></li><li><strong><font color='orange'>SS:SP (BP) SS:SP </font></strong></li><li><strong> 0~FFFF</strong></li></ol><img src="/2022/img/-1665624319178-11.png" style="zoom:67%;" /><p><strong><mark class="hl-label blue">pushapopa</mark> </strong><br><code>pusha</code> AX,CX,DX,BX,SP,BP,SI,DI<code>popa</code> <strong> PUSHA  POPA POPA </strong> </p><p><strong><mark class="hl-label blue">incdec</mark> </strong></p><p><code>inc</code>  1<code>dec</code>  1</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">inc ax</span><br><span class="line">dec bx</span><br><span class="line">inc word ptr [bx]</span><br><span class="line">dec byte ptr [bx]</span><br></pre></td></tr></table></figure><p><strong><mark class="hl-label blue">Loop</mark> </strong><br><code>loop</code> <code>loop </code>  Loop </p><ol><li><p><code>cx = cx - 1</code></p></li><li><p> CX </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mov cx,5</span><br><span class="line">s:  </span><br><span class="line">inc ax</span><br><span class="line">loop s</span><br></pre></td></tr></table></figure></li></ol><p> <strong></strong></p><p><strong><mark class="hl-label blue">andor</mark> </strong><br></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mov al,10010010B</span><br><span class="line">and al,11101111B</span><br><span class="line">or  al,11101110B</span><br></pre></td></tr></table></figure><p><strong><mark class="hl-label blue">test</mark> </strong><br>Test  ()  AND &amp;&amp;&amp;<strong></strong> </p><p><code>TEST AX,BX</code>  <code>AND AX,BX</code>  Test  AX  BX  AND  AX </p><p><strong><mark class="hl-label blue">div</mark> </strong><br><strong><code>div</code> <code>idiv</code> </strong>  8  16  AX  16  32  DX  AX <strong></strong>  8  AL AH 16  AX DX</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">div /</span><br><span class="line">div word/byte ptr </span><br></pre></td></tr></table></figure><p> 100001  100186A1H  64H</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mov ax,1H</span><br><span class="line">mov dx,186AH</span><br><span class="line">mov cx,64H</span><br><span class="line">div cx</span><br></pre></td></tr></table></figure><p><strong><mark class="hl-label blue">mul</mark> </strong><br><strong><code>mul</code> <code>imul</code> </strong>  8  16 <br>8  AL  8 (<u></u>) AX</p><p>16  AX  16 (<u></u>) DX  AX </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#8</span><br><span class="line">mov al,5h</span><br><span class="line">mov bl,15h</span><br><span class="line">mul bl</span><br><span class="line">#16</span><br><span class="line">mov ax,0fffh</span><br><span class="line">mov dx,1111h</span><br><span class="line">mul dx</span><br></pre></td></tr></table></figure><p><strong><mark class="hl-label blue">jcxz</mark> </strong><br><code>jcxz</code>  <strong><font color='orange'></font></strong>  CX=0 </p><p><strong><mark class="hl-label blue">retretf</mark> </strong><br><code>ret</code>   1IP = SS:[SP]2SP = SP+2POP IP<br><code>ret imm</code> 1IP = SS:[SP]2SP = SP+23SP = SP+imm POP IPSP+=imm</p><p><code>retf</code> 1IP = SS:[SP]2SP = SP+23CS = SS:[SP]4SP = SP+2</p><p><strong><mark class="hl-label blue">call</mark> </strong><br><code>call </code> 1SP = SP-22SS:[SP] = IP3jmp near <strong></strong><br><code>call far </code> 1SP = SP-22SS:[SP] = CS3SP = SP-24SS:[SP] = IP5jmp far <strong></strong><br><code>call 16reg</code> 1SP = SP-22SS:[SP] = IP3IP = reg<strong></strong></p><p><code>call word ptr </code> 1SP = SP-22SS:[SP] = IP3IP = <br><code>call dword ptr </code> 1SP = SP-22SS:[SP] = CS3SP = SP-24SS:[SP] = IP5CS = 6IP = </p><p><strong><mark class="hl-label blue">adc</mark> </strong><br></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adc operand1,operand2</span><br></pre></td></tr></table></figure><p>oprand1 = operand1 + operand2 + CF<br><br><strong>12</strong>  <code>add ax,bx</code> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">add al,bl</span><br><span class="line">adc ah,bh</span><br><span class="line">#ax</span><br></pre></td></tr></table></figure><p>16  CPU  32  <code>11FF89FF33420010</code> + <code>12983476FFAAB444</code> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mov ax,11FF89FF #ax</span><br><span class="line">mov bx,33420010 #bx</span><br><span class="line">add bx,FFAAB444</span><br><span class="line">adc ax,12983476</span><br><span class="line">#axbxaxbx</span><br></pre></td></tr></table></figure><blockquote><p>8 adc  32/64 </p></blockquote><p><strong><mark class="hl-label blue">sbb</mark> </strong><br> adc </p><p><strong><mark class="hl-label blue">cmp</mark> </strong><br>cmp </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmp operand1,operand2</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">##zf,cf</span><br><span class="line">(ax)=(bx)(ax)-(bx)=0,: zf=1;</span><br><span class="line">(ax)(bx)(ax)-(bx)0,: zf=0;</span><br><span class="line">(ax)&lt;(bx)(ax)-(bx),: cf=1;</span><br><span class="line">(ax)&gt;=(bx)(ax)-(bx),: cf=0;</span><br><span class="line">(ax)&gt;(bx)(ax)-(bx),0,: cf=0zf=0;</span><br><span class="line">(ax)&lt;=(bx)(ax)-(bx),0,: cf=1zf=1</span><br><span class="line">##zf,sf,cf</span><br><span class="line">ax&lt;bxax-bx&lt;0,: (sf=1of=0)(sf=0,of=1)</span><br><span class="line">ax=bxax-bx=0,: zf=1</span><br><span class="line">ax&gt;=bxax-bx&gt;=0,: sf=0zf=0</span><br><span class="line">ax&gt;bxax-bx&gt;0,: sf=1of=1</span><br></pre></td></tr></table></figure><p></p><p><strong><mark class="hl-label blue"></mark> </strong><br><strong></strong></p><table><thead><tr><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><td>je</td><td></td><td>zf=1</td><td>jump if equal</td></tr><tr><td>jne</td><td></td><td>zf=0</td><td>jump if not equal</td></tr><tr><td>jb</td><td></td><td>cf=1</td><td>jump if blow</td></tr><tr><td>jnb</td><td></td><td>cf=0</td><td>jump if not blow</td></tr><tr><td>ja</td><td></td><td>cf=0zf=0</td><td>jump if above</td></tr><tr><td>jna</td><td></td><td>cf=1zf=1</td><td>jump if not above</td></tr></tbody></table><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cmp ax,bx</span><br><span class="line">jne start</span><br></pre></td></tr></table></figure><p><a href="http://c.biancheng.net/view/3567.html"></a></p><p><strong><mark class="hl-label blue">movsx</mark> </strong></p><p> movsbmovswmovsd <br>movsb <br>1<code>ES:[DI]=DS:[SI]</code><br>2 DF=0 <code>SI++,DI++</code>  DF=1 <code>SI--,DI--</code> <br>movsw  DF=0 <code>SI+=2,DI+=2</code>  DF=1 <code>SI-=2,DI-=2</code> <br>movsd </p><p>cld  DF  0std  1<br>movsb  movsw  rep </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">rep movsb</span><br><span class="line">###</span><br><span class="line">s:movsb</span><br><span class="line">loop s</span><br></pre></td></tr></table></figure><p>rep  CX </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code,ds:data</span><br><span class="line">data segment</span><br><span class="line">db 11h,22h,33h,44h,55h,66h,77h,88h</span><br><span class="line">db 8 dup(0)</span><br><span class="line">data ends</span><br><span class="line">code segment</span><br><span class="line">mov ax,4c00h</span><br><span class="line">int 21h</span><br><span class="line">start:</span><br><span class="line">mov ax,0</span><br><span class="line">push ax</span><br><span class="line">mov ax,data</span><br><span class="line">mov ds,ax</span><br><span class="line">mov es,ax</span><br><span class="line">mov si,0</span><br><span class="line">mov di,8</span><br><span class="line">mov cx,8</span><br><span class="line">rep movsb</span><br><span class="line">ret</span><br><span class="line">code ends</span><br><span class="line">end start</span><br></pre></td></tr></table></figure><p><strong><mark class="hl-label blue">pushfpopf</mark> </strong></p><p>pushf <font color='orange'></font>popf  <a href="#%E4%B8%AD%E6%96%AD"></a></p><p><strong><mark class="hl-label blue">iret</mark> </strong><br></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pop IP</span><br><span class="line">pop CS</span><br><span class="line">popf</span><br></pre></td></tr></table></figure><p></p><p><strong><mark class="hl-label blue">shlshr</mark> </strong><br><code>shl</code> <code>shr</code> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">shl ax,1</span><br><span class="line">mov cl,4</span><br><span class="line">shl ax,cl</span><br></pre></td></tr></table></figure><p> 1  CL<strong> CF </strong> </p><p><strong><mark class="hl-label blue">seg</mark> </strong></p><p></p><p><strong><mark class="hl-label blue"></mark> </strong><br></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov ax,4c00h</span><br><span class="line">int 21h</span><br></pre></td></tr></table></figure><p> main()  <code>return 0</code> </p><h3 id="font-color-red--font"><font color='red'></font></h3><blockquote><p><strong> masm </strong> nasm  masm </p></blockquote><p> <strong><font color='red'>( .asm ) .asm  end </font></strong>  <strong><font color='gree'> masm  nasm  masm </font></strong><br></p><ol><li><p><code>segment</code>  <code>ends</code> </p></li><li><p><code>end</code>  <code>ends</code> <strong></strong> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code,ds:data</span><br><span class="line">data segment</span><br><span class="line">dw 0FFFF,0EEEE</span><br><span class="line">data ends</span><br><span class="line">code segment</span><br><span class="line">mov ax,4c00h</span><br><span class="line">int 21h</span><br><span class="line">start:</span><br><span class="line">mov ax,ds:[0]</span><br><span class="line">ret</span><br><span class="line">code ends</span><br><span class="line">end start</span><br></pre></td></tr></table></figure><p><code>end start</code>  <code>start</code> </p></li><li><p><code>assume</code>  <code>segment</code>  <code>ends</code> </p></li><li><p><code>+</code> <code>-</code> <code>mov ax,90-4</code></p></li><li><p><code>dw</code> <code>db</code> <code>dd</code> <code>dq</code> define worddefine bytedefine double worddefine quadword(8 )</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">stack1 segment</span><br><span class="line">dw 0FFFF,0FFFF,0FFFF</span><br><span class="line">stack1 ends</span><br><span class="line"></span><br><span class="line">stack2 segment</span><br><span class="line">db 11,22,33,44</span><br><span class="line">stack2 ends</span><br></pre></td></tr></table></figure></li><li><p><code>dup</code>  2 </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">   stack1 segment</span><br><span class="line">   dw 3 dup(0FFFF)</span><br><span class="line">   stack1 ends</span><br><span class="line"></span><br><span class="line">7. `offset` </span><br><span class="line"></span><br><span class="line">   ```assembly</span><br><span class="line">   codesg segment</span><br><span class="line">   mov ax,4c00h</span><br><span class="line">   int 21h</span><br><span class="line">   start:</span><br><span class="line">   mov bx,offset start</span><br><span class="line">   code ends</span><br></pre></td></tr></table></figure><p>bx  start  <code>mov</code>  codesg  <code>mov</code>  offset </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">codesg segment</span><br><span class="line">mov ax,4c00h</span><br><span class="line">int 21h</span><br><span class="line">start:</span><br><span class="line">mov bx,45h</span><br><span class="line">mov cx,8</span><br><span class="line">push cx</span><br><span class="line">push bx</span><br><span class="line">mov dx,offset s - offset start</span><br><span class="line">s:nop</span><br><span class="line">code ends</span><br></pre></td></tr></table></figure></li><li><p> <code>codesg segment</code>  <code>codesg</code>  9 <strong><code>:</code> </strong> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code,ds:data</span><br><span class="line">data segment</span><br><span class="line">dw 0FFFF,0EEEE</span><br><span class="line">data ends</span><br><span class="line">code segment</span><br><span class="line">mov ax,4c00h</span><br><span class="line">int 21h</span><br><span class="line">start:</span><br><span class="line">mov ax,data</span><br><span class="line">ret</span><br><span class="line">code ends</span><br><span class="line">end start</span><br></pre></td></tr></table></figure></li><li><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code,ds:data</span><br><span class="line">data segment</span><br><span class="line">a dw 0FFFFh,0EEEEh</span><br><span class="line">b dw 0</span><br><span class="line">data ends</span><br><span class="line">code segment</span><br><span class="line">mov ax,4c00h</span><br><span class="line">int 21h</span><br><span class="line">start:</span><br><span class="line">mov ax,data</span><br><span class="line">mov ds,ax</span><br><span class="line">inc b[0] ##word ptr</span><br><span class="line">ret</span><br><span class="line">code ends</span><br><span class="line">end start</span><br></pre></td></tr></table></figure></li></ol><h3 id="font-color-red--font"><font color='red'></font></h3><ul><li><p> <code>;</code> </p></li><li><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov ax,bl</span><br><span class="line">add bh,1000</span><br></pre></td></tr></table></figure></li><li><p>AH  AL  <code>add al,93H</code>  AH </p></li><li><p> 21F60 2000:1F60 </p></li><li><p><strong><font color='orange'>8086 CPU </font></strong> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#</span><br><span class="line">mov ss,1100</span><br><span class="line">#</span><br><span class="line">mov ax,1100</span><br><span class="line">mov ss,ax</span><br></pre></td></tr></table></figure></li><li><p>mov  16  16  8  8 </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov ax,[0]</span><br><span class="line">mov al,[0]</span><br></pre></td></tr></table></figure><p><strong> <code>word ptr</code>  <code>byte ptr</code> </strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov word ptr [0],0fffh</span><br><span class="line">inc byte [0]</span><br></pre></td></tr></table></figure></li><li><p><strong><font color='orange'>H0x</font></strong></p></li><li><p> 16  64KB</p></li><li><p><strong>8086 CPU 1(jmp)2(jcxz)3(loop)4call  ret5</strong></p></li><li><p><code>jmp short </code> <code>jmp near </code> <code>jcxz </code> <code>loop </code> </p></li><li><p> SS  SP</p></li></ul><h3 id="font-color-red--font"><font color='red'></font></h3><p></p><ul><li>10.10 </li><li>10.11</li><li>10.12</li><li></li></ul><h3 id="font-color-red--font"><font color='red'></font></h3><p>.  hellomasm</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code,ds:data</span><br><span class="line">data segment</span><br><span class="line">db &#x27;h&#x27;,11000010b,&#x27;e&#x27;,11000010b,&#x27;l&#x27;,11000010b,&#x27;l&#x27;,11000010b,&#x27;o&#x27;</span><br><span class="line">data ends</span><br><span class="line">code segment</span><br><span class="line">mov ax,4c00h</span><br><span class="line">int 21h</span><br><span class="line">start:</span><br><span class="line">mov ax,data</span><br><span class="line">mov ds,ax</span><br><span class="line">mov ax,0b800h</span><br><span class="line">mov es,ax</span><br><span class="line">mov si,0</span><br><span class="line">mov di,1660</span><br><span class="line">mov cx,10</span><br><span class="line">cld</span><br><span class="line">rep movsb</span><br><span class="line">ret</span><br><span class="line">code ends</span><br><span class="line">end start</span><br></pre></td></tr></table></figure><p>188</p><h3 id="font-color-red--font"><font color='red'></font></h3><blockquote><p><a href="https://pan.baidu.com/s/19TWArrfgDA06_IOYwUUDlg?pwd=gzwb"></a><br>gzwb</p></blockquote><p><strong><mark class="hl-label blue"></mark> </strong></p><p>Debug  Dos  Windows  <strong> (8086)</strong>  CPU  <a href="https://blog.csdn.net/plus_re/article/details/60761467">DosBox</a> DosBox  LINK.exe masm.exe  Debug.exe  DosBox </p><p><strong><mark class="hl-label blue">Debug</mark> </strong></p><ul><li><p>R</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line">D:\&gt;debug</span><br><span class="line">-r</span><br><span class="line">AX=0000 BX=0000 CX=0000 DX=0000 SP=00FD BP=0000 SI=0000 </span><br><span class="line">DI=0000 DS=073F ES=073F SS=073F CS=073F IP=0100 NU UP EI PL NZ NA PO NC 073F:0100  0000ADD[BX+SI],ALDS:0000=CD</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line">D:\&gt;debug</span><br><span class="line">-r AX</span><br><span class="line">AX 0000</span><br><span class="line">:FFFF</span><br><span class="line">-r </span><br><span class="line">AX=FFFF BX=0000 CX=0000 DX=0000 SP=00FD BP=0000 SI=0000 </span><br><span class="line">DI=0000 DS=073F ES=073F SS=073F CS=073F IP=0100 NU UP EI PL NZ NA PO NC </span><br><span class="line">073F:0100  0000  ADD[BX+SI],ALDS:0000=CD #</span><br></pre></td></tr></table></figure><p></p><table><thead><tr><th></th><th>1</th><th>0</th></tr></thead><tbody><tr><td>OF</td><td>OV</td><td>NV</td></tr><tr><td>SF</td><td>NG</td><td>PL</td></tr><tr><td>ZF</td><td>ZR</td><td>NZ</td></tr><tr><td>PF</td><td>PE</td><td>PO</td></tr><tr><td>DF</td><td>DN</td><td>UP</td></tr><tr><td>AF</td><td>AC</td><td>NA</td></tr><tr><td>IF</td><td>EI</td><td>DI</td></tr></tbody></table></li><li><p>D</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">D:\&gt;debug</span><br><span class="line">-d 1000:0</span><br><span class="line">1000:0   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">......</span><br></pre></td></tr></table></figure></li><li><p>E</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">D:\&gt;debug</span><br><span class="line">-e 1000:0</span><br><span class="line">1000:0000   00.FF   00.11 #</span><br><span class="line">-d 1000:0</span><br><span class="line">1000:0   FF 11 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">.........</span><br></pre></td></tr></table></figure></li><li><p>U</p></li><li><p>T</p></li><li><p>A</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-a</span><br><span class="line">073F:0100 MOV AX,FF</span><br><span class="line">073F:0103 ADD BX,EE</span><br><span class="line">-u 073F:0100</span><br><span class="line">073F:0100  BBFF00    MOV AX,FF</span><br><span class="line">073F:103  81C3EE00  ADD BX,</span><br></pre></td></tr></table></figure></li><li><p>P VS  F10 T  F11 CX=0</p></li><li><p>G IP</p></li></ul><p><strong><font color='orange'>debugHH</font></strong></p><p><strong><mark class="hl-label blue"></mark> </strong><br> test.asm  DosBox  <code>masm</code>  <code>test.asm</code>  <code>link test.obj</code>  <code>debug test.exe</code> </p><h3 id="font-color-red-Dosexe-font"><font color='red'>Dosexe</font></h3><img src="/2022/img/IMG_0468(20221013-103739).PNG" style="zoom:80%;" /><p>DS  PSP CS PSP <a href="https://jyx-fyh.github.io/2022/10/23/%E5%89%96%E6%9E%90%E9%87%8D%E5%AE%9A%E4%BD%8D%E2%80%94%E2%80%94%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD%E5%99%A8/"></a> </p><h3 id="font-color-red-nasm--font"><font color='red'>nasm </font></h3><p> Linux  nasm  nasm  masm  assume, start, end </p><p><strong><mark class="hl-label blue"></mark> </strong><br>1</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#myfile.sbinmyfile</span></span><br><span class="line">nasm -f bin myfile.s</span><br><span class="line"><span class="comment">#myfile.sbinmyfile.bin</span></span><br><span class="line">nasm -f bin myfile.s -o myfile.bin</span><br></pre></td></tr></table></figure><blockquote><ul><li> Linux  <code>.s</code>  Windows  <code>.asm</code> </li><li><code>.bin</code>  CPU  ELF  PE </li></ul></blockquote><p>2</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nasm -f coff myfile.s -l myfile.lst</span><br></pre></td></tr></table></figure><p><br><img src="/2022/img/image-20221030102024363.png" alt=""></p><p>3</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nasm myfile.s -p myinc.inc</span><br></pre></td></tr></table></figure><p> <code>%include &quot;myinc.inc&quot;</code> </p><p><strong><mark class="hl-label blue"></mark> </strong><br><strong>1</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">section .data [vstart] [align]</span><br></pre></td></tr></table></figure><p>masm  <code>data segment</code>  vstart  vstart  align <a href="https://jyx-fyh.github.io/2022/10/23/%E5%89%96%E6%9E%90%E9%87%8D%E5%AE%9A%E4%BD%8D%E2%80%94%E2%80%94%E7%A8%8B%E5%BA%8F%E5%8A%A0%E8%BD%BD%E5%99%A8/"></a> </p><blockquote><p><code>.data</code> <code>.code</code> <code>.bss</code> <code>.text</code> <br><code>.data</code> <br><code>.bss</code>   <br><code>.code\.text</code> </p></blockquote><p><strong>2$  $$</strong><br>$  $$  section   vstart </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">section .data vstart=0x100</span><br><span class="line">db &quot;hello&quot;</span><br><span class="line">db $-$$</span><br></pre></td></tr></table></figure><p> $  <code>0x100+5=0x105</code> $$  0x100 </p><p><strong>3</strong><br>masm </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dw 100 dup(0)</span><br></pre></td></tr></table></figure><p>nasm </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">times 100 db 0</span><br></pre></td></tr></table></figure><p><strong>4</strong><br> masm </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mov ax,ds:[1000]</span><br></pre></td></tr></table></figure><p> nasm </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mov ax,[ds:1000]</span><br></pre></td></tr></table></figure><p><strong>5</strong><br> masm  <code>size ptr</code> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">push byte ptr [1000]</span><br></pre></td></tr></table></figure><p> nasm  <code>ptr</code> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">push byte [1000]</span><br></pre></td></tr></table></figure><p><strong>6equ </strong><br>equ  C equ </p><p><strong>7</strong></p><ul><li><code>dw</code> <code>db</code> <code>dd</code> <code>dq</code>  .data define worddefine bytedefine double worddefine quadword(8 )</li><li><code>resw</code> <code>resb</code> <code>resd</code> <code>resq</code>  .bss </li></ul>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/09/30/%E5%8A%A0%E5%BC%BA%E5%A0%86/"/>
      <url>/2022/09/30/%E5%8A%A0%E5%BC%BA%E5%A0%86/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p><a href="https://jyxcpp.netlify.app/2022/09/22/%E5%A0%86%E4%B8%8E%E5%A0%86%E6%8E%92%E5%BA%8F/"></a></p></blockquote><p><strong><mark class="hl-label blue"></mark> </strong><br> O(N) </p><p></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;utility&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">heapGreater</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; heap;</span><br><span class="line">unordered_multimap&lt;<span class="type">int</span>, <span class="type">int</span>&gt; indexMap;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">swap</span><span class="params">(<span class="type">int</span>&amp; a,<span class="type">int</span>&amp; b)</span> </span>&#123;</span><br><span class="line"><span class="type">int</span> tmp = a;</span><br><span class="line">a = b;</span><br><span class="line">b = tmp;</span><br><span class="line">tmp = indexMap.<span class="built_in">find</span>(a)-&gt;second;</span><br><span class="line">indexMap.<span class="built_in">find</span>(a)-&gt;second = indexMap.<span class="built_in">find</span>(b)-&gt;second;</span><br><span class="line">indexMap.<span class="built_in">find</span>(b)-&gt;second = tmp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">heapInsert</span><span class="params">(<span class="type">int</span> cur)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (heap[(cur - <span class="number">1</span>) / <span class="number">2</span>] &lt; heap[cur])<span class="comment">//</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">swap</span>(heap[(cur - <span class="number">1</span>) / <span class="number">2</span>], heap[cur]);</span><br><span class="line"><span class="built_in">heapInsert</span>((cur - <span class="number">1</span>) / <span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">heaplify</span><span class="params">(<span class="type">int</span> cur)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> leftChd = cur * <span class="number">2</span> + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (leftChd &gt; ((<span class="type">int</span>)heap.<span class="built_in">size</span>() - <span class="number">1</span>))<span class="comment">//heap.size()size_t01</span></span><br><span class="line"><span class="keyword">return</span>;                          <span class="comment">//int</span></span><br><span class="line"><span class="type">int</span> largest = leftChd + <span class="number">1</span> &lt; (<span class="type">int</span>)heap.<span class="built_in">size</span>() &amp;&amp; heap[leftChd + <span class="number">1</span>] &gt; heap[leftChd] ? leftChd + <span class="number">1</span> : leftChd;</span><br><span class="line"><span class="keyword">if</span> (heap[largest] &gt; heap[cur])<span class="comment">//</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">swap</span>(heap[largest], heap[cur]);</span><br><span class="line"><span class="built_in">heaplify</span>(largest);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">push</span><span class="params">(<span class="type">int</span> var)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (indexMap.<span class="built_in">find</span>(var) != indexMap.<span class="built_in">end</span>())<span class="comment">//</span></span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">heap.<span class="built_in">push_back</span>(var);</span><br><span class="line">indexMap.<span class="built_in">emplace</span>(var,heap.<span class="built_in">size</span>()<span class="number">-1</span>);</span><br><span class="line"><span class="built_in">heapInsert</span>(heap.<span class="built_in">size</span>() - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> heap.<span class="built_in">size</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">peek</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> heap[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pop</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">swap</span>(heap[<span class="number">0</span>], heap[heap.<span class="built_in">size</span>() - <span class="number">1</span>]);</span><br><span class="line">indexMap.<span class="built_in">erase</span>(heap[heap.<span class="built_in">size</span>()<span class="number">-1</span>]);</span><br><span class="line">heap.<span class="built_in">pop_back</span>();</span><br><span class="line"><span class="built_in">heaplify</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">remove</span><span class="params">(<span class="type">int</span> var)</span> </span>&#123;</span><br><span class="line"><span class="type">int</span> index = indexMap.<span class="built_in">find</span>(var)-&gt;second;</span><br><span class="line"><span class="built_in">swap</span>(heap[index], heap[heap.<span class="built_in">size</span>() - <span class="number">1</span>]);</span><br><span class="line">indexMap.<span class="built_in">erase</span>(heap[heap.<span class="built_in">size</span>() - <span class="number">1</span>]);<span class="comment">//var</span></span><br><span class="line">heap.<span class="built_in">pop_back</span>();</span><br><span class="line"><span class="keyword">if</span> (index != heap.<span class="built_in">size</span>())<span class="comment">//poppopheap.size()-1</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">heaplify</span>(index);</span><br><span class="line"><span class="built_in">heapInsert</span>(index);<span class="comment">//</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">modify</span><span class="params">(<span class="type">int</span> var1, <span class="type">int</span> var2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (var1 == var2)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="type">int</span> index = indexMap.<span class="built_in">find</span>(var1)-&gt;second;</span><br><span class="line">heap[index] = var2;</span><br><span class="line">indexMap.<span class="built_in">emplace</span>(var2, index);</span><br><span class="line">indexMap.<span class="built_in">erase</span>(var1);</span><br><span class="line"><span class="built_in">heaplify</span>(index);</span><br><span class="line"><span class="built_in">heapInsert</span>(index);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">heapGreater shit;</span><br><span class="line">shit.<span class="built_in">push</span>(<span class="number">5</span>);</span><br><span class="line">shit.<span class="built_in">push</span>(<span class="number">10</span>);</span><br><span class="line">shit.<span class="built_in">push</span>(<span class="number">4</span>);</span><br><span class="line">shit.<span class="built_in">push</span>(<span class="number">1</span>);</span><br><span class="line">shit.<span class="built_in">push</span>(<span class="number">32</span>);</span><br><span class="line">shit.<span class="built_in">push</span>(<span class="number">50</span>);</span><br><span class="line">shit.<span class="built_in">push</span>(<span class="number">60</span>);</span><br><span class="line">shit.<span class="built_in">modify</span>(<span class="number">10</span>, <span class="number">121</span>);</span><br><span class="line">shit.<span class="built_in">remove</span>(<span class="number">32</span>);</span><br><span class="line"><span class="keyword">while</span> (shit.<span class="built_in">size</span>() != <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; shit.<span class="built_in">peek</span>() &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">shit.<span class="built_in">pop</span>();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mysql-</title>
      <link href="/2022/09/28/Mysql%E5%9F%BA%E7%A1%80-%E7%BA%A6%E6%9D%9F/"/>
      <url>/2022/09/28/Mysql%E5%9F%BA%E7%A1%80-%E7%BA%A6%E6%9D%9F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong></strong></p><h3 id="font-color-red--font"><font color='red'></font></h3><p>PRIMARY KEY MySQL  DBMS </p><ul><li><strong></strong></li><li><strong></strong></li><li><strong> NULL</strong> </li><li></li><li><strong></strong></li></ul><p><strong><mark class="hl-label blue"></mark> </strong></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category> MySQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title> TopK</title>
      <link href="/2022/09/24/%E5%8A%A0%E5%BC%BA%E5%A0%86%E5%8F%8A%E5%85%B6%E7%9B%B8%E5%85%B3%E9%A2%98%E7%9B%AE/"/>
      <url>/2022/09/24/%E5%8A%A0%E5%BC%BA%E5%A0%86%E5%8F%8A%E5%85%B6%E7%9B%B8%E5%85%B3%E9%A2%98%E7%9B%AE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong><mark class="hl-label blue"></mark> </strong><br>, [start, end] 12&gt;=1,</p><p><strong><mark class="hl-label blue"></mark> </strong></p><p><br> <code>line1.left &gt;= line2.right</code>  <code>line1.right&lt;=line2.left</code> <code>line1.right&lt;line2.left</code> <code>line3.left&gt;line2.right</code>  line2  line1line3 <br><img src="/2022/img/-16641125875741.png" alt="" style="zoom:80%;" /></p><p> <code>line1.left&lt;=line2.left&lt;line1.right</code> line1  line2 ( line2.right )<br><img src="/2022/img/-16641133105063.png" style="zoom:80%;" /></p><p><strong> <code>line2.left&lt;=line1.left&lt;line2.right</code> </strong> <strong><font color='red'> line1  line2 </font></strong> <strong></strong> <br><img src="/2022/img/-16641151643545.png" style="zoom:80%;" /><br> <strong><font color='orange'></font></strong>  <code>line2.left&lt;line1.right</code>  <code>line1.left&lt;=line2.left</code> <br><code>line2.left&lt;line1.right</code>  line2  line1 <code>line3.left=line1.right</code>  line3  line1 <code>line3.left&lt;line2.right</code>  line3  line2  2 line2  line3  3 line1  line1 <br><img src="/2022/img/-16641610218953.png" style="zoom:80%;" /></p><p> line4 3 3<code>line4.left&lt;line2.right</code>  <code>line4.left&lt;line3.right</code>  3 <code>line4.left&lt;line3.right</code>  3 <code>line3.right&lt;line2.right</code>  <code>line4.left&lt;line3.right</code>  <code>line4.left&lt;line2.right</code> <br><img src="/2022/img/-16641621240717.png" style="zoom:80%;" /></p><p><code>line4.left&lt;=line3.right</code>  2&gt;=<code>line4.left&gt;=line2.right</code>  line2 <br><img src="/2022/img/-16641624724099.png" style="zoom:80%;" /><br> <code>line4.left&lt;line3.right</code>  2</p><p><strong> lineN  lineN.left </strong></p><p><br><img src="/2022/img/-166416373697811.png" style="zoom:80%;" /><br>line4  line4  1 2  max  <code>cur&gt;=max</code> , <code>max=cur</code>  <code>cur&lt;max</code>  <code>max=max</code>  <code>max=cur&gt;max?cur:max;</code>  line4 max=2 line4 cur=1cur&lt;max max  2</p><p><br><img src="/2022/img/-166416692487213.png" style="zoom:80%;" /></p><p> right</p><p></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span><span class="comment">//rand()</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span><span class="comment">//time()</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span><span class="comment">//sort()</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span><span class="comment">//memcpy()</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">line</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> start;</span><br><span class="line"><span class="type">int</span> end;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">heapInsert</span><span class="params">(line* arr, <span class="type">int</span> cur)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (arr[(cur - <span class="number">1</span>) / <span class="number">2</span>].end &gt; arr[cur].end)<span class="comment">//</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">swap</span>(arr[(cur - <span class="number">1</span>) / <span class="number">2</span>], arr[cur]);</span><br><span class="line"><span class="built_in">heapInsert</span>(arr, (cur - <span class="number">1</span>) / <span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">heaplify</span><span class="params">(line* arr, <span class="type">int</span> cur, <span class="type">int</span> heapSize)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> leftChd = cur * <span class="number">2</span> + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (leftChd &gt; heapSize<span class="number">-1</span>)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="type">int</span> smallest = leftChd + <span class="number">1</span> &lt; heapSize &amp;&amp; arr[leftChd + <span class="number">1</span>].end &lt; arr[leftChd].end ? leftChd + <span class="number">1</span> : leftChd;<span class="comment">//</span></span><br><span class="line"><span class="keyword">if</span> (arr[smallest].end &lt; arr[cur].end)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">swap</span>(arr[smallest], arr[cur]);</span><br><span class="line"><span class="built_in">heaplify</span>(arr, smallest, heapSize);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">heapPop</span><span class="params">(line* arr, <span class="type">int</span>&amp; heapSize)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">swap</span>(arr[<span class="number">0</span>], arr[heapSize - <span class="number">1</span>]);</span><br><span class="line">heapSize--;</span><br><span class="line"><span class="built_in">heaplify</span>(arr, <span class="number">0</span>, heapSize);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//====================================================================================================</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="function">line* <span class="title">generateRandomline</span><span class="params">(<span class="type">int</span> max, <span class="type">int</span> size)</span> </span>&#123;</span><br><span class="line">line* arr = <span class="keyword">new</span> line[size];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; size; i++)</span><br><span class="line">&#123;</span><br><span class="line">arr[i].start = <span class="built_in">rand</span>() % max;</span><br><span class="line">arr[i].end = <span class="built_in">rand</span>() % max;</span><br><span class="line"><span class="keyword">if</span> (arr[i].start == arr[i].end)</span><br><span class="line">arr[i].end += (<span class="built_in">rand</span>() % max / <span class="number">2</span>);</span><br><span class="line"><span class="keyword">if</span> (arr[i].start &gt; arr[i].end)</span><br><span class="line"><span class="built_in">swap</span>(arr[i].start, arr[i].end);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">line* <span class="title">cpyArr</span><span class="params">(line* src, <span class="type">int</span> size)</span> </span>&#123;</span><br><span class="line">line* des = <span class="keyword">new</span> line[size];</span><br><span class="line"><span class="built_in">memcpy</span>(des, src, size * <span class="built_in">sizeof</span>(line));</span><br><span class="line"><span class="keyword">return</span> des;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">maxCover2</span><span class="params">(line* arr, <span class="type">int</span> size)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> minStart = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> maxEnd = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">sort</span>(&amp;arr[<span class="number">0</span>], &amp;arr[size], [](line a, line b) &#123;<span class="keyword">return</span> a.start &lt; b.start; &#125;);</span><br><span class="line">minStart = arr[<span class="number">0</span>].start;</span><br><span class="line"><span class="built_in">sort</span>(&amp;arr[<span class="number">0</span>], &amp;arr[size], [](line a, line b) &#123;<span class="keyword">return</span> a.end &gt; b.end; &#125;);</span><br><span class="line">maxEnd = arr[<span class="number">0</span>].end;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; maxEnd - minStart; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> tmp = <span class="number">0</span>;</span><br><span class="line"><span class="type">double</span> point = (<span class="type">double</span>)minStart + (<span class="type">double</span>)i + <span class="number">0.5</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; size; k++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> ((<span class="type">double</span>)arr[k].start&lt;point &amp;&amp; (<span class="type">double</span>)arr[k].end&gt;point)</span><br><span class="line">tmp++;</span><br><span class="line">&#125;</span><br><span class="line">count = count &gt; tmp ? count : tmp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//==================================================================================================</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">maxCover</span><span class="params">(line* arr, <span class="type">int</span> size)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (size == <span class="number">0</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> heapSize = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> p = <span class="number">1</span>;</span><br><span class="line"><span class="built_in">sort</span>(&amp;arr[<span class="number">0</span>], &amp;arr[size], [](line a, line b) &#123;<span class="keyword">return</span> a.start &lt; b.start; &#125;);</span><br><span class="line"><span class="type">int</span> max = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; size; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (arr[<span class="number">0</span>].end &lt;= arr[i].start &amp;&amp; heapSize &gt; <span class="number">0</span>)<span class="comment">//&lt;=</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">heapPop</span>(arr, heapSize);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">heapSize++;</span><br><span class="line">arr[heapSize - <span class="number">1</span>].end = arr[i].end;</span><br><span class="line"><span class="built_in">heapInsert</span>(arr, heapSize<span class="number">-1</span>);</span><br><span class="line">max = max &gt; heapSize ? max : heapSize;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> max;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">srand</span>(<span class="built_in">time</span>(<span class="literal">NULL</span>));</span><br><span class="line"><span class="type">int</span> testTimes = <span class="number">1000000</span>;<span class="comment">//</span></span><br><span class="line"><span class="type">int</span> arrMaxLen = <span class="number">10000</span>;<span class="comment">//</span></span><br><span class="line"><span class="type">int</span> max = <span class="number">1000</span>;<span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; testTimes; i++) &#123;</span><br><span class="line"><span class="type">int</span> arrLen = <span class="built_in">rand</span>() % arrMaxLen;</span><br><span class="line">line* arr_1 = <span class="built_in">generateRandomline</span>(max, arrLen);</span><br><span class="line">line* arr_2 = <span class="built_in">cpyArr</span>(arr_1, arrLen);</span><br><span class="line"><span class="type">int</span> count_1 = <span class="built_in">maxCover</span>(arr_1, arrLen);</span><br><span class="line"><span class="type">int</span> count_2 = <span class="built_in">maxCover2</span>(arr_2, arrLen);</span><br><span class="line"><span class="keyword">if</span> (count_1 != count_2)</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;count_1 = &quot;</span> &lt;&lt; count_1 &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;count_2 = &quot;</span> &lt;&lt; count_2 &lt;&lt; endl;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; arrLen; i++)</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;[&quot;</span> &lt;&lt; arr_2[i].start &lt;&lt; <span class="string">&quot;,&quot;</span> &lt;&lt; arr_2[i].end &lt;&lt; <span class="string">&quot;]&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">cout &lt;&lt; i &lt;&lt; <span class="string">&quot;  success&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">delete</span> arr_1;</span><br><span class="line"><span class="keyword">delete</span> arr_2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">line* arr = <span class="keyword">new</span> line[<span class="number">8</span>];</span><br><span class="line">arr[<span class="number">0</span>].start = <span class="number">0</span>, arr[<span class="number">0</span>].end = <span class="number">8</span>;</span><br><span class="line">arr[<span class="number">1</span>].start = <span class="number">2</span>, arr[<span class="number">1</span>].end = <span class="number">6</span>;</span><br><span class="line">arr[<span class="number">2</span>].start = <span class="number">1</span>, arr[<span class="number">2</span>].end = <span class="number">5</span>;</span><br><span class="line">arr[<span class="number">3</span>].start = <span class="number">3</span>, arr[<span class="number">3</span>].end = <span class="number">5</span>;</span><br><span class="line">arr[<span class="number">4</span>].start = <span class="number">4</span>, arr[<span class="number">4</span>].end = <span class="number">5</span>;</span><br><span class="line">arr[<span class="number">5</span>].start = <span class="number">3</span>, arr[<span class="number">5</span>].end = <span class="number">4</span>;</span><br><span class="line">arr[<span class="number">6</span>].start = <span class="number">0</span>, arr[<span class="number">6</span>].end = <span class="number">2</span>;</span><br><span class="line">arr[<span class="number">7</span>].start = <span class="number">0</span>, arr[<span class="number">7</span>].end = <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> a = <span class="built_in">maxCover</span>(arr, <span class="number">8</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="font-color-red-TopK-font"><font color='red'>TopK</font></h3><blockquote><p><a href="https://jyxcpp.netlify.app/2022/09/30/%E5%8A%A0%E5%BC%BA%E5%A0%86/"></a> </p></blockquote><h3 id="font-color-red-TopK-font"><font color='red'>TopK</font></h3><p><strong><mark class="hl-label blue"></mark> </strong><br> 8  12  K  12 K<br>1&gt;0<br>2+1-1<br>3 K K  K <br>4 0<br>5 K <strong> K </strong><br>65  6<br>7 <strong></strong> <strong></strong><br>8<strong></strong><br> 78 </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">arr = [<span class="number">3</span> , <span class="number">3</span> , <span class="number">1</span> , <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>]</span><br><span class="line"> op = [T , T , T , T, F, T, F]</span><br></pre></td></tr></table></figure><p> arr[ ] op[ ] 3 3 1 2 1 2 5 </p><p><strong><mark class="hl-label blue"></mark> </strong><br><font color='orange'>K</font> <strong>+</strong> <br><img src="/2022/img/-16648848835431.png" style="zoom: 67%;" /></p><p></p><ol><li>heap1heap2</li><li></li><li> K </li><li></li></ol><p></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;utility&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">client</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> id;</span><br><span class="line"><span class="type">int</span> buy;</span><br><span class="line"><span class="type">int</span> time;</span><br><span class="line"><span class="built_in">client</span>(<span class="type">int</span> _id, <span class="type">int</span> _buy, <span class="type">int</span> _time) :<span class="built_in">id</span>(_id), <span class="built_in">buy</span>(_buy), <span class="built_in">time</span>(_time) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">myKey</span><span class="comment">//const</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="function">std::<span class="type">size_t</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">const</span> client&amp; a)</span><span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> std::<span class="built_in">hash</span>&lt;<span class="type">int</span>&gt;()(a.id);</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">isEqual</span><span class="comment">//const</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">const</span> client&amp; a, <span class="type">const</span> client&amp; b)</span><span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a.id == b.id;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">topK</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">hp</span> &#123; cnd, win &#125;;<span class="comment">//cndcandidatewin</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function">vector&lt;client&gt; <span class="title">batchRank</span><span class="params">()</span></span>;<span class="comment">//1</span></span><br><span class="line"><span class="function">vector&lt;client&gt; <span class="title">add</span><span class="params">(<span class="type">int</span> id, <span class="type">bool</span> buy)</span></span>;<span class="comment">//</span></span><br><span class="line"><span class="built_in">topK</span>(<span class="type">int</span>*user,<span class="type">bool</span>*buy,<span class="type">int</span> size,<span class="type">int</span> k);</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">swap</span><span class="params">(client&amp; a, client&amp; b, hp p)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">heapInsert</span><span class="params">(<span class="type">int</span> cur, hp p)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">heaplify</span><span class="params">(<span class="type">int</span> cur, hp p)</span></span>;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">comparator</span><span class="params">(<span class="type">const</span> client&amp; cur, <span class="type">const</span> client&amp; dad, hp p)</span></span>;<span class="comment">//</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">remove</span><span class="params">(<span class="type">const</span> client&amp; usr, hp p)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">push</span><span class="params">(<span class="type">const</span> client&amp; usr, hp p)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">swapHeapTops</span><span class="params">()</span></span>;<span class="comment">//</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solution</span><span class="params">(<span class="type">int</span> i)</span></span>;<span class="comment">//</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">vector&lt;vector&lt;client&gt;&gt; heap;<span class="comment">//heap[cnd]heap[win]</span></span><br><span class="line">unordered_multimap &lt; client, <span class="type">int</span>, myKey, isEqual&gt; indexMap1;<span class="comment">//</span></span><br><span class="line">unordered_multimap&lt;client, <span class="type">int</span>, myKey, isEqual&gt; indexMap2;<span class="comment">//</span></span><br><span class="line">vector&lt;<span class="type">int</span>&gt;user;<span class="comment">//id</span></span><br><span class="line">vector&lt;<span class="type">bool</span>&gt;buy;<span class="comment">//</span></span><br><span class="line"><span class="type">int</span> k;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function">vector&lt;client&gt; <span class="title">topK::batchRank</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (k &lt;= <span class="number">0</span>||user.<span class="built_in">size</span>()==<span class="number">0</span>||buy.<span class="built_in">size</span>()==<span class="number">0</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">vector</span>&lt;client&gt;();<span class="comment">//</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; user.<span class="built_in">size</span>(); i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">solution</span>(i);</span><br><span class="line">&#125;</span><br><span class="line">vector&lt;client&gt;tops;<span class="comment">//add</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; heap[hp::win].<span class="built_in">end</span>() - heap[hp::win].<span class="built_in">begin</span>(); i++)</span><br><span class="line">&#123;</span><br><span class="line">tops.<span class="built_in">push_back</span>(heap[hp::win][i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">sort</span>(tops.<span class="built_in">begin</span>(), tops.<span class="built_in">end</span>(), [](client a, client b) &#123; </span><br><span class="line"><span class="keyword">return</span> a.buy != b.buy ? a.buy &gt; b.buy:a.time &lt; b.time; &#125;);<span class="comment">//</span></span><br><span class="line"><span class="keyword">return</span> tops;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">vector&lt;client&gt; <span class="title">topK::add</span><span class="params">(<span class="type">int</span> id, <span class="type">bool</span> buy)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">this</span>-&gt;user.<span class="built_in">push_back</span>(id);</span><br><span class="line"><span class="keyword">this</span>-&gt;buy.<span class="built_in">push_back</span>(buy);</span><br><span class="line"><span class="built_in">solution</span>(user.<span class="built_in">size</span>() - <span class="number">1</span>);</span><br><span class="line">vector&lt;client&gt;tops;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; heap[hp::win].<span class="built_in">end</span>() - heap[hp::win].<span class="built_in">begin</span>(); i++)</span><br><span class="line">&#123;</span><br><span class="line">tops.<span class="built_in">push_back</span>(heap[hp::win][i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">sort</span>(tops.<span class="built_in">begin</span>(), tops.<span class="built_in">end</span>(), [](client a, client b) &#123;</span><br><span class="line"><span class="keyword">return</span> a.buy != b.buy ? a.buy &gt; b.buy:a.time &lt; b.time; &#125;);</span><br><span class="line"><span class="keyword">return</span> tops;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">topK::<span class="built_in">topK</span>(<span class="type">int</span>* user,<span class="type">bool</span>* buy,<span class="type">int</span> size,<span class="type">int</span> k)</span><br><span class="line">&#123;</span><br><span class="line">vector&lt;client&gt;heapCnd;</span><br><span class="line">vector&lt;client&gt;heapWin;</span><br><span class="line">heap.<span class="built_in">push_back</span>(heapCnd);</span><br><span class="line">heap.<span class="built_in">push_back</span>(heapWin);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; size; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">this</span>-&gt;user.<span class="built_in">push_back</span>(user[i]);</span><br><span class="line"><span class="keyword">this</span>-&gt;buy.<span class="built_in">push_back</span>(buy[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">this</span>-&gt;k = k;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">topK::swap</span><span class="params">(client&amp; a, client&amp; b,hp p)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    client tmp = a;</span><br><span class="line">a = b;</span><br><span class="line">b = tmp;</span><br><span class="line">    <span class="comment">//</span></span><br><span class="line"><span class="keyword">if</span> (p == hp::cnd)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> t = indexMap1.<span class="built_in">find</span>(a)-&gt;second;</span><br><span class="line">indexMap1.<span class="built_in">find</span>(a)-&gt;second = indexMap1.<span class="built_in">find</span>(b)-&gt;second;</span><br><span class="line">indexMap1.<span class="built_in">find</span>(b)-&gt;second = t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> t = indexMap2.<span class="built_in">find</span>(a)-&gt;second;</span><br><span class="line">indexMap2.<span class="built_in">find</span>(a)-&gt;second = indexMap2.<span class="built_in">find</span>(b)-&gt;second;</span><br><span class="line">indexMap2.<span class="built_in">find</span>(b)-&gt;second = t;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">topK::heapInsert</span><span class="params">(<span class="type">int</span> cur,hp p)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">comparator</span>(heap[p][cur],heap[p][(cur<span class="number">-1</span>)/<span class="number">2</span>],p))</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">swap</span>(heap[p][(cur - <span class="number">1</span>) / <span class="number">2</span>], heap[p][cur], p);</span><br><span class="line"><span class="built_in">heapInsert</span>((cur - <span class="number">1</span>) / <span class="number">2</span>, p);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">topK::heaplify</span><span class="params">(<span class="type">int</span> cur,hp p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> leftChd = cur * <span class="number">2</span> + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (leftChd &gt; (<span class="type">int</span>)heap[p].<span class="built_in">size</span>() - <span class="number">1</span>)<span class="comment">//int!!!!</span></span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="type">int</span> tar = leftChd + <span class="number">1</span> &lt; heap[p].<span class="built_in">size</span>() &amp;&amp; <span class="built_in">comparator</span>(heap[p][leftChd + <span class="number">1</span>], heap[p][leftChd],p) ? leftChd + <span class="number">1</span> : leftChd;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">comparator</span>(heap[p][tar] , heap[p][cur],p))<span class="comment">//</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">swap</span>(heap[p][tar], heap[p][cur],p);</span><br><span class="line"><span class="built_in">heaplify</span>(tar,p);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">topK::comparator</span><span class="params">(<span class="type">const</span> client&amp; cur, <span class="type">const</span> client&amp; dad,hp p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(p==hp::cnd)</span><br><span class="line"><span class="keyword">return</span> cur.buy != dad.buy ? cur.buy &gt; dad.buy:cur.time &lt; dad.time;</span><br><span class="line"><span class="keyword">if</span>(p==hp::win)</span><br><span class="line"><span class="keyword">return</span> cur.buy != dad.buy ? cur.buy &lt; dad.buy : cur.time &lt; dad.time;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">topK::remove</span><span class="params">(<span class="type">const</span> client&amp; usr, hp p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> pos = p == hp::cnd ? indexMap1.<span class="built_in">find</span>(usr)-&gt;second : indexMap2.<span class="built_in">find</span>(usr)-&gt;second;</span><br><span class="line"><span class="built_in">swap</span>(heap[p][heap[p].<span class="built_in">size</span>() - <span class="number">1</span>], heap[p][pos], p);</span><br><span class="line">heap[p].<span class="built_in">pop_back</span>();</span><br><span class="line">p == hp::cnd ? indexMap1.<span class="built_in">erase</span>(usr) : indexMap2.<span class="built_in">erase</span>(usr);</span><br><span class="line"><span class="keyword">if</span> (pos != heap[p].<span class="built_in">size</span>())</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">heapInsert</span>(pos, p);</span><br><span class="line"><span class="built_in">heaplify</span>(pos, p);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">topK::push</span><span class="params">(<span class="type">const</span> client&amp; usr, hp p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">heap[p].<span class="built_in">push_back</span>(usr);</span><br><span class="line">p == hp::cnd ? indexMap1.<span class="built_in">emplace</span>(usr, heap[p].<span class="built_in">size</span>() - <span class="number">1</span>) : indexMap2.<span class="built_in">emplace</span>(usr, heap[p].<span class="built_in">size</span>() - <span class="number">1</span>);</span><br><span class="line"><span class="built_in">heapInsert</span>(heap[p].<span class="built_in">size</span>() - <span class="number">1</span>, p);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">topK::swapHeapTops</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">indexMap1.<span class="built_in">erase</span>(heap[hp::cnd][<span class="number">0</span>]);</span><br><span class="line">indexMap2.<span class="built_in">erase</span>(heap[hp::win][<span class="number">0</span>]);</span><br><span class="line">indexMap1.<span class="built_in">emplace</span>(heap[hp::win][<span class="number">0</span>], <span class="number">0</span>);</span><br><span class="line">indexMap2.<span class="built_in">emplace</span>(heap[hp::cnd][<span class="number">0</span>], <span class="number">0</span>);</span><br><span class="line">client tmp = heap[hp::cnd][<span class="number">0</span>];</span><br><span class="line">heap[hp::cnd][<span class="number">0</span>] = heap[hp::win][<span class="number">0</span>];</span><br><span class="line">heap[hp::win][<span class="number">0</span>] = tmp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">topK::solution</span><span class="params">(<span class="type">int</span> i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function">client <span class="title">tmp</span><span class="params">(user[i], <span class="number">0</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line"><span class="keyword">if</span> (indexMap1.<span class="built_in">find</span>(tmp) != indexMap1.<span class="built_in">end</span>())<span class="comment">//usr</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> pos = indexMap1.<span class="built_in">find</span>(tmp)-&gt;second;</span><br><span class="line">client&amp; usr = heap[hp::cnd][pos];</span><br><span class="line">buy[i] ? usr.buy++ : usr.buy--;</span><br><span class="line">usr.time = i;</span><br><span class="line"><span class="keyword">if</span> (usr.buy &lt;= <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">remove</span>(usr, hp::cnd);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">heapInsert</span>(pos, hp::cnd);</span><br><span class="line"><span class="built_in">heaplify</span>(pos, hp::cnd);</span><br><span class="line"><span class="keyword">if</span> (heap[hp::cnd][<span class="number">0</span>].buy &gt; heap[hp::win][<span class="number">0</span>].buy)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">swapHeapTops</span>();</span><br><span class="line">heap[hp::cnd][<span class="number">0</span>].time = i;</span><br><span class="line">heap[hp::win][<span class="number">0</span>].time = i;<span class="comment">//</span></span><br><span class="line"><span class="built_in">heaplify</span>(<span class="number">0</span>, hp::win);<span class="comment">//</span></span><br><span class="line"><span class="built_in">heaplify</span>(<span class="number">0</span>, hp::cnd);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (indexMap2.<span class="built_in">find</span>(tmp) != indexMap2.<span class="built_in">end</span>())<span class="comment">//usr</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> pos = indexMap2.<span class="built_in">find</span>(tmp)-&gt;second;</span><br><span class="line">client&amp; usr = heap[hp::win][pos];</span><br><span class="line">buy[i] ? usr.buy++ : usr.buy--;</span><br><span class="line">usr.time = i;</span><br><span class="line"><span class="keyword">if</span> (usr.buy &lt;= <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">remove</span>(usr, hp::win);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">heapInsert</span>(pos, hp::win);</span><br><span class="line"><span class="built_in">heaplify</span>(pos, hp::win);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span><span class="comment">//</span></span><br><span class="line">&#123;</span><br><span class="line">buy[i] ? tmp.buy++ : tmp.buy--;</span><br><span class="line">tmp.time = i;</span><br><span class="line"><span class="keyword">if</span> (tmp.buy &lt;= <span class="number">0</span>)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">if</span> (heap[win].<span class="built_in">size</span>() &lt; k)</span><br><span class="line"><span class="built_in">push</span>(tmp, hp::win);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">push</span>(tmp, hp::cnd);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> user[] = &#123; <span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">4</span>&#125;;</span><br><span class="line"><span class="type">bool</span> buy[] = &#123; <span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>&#125;;</span><br><span class="line"><span class="type">int</span> k = <span class="number">3</span>;</span><br><span class="line"><span class="function">topK <span class="title">issue</span><span class="params">(user, buy, <span class="keyword">sizeof</span>(user) / <span class="keyword">sizeof</span>(<span class="type">int</span>), k)</span></span>;</span><br><span class="line"><span class="keyword">auto</span> res = issue.<span class="built_in">batchRank</span>();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> &amp;i : res)</span><br><span class="line">cout &lt;&lt; i.id &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">cout &lt;&lt; endl;</span><br><span class="line">    issue.<span class="built_in">add</span>(<span class="number">4</span>, <span class="literal">true</span>);</span><br><span class="line">res = issue.<span class="built_in">add</span>(<span class="number">4</span>, <span class="literal">true</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span>&amp; i : res)</span><br><span class="line">cout &lt;&lt; i.id &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><ol><li>vector heaplify()  heapInsert()  hp </li><li><a href="https://jyxcpp.netlify.app/2022/09/23/%E5%88%9D%E8%AF%86%E6%AF%94%E8%BE%83%E5%99%A8/"></a> </li></ol>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/09/23/%E5%88%9D%E8%AF%86%E6%AF%94%E8%BE%83%E5%99%A8/"/>
      <url>/2022/09/23/%E5%88%9D%E8%AF%86%E6%AF%94%E8%BE%83%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="font-color-red--font"><font color='red'></font></h3><p></p><ol><li><p><br><strong>C++lambda</strong> </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;utility&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">mySwap</span><span class="params">(T&amp; a, T&amp; b)</span> </span>&#123;</span><br><span class="line">T tmp = a;</span><br><span class="line">a = b;</span><br><span class="line">b = tmp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">stu</span></span><br><span class="line">&#123;</span><br><span class="line">string name;</span><br><span class="line"><span class="type">int</span> age;</span><br><span class="line"><span class="built_in">stu</span>(<span class="type">int</span> _age,string _name):<span class="built_in">age</span>(_age),<span class="built_in">name</span>(_name)&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp1</span><span class="params">(<span class="type">const</span> stu&amp; a, <span class="type">const</span> stu&amp; b)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> a.age &gt; b.age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">cmp2</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">const</span> stu&amp; a,<span class="type">const</span> stu&amp; b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a.age &lt; b.age;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T, <span class="keyword">class</span> comparator&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">mySort</span><span class="params">(T* arr, <span class="type">int</span> size,comparator c=cmp1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;size<span class="number">-1</span>;i++)</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; size - i - <span class="number">1</span>; k++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">c</span>(arr[k], arr[k + <span class="number">1</span>]))<span class="comment">//</span></span><br><span class="line"><span class="built_in">mySwap</span>(arr[k], arr[k + <span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">stu arr[] = &#123; <span class="built_in">stu</span>(<span class="number">22</span>,<span class="string">&quot;xuan&quot;</span>),<span class="built_in">stu</span>(<span class="number">15</span>,<span class="string">&quot;han&quot;</span>),<span class="built_in">stu</span>(<span class="number">18</span>,<span class="string">&quot;shan&quot;</span>) &#125;;</span><br><span class="line"><span class="built_in">mySort</span>&lt;stu&gt;(arr, <span class="built_in">sizeof</span>(arr) / <span class="built_in">sizeof</span>(stu),cmp1);</span><br><span class="line">    <span class="comment">//mySort&lt;stu&gt;(arr, sizeof(arr) / sizeof(stu),cmp2());//()</span></span><br><span class="line">    <span class="comment">//mySort&lt;stu&gt;(arr, sizeof(arr) / sizeof(stu),[](const stu&amp; a,const stu&amp;b)//lambda</span></span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">return</span> a.age&lt;b.age;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> i : arr)</span><br><span class="line">cout &lt;&lt; i.name &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p> C </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">stu</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="type">char</span> name[<span class="number">32</span>];</span><br><span class="line"><span class="type">int</span> age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">mySwap</span><span class="params">(<span class="keyword">struct</span> stu* a, <span class="keyword">struct</span> stu* b)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">stu</span> <span class="title">tmp</span> =</span> *a;</span><br><span class="line">*a = *b;</span><br><span class="line">*b = tmp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">cmp1</span><span class="params">(<span class="keyword">struct</span> stu* a, <span class="keyword">struct</span> stu* b)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> b-&gt;age - a-&gt;age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">mySort</span><span class="params">(<span class="keyword">struct</span> stu* arr, <span class="type">int</span> size, <span class="type">int</span> (*cmp)(<span class="keyword">struct</span> stu*, <span class="keyword">struct</span> stu*))</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; size - <span class="number">1</span>; i++)</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; size - i - <span class="number">1</span>; k++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (cmp(&amp;arr[k], &amp;arr[k + <span class="number">1</span>])&gt;<span class="number">0</span>)</span><br><span class="line">mySwap(&amp;arr[k], &amp;arr[k + <span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">stu</span> <span class="title">arr</span>[] =</span> &#123; &#123;.age=<span class="number">22</span>,.name=<span class="string">&quot;xuan&quot;</span>&#125;,&#123;.age=<span class="number">45</span>,.name=<span class="string">&quot;han&quot;</span>&#125;,&#123;.age=<span class="number">18</span>,.name=<span class="string">&quot;shan&quot;</span>&#125; &#125;;</span><br><span class="line">mySort(arr, <span class="keyword">sizeof</span>(arr) / <span class="keyword">sizeof</span>(<span class="keyword">struct</span> stu), cmp1);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s  &quot;</span>, arr[i].name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong> (functor)  ()   struct  class</strong> <br></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;utility&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">mySwap</span><span class="params">(T&amp; a, T&amp; b)</span> </span>&#123;</span><br><span class="line">T tmp = a;</span><br><span class="line">a = b;</span><br><span class="line">b = tmp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">stu</span></span><br><span class="line">&#123;</span><br><span class="line">string name;</span><br><span class="line"><span class="type">int</span> age;</span><br><span class="line"><span class="built_in">stu</span>(<span class="type">int</span> _age,string _name):<span class="built_in">age</span>(_age),<span class="built_in">name</span>(_name)&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">cmp2</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">const</span> stu&amp; a,<span class="type">const</span> stu&amp; b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a.age &lt; b.age;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T, <span class="keyword">class</span> comparator&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">mySort</span><span class="params">(T* arr, <span class="type">int</span> size,comparator c=cmp1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;size<span class="number">-1</span>;i++)</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; size - i - <span class="number">1</span>; k++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">c</span>(arr[k], arr[k + <span class="number">1</span>]))<span class="comment">//</span></span><br><span class="line"><span class="built_in">mySwap</span>(arr[k], arr[k + <span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">stu arr[] = &#123; <span class="built_in">stu</span>(<span class="number">22</span>,<span class="string">&quot;xuan&quot;</span>),<span class="built_in">stu</span>(<span class="number">15</span>,<span class="string">&quot;han&quot;</span>),<span class="built_in">stu</span>(<span class="number">18</span>,<span class="string">&quot;shan&quot;</span>) &#125;;</span><br><span class="line">    <span class="built_in">mySort</span>&lt;stu&gt;(arr, <span class="built_in">sizeof</span>(arr) / <span class="built_in">sizeof</span>(stu),<span class="built_in">cmp2</span>());<span class="comment">//</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> i : arr)</span><br><span class="line">cout &lt;&lt; i.name &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
          <category>  </category>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/09/22/%E5%A0%86%E4%B8%8E%E5%A0%86%E6%8E%92%E5%BA%8F/"/>
      <url>/2022/09/22/%E5%A0%86%E4%B8%8E%E5%A0%86%E6%8E%92%E5%BA%8F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong><mark class="hl-label blue"></mark> </strong><br> <strong><font color='orange'></font></strong> <br><img src="/2022/img/-16638463052091.png" style="zoom:80%;" /></p><p> <strong><font color='orange'></font></strong> <u></u><u> k  n  i1in i </u><br><img src="/2022/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE-16638465286303.png" alt=""></p><p><strong><mark class="hl-label blue"></mark> </strong><br><strong></strong> <br><img src="/2022/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE-16638474045907.png" alt=""></p><p> i </p><ul><li><code>i=[(i-1)/2]</code> [ ]  9  4[ (4-1) / 2 ] = 1 1 6</li><li><code>i=2*i+1</code> <code>i=2*i+2</code> </li></ul><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong><mark class="hl-label blue"></mark> </strong><br>1()2<br><img src="/2022/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE-16638493337779.png" alt=""></p><p><strong><mark class="hl-label blue"></mark> </strong></p><p><strong><font color='orange'></font></strong> priority queue <strong></strong>  <strong>12 3</strong>  <u></u>  <strong><font color='orange'></font></strong><br><strong></strong> <u> <strong></strong> O(logn)/O(1)</u></p><p><strong><mark class="hl-label blue"></mark> </strong><br></p><ol><li><strong></strong> ) <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(NlogN)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">Nl</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span></li><li><strong></strong>  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span> </li></ol><p><strong><mark class="hl-label red">1.</mark> </strong><br> heapInsert() </p><ol><li>heapSize++ arr[heapSize-1]</li><li> arr[heapSize]  arr[heapSize]  swap  1</li><li>swap  swap</li></ol><p><br><img src="/2022/img/-166390312717915.png" style="zoom:67%;" /><br></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">heapInsert</span><span class="params">(<span class="type">int</span>* arr,<span class="type">int</span> cur)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(arr[(cur<span class="number">-1</span>)/<span class="number">2</span>] &lt; arr[cur])<span class="comment">//</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">swap</span>(arr[(cur<span class="number">-1</span>)/<span class="number">2</span>],arr[cur]);</span><br><span class="line"><span class="built_in">heapInsert</span>(arr,(cur<span class="number">-1</span>)/<span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">createHeap</span><span class="params">(<span class="type">int</span>* arr,<span class="type">int</span> size)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;size;i++)</span><br><span class="line"><span class="built_in">heapInsert</span>(arr, i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li></li><li> 3  &lt;  &gt; </li><li><strong> 3  &lt;  &lt;= <code>cur = 0</code> </strong></li><li>heapInsert()  heapSize swap swap</li></ul><p><strong><mark class="hl-label red">2.</mark> </strong><br> heaplify() <br><img src="/2022/img/-166390135670413.png" style="zoom:80%;" /><br></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">heaplify</span><span class="params">(<span class="type">int</span>* arr, <span class="type">int</span> cur, <span class="type">int</span> heapSize)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> leftChd = cur * <span class="number">2</span> + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (leftChd &gt; heapSize<span class="number">-1</span>)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="type">int</span> largest = leftChd + <span class="number">1</span> &lt; heapSize &amp;&amp; arr[leftChd + <span class="number">1</span>] &gt; arr[leftChd] ? leftChd + <span class="number">1</span> : leftChd;</span><br><span class="line"><span class="keyword">if</span> (arr[largest] &gt; arr[cur])</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">swap</span>(arr[largest], arr[cur]);</span><br><span class="line"><span class="built_in">heaplify</span>(arr, largest, heapSize);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">createHeap</span><span class="params">(<span class="type">int</span>* arr,<span class="type">int</span> size)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = size; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line"><span class="built_in">heaplify</span>(arr, i, size);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>size</code>  <code>heapSize</code> </li><li> 6 </li></ul><p><strong><mark class="hl-label blue"></mark> </strong><br></p><ol><li><p></p></li><li><p>heapSize</p><blockquote><p> arr  heap arr  heapSize<strong> heapSize </strong><br>vector</p></blockquote></li><li><p> heaplify()</p></li></ol><p><br><img src="/2022/img/-166390433704719.png" style="zoom:80%;" /></p><h3 id="font-color-red--font"><font color='red'></font></h3><p> heapSize-1 <br></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span><span class="comment">//rand()</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span><span class="comment">//time()</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span><span class="comment">//memcpy()</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">swap</span><span class="params">(<span class="type">int</span>&amp; a, <span class="type">int</span>&amp; b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> temp = a;</span><br><span class="line">a = b;</span><br><span class="line">b = temp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//===================================================================================================</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">heapInsert</span><span class="params">(<span class="type">int</span>* arr, <span class="type">int</span> cur)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (arr[(cur - <span class="number">1</span>) / <span class="number">2</span>] &lt; arr[cur])<span class="comment">//</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">swap</span>(arr[(cur - <span class="number">1</span>) / <span class="number">2</span>], arr[cur]);</span><br><span class="line"><span class="built_in">heapInsert</span>(arr, (cur - <span class="number">1</span>) / <span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">heaplify</span><span class="params">(<span class="type">int</span>* arr, <span class="type">int</span> cur, <span class="type">int</span> heapSize)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> leftChd = cur * <span class="number">2</span> + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (leftChd &gt; heapSize<span class="number">-1</span>)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="type">int</span> largest = leftChd + <span class="number">1</span> &lt; heapSize &amp;&amp; arr[leftChd + <span class="number">1</span>] &gt; arr[leftChd] ? leftChd + <span class="number">1</span> : leftChd;</span><br><span class="line"><span class="keyword">if</span> (arr[largest] &gt; arr[cur])</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">swap</span>(arr[largest], arr[cur]);</span><br><span class="line"><span class="built_in">heaplify</span>(arr, largest, heapSize);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">heapSort</span><span class="params">(<span class="type">int</span>* arr, <span class="type">int</span> size)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = size; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">heaplify</span>(arr, i, size);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//for (int i = 0; i &lt;= size; i++)</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//heapInsert(arr, i);</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; size; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">swap</span>(arr[<span class="number">0</span>], arr[size - <span class="number">1</span> - i]);</span><br><span class="line"><span class="built_in">heaplify</span>(arr, <span class="number">0</span>, size - i - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//==================================================================================================</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">bubbleSort</span><span class="params">(<span class="type">int</span>* arr, <span class="type">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len - <span class="number">1</span>; i++)</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; len - i - <span class="number">1</span>; k++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (arr[k] &gt; arr[k + <span class="number">1</span>])</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> tmp = arr[k];</span><br><span class="line">arr[k] = arr[k + <span class="number">1</span>];</span><br><span class="line">arr[k + <span class="number">1</span>] = tmp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//====================================================================================================</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="function"><span class="type">int</span>* <span class="title">generateRandomArr</span><span class="params">(<span class="type">int</span> max, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line"><span class="type">int</span>* arr = <span class="keyword">new</span> <span class="type">int</span>[len];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">arr[i] = <span class="built_in">rand</span>() % max;</span><br><span class="line"><span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span>* <span class="title">cpyArr</span><span class="params">(<span class="type">int</span>* src, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line"><span class="type">int</span>* des = <span class="keyword">new</span> <span class="type">int</span>[len];</span><br><span class="line"><span class="built_in">memcpy</span>(des, src, len * <span class="built_in">sizeof</span>(<span class="type">int</span>));</span><br><span class="line"><span class="keyword">return</span> des;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isEqual</span><span class="params">(<span class="type">int</span>* arr_1, <span class="type">int</span>* arr_2, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line"><span class="keyword">if</span> (arr_1[i] != arr_2[i])</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//==================================================================================================</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">srand</span>(<span class="built_in">time</span>(<span class="literal">NULL</span>));</span><br><span class="line"><span class="type">int</span> testTimes = <span class="number">10000</span>;<span class="comment">//</span></span><br><span class="line"><span class="type">int</span> arrMaxLen = <span class="number">10000</span>;<span class="comment">//</span></span><br><span class="line"><span class="type">int</span> max = <span class="number">100000</span>;<span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; testTimes; i++) &#123;</span><br><span class="line"><span class="type">int</span> arrLen = <span class="built_in">rand</span>() % arrMaxLen;</span><br><span class="line"><span class="type">int</span>* arr_1 = <span class="built_in">generateRandomArr</span>(max, arrLen);</span><br><span class="line"><span class="type">int</span>* arr_2 = <span class="built_in">cpyArr</span>(arr_1, arrLen);</span><br><span class="line"><span class="built_in">bubbleSort</span>(arr_1, arrLen);</span><br><span class="line"><span class="built_in">heapSort</span>(arr_2, arrLen);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">isEqual</span>(arr_1, arr_2, arrLen) == <span class="literal">false</span>) &#123;<span class="comment">//</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;fuck!&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; arrLen; i++) <span class="comment">//</span></span><br><span class="line">cout &lt;&lt; arr_1[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">cout &lt;&lt; endl;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; arrLen; i++)</span><br><span class="line">cout &lt;&lt; arr_2[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;success   &quot;</span> &lt;&lt; i &lt;&lt; endl;</span><br><span class="line"><span class="keyword">delete</span> arr_1;</span><br><span class="line"><span class="keyword">delete</span> arr_2;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(NlogN)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">Nl</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span></strong> <br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mn>1</mn><mo>+</mo><mi>l</mi><mi>o</mi><mi>g</mi><mn>2</mn><mo>+</mo><mi>l</mi><mi>o</mi><mi>g</mi><mn>3</mn><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo>&lt;</mo><mi>N</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi></mrow><annotation encoding="application/x-tex">log1+log2+log3+...+logN&lt;NlogN</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">...</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">Nl</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi></mrow><annotation encoding="application/x-tex">NlogN</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">Nl</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> <br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo>&lt;</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mi>N</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mi>N</mi><mo>+</mo><mn>2</mn><mo stretchy="false">)</mo><mo>+</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mi>N</mi><mo>+</mo><mn>3</mn><mo stretchy="false">)</mo><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><mi>l</mi><mi>o</mi><mi>g</mi><mn>2</mn><mi>N</mi><mo>&lt;</mo><mi>N</mi><mi>l</mi><mi>o</mi><mi>g</mi><mn>2</mn><mi>N</mi></mrow><annotation encoding="application/x-tex">NlogN&lt;log(N+1)+log(N+2)+log(N+3)+...+log2N&lt;Nlog2N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">Nl</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">3</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">...</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">Nl</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>  <strong></strong>  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi></mrow><annotation encoding="application/x-tex">NlogN</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">Nl</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(NlogN)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">Nl</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span>  </p><p><strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span></strong> <br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><mfrac><mi>N</mi><mn>2</mn></mfrac><mo></mo><mn>0</mn><mo>+</mo><mfrac><mi>N</mi><mn>4</mn></mfrac><mo></mo><mn>1</mn><mo>+</mo><mfrac><mi>N</mi><mn>8</mn></mfrac><mo></mo><mn>2</mn><mo>+</mo><mfrac><mi>N</mi><mn>16</mn></mfrac><mo></mo><mn>3</mn><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><mfrac><mi>N</mi><msup><mn>2</mn><mrow><mn>1</mn><mo>+</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi></mrow></msup></mfrac><mo></mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi></mrow><annotation encoding="application/x-tex">M=\frac{N}{2}0+\frac{N}{4}1+\frac{N}{8}2+\frac{N}{16}3+...+\frac{N}{2^{1+logN}}logN</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2173em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.2173em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.2173em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.2173em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">16</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">...</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.2298em;vertical-align:-0.3574em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.6426em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.782em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.3574em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></p><p> M  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span> <br><strong>heapInsert  heaplify  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(logN)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span></strong> </p><p><strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(NlogN)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">Nl</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span></strong>  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(NlogN)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">Nl</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span> <br><strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></strong> <strong>heapSize </strong> </p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category>  </category>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL-</title>
      <link href="/2022/09/18/MySQL-%E7%B4%A2%E5%BC%95/"/>
      <url>/2022/09/18/MySQL-%E7%B4%A2%E5%BC%95/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="font-color-red--font"><font color='red'></font></h3><p> MySQL </p><ol><li><strong></strong></li></ol><p> <strong></strong> </p><ol start="2"><li><strong></strong></li></ol><p> B+ <a href="https://zhuanlan.zhihu.com/p/77383599">Mysql</a> .</p><p>12<strong></strong> <strong></strong> <strong></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> stu_info;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+------+-------+</span></span><br><span class="line"><span class="operator">|</span> ID    <span class="operator">|</span> name <span class="operator">|</span> age  <span class="operator">|</span> score <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+------+-------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">12134</span> <span class="operator">|</span> Jack <span class="operator">|</span>   <span class="number">18</span> <span class="operator">|</span>   <span class="number">150</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">12135</span> <span class="operator">|</span> Mike <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span>   <span class="number">149</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">12136</span> <span class="operator">|</span> Dan  <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span>   <span class="number">130</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">12137</span> <span class="operator">|</span> Xuan <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span>   <span class="number">141</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+------+-------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> INDEX <span class="keyword">FROM</span> stu_info;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Table</span>    <span class="operator">|</span> Non_unique <span class="operator">|</span> Key_name <span class="operator">|</span> Seq_in_index <span class="operator">|</span> Column_name <span class="operator">|</span> <span class="keyword">Collation</span> <span class="operator">|</span> <span class="keyword">Cardinality</span> <span class="operator">|</span> Sub_part <span class="operator">|</span> Packed <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Index_type <span class="operator">|</span> Comment <span class="operator">|</span> Index_comment <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span></span><br><span class="line"><span class="operator">|</span> stu_info <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span> ID       <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> ID          <span class="operator">|</span> A         <span class="operator">|</span>           <span class="number">1</span> <span class="operator">|</span>        <span class="number">4</span> <span class="operator">|</span> <span class="keyword">NULL</span>   <span class="operator">|</span> YES  <span class="operator">|</span> BTREE      <span class="operator">|</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> stu_info <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span> score    <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> score       <span class="operator">|</span> A         <span class="operator">|</span>           <span class="number">4</span> <span class="operator">|</span>     <span class="keyword">NULL</span> <span class="operator">|</span> <span class="keyword">NULL</span>   <span class="operator">|</span> YES  <span class="operator">|</span> BTREE      <span class="operator">|</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> EXPLAIN <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> stu_info <span class="keyword">WHERE</span> score<span class="operator">=</span><span class="number">149</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------+----------+------------+------+---------------+-------+---------+-------+------+----------+-------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> select_type <span class="operator">|</span> <span class="keyword">table</span>    <span class="operator">|</span> partitions <span class="operator">|</span> type <span class="operator">|</span> possible_keys <span class="operator">|</span> key   <span class="operator">|</span> key_len <span class="operator">|</span> <span class="keyword">ref</span>   <span class="operator">|</span> <span class="keyword">rows</span> <span class="operator">|</span> filtered <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------+----------+------------+------+---------------+-------+---------+-------+------+----------+-------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> SIMPLE      <span class="operator">|</span> stu_info <span class="operator">|</span> <span class="keyword">NULL</span>       <span class="operator">|</span> <span class="keyword">ref</span>  <span class="operator">|</span> score         <span class="operator">|</span> score <span class="operator">|</span> <span class="number">5</span>       <span class="operator">|</span> const <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span>   <span class="number">100.00</span> <span class="operator">|</span> <span class="keyword">NULL</span>  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------+----------+------------+------+---------------+-------+---------+-------+------+----------+-------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span>, <span class="number">1</span> warning (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> EXPLAIN <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> stu_info <span class="keyword">WHERE</span> name<span class="operator">=</span><span class="string">&#x27;Jack&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------+----------+------------+------+---------------+------+---------+------+------+----------+-------------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> select_type <span class="operator">|</span> <span class="keyword">table</span>    <span class="operator">|</span> partitions <span class="operator">|</span> type <span class="operator">|</span> possible_keys <span class="operator">|</span> key  <span class="operator">|</span> key_len <span class="operator">|</span> <span class="keyword">ref</span>  <span class="operator">|</span> <span class="keyword">rows</span> <span class="operator">|</span> filtered <span class="operator">|</span> Extra       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------+----------+------------+------+---------------+------+---------+------+------+----------+-------------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> SIMPLE      <span class="operator">|</span> stu_info <span class="operator">|</span> <span class="keyword">NULL</span>       <span class="operator">|</span> <span class="keyword">ALL</span>  <span class="operator">|</span> <span class="keyword">NULL</span>          <span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span>    <span class="number">4</span> <span class="operator">|</span>    <span class="number">25.00</span> <span class="operator">|</span> <span class="keyword">Using</span> <span class="keyword">where</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------+----------+------------+------+---------------+------+---------+------+------+----------+-------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span>, <span class="number">1</span> warning (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p> EXPLAIN  score  1 name  4</p><h3 id="font-color-red--font"><font color='red'></font></h3><h4 id="font-color-gree--font"><font color='gree'></font></h4><ol><li><p><strong></strong> <br> MySQL <strong></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> INDEX index_id <span class="keyword">ON</span> tb_student(id);</span><br></pre></td></tr></table></figure></li><li><p><strong></strong> <br><strong></strong> <strong></strong> </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">UNIQUE</span> INDEX index_id <span class="keyword">ON</span> tb_student(id);</span><br></pre></td></tr></table></figure></li><li><p><strong></strong> <br><strong></strong>  <code>PRIMARY KEY</code>  <code>CREATE INDEX</code> </p></li><li><p><strong></strong> <br> GEOMETRY</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> SPATIAL INDEX index_line <span class="keyword">ON</span> tb_student(line);</span><br></pre></td></tr></table></figure></li><li><p><strong></strong> <br> CHARVARCHAR  TEXT <strong> MySQL  MyISAM </strong>  mysql  Solr  ElasticSearch</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> FULLTEXT INDEX index_info <span class="keyword">ON</span> tb_student(info);</span><br></pre></td></tr></table></figure></li></ol><h4 id="font-color-gree--font"><font color='gree'></font></h4><ol><li><p><strong>BTREE</strong> <br> B-B- ORDER BY  B-</p><ul><li></li><li></li><li></li></ul></li><li><p><strong></strong><br> MEMORY  HEAP MEMORY  B- HASH  HASH  BTREE </p><ul><li> B-</li><li> = IN()  &lt;=&gt;</li><li> HASH </li><li>HASH  HASH .</li></ul><table><thead><tr><th><strong></strong></th><th><strong></strong></th></tr></thead><tbody><tr><td>MyISAM</td><td>BTREE</td></tr><tr><td>InnoDB</td><td>BTREE</td></tr><tr><td>MEMORY/HEAP</td><td>HASH, BTREE</td></tr></tbody></table></li></ol><h4 id="font-color-gree--font"><font color='gree'></font></h4><ol><li><p><strong></strong> <br></p></li><li><p><strong></strong> <br><strong></strong> <strong><u></u></strong>  idname  sex  id </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> INDEX index_na <span class="keyword">ON</span> tb_student(id,name,sex);</span><br></pre></td></tr></table></figure></li></ol><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong><mark class="hl-label blue"> CREATE INDEX </mark> </strong><br> CREATE INDEX <strong></strong> </p><p></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="operator">&lt;</span><span class="operator">&gt;</span> <span class="keyword">ON</span> <span class="operator">&lt;</span><span class="operator">&gt;</span> (<span class="operator">&lt;</span><span class="operator">&gt;</span> [<span class="operator">&lt;</span><span class="operator">&gt;</span>] [ <span class="keyword">ASC</span> <span class="operator">|</span> <span class="keyword">DESC</span>])</span><br></pre></td></tr></table></figure><ul><li><p><code>&lt;&gt;</code>  length <strong></strong>  255 MyISAM  InnoDB  1000 <strong>BLOB  TEXT </strong> </p><blockquote><p>255 MyISAM  InnoDB 1000CREATE  INDEX<br></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> stu_info;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+------+-------+</span></span><br><span class="line"><span class="operator">|</span> ID    <span class="operator">|</span> name <span class="operator">|</span> age  <span class="operator">|</span> score <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+------+-------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">12134</span> <span class="operator">|</span> Jack <span class="operator">|</span>   <span class="number">18</span> <span class="operator">|</span>   <span class="number">150</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">12135</span> <span class="operator">|</span> Mike <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span>   <span class="number">149</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">12136</span> <span class="operator">|</span> Dan  <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span>   <span class="number">130</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">12137</span> <span class="operator">|</span> Xuan <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span>   <span class="number">141</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">12345</span> <span class="operator">|</span> Mike <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span>   <span class="number">120</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+------+-------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> INDEX <span class="keyword">FROM</span> stu_info;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Table</span>    <span class="operator">|</span> Non_unique <span class="operator">|</span> Key_name <span class="operator">|</span> Seq_in_index <span class="operator">|</span> Column_name <span class="operator">|</span> <span class="keyword">Collation</span> <span class="operator">|</span> <span class="keyword">Cardinality</span> <span class="operator">|</span> Sub_part <span class="operator">|</span> Packed <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Index_type <span class="operator">|</span> Comment <span class="operator">|</span> Index_comment <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span></span><br><span class="line"><span class="operator">|</span> stu_info <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span> ID       <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> ID          <span class="operator">|</span> A         <span class="operator">|</span>           <span class="number">1</span> <span class="operator">|</span>        <span class="number">4</span> <span class="operator">|</span> <span class="keyword">NULL</span>   <span class="operator">|</span> YES  <span class="operator">|</span> BTREE      <span class="operator">|</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> EXPLAIN <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> stu_info <span class="keyword">WHERE</span> ID<span class="operator">=</span><span class="string">&#x27;12134&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------+----------+------------+------+---------------+------+---------+------+------+----------+-------------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> select_type <span class="operator">|</span> <span class="keyword">table</span>    <span class="operator">|</span> partitions <span class="operator">|</span> type <span class="operator">|</span> possible_keys <span class="operator">|</span> key  <span class="operator">|</span> key_len <span class="operator">|</span> <span class="keyword">ref</span>  <span class="operator">|</span> <span class="keyword">rows</span> <span class="operator">|</span> filtered <span class="operator">|</span> Extra       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------+----------+------------+------+---------------+------+---------+------+------+----------+-------------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> SIMPLE      <span class="operator">|</span> stu_info <span class="operator">|</span> <span class="keyword">NULL</span>       <span class="operator">|</span> <span class="keyword">ALL</span>  <span class="operator">|</span> ID            <span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span>    <span class="number">5</span> <span class="operator">|</span>    <span class="number">80.00</span> <span class="operator">|</span> <span class="keyword">Using</span> <span class="keyword">where</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------+----------+------------+------+---------------+------+---------+------+------+----------+-------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span>, <span class="number">1</span> warning (<span class="number">0.00</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> EXPLAIN <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> stu_info <span class="keyword">WHERE</span> ID<span class="operator">=</span><span class="string">&#x27;12345&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------+----------+------------+------+---------------+------+---------+-------+------+----------+-------------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> select_type <span class="operator">|</span> <span class="keyword">table</span>    <span class="operator">|</span> partitions <span class="operator">|</span> type <span class="operator">|</span> possible_keys <span class="operator">|</span> key  <span class="operator">|</span> key_len <span class="operator">|</span> <span class="keyword">ref</span>   <span class="operator">|</span> <span class="keyword">rows</span> <span class="operator">|</span> filtered <span class="operator">|</span> Extra       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------+----------+------------+------+---------------+------+---------+-------+------+----------+-------------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> SIMPLE      <span class="operator">|</span> stu_info <span class="operator">|</span> <span class="keyword">NULL</span>       <span class="operator">|</span> <span class="keyword">ref</span>  <span class="operator">|</span> ID            <span class="operator">|</span> ID   <span class="operator">|</span> <span class="number">15</span>      <span class="operator">|</span> const <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span>   <span class="number">100.00</span> <span class="operator">|</span> <span class="keyword">Using</span> <span class="keyword">where</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------------+----------+------------+------+---------------+------+---------+-------+------+----------+-------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span>, <span class="number">1</span> warning (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p>ID  4</p></blockquote></li><li><p><code>ASC|DESC</code> <code>ASC</code> <code>DESC</code>  <code>ASC</code> </p><blockquote><p>(2005)<code>ASC|DESC</code>  </p></blockquote></li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> stu_info;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+------+-------+</span></span><br><span class="line"><span class="operator">|</span> ID    <span class="operator">|</span> name <span class="operator">|</span> age  <span class="operator">|</span> score <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+------+-------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">12134</span> <span class="operator">|</span> Jack <span class="operator">|</span>   <span class="number">18</span> <span class="operator">|</span>   <span class="number">150</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">12135</span> <span class="operator">|</span> Mike <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span>   <span class="number">149</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">12136</span> <span class="operator">|</span> Dan  <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span>   <span class="number">130</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">12137</span> <span class="operator">|</span> Xuan <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span>   <span class="number">141</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+------+-------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> INDEX ID <span class="keyword">ON</span> stu_info(ID);</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br></pre></td></tr></table></figure><p><strong><mark class="hl-label blue"> CREATE TABLE </mark> </strong> CREATE TABLE CREATE TABLE CREATE TABLE CREATE TABLE </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">###</span><br><span class="line"><span class="keyword">PRIMARY</span> KEY [] (<span class="operator">&lt;</span><span class="operator">&gt;</span>,)</span><br><span class="line">###</span><br><span class="line">KEY <span class="operator">|</span> INDEX [<span class="operator">&lt;</span><span class="operator">&gt;</span>] [<span class="operator">&lt;</span><span class="operator">&gt;</span>] (<span class="operator">&lt;</span><span class="operator">&gt;</span>,)</span><br><span class="line">###</span><br><span class="line"><span class="keyword">UNIQUE</span> [ INDEX <span class="operator">|</span> KEY] [<span class="operator">&lt;</span><span class="operator">&gt;</span>] [<span class="operator">&lt;</span><span class="operator">&gt;</span>] (<span class="operator">&lt;</span><span class="operator">&gt;</span>,)</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> stu (</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> ID <span class="type">VARCHAR</span>(<span class="number">8</span>) <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> `name` <span class="type">VARCHAR</span>(<span class="number">32</span>));</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line">###################################</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test (</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> ID <span class="type">VARCHAR</span>(<span class="number">8</span>) ,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> `name` <span class="type">VARCHAR</span>(<span class="number">32</span>),</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">PRIMARY</span> KEY(ID,`name`));</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line">###################################</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> staff (</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> `name` <span class="type">VARCHAR</span>(<span class="number">32</span>),</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> `mgr`  <span class="type">VARCHAR</span>(<span class="number">32</span>),</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> id     <span class="type">CHAR</span>(<span class="number">8</span>),</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">UNIQUE</span>(id));</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br></pre></td></tr></table></figure><blockquote><p> CREATE TABLE  PRIMARY KEY  PRIMARY KRY(&lt;&gt;) </p></blockquote><p><strong><mark class="hl-label blue"> ALTER TABLE </mark> </strong><br> ALTER TABLE </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">###INDEXKEY</span><br><span class="line"><span class="keyword">ADD</span> INDEX<span class="operator">|</span>KEY [<span class="operator">&lt;</span><span class="operator">&gt;</span>] [<span class="operator">&lt;</span><span class="operator">&gt;</span>] (<span class="operator">&lt;</span><span class="operator">&gt;</span>,)</span><br><span class="line">###</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">PRIMARY</span> KEY [<span class="operator">&lt;</span><span class="operator">&gt;</span>] (<span class="operator">&lt;</span><span class="operator">&gt;</span>,)</span><br><span class="line">###</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">UNIQUE</span> [ INDEX <span class="operator">|</span> KEY] [<span class="operator">&lt;</span><span class="operator">&gt;</span>] [<span class="operator">&lt;</span><span class="operator">&gt;</span>] (<span class="operator">&lt;</span><span class="operator">&gt;</span>,)</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> stu_info <span class="keyword">ADD</span> INDEX (score);</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.03</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br></pre></td></tr></table></figure><blockquote><p><strong></strong> </p></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> INDEX <span class="keyword">FROM</span> <span class="operator">&lt;</span><span class="operator">&gt;</span> </span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> INDEX <span class="keyword">FROM</span> no1sc.staff;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Table</span> <span class="operator">|</span> Non_unique <span class="operator">|</span> Key_name <span class="operator">|</span> Seq_in_index <span class="operator">|</span> Column_name <span class="operator">|</span> <span class="keyword">Collation</span> <span class="operator">|</span> <span class="keyword">Cardinality</span> <span class="operator">|</span> Sub_part <span class="operator">|</span> Packed <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Index_type <span class="operator">|</span> Comment <span class="operator">|</span> Index_comment <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span></span><br><span class="line"><span class="operator">|</span> staff <span class="operator">|</span>          <span class="number">0</span> <span class="operator">|</span> id       <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> id          <span class="operator">|</span> A         <span class="operator">|</span>           <span class="number">0</span> <span class="operator">|</span>     <span class="keyword">NULL</span> <span class="operator">|</span> <span class="keyword">NULL</span>   <span class="operator">|</span> YES  <span class="operator">|</span> BTREE      <span class="operator">|</span>         <span class="operator">|</span>               <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>Table</td><td> tb_stu_info2 </td></tr><tr><td>Non_unique</td><td> 1 0</td></tr><tr><td>Key_name</td><td></td></tr><tr><td>Seq_in_index</td><td> 1</td></tr><tr><td>Column_name</td><td></td></tr><tr><td>Collation</td><td> MySQL A NULL</td></tr><tr><td>Cardinality</td><td>MySQL </td></tr><tr><td>Sub_part</td><td> NULL</td></tr><tr><td>Packed</td><td> NULL</td></tr><tr><td>Null</td><td> NULL NULL YES NO</td></tr><tr><td>Index_type</td><td>BTREEFULLTEXTHASHRTREE</td></tr><tr><td>Comment</td><td></td></tr></tbody></table><h3 id="font-color-red--font"><font color='red'></font></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> INDEX <span class="operator">&lt;</span><span class="operator">&gt;</span> <span class="keyword">ON</span> <span class="operator">&lt;</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> index <span class="keyword">from</span> staff;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Table</span> <span class="operator">|</span> Non_unique <span class="operator">|</span> Key_name <span class="operator">|</span> Seq_in_index <span class="operator">|</span> Column_name <span class="operator">|</span> <span class="keyword">Collation</span> <span class="operator">|</span> <span class="keyword">Cardinality</span> <span class="operator">|</span> Sub_part <span class="operator">|</span> Packed <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Index_type <span class="operator">|</span> Comment <span class="operator">|</span> Index_comment <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span></span><br><span class="line"><span class="operator">|</span> staff <span class="operator">|</span>          <span class="number">0</span> <span class="operator">|</span> id       <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> id          <span class="operator">|</span> A         <span class="operator">|</span>           <span class="number">0</span> <span class="operator">|</span>     <span class="keyword">NULL</span> <span class="operator">|</span> <span class="keyword">NULL</span>   <span class="operator">|</span> YES  <span class="operator">|</span> BTREE      <span class="operator">|</span>         <span class="operator">|</span>               <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">DROP</span> INDEX id <span class="keyword">ON</span> staff;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> index <span class="keyword">from</span> staff;</span><br><span class="line"><span class="keyword">Empty</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong><mark class="hl-label blue"></mark> </strong></p><ol><li><strong>LIKE %</strong></li><li><strong></strong></li><li><strong> OR OR </strong> </li></ol><p><strong><mark class="hl-label blue"></mark> </strong></p><ol><li><p><strong></strong><br></p></li><li><p><strong></strong><br> ORDER BYGROUP BYDISTINCT  UNION </p></li><li><p><strong></strong><br> WHERE  SELECT </p></li><li><p><strong></strong><br>MySQL  MySQL </p></li><li><p><strong></strong><br> CHAR(100)  CHAR(10) </p></li><li><p><strong></strong><br>.</p></li><li><p><strong></strong><br>TEXT  BLOG </p></li><li><p><strong></strong><br></p></li></ol>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category> MySQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL-</title>
      <link href="/2022/09/16/MySQL-%E8%A7%86%E5%9B%BE/"/>
      <url>/2022/09/16/MySQL-%E8%A7%86%E5%9B%BE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong>MySQL View</strong> <strong></strong>  <strong></strong> <strong>.frm</strong> <strong></strong><br> <code>.frm</code>  <code>.ibd</code>  <code>customer_info.frm</code>  <code>customer_view.frm</code>  <code>customer_info.ibd</code> <br><img src="/2022/img/image-20220917103106816.png" alt=""></p><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong><mark class="hl-label blue"></mark> </strong><br><br><strong><mark class="hl-label blue"></mark> </strong><br>(JOIN),JOIN<br><strong><mark class="hl-label blue"></mark> </strong><br>,</p><p><a href="https://cloud.tencent.com/product/cdb?from=10680">MySQL</a>MySQLMySQL</p><h3 id="font-color-red--font"><font color='red'></font></h3><h4 id="font-color-gree--font"><font color='gree'></font></h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> <span class="operator">&lt;</span><span class="operator">&gt;</span> <span class="keyword">AS</span> <span class="operator">&lt;</span><span class="keyword">SELECT</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure><p></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> room_info;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+----------+-------+---------+</span></span><br><span class="line"><span class="operator">|</span> type         <span class="operator">|</span> location <span class="operator">|</span> state <span class="operator">|</span> room_id <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+----------+-------+---------+</span></span><br><span class="line"><span class="operator">|</span>        <span class="operator">|</span> <span class="number">10</span><span class="number">-1</span>     <span class="operator">|</span>     <span class="number">1</span> <span class="operator">|</span> <span class="number">001</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>        <span class="operator">|</span> <span class="number">10</span><span class="number">-2</span>     <span class="operator">|</span>     <span class="number">1</span> <span class="operator">|</span> <span class="number">002</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>        <span class="operator">|</span> <span class="number">10</span><span class="number">-3</span>     <span class="operator">|</span>     <span class="number">0</span> <span class="operator">|</span> <span class="number">003</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>        <span class="operator">|</span> <span class="number">10</span><span class="number">-4</span>     <span class="operator">|</span>     <span class="number">0</span> <span class="operator">|</span> <span class="number">004</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>        <span class="operator">|</span> <span class="number">10</span><span class="number">-5</span>     <span class="operator">|</span>     <span class="number">0</span> <span class="operator">|</span> <span class="number">005</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>        <span class="operator">|</span> <span class="number">11</span><span class="number">-6</span>     <span class="operator">|</span>     <span class="number">0</span> <span class="operator">|</span> <span class="number">006</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>        <span class="operator">|</span> <span class="number">11</span><span class="number">-7</span>     <span class="operator">|</span>     <span class="number">0</span> <span class="operator">|</span> <span class="number">007</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>        <span class="operator">|</span> <span class="number">12</span><span class="number">-8</span>     <span class="operator">|</span>     <span class="number">0</span> <span class="operator">|</span> <span class="number">008</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="operator">|</span> <span class="number">12</span><span class="number">-9</span>     <span class="operator">|</span>     <span class="number">0</span> <span class="operator">|</span> <span class="number">009</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="operator">|</span> <span class="number">13</span><span class="number">-10</span>    <span class="operator">|</span>     <span class="number">0</span> <span class="operator">|</span> <span class="number">010</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="operator">|</span> <span class="number">10</span><span class="number">-11</span>    <span class="operator">|</span>     <span class="number">1</span> <span class="operator">|</span> <span class="number">011</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+----------+-------+---------+</span></span><br><span class="line"><span class="number">11</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> type_info;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------------+-------+----------+</span></span><br><span class="line"><span class="operator">|</span> id   <span class="operator">|</span> type         <span class="operator">|</span> price <span class="operator">|</span> capacity <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------------+-------+----------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span>        <span class="operator">|</span>   <span class="number">150</span> <span class="operator">|</span> <span class="number">2</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">2</span> <span class="operator">|</span>        <span class="operator">|</span>   <span class="number">200</span> <span class="operator">|</span> <span class="number">2</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">3</span> <span class="operator">|</span>        <span class="operator">|</span>   <span class="number">210</span> <span class="operator">|</span> <span class="number">2</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">4</span> <span class="operator">|</span>      <span class="operator">|</span>   <span class="number">400</span> <span class="operator">|</span> <span class="number">4</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">5</span> <span class="operator">|</span>      <span class="operator">|</span>   <span class="number">600</span> <span class="operator">|</span> <span class="number">4</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------------+-------+----------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> customer_info;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------+------+-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> name   <span class="operator">|</span> ID     <span class="operator">|</span> age  <span class="operator">|</span> tel         <span class="operator">|</span> room_id <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------+------+-------------+---------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> <span class="number">511323</span> <span class="operator">|</span>   <span class="number">18</span> <span class="operator">|</span> <span class="number">18990889826</span> <span class="operator">|</span> <span class="number">002</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> <span class="number">511345</span> <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span> <span class="number">17390199497</span> <span class="operator">|</span> <span class="number">011</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> <span class="number">532435</span> <span class="operator">|</span>   <span class="number">45</span> <span class="operator">|</span> <span class="number">18932981949</span> <span class="operator">|</span> <span class="number">002</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> <span class="number">343234</span> <span class="operator">|</span>   <span class="number">34</span> <span class="operator">|</span> <span class="number">14342324323</span> <span class="operator">|</span> <span class="number">001</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> <span class="number">343323</span> <span class="operator">|</span>   <span class="number">23</span> <span class="operator">|</span> <span class="number">32232123343</span> <span class="operator">|</span> <span class="number">002</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------+------+-------------+---------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p><strong>1</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">VIEW</span> customer_view</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">AS</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> `name`, room_id <span class="keyword">FROM</span> customer_info;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> customer_view;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------+</span></span><br><span class="line"><span class="operator">|</span> name   <span class="operator">|</span> room_id <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> <span class="number">002</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> <span class="number">011</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> <span class="number">002</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> <span class="number">001</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> <span class="number">002</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p><strong>2</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">VIEW</span> customer_view2</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">AS</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> name, room_info.room_id, room_info.type</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> customer_info,  room_info</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> customer_info.room_id<span class="operator">=</span>room_info.room_id;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> customer_view2;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------+--------------+</span></span><br><span class="line"><span class="operator">|</span> name   <span class="operator">|</span> room_id <span class="operator">|</span> type         <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------+--------------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> <span class="number">001</span>     <span class="operator">|</span>          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> <span class="number">002</span>     <span class="operator">|</span>          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> <span class="number">002</span>     <span class="operator">|</span>          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> <span class="number">002</span>     <span class="operator">|</span>          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> <span class="number">011</span>     <span class="operator">|</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------+--------------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p>3</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">VIEW</span> customer_view3</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">AS</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> name</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> customer_view2;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> customer_view3;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+</span></span><br><span class="line"><span class="operator">|</span> name   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+</span></span><br></pre></td></tr></table></figure><p><strong></strong> <strong> TEMPORARY  TEMPORARY </strong></p><p> SELECT </p><ul><li><strong> CREATE VIEW </strong></li><li>SELECT </li><li>SELECT  FROM </li><li>SELECT </li></ul><h4 id="font-color-gree--font"><font color='gree'></font></h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> <span class="operator">&lt;</span><span class="number">1</span><span class="operator">&gt;</span> [ , <span class="operator">&lt;</span><span class="number">2</span><span class="operator">&gt;</span> ]</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">DROP</span> <span class="keyword">VIEW</span> customer_view2;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p> <code>customer_view2</code> <code>customer_view3</code> </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> customer_view3;</span><br><span class="line">ERROR <span class="number">1356</span> (HY000): <span class="keyword">View</span> <span class="string">&#x27;custom_info.customer_view3&#x27;</span> <span class="keyword">references</span> invalid <span class="keyword">table</span>(s) <span class="keyword">or</span> <span class="keyword">column</span>(s) <span class="keyword">or</span> <span class="keyword">function</span>(s) <span class="keyword">or</span> definer<span class="operator">/</span>invoker <span class="keyword">of</span> <span class="keyword">view</span> lack rights <span class="keyword">to</span> use them</span><br></pre></td></tr></table></figure><p> <code>CHECK TABLE</code> </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CHECK</span> <span class="keyword">TABLE</span> customer_view3 \G;</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">   <span class="keyword">Table</span>: custom_info.customer_view3</span><br><span class="line">      Op: <span class="keyword">check</span></span><br><span class="line">Msg_type: Error</span><br><span class="line">Msg_text: <span class="keyword">Table</span> <span class="string">&#x27;custom_info.customer_view2&#x27;</span> doesn<span class="string">&#x27;t exist</span></span><br><span class="line"><span class="string">*************************** 2. row ***************************</span></span><br><span class="line"><span class="string">   Table: custom_info.customer_view3</span></span><br><span class="line"><span class="string">      Op: check</span></span><br><span class="line"><span class="string">Msg_type: Error</span></span><br><span class="line"><span class="string">Msg_text: View &#x27;</span>custom_info.customer_view3<span class="string">&#x27; references invalid table(s) or column(s) or function(s) or definer/invoker of view lack rights to use them</span></span><br><span class="line"><span class="string">*************************** 3. row ***************************</span></span><br><span class="line"><span class="string">   Table: custom_info.customer_view3</span></span><br><span class="line"><span class="string">      Op: check</span></span><br><span class="line"><span class="string">Msg_type: error</span></span><br><span class="line"><span class="string">Msg_text: Corrupt</span></span><br><span class="line"><span class="string">3 rows in set (0.00 sec)</span></span><br></pre></td></tr></table></figure><p> 6  <code>customer_view2</code> </p><h4 id="font-color-gree--font"><font color='gree'></font></h4><p>1</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">DESC</span> demo_view1;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field <span class="operator">|</span> Type        <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> name  <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">32</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> age   <span class="operator">|</span> tinyint(<span class="number">4</span>)  <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p>2</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> demo_view1 \G;</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">                <span class="keyword">View</span>: demo_view1</span><br><span class="line">         <span class="keyword">Create</span> <span class="keyword">View</span>: <span class="keyword">CREATE</span> ALGORITHM<span class="operator">=</span>UNDEFINED DEFINER<span class="operator">=</span>`root`@`localhost` <span class="keyword">SQL</span> SECURITY DEFINER <span class="keyword">VIEW</span> `demo_view1` <span class="keyword">AS</span> <span class="keyword">select</span> `stuinfo`.`name` <span class="keyword">AS</span> `name`,`stuinfo`.`age` <span class="keyword">AS</span> `age` <span class="keyword">from</span> `stuinfo` <span class="keyword">order</span> <span class="keyword">by</span> `stuinfo`.`age`</span><br><span class="line">character_set_client: utf8</span><br><span class="line">collation_connection: utf8_general_ci</span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line">######</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">VIEW</span> demo_view1 \G;</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">                <span class="keyword">View</span>: demo_view1</span><br><span class="line">         <span class="keyword">Create</span> <span class="keyword">View</span>: <span class="keyword">CREATE</span> ALGORITHM<span class="operator">=</span>UNDEFINED DEFINER<span class="operator">=</span>`root`@`localhost` <span class="keyword">SQL</span> SECURITY DEFINER <span class="keyword">VIEW</span> `demo_view1` <span class="keyword">AS</span> <span class="keyword">select</span> `stuinfo`.`name` <span class="keyword">AS</span> `name`,`stuinfo`.`age` <span class="keyword">AS</span> `age` <span class="keyword">from</span> `stuinfo` <span class="keyword">order</span> <span class="keyword">by</span> `stuinfo`.`age`</span><br><span class="line">character_set_client: utf8</span><br><span class="line">collation_connection: utf8_general_ci</span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p>3</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> <span class="keyword">TABLE</span> STATUS \G;</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">2.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           Name: demo_view1</span><br><span class="line">         Engine: <span class="keyword">NULL</span></span><br><span class="line">        Version: <span class="keyword">NULL</span></span><br><span class="line">     Row_format: <span class="keyword">NULL</span></span><br><span class="line">           <span class="keyword">Rows</span>: <span class="keyword">NULL</span></span><br><span class="line"> Avg_row_length: <span class="keyword">NULL</span></span><br><span class="line">    Data_length: <span class="keyword">NULL</span></span><br><span class="line">Max_data_length: <span class="keyword">NULL</span></span><br><span class="line">   Index_length: <span class="keyword">NULL</span></span><br><span class="line">      Data_free: <span class="keyword">NULL</span></span><br><span class="line"> Auto_increment: <span class="keyword">NULL</span></span><br><span class="line">    Create_time: <span class="keyword">NULL</span></span><br><span class="line">    Update_time: <span class="keyword">NULL</span></span><br><span class="line">     Check_time: <span class="keyword">NULL</span></span><br><span class="line">      <span class="keyword">Collation</span>: <span class="keyword">NULL</span></span><br><span class="line">       Checksum: <span class="keyword">NULL</span></span><br><span class="line"> Create_options: <span class="keyword">NULL</span></span><br><span class="line">        Comment: <span class="keyword">VIEW</span></span><br></pre></td></tr></table></figure><h4 id="font-color-gree--font"><font color='gree'></font></h4><p><strong><mark class="hl-label blue"></mark> </strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">DESC</span> demo_view1;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field <span class="operator">|</span> Type        <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> name  <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">32</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> age   <span class="operator">|</span> tinyint(<span class="number">4</span>)  <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">ALTER</span> <span class="keyword">VIEW</span> demo_view1</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">AS</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> age</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> stuinfo;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">DESC</span> demo_view1;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field <span class="operator">|</span> Type       <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> age   <span class="operator">|</span> tinyint(<span class="number">4</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p></p><p><strong><mark class="hl-label blue"></mark> </strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> customer_view;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------+</span></span><br><span class="line"><span class="operator">|</span> name   <span class="operator">|</span> room_id <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> <span class="number">002</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> <span class="number">011</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> <span class="number">002</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> <span class="number">001</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> <span class="number">002</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">UPDATE</span> customer_view</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SET</span> room_id<span class="operator">=</span><span class="string">&#x27;011&#x27;</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> name<span class="operator">=</span><span class="string">&#x27;&#x27;</span>;</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line"><span class="keyword">Rows</span> matched: <span class="number">1</span>  Changed: <span class="number">1</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> customer_view;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------+</span></span><br><span class="line"><span class="operator">|</span> name   <span class="operator">|</span> room_id <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> <span class="number">011</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> <span class="number">011</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> <span class="number">002</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> <span class="number">001</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> <span class="number">002</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p><strong></strong><br><strong><font color='orange'></font></strong> </p><ul><li> SUM()MIN()MAX()COUNT() </li><li>DISTINCT </li><li>GROUP BY </li><li>HAVING </li><li>UNION  UNION ALL </li><li></li><li>FROM </li><li>WHERE  FROM </li><li>ALGORITHM  TEMPTABLE</li><li><strong></strong></li></ul><p></p><ul><li><strong></strong></li><li><strong></strong> </li></ul>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category> MySQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/09/15/%E8%AF%A6%E8%A7%A3%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F/"/>
      <url>/2022/09/15/%E8%AF%A6%E8%A7%A3%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong><mark class="hl-label blue"></mark> </strong><br> Dijkstra Dijkstra Dutch National Flag Problem  n <strong> N  N  N </strong>  arr[1, 14, 5, 16, 8, 7], N=8, [1, 7, 5, 8, 16, 14]<strong></strong> </p><p><strong><mark class="hl-label blue"></mark> </strong><br>()() <strong>(partition)</strong> <br><img src="/2022/img/-16632545470111.png" alt="" style="zoom:80%;" /></p><p></p><ol><li><strong> L=-1 R=size</strong></li><li>(T)<ul><li><p> N  arr[T]  arr[L+1] T++ <strong><font color='red'>L++</font></strong></p></li><li><p> N T++</p></li><li><p> N  arr[T]  arr[R-1]R<strong><font color='red'> T++ </font></strong></p></li></ul></li><li>T &gt;= R  T==R RT++ T-R=1</li><li><strong><font color='orange'></font></strong></li></ol><p><strong><mark class="hl-label blue"></mark> </strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">netherLandFlag</span><span class="params">(<span class="type">int</span>* arr, <span class="type">int</span> size, <span class="type">int</span> N)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> L = <span class="number">-1</span>;</span><br><span class="line"><span class="type">int</span> R = size;</span><br><span class="line"><span class="type">int</span> T = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (T &lt; R)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (arr[T] &lt; N)</span><br><span class="line"><span class="built_in">swap</span>(arr[T++], arr[++L]);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (arr[T] = N)</span><br><span class="line">T++;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">swap</span>(arr[T], arr[--R]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="font-color-red-1-0-font"><font color='red'>1.0</font></h3><p><strong><font color='orange'></font></strong> <strong><font color='red'> partition(N)</font></strong> N <strong></strong> <br><img src="/2022/img/-16632931991463.png" alt="" style="zoom:80%;" /><br></p><ol><li><strong> R=size R = size-1</strong></li><li><strong> arr[R]  arr[size-1]</strong></li></ol><p><strong><mark class="hl-label blue"></mark> </strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">loc</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> left;</span><br><span class="line"><span class="type">int</span> right;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function">loc <span class="title">netherLandsFlag</span><span class="params">(<span class="type">int</span>* arr, <span class="type">int</span> lower, <span class="type">int</span> upper)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">loc bound;</span><br><span class="line"><span class="keyword">if</span> (lower == upper)</span><br><span class="line">&#123;</span><br><span class="line">bound.left = bound.right = lower;</span><br><span class="line"><span class="keyword">return</span> bound;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> L = lower - <span class="number">1</span>; </span><br><span class="line"><span class="type">int</span> R = upper;</span><br><span class="line"><span class="type">int</span> index = lower;</span><br><span class="line"><span class="keyword">while</span> (index &lt; R)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (arr[index] &lt; arr[upper])</span><br><span class="line"><span class="built_in">swap</span>(arr[index++], arr[++L]);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (arr[index] == arr[upper])</span><br><span class="line">index++;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">swap</span>(arr[index], arr[--R]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">swap</span>(arr[R], arr[upper]);</span><br><span class="line">bound.left = L;</span><br><span class="line">bound.right = R + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">return</span> bound;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">process</span><span class="params">(<span class="type">int</span>* arr, <span class="type">int</span> lower, <span class="type">int</span> upper)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (lower &gt;= upper)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">loc bound = <span class="built_in">netherLandsFlag</span>(arr, lower, upper);</span><br><span class="line"><span class="built_in">process</span>(arr, lower, bound.left);</span><br><span class="line"><span class="built_in">process</span>(arr, bound.right, upper);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li> 21  swap</li><li> lower&gt;=upper lower==upper</li><li><strong> 29  R+1  R</strong> </li></ul><h3 id="font-color-red-2-0-font"><font color='red'>2.0</font></h3><p> N <strong>N (, )</strong> <br><img src="/2022/img/-16632988093595.png" alt="" style="zoom:80%;" /></p><p> K  N-K  N ( <strong> N  N</strong> ) N-1  N  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> </p><p><br><img src="/2022/img/-166330129553810.png" alt="56" style="zoom:80%;" /></p><p> K  N-K  N  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mi>N</mi></mrow><annotation encoding="application/x-tex">log_2N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> ( <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mn>7</mn><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">log_27=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">7</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span> ) <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi></mrow><annotation encoding="application/x-tex">logN</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi></mrow><annotation encoding="application/x-tex">NlogN</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">Nl</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> </p><p> N  N ()<strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi></mrow><annotation encoding="application/x-tex">NlogN</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">Nl</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> </strong></p><p><strong><mark class="hl-label blue"></mark> </strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span><span class="comment">//rand()</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span><span class="comment">//time()</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span><span class="comment">//memcpy()</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">loc</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> left;</span><br><span class="line"><span class="type">int</span> right;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span>* <span class="title">generateRandomArr</span><span class="params">(<span class="type">int</span> max, <span class="type">int</span> len)</span> </span>&#123;<span class="comment">//</span></span><br><span class="line"><span class="type">int</span>* arr = <span class="keyword">new</span> <span class="type">int</span>[len];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">arr[i] = <span class="built_in">rand</span>() % max;</span><br><span class="line"><span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">swap</span><span class="params">(<span class="type">int</span>&amp; a, <span class="type">int</span>&amp; b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> tmp = a;</span><br><span class="line">a = b;</span><br><span class="line">b = tmp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">loc <span class="title">netherLandsFlag</span><span class="params">(<span class="type">int</span>* arr, <span class="type">int</span> lower, <span class="type">int</span> upper)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">loc bound;</span><br><span class="line"><span class="keyword">if</span> (lower == upper)</span><br><span class="line">&#123;</span><br><span class="line">bound.left = bound.right = lower;</span><br><span class="line"><span class="keyword">return</span> bound;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> L = lower - <span class="number">1</span>; </span><br><span class="line"><span class="type">int</span> R = upper;</span><br><span class="line"><span class="type">int</span> index = lower;</span><br><span class="line"><span class="keyword">while</span> (index &lt; R)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (arr[index] &lt; arr[upper])</span><br><span class="line"><span class="built_in">swap</span>(arr[index++], arr[++L]);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (arr[index] == arr[upper])</span><br><span class="line">index++;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">swap</span>(arr[index], arr[--R]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">swap</span>(arr[R], arr[upper]);</span><br><span class="line">bound.left = L;</span><br><span class="line">bound.right = R + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">return</span> bound;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">process</span><span class="params">(<span class="type">int</span>* arr, <span class="type">int</span> lower, <span class="type">int</span> upper)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (lower &gt;= upper)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="built_in">swap</span>(arr[upper], arr[<span class="built_in">rand</span>() % (upper - lower + <span class="number">1</span>) + lower]);</span><br><span class="line">loc bound = <span class="built_in">netherLandsFlag</span>(arr, lower, upper);</span><br><span class="line"><span class="built_in">process</span>(arr, lower, bound.left);</span><br><span class="line"><span class="built_in">process</span>(arr, bound.right, upper);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">quickSort</span><span class="params">(<span class="type">int</span>* arr, <span class="type">int</span> size)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (arr == <span class="literal">nullptr</span> || size == <span class="number">1</span>)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="built_in">process</span>(arr, <span class="number">0</span>, size - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li> 57 </li></ul><h3 id="font-color-red--font"><font color='red'></font></h3><p><code>time=10000</code> <code>max=1000000000</code> <code>size=1000000</code>  1.0  <code>0.6203 ms</code> </p><img src="/2022/img/image-20220920231457291.png" alt="image-20220920231457291" style="zoom:67%;" /><p></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span><span class="comment">//rand()</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span><span class="comment">//time()</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span><span class="comment">//memcpy()</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">loc</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> left;</span><br><span class="line"><span class="type">int</span> right;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span>* <span class="title">generateRandomArr</span><span class="params">(<span class="type">int</span> max, <span class="type">int</span> len)</span> </span>&#123;<span class="comment">//</span></span><br><span class="line"><span class="type">int</span>* arr = <span class="keyword">new</span> <span class="type">int</span>[len];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">arr[i] = <span class="built_in">rand</span>() % max;</span><br><span class="line"><span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">swap</span><span class="params">(<span class="type">int</span>&amp; a, <span class="type">int</span>&amp; b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> tmp = a;</span><br><span class="line">a = b;</span><br><span class="line">b = tmp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">loc <span class="title">netherLandsFlag</span><span class="params">(<span class="type">int</span>* arr, <span class="type">int</span> lower, <span class="type">int</span> upper)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">loc bound;</span><br><span class="line"><span class="keyword">if</span> (lower == upper)</span><br><span class="line">&#123;</span><br><span class="line">bound.left = bound.right = lower;</span><br><span class="line"><span class="keyword">return</span> bound;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> L = lower - <span class="number">1</span>; </span><br><span class="line"><span class="type">int</span> R = upper;</span><br><span class="line"><span class="type">int</span> index = lower;</span><br><span class="line"><span class="keyword">while</span> (index &lt; R)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (arr[index] &lt; arr[upper])</span><br><span class="line"><span class="built_in">swap</span>(arr[index++], arr[++L]);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (arr[index] == arr[upper])</span><br><span class="line">index++;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">swap</span>(arr[index], arr[--R]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">swap</span>(arr[R], arr[upper]);</span><br><span class="line">bound.left = L;</span><br><span class="line">bound.right = R + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">return</span> bound;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">process_1</span><span class="params">(<span class="type">int</span>* arr, <span class="type">int</span> lower, <span class="type">int</span> upper)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (lower &gt;= upper)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">loc bound = <span class="built_in">netherLandsFlag</span>(arr, lower, upper);</span><br><span class="line"><span class="built_in">process_1</span>(arr, lower, bound.left);</span><br><span class="line"><span class="built_in">process_1</span>(arr, bound.right, upper);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">quickSort_1</span><span class="params">(<span class="type">int</span>* arr, <span class="type">int</span> size)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (arr == <span class="literal">nullptr</span> || size == <span class="number">1</span>)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="built_in">process_1</span>(arr, <span class="number">0</span>, size - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">process_2</span><span class="params">(<span class="type">int</span>* arr, <span class="type">int</span> lower, <span class="type">int</span> upper)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (lower &gt;= upper)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="built_in">swap</span>(arr[upper], arr[<span class="built_in">rand</span>() % (upper - lower + <span class="number">1</span>) + lower]);</span><br><span class="line">loc bound = <span class="built_in">netherLandsFlag</span>(arr, lower, upper);</span><br><span class="line"><span class="built_in">process_2</span>(arr, lower, bound.left);</span><br><span class="line"><span class="built_in">process_2</span>(arr, bound.right, upper);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">quickSort_2</span><span class="params">(<span class="type">int</span>* arr, <span class="type">int</span> size)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (arr == <span class="literal">nullptr</span> || size == <span class="number">1</span>)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="built_in">process_2</span>(arr, <span class="number">0</span>, size - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span>* <span class="title">cpyArr</span><span class="params">(<span class="type">int</span>* src, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line"><span class="type">int</span>* des = <span class="keyword">new</span> <span class="type">int</span>[len];</span><br><span class="line"><span class="built_in">memcpy</span>(des, src, len * <span class="built_in">sizeof</span>(<span class="type">int</span>));</span><br><span class="line"><span class="keyword">return</span> des;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isEqual</span><span class="params">(<span class="type">int</span>* arr_1, <span class="type">int</span>* arr_2, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line"><span class="keyword">if</span> (arr_1[i] != arr_2[i])</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">clock_t</span> start_1, end_1,start_2,end_2;</span><br><span class="line"></span><br><span class="line"><span class="built_in">srand</span>((<span class="type">unsigned</span>)<span class="built_in">time</span>(<span class="literal">NULL</span>));</span><br><span class="line"><span class="type">int</span> max = <span class="number">1000000000</span>;</span><br><span class="line"><span class="type">int</span> maxSize = <span class="number">1000000</span>;</span><br><span class="line"><span class="type">int</span> times = <span class="number">10000</span>;</span><br><span class="line"><span class="type">int</span> arg=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; times; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> size = <span class="built_in">rand</span>() % maxSize + <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span>* arr_1 = <span class="built_in">generateRandomArr</span>(max, size);</span><br><span class="line"><span class="type">int</span>* arr_2 = <span class="built_in">cpyArr</span>(arr_1, size);</span><br><span class="line">start_1 = <span class="built_in">clock</span>();</span><br><span class="line"><span class="built_in">quickSort_1</span>(arr_1, size);</span><br><span class="line">end_1 = <span class="built_in">clock</span>();</span><br><span class="line"></span><br><span class="line">start_2 = <span class="built_in">clock</span>();</span><br><span class="line"><span class="built_in">quickSort_2</span>(arr_2, size);</span><br><span class="line">end_2 = <span class="built_in">clock</span>();</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">isEqual</span>(arr_1, arr_2, size) == <span class="literal">false</span>)</span><br><span class="line">&#123;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;!&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;&quot;</span> &lt;&lt; end_1 - start_1 &lt;&lt; <span class="string">&quot; ms&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;&quot;</span> &lt;&lt; end_2 - start_2 &lt;&lt; <span class="string">&quot; ms&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;&quot;</span> &lt;&lt; end_1 - start_1 - (end_2 - start_2) &lt;&lt; <span class="string">&quot; ms&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">arg += end_1 - start_1 - (end_2 - start_2);</span><br><span class="line">&#125;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;==========================================&quot;</span> &lt;&lt; std::endl &lt;&lt; <span class="string">&quot;&quot;</span> &lt;&lt; (<span class="type">double</span>)arg/times &lt;&lt; <span class="string">&quot; ms&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>-</title>
      <link href="/2022/09/14/%E9%80%92%E5%BD%92%E6%8E%92%E5%BA%8F%E5%8F%98%E5%BC%8F-%E5%8C%BA%E9%97%B4%E5%92%8C%E8%AE%A1%E6%95%B0/"/>
      <url>/2022/09/14/%E9%80%92%E5%BD%92%E6%8E%92%E5%BA%8F%E5%8F%98%E5%BC%8F-%E5%8C%BA%E9%97%B4%E5%92%8C%E8%AE%A1%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong><mark class="hl-label blue"></mark> </strong><br> arr lower  upper arr  [lower, upper] ()<strong></strong> </p><p><strong><mark class="hl-label blue">  </mark> </strong></p><p> <strong></strong>  [l, r]  0 arr[4, 8, 6, 10, 12] presum[4, 12, 18, 28, 40] arr  [2, 4]  presum[4] - presum[2-1] </p><p><strong><mark class="hl-label blue"></mark> </strong><br> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>N</mi><mn>3</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N^3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>  0  N  -&gt;  1  N-1  -&gt; 2  N-2   <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> <br><img src="/2022/img/.png" alt=""  /><br> <strong></strong>  <strong></strong> <a href="https://jyxcpp.netlify.app/2022/09/10/%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F%E5%8F%8A%E5%85%B6%E5%8A%A0%E5%BC%BA%E4%B9%A0%E9%A2%98/"></a> <strong><font color='red'>()</font></strong>  <strong><font color='red'>:K&lt;N</font></strong> ([10, 30])<br><img src="/2022/img/-16631419576573-16631425474895.png"  /><br></p><ol><li><strong><font color='red'></font></strong></li><li> merge merge<a href="https://jyxcpp.netlify.app/2022/09/10/%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F%E5%8F%8A%E5%85%B6%E5%8A%A0%E5%BC%BA%E4%B9%A0%E9%A2%98/"></a> </li><li> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(NlogN)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">Nl</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span>  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li><li><strong><font color='red'></font></strong></li><li><strong> arr  0  N  K(K0)  N (presum[N]-presum[K]) 63 </strong></li></ol><p></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span><span class="comment">//rand()</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span><span class="comment">//time()</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span><span class="comment">//memcpy()</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> upper, lower;</span><br><span class="line"><span class="type">int</span> cnt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span>* arr, <span class="type">int</span> l, <span class="type">int</span> m, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> lp = l;            <span class="comment">//left pointer</span></span><br><span class="line"><span class="type">int</span> rp = m + <span class="number">1</span>;        <span class="comment">//right pointer</span></span><br><span class="line"><span class="keyword">while</span>(rp&lt;=r)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> prel = arr[rp] - upper;<span class="comment">//presum left</span></span><br><span class="line"><span class="type">int</span> prer = arr[rp] - lower;<span class="comment">//presum right</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (lp &gt; m)</span><br><span class="line">&#123;</span><br><span class="line">rp++;</span><br><span class="line">lp = l;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (arr[lp] &lt; prel)</span><br><span class="line">lp++;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (arr[lp] &gt; prer)</span><br><span class="line">&#123;</span><br><span class="line">rp++;</span><br><span class="line">lp = l;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">cnt++;</span><br><span class="line">lp++;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span>* help = <span class="keyword">new</span> <span class="type">int</span>[r - l + <span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> p = <span class="number">0</span>;             <span class="comment">//help[]pointer</span></span><br><span class="line">lp = l;           </span><br><span class="line">rp = m + <span class="number">1</span>;       </span><br><span class="line"><span class="keyword">while</span> (lp &lt;= m &amp;&amp; rp &lt;= r)</span><br><span class="line">help[p++] = arr[lp] &lt; arr[rp] ? arr[lp++] : arr[rp++];</span><br><span class="line"><span class="keyword">while</span> (lp &lt;= m)</span><br><span class="line">help[p++] = arr[lp++];</span><br><span class="line"><span class="keyword">while</span> (rp &lt;= r)           <span class="comment">//911while</span></span><br><span class="line">help[p++] = arr[rp++];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; r - l + <span class="number">1</span>; i++)</span><br><span class="line">arr[l + i] = help[i];</span><br><span class="line"><span class="keyword">delete</span>[] help;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">process</span><span class="params">(<span class="type">int</span>* arr, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (l == r)<span class="comment">//base case</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (arr[l] &gt;= lower &amp;&amp; arr[r] &lt;= upper)</span><br><span class="line">cnt++;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> m = l + ((r - l) &gt;&gt; <span class="number">1</span>);</span><br><span class="line"><span class="built_in">process</span>(arr, l, m);</span><br><span class="line"><span class="built_in">process</span>(arr, m + <span class="number">1</span>, r);</span><br><span class="line"><span class="built_in">merge</span>(arr, l, m, r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">mergeSort</span><span class="params">(<span class="type">int</span>* arr, <span class="type">int</span> size)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (size == <span class="number">1</span>)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="type">int</span> r = size - <span class="number">1</span>;</span><br><span class="line"><span class="built_in">process</span>(arr, <span class="number">0</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">lower = <span class="number">10</span>;</span><br><span class="line">upper = <span class="number">30</span>;</span><br><span class="line"><span class="type">int</span> arr[<span class="number">4</span>] = &#123;<span class="number">10</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">10</span>&#125;; </span><br><span class="line"><span class="type">int</span> presum[<span class="number">4</span>] = &#123;<span class="number">0</span>&#125;;   <span class="comment">//10 11 12 22</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt;= i; k++)</span><br><span class="line">presum[i] += arr[k];</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">mergeSort</span>(presum,<span class="number">4</span>);</span><br><span class="line">std::cout &lt;&lt; cnt &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><mark class="hl-label blue"></mark> </strong><br> prel  prer  prel = arr[rp] - upperprer = arr[rp] - lower  arr[rp]  prel  prer [prel, prer]  [prel, prer]  count <br><img src="/2022/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE-16631662112261.png" alt=""></p><ul><li><strong>l  r  presum </strong></li><li><strong>presum[l] presum[r] </strong></li><li><strong></strong></li><li><strong>count = r + l - 1</strong></li><li><strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(NlogN)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">Nl</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span> </strong></li><li> merge<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>N</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi></mrow><annotation encoding="application/x-tex">2NlogN</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.01968em;">Nl</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(NlogN)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">Nl</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span> </li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span><span class="comment">//rand()</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span><span class="comment">//time()</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span><span class="comment">//memcpy()</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> upper, lower;</span><br><span class="line"><span class="type">int</span> cnt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span>* arr, <span class="type">int</span> l, <span class="type">int</span> m, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> lp = l;            </span><br><span class="line"><span class="type">int</span> rp = m + <span class="number">1</span>;       </span><br><span class="line"><span class="type">int</span> wl = l - <span class="number">1</span>;   <span class="comment">//window left;  wll</span></span><br><span class="line"><span class="type">int</span> wr = l - <span class="number">1</span>;  <span class="comment">//window right; wpr</span></span><br><span class="line"><span class="keyword">while</span>(rp &lt;= r)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> prel = arr[rp] - upper;<span class="comment">//presum left</span></span><br><span class="line"><span class="type">int</span> prer = arr[rp] - lower;<span class="comment">//presum right</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (wl &lt;= m)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (arr[wl] &lt; prel)</span><br><span class="line">wl++;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (wl &gt; m)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">while</span> (wr &lt;= m)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (arr[wr + <span class="number">1</span>] &lt;= prer &amp;&amp; wr!=m)</span><br><span class="line">wr++;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (wl != l<span class="number">-1</span> &amp;&amp; wr != l<span class="number">-1</span>)</span><br><span class="line">cnt += wr - wl + <span class="number">1</span>;</span><br><span class="line">rp++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span>* help = <span class="keyword">new</span> <span class="type">int</span>[r - l + <span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> p = <span class="number">0</span>;             <span class="comment">//help[]pointer</span></span><br><span class="line">lp = l;           </span><br><span class="line">rp = m + <span class="number">1</span>;       </span><br><span class="line"><span class="keyword">while</span> (lp &lt;= m &amp;&amp; rp &lt;= r)</span><br><span class="line">help[p++] = arr[lp] &lt; arr[rp] ? arr[lp++] : arr[rp++];</span><br><span class="line"><span class="keyword">while</span> (lp &lt;= m)</span><br><span class="line">help[p++] = arr[lp++];</span><br><span class="line"><span class="keyword">while</span> (rp &lt;= r)           <span class="comment">//911while</span></span><br><span class="line">help[p++] = arr[rp++];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; r - l + <span class="number">1</span>; i++)</span><br><span class="line">arr[l + i] = help[i];</span><br><span class="line"><span class="keyword">delete</span>[] help;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">process</span><span class="params">(<span class="type">int</span>* arr, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (l == r)<span class="comment">//base case</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (arr[l] &gt;= lower &amp;&amp; arr[r] &lt;= upper)</span><br><span class="line">cnt++;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> m = l + ((r - l) &gt;&gt; <span class="number">1</span>);</span><br><span class="line"><span class="built_in">process</span>(arr, l, m);</span><br><span class="line"><span class="built_in">process</span>(arr, m + <span class="number">1</span>, r);</span><br><span class="line"><span class="built_in">merge</span>(arr, l, m, r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">mergeSort</span><span class="params">(<span class="type">int</span>* arr, <span class="type">int</span> size)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (size == <span class="number">1</span>)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="type">int</span> r = size - <span class="number">1</span>;</span><br><span class="line"><span class="built_in">process</span>(arr, <span class="number">0</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">lower = <span class="number">10</span>;</span><br><span class="line">upper = <span class="number">30</span>;</span><br><span class="line"><span class="type">int</span> arr[<span class="number">4</span>] = &#123;<span class="number">0</span>,<span class="number">9</span>,<span class="number">-1</span>,<span class="number">-1</span>&#125;; </span><br><span class="line"><span class="type">int</span> presum[<span class="number">4</span>] = &#123;<span class="number">0</span>&#125;;   <span class="comment">//10 20 30 40</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt;= i; k++)</span><br><span class="line">presum[i] += arr[k];</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">mergeSort</span>(presum,<span class="number">4</span>);</span><br><span class="line">std::cout &lt;&lt; cnt &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>1415  l-1 36  if  wr  wl  l  presum[l]  cnt += wr - wl + 1</li><li>21272931</li></ul>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/09/13/%E5%90%84%E7%A7%8D%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93/"/>
      <url>/2022/09/13/%E5%90%84%E7%A7%8D%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="font-color-red--font"><font color='red'></font></h2><p><strong><font color='gree'><u></u>r[i] = r[j] r[i]  r[j] r[i]  r[j] </font></strong></p><blockquote><p></p></blockquote><p> intdouble </p><ol><li></li><li></li></ol><p><strong></strong> </p><hr><h2 id="font-color-red--font"><font color='red'></font></h2><table><thead><tr><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><td></td><td>O(N^2)</td><td>O(1)</td><td></td></tr><tr><td></td><td>O(N^2)</td><td>O(1)</td><td></td></tr><tr><td></td><td>O(N^2)</td><td>O(1)</td><td></td></tr><tr><td></td><td>O(N^2)</td><td>O(1)</td><td></td></tr><tr><td></td><td>O(NlogN)</td><td>O(N)</td><td></td></tr><tr><td></td><td>O(NlogN)</td><td>O(1)</td><td></td></tr><tr><td></td><td>O(NlogN)</td><td>O(logN) </td><td></td></tr><tr><td></td><td>O(N)</td><td>O(N)</td><td></td></tr></tbody></table><ul><li> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(NlogN)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">Nl</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span></li><li></li><li> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(NlogN)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">Nl</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span>  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span> </li><li><strong></strong></li><li><strong><font color='gree'></font></strong></li></ul><h2 id="font-color-red--font"><font color='red'></font></h2><p></p><ol><li><p><strong></strong></p><p> java  arrays.sort() </p></li><li><p><strong></strong></p><p> C  std::sort  <code>__depth_limit</code>  O(NlogN) _S_threshold </p></li></ol><hr><h2 id="font-color-red--font"><font color='red'></font></h2><p><strong> chatGPT </strong> </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;chrono&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;random&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;functional&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;radixSort.h&quot;</span> <span class="comment">//</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span> <span class="comment">//sort</span></span></span><br><span class="line"><span class="keyword">using</span> std::sort;</span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sortFunc1</span><span class="params">(<span class="type">int</span>* data, <span class="type">int</span> dataSize)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 1</span></span><br><span class="line"><span class="built_in">sort</span>(data, &amp;data[dataSize], [](<span class="type">int</span> a, <span class="type">int</span> b)&#123;<span class="keyword">return</span> a&lt;b;&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sortFunc2</span><span class="params">(<span class="type">int</span>* data, <span class="type">int</span> dataSize)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 2</span></span><br><span class="line"><span class="built_in">radixSort</span>(data, dataSize);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="function">std::pair&lt;<span class="type">double</span>, <span class="type">double</span>&gt; <span class="title">testSortingTime</span><span class="params">(std::function&lt;<span class="type">void</span>(<span class="type">int</span>*, <span class="type">int</span>)&gt; sortFunc1,</span></span></span><br><span class="line"><span class="params"><span class="function">                                          std::function&lt;<span class="type">void</span>(<span class="type">int</span>*, <span class="type">int</span>)&gt; sortFunc2,</span></span></span><br><span class="line"><span class="params"><span class="function">                                          <span class="type">int</span> numComparisons, <span class="type">int</span> dataSize, <span class="type">int</span> maxValue)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span>* data = <span class="keyword">new</span> <span class="type">int</span>[dataSize];</span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    std::random_device rd;</span><br><span class="line">    <span class="function">std::mt19937 <span class="title">gen</span><span class="params">(rd())</span></span>;</span><br><span class="line">    <span class="function">std::uniform_int_distribution&lt;<span class="type">int</span>&gt; <span class="title">dis</span><span class="params">(<span class="number">0</span>, maxValue)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; dataSize; ++i) &#123;</span><br><span class="line">        data[i] = <span class="built_in">dis</span>(gen);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1</span></span><br><span class="line">    <span class="keyword">auto</span> startTime = std::chrono::high_resolution_clock::<span class="built_in">now</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; numComparisons; ++i) &#123;</span><br><span class="line">        <span class="type">int</span>* sortedData = <span class="keyword">new</span> <span class="type">int</span>[dataSize];</span><br><span class="line">        std::<span class="built_in">copy</span>(data, data + dataSize, sortedData);</span><br><span class="line">        <span class="built_in">sortFunc1</span>(sortedData, dataSize);</span><br><span class="line">        <span class="keyword">delete</span>[] sortedData;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">auto</span> endTime = std::chrono::high_resolution_clock::<span class="built_in">now</span>();</span><br><span class="line">    <span class="type">double</span> sortingTime1 = std::chrono::<span class="built_in">duration</span>&lt;<span class="type">double</span>&gt;(endTime - startTime).<span class="built_in">count</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2</span></span><br><span class="line">    startTime = std::chrono::high_resolution_clock::<span class="built_in">now</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; numComparisons; ++i) &#123;</span><br><span class="line">        <span class="type">int</span>* sortedData = <span class="keyword">new</span> <span class="type">int</span>[dataSize];</span><br><span class="line">        std::<span class="built_in">copy</span>(data, data + dataSize, sortedData);</span><br><span class="line">        <span class="built_in">sortFunc2</span>(sortedData, dataSize);</span><br><span class="line">        <span class="keyword">delete</span>[] sortedData;</span><br><span class="line">    &#125;</span><br><span class="line">    endTime = std::chrono::high_resolution_clock::<span class="built_in">now</span>();</span><br><span class="line">    <span class="type">double</span> sortingTime2 = std::chrono::<span class="built_in">duration</span>&lt;<span class="type">double</span>&gt;(endTime - startTime).<span class="built_in">count</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    <span class="keyword">delete</span>[] data;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    <span class="keyword">return</span> std::<span class="built_in">make_pair</span>(sortingTime1, sortingTime2);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    <span class="keyword">auto</span> result = <span class="built_in">testSortingTime</span>(sortFunc1, sortFunc2, <span class="number">1</span>, <span class="number">100000000</span>, <span class="number">10000000</span>);</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Sorting Time for Function 1: &quot;</span> &lt;&lt; result.first &lt;&lt; <span class="string">&quot; seconds\n&quot;</span>;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Sorting Time for Function 2: &quot;</span> &lt;&lt; result.second &lt;&lt; <span class="string">&quot; seconds\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>:Xenia and Weights</title>
      <link href="/2022/09/13/%E5%9B%9E%E6%BA%AF%E6%B3%95-Xenia-and-Weights/"/>
      <url>/2022/09/13/%E5%9B%9E%E6%BA%AF%E6%B3%95-Xenia-and-Weights/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong><mark class="hl-label blue"></mark> </strong><br> n , [1,10] ,<strong>()</strong>  m NO</p><p><strong><mark class="hl-label blue"></mark> </strong><br>process()  <strong><font color='orange'></font></strong> </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span><span class="comment">//rand()</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span><span class="comment">//time()</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span><span class="comment">//memcpy()</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">turn</span>&#123;LEFT,RIGHT&#125;;</span><br><span class="line"><span class="type">int</span> weights[<span class="number">2</span>][<span class="number">10</span>] = &#123; &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>&#125; <span class="comment">//</span></span><br><span class="line">  ,&#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>&#125;&#125;;<span class="comment">//1</span></span><br><span class="line"><span class="type">int</span> count = <span class="number">0</span>;<span class="comment">//</span></span><br><span class="line">std::vector&lt;<span class="type">int</span>&gt; temp;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*    lw: rw: m: temp:  t:*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">process</span><span class="params">(<span class="type">int</span> lw,<span class="type">int</span> rw,<span class="type">int</span> w, <span class="type">int</span> m,std::vector&lt;<span class="type">int</span>&gt; temp,turn t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (count == <span class="number">-1</span>)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">if</span> (m == count)</span><br><span class="line">&#123;</span><br><span class="line">count = <span class="number">-1</span>;<span class="comment">//count1dfs</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i : temp)</span><br><span class="line">std::cout &lt;&lt; i &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (t == turn::LEFT)<span class="comment">//</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (lw + w &lt;= rw)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">lw += w;</span><br><span class="line">m++;</span><br><span class="line">temp.<span class="built_in">push_back</span>(w);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (weights[<span class="number">1</span>][i] == <span class="number">0</span> || w == i+<span class="number">1</span>)<span class="comment">//w==i+1,</span></span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="built_in">process</span>(lw, rw, weights[<span class="number">0</span>][i], m, temp, turn::RIGHT);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (t == turn::RIGHT)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (rw + w &lt;= lw)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">rw += w;</span><br><span class="line">m++;</span><br><span class="line">temp.<span class="built_in">push_back</span>(w);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (weights[<span class="number">1</span>][i] == <span class="number">0</span> || w == i+<span class="number">1</span>)</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="built_in">process</span>(lw, rw, weights[<span class="number">0</span>][i], m, temp, turn::LEFT);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">put</span><span class="params">(<span class="type">int</span> count)</span><span class="comment">//</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (weights[<span class="number">1</span>][i] == <span class="number">0</span>)</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line"><span class="built_in">process</span>(<span class="number">0</span>, <span class="number">0</span>, weights[<span class="number">0</span>][i], <span class="number">0</span>, temp, turn::LEFT);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">weights[<span class="number">1</span>][<span class="number">7</span>] = <span class="number">1</span>;</span><br><span class="line">weights[<span class="number">1</span>][<span class="number">9</span>] = <span class="number">1</span>;</span><br><span class="line">weights[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">count = <span class="number">7</span>;</span><br><span class="line"><span class="built_in">put</span>(count);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> dfs dp </p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>:</title>
      <link href="/2022/09/13/%E5%9B%9E%E6%BA%AF%E6%B3%95%E4%B8%80-%E5%B9%B8%E8%BF%90%E6%95%B0/"/>
      <url>/2022/09/13/%E5%9B%9E%E6%BA%AF%E6%B3%95%E4%B8%80-%E5%B9%B8%E8%BF%90%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong><mark class="hl-label blue"></mark> </strong><br> 4  7 4  7  281649  N num&gt;1, N&gt;1</p><p><strong><mark class="hl-label blue"></mark> </strong><br></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">comparator</span><span class="params">(<span class="type">int</span> num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (num == <span class="number">1</span>)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">while</span> (num!=<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (num == <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">count_2++;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (num % <span class="number">4</span> != <span class="number">0</span> &amp;&amp; num % <span class="number">7</span> != <span class="number">0</span>)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> (num % <span class="number">4</span> == <span class="number">0</span>)</span><br><span class="line">num /= <span class="number">4</span>;</span><br><span class="line"><span class="keyword">if</span> (num % <span class="number">7</span> == <span class="number">0</span>)</span><br><span class="line">num /= <span class="number">7</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong> 3512 </strong></p><p> num  <strong></strong> () num  <strong></strong>  18 4*44*7  num<br><img src="/2022/img/image-20220913105139956.png" style="zoom:80%;" /><br></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//numluck</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">lucky</span><span class="params">(<span class="type">int</span>&amp; num, <span class="type">int</span> luck)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (num&lt;luck*<span class="number">4</span>)<span class="comment">//(luck*4)(luck*7)</span></span><br><span class="line"><span class="keyword">return</span>;<span class="comment">//</span></span><br><span class="line"><span class="keyword">if</span> (num == luck * <span class="number">4</span> || num == luck * <span class="number">7</span>)</span><br><span class="line">&#123;</span><br><span class="line">num = <span class="number">0</span>;<span class="comment">//</span></span><br><span class="line">count_1++;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">lucky</span>(num, luck*<span class="number">4</span>);<span class="comment">//</span></span><br><span class="line"><span class="keyword">if</span> (num == <span class="number">0</span>)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="built_in">lucky</span>(num, luck*<span class="number">7</span>);<span class="comment">//</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> 813 <br><img src="/2022/img/image-20220913110716725.png" style="zoom:67%;" /><br>28  count++ count++  num  0</p><p></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span><span class="comment">//rand()</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span><span class="comment">//time()</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span><span class="comment">//memcpy()</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> count_1;</span><br><span class="line"><span class="type">int</span> count_2;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">lucky</span><span class="params">(<span class="type">int</span>&amp; num, <span class="type">int</span> luck)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (num&lt;luck*<span class="number">4</span>)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">if</span> (num == luck * <span class="number">4</span> || num == luck * <span class="number">7</span>)</span><br><span class="line">&#123;</span><br><span class="line">num = <span class="number">0</span>;</span><br><span class="line">count_1++;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">lucky</span>(num, luck*<span class="number">4</span>);</span><br><span class="line"><span class="keyword">if</span> (num == <span class="number">0</span>)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="built_in">lucky</span>(num, luck*<span class="number">7</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">comparator</span><span class="params">(<span class="type">int</span> num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (num == <span class="number">1</span>)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">while</span> (num!=<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (num == <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">count_2++;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (num % <span class="number">4</span> != <span class="number">0</span> &amp;&amp; num % <span class="number">7</span> != <span class="number">0</span>)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> (num % <span class="number">4</span> == <span class="number">0</span>)</span><br><span class="line">num /= <span class="number">4</span>;</span><br><span class="line"><span class="keyword">if</span> (num % <span class="number">7</span> == <span class="number">0</span>)</span><br><span class="line">num /= <span class="number">7</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span>* <span class="title">generateRandomArr</span><span class="params">(<span class="type">int</span> max, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line"><span class="type">int</span>* arr = <span class="keyword">new</span> <span class="type">int</span>[len];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">arr[i] = <span class="built_in">rand</span>() % max;</span><br><span class="line"><span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span>* <span class="title">cpyArr</span><span class="params">(<span class="type">int</span>* src, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line"><span class="type">int</span>* des = <span class="keyword">new</span> <span class="type">int</span>[len];</span><br><span class="line"><span class="built_in">memcpy</span>(des, src, len * <span class="built_in">sizeof</span>(<span class="type">int</span>));</span><br><span class="line"><span class="keyword">return</span> des;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">srand</span>(<span class="built_in">time</span>(<span class="literal">NULL</span>));</span><br><span class="line"><span class="type">int</span> testTimes = <span class="number">10000000</span>;<span class="comment">//</span></span><br><span class="line"><span class="type">int</span> arrMaxLen = <span class="number">1000</span>;<span class="comment">//</span></span><br><span class="line"><span class="type">int</span> max = <span class="number">100000</span>;<span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; testTimes; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> arrLen = <span class="built_in">rand</span>() % arrMaxLen;</span><br><span class="line"><span class="type">int</span>* arr_1 = <span class="built_in">generateRandomArr</span>(max, arrLen);</span><br><span class="line"><span class="type">int</span>* arr_2 = <span class="built_in">cpyArr</span>(arr_1, arrLen);</span><br><span class="line">count_1 = <span class="number">0</span>;</span><br><span class="line">count_2 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; arrLen; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">lucky</span>(arr_1[i], <span class="number">1</span>);</span><br><span class="line"><span class="built_in">comparator</span>(arr_2[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (count_1 != count_2)</span><br><span class="line">&#123;</span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;go wrong&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; arrLen; i++)</span><br><span class="line">std::cout &lt;&lt; arr_2[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">std::cout &lt;&lt; std::endl;</span><br><span class="line">std::cout &lt;&lt; count_1 &lt;&lt; std::endl;</span><br><span class="line">std::cout &lt;&lt; count_2 &lt;&lt; std::endl;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">std::cout &lt;&lt; <span class="string">&quot;success&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/09/11/%E5%86%92%E6%B3%A1%E3%80%81%E9%80%89%E6%8B%A9%E3%80%81%E6%8F%92%E5%85%A5%E3%80%81%E5%B8%8C%E5%B0%94%E6%8E%92%E5%BA%8F/"/>
      <url>/2022/09/11/%E5%86%92%E6%B3%A1%E3%80%81%E9%80%89%E6%8B%A9%E3%80%81%E6%8F%92%E5%85%A5%E3%80%81%E5%B8%8C%E5%B0%94%E6%8E%92%E5%BA%8F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="font-color-red--font"><font color='red'></font></h3><p></p><ol><li></li><li></li><li> K  K+1  size-1 </li></ol><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T, <span class="keyword">class</span> comparator&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">mySort</span><span class="params">(T* arr, <span class="type">int</span> size,comparator cmp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;size<span class="number">-1</span>;i++)<span class="comment">//-1</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; size - i - <span class="number">1</span>; k++)<span class="comment">//-i-1</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">cmp</span>(arr[k], arr[k + <span class="number">1</span>]))<span class="comment">//</span></span><br><span class="line"><span class="built_in">swap</span>(arr[k], arr[k + <span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="font-color-red--font"><font color='red'></font></h3><p></p><ol><li> K  K+1 </li><li> mIndex </li><li> 1  i&lt;size-1 k &lt;size</li></ol><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T, <span class="keyword">class</span> comparator&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">mySort</span><span class="params">(T* arr, <span class="type">int</span> size,comparator cmp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> mIndex; <span class="comment">//</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; size<span class="number">-1</span>; i++)<span class="comment">//-1!</span></span><br><span class="line">&#123;</span><br><span class="line">mIndex = i; <span class="comment">//</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> k = i+<span class="number">1</span>; k &lt; size; k++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(!<span class="built_in">cmp</span>(arr[mIndex], arr[k]))</span><br><span class="line">mIndex = k;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">swap</span>(arr[i], arr[mIndex]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="font-color-red--font"><font color='red'></font></h3><p></p><ol><li> arr[k]  arr[k-1]  i=1  arr[k]  arr[k+1] </li><li> i </li></ol><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T, <span class="keyword">class</span> comparator&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insertSort</span><span class="params">(T* arr, <span class="type">int</span> size, comparator cmp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; size; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> k = i; k &gt; <span class="number">0</span>; k--) <span class="comment">//k&gt;0k&gt;=0</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">cmp</span>(arr[k<span class="number">-1</span>], arr[k]))</span><br><span class="line"><span class="built_in">swap</span>(arr[k<span class="number">-1</span>], arr[k]);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">break</span>; <span class="comment">//break,</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> O(N^2^) </p><p></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/09/10/%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F%E5%8F%8A%E5%85%B6%E5%8A%A0%E5%BC%BA%E4%B9%A0%E9%A2%98/"/>
      <url>/2022/09/10/%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F%E5%8F%8A%E5%85%B6%E5%8A%A0%E5%BC%BA%E4%B9%A0%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>(Merge Sort)</strong>  <strong>(divide-and-conquer)</strong> </p><h3 id="font-color-red--font"><font color='red'></font></h3><p><br><img src="/2022/img/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2FhYmJjYzEzMg==,size_16,color_FFFFFF,t_70.png" alt="" style="zoom: 50%;" /></p><p>= <strong>(merge)</strong> <br><img src="/2022/img/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2FhYmJjYzEzMg==,size_16,color_FFFFFF,t_70-16628687498517.png" style="zoom:50%;" /></p><p><strong><font color='orange'></font></strong>  new  i  7 7&gt;6 6  j++ j <strong> 78 </strong> </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T, <span class="keyword">class</span> cmptor&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(T* vec, <span class="type">int</span> l, <span class="type">int</span> m, <span class="type">int</span> r, cmptor cmp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">T* help = <span class="keyword">new</span> <span class="type">int</span>[r - l + <span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> p = <span class="number">0</span>;             <span class="comment">//help[]pointer</span></span><br><span class="line"><span class="type">int</span> lp = l;            <span class="comment">//left pointer</span></span><br><span class="line"><span class="type">int</span> rp = m + <span class="number">1</span>;        <span class="comment">//right pointer</span></span><br><span class="line"><span class="keyword">while</span> (lp &lt;= m &amp;&amp; rp &lt;= r)</span><br><span class="line">help[p++] = vec[lp] &lt; vec[rp] ? vec[lp++] : vec[rp++];</span><br><span class="line"><span class="keyword">while</span> (lp &lt;= m)</span><br><span class="line">help[p++] = vec[lp++];</span><br><span class="line"><span class="keyword">while</span> (rp &lt;= r)           <span class="comment">//1012while</span></span><br><span class="line">help[p++] = vec[rp++];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; r - l + <span class="number">1</span>; i++)</span><br><span class="line">vec[l + i] = help[i];</span><br><span class="line"><span class="keyword">delete</span>[] help;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T, <span class="keyword">class</span> cmptor&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">process</span><span class="params">(T* vec, <span class="type">int</span> l, <span class="type">int</span> r, cmptor cmp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (l &gt;= r)<span class="comment">//base case</span></span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="type">int</span> m = (l+r)/<span class="number">2</span>;</span><br><span class="line"><span class="built_in">process</span>(vec, l, m, cmp);</span><br><span class="line"><span class="built_in">process</span>(vec, m + <span class="number">1</span>, r, cmp);</span><br><span class="line"><span class="built_in">merge</span>(vec, l, m, r, cmp);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T, <span class="keyword">class</span> cmptor&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">mergeSort</span><span class="params">(T* vec, <span class="type">int</span> size, cmptor cmp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (size == <span class="number">1</span>)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="type">int</span> r = size - <span class="number">1</span>;</span><br><span class="line"><span class="built_in">process</span>(vec, <span class="number">0</span>, r, cmp);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><ul><li><strong><font color='red'>[LM][M+1R]</font></strong>  L&gt;=M[0, 1]L=0R=1M=(0+1)/2=0 [0, 0] [1, 1](base case) return<strong><font color='orange'></font></strong></li><li><strong> base case  l&gt;=r  l==r</strong></li><li><strong><font color='red'> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>  low </font></strong></li><li><strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(NlogN)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">Nl</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span></strong> ( N ) logN </li></ul><h3 id="font-color-red--font"><font color='red'></font></h3><p><br><img src="/2022/img/image-20220911173802954.png" alt=""><br><img src="/2022/img/image-20220911174107803.png" alt=""></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span>* arr, <span class="type">int</span> l, <span class="type">int</span> m, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span>* help = <span class="keyword">new</span> <span class="type">int</span>[r - l + <span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> p = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> lp = l;</span><br><span class="line"><span class="type">int</span> rp = m + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (lp &lt;= m &amp;&amp; rp &lt;= r)</span><br><span class="line">help[p++] = arr[lp] &lt; arr[rp] ? arr[lp++] : arr[rp++];</span><br><span class="line"><span class="keyword">while</span> (lp &lt;= m)</span><br><span class="line">help[p++] = arr[lp++];</span><br><span class="line"><span class="keyword">while</span> (rp &lt;= r)         <span class="comment">//910while</span></span><br><span class="line">help[p++] = arr[rp++];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; r - l + <span class="number">1</span>; i++)</span><br><span class="line">arr[l + i] = help[i];</span><br><span class="line"><span class="keyword">delete</span>[] help;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">mergeSort</span><span class="params">(<span class="type">int</span>* arr, <span class="type">int</span> N)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (arr == <span class="literal">nullptr</span> || N == <span class="number">1</span>)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="type">int</span> mergeSize = <span class="number">1</span>, L, M, R;</span><br><span class="line"><span class="keyword">while</span> (mergeSize &lt; N)</span><br><span class="line">&#123;</span><br><span class="line">L = <span class="number">0</span>; <span class="comment">//</span></span><br><span class="line"><span class="keyword">while</span> (L &lt; N)</span><br><span class="line">&#123;</span><br><span class="line">M = L + mergeSize - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (M &gt;= N<span class="number">-1</span>) <span class="comment">//</span></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">R = (M + mergeSize) &lt; (N - <span class="number">1</span>) ? M + mergeSize : N - <span class="number">1</span>;</span><br><span class="line"><span class="built_in">merge</span>(arr, L, M, R);</span><br><span class="line">L = R + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (mergeSize &gt; N / <span class="number">2</span>)<span class="comment">//</span></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">mergeSize *= <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> arr[] = &#123; <span class="number">1</span>,<span class="number">23</span>,<span class="number">24</span>,<span class="number">51</span>,<span class="number">3</span>,<span class="number">56</span>,<span class="number">27</span>,<span class="number">17</span>,<span class="number">10</span>,<span class="number">43</span>,<span class="number">25</span>,<span class="number">36</span>,<span class="number">86</span> &#125;;</span><br><span class="line"><span class="built_in">mergeSort</span>(arr, <span class="built_in">sizeof</span>(arr) / <span class="built_in">sizeof</span>(<span class="type">int</span>));</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">sizeof</span>(arr) / <span class="built_in">sizeof</span>(<span class="type">int</span>); i++)</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; arr[i] &lt;&lt; <span class="string">&quot;  &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li> merge()  merge() </li><li><strong> 25 </strong></li><li><strong><font color='orange'> 28  31 </font></strong></li><li><strong><font color='orange'> 232629 </font></strong></li><li> 35  N mergeSize2  23  while <strong><font color='orange'></font></strong></li></ul><h3 id="font-color-red--font"><font color='red'></font></h3><h4 id="font-color-gree--font"><font color='gree'></font></h4><p><strong><mark class="hl-label blue"></mark> </strong><br> <code>[6,3,8,9]</code> 6  6 3  3 8 6  3  8 6+3=99 638  9 17 26</p><p><strong><mark class="hl-label blue"></mark> </strong><br> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>  7  6  6  6 <br><img src="/2022/img/image-20220912172534459.png" style="zoom: 50%;" /><br> N  N-1  <code>[7,6,5,4,3,2,1]</code>  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> <br><img src="/2022/img/image-20220912181635790.png" alt="" style="zoom:67%;" /></p><p><br><img src="/2022/img/image-20230914154308608.png" alt=""></p><ul><li><strong>sum +=   ()</strong> <strong><font color='red'>sum += arr[lp] * (R - rp + 1)</font></strong>  [2, 3, 4]  [3, 5, 9] merge 3 &gt; 2  3  &gt; 2 2 *(r-p2+1)  <strong></strong></li><li><strong><font color='orange'></font></strong> <strong><font color='gree'>(merge)merge</font></strong> </li><li> merge() 17-20</li></ul><p><strong><font color='orange'></font></strong> <br><img src="/2022/img/image-20220912190912493.png" alt="" style="zoom: 67%;" /></p><p></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span><span class="comment">//rand()</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span><span class="comment">//time()</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span><span class="comment">//memcpy()</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> count_1 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span>* arr, <span class="type">int</span> l, <span class="type">int</span> m, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span>* help = <span class="keyword">new</span> <span class="type">int</span>[r - l + <span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> p = <span class="number">0</span>;             <span class="comment">//help[]pointer</span></span><br><span class="line"><span class="type">int</span> lp = l;            <span class="comment">//left pointer</span></span><br><span class="line"><span class="type">int</span> rp = m + <span class="number">1</span>;        <span class="comment">//right pointer</span></span><br><span class="line"><span class="keyword">while</span> (lp &lt;= m &amp;&amp; rp &lt;= r)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (arr[lp] &lt; arr[rp])</span><br><span class="line">&#123;</span><br><span class="line">count_1 += (r - rp + <span class="number">1</span>) * arr[lp];<span class="comment">//</span></span><br><span class="line">&#125;</span><br><span class="line">help[p++] = arr[lp] &lt; arr[rp] ? arr[lp++] : arr[rp++];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (lp &lt;= m)</span><br><span class="line">help[p++] = arr[lp++];</span><br><span class="line"><span class="keyword">while</span> (rp &lt;= r)           <span class="comment">//911while</span></span><br><span class="line">help[p++] = arr[rp++];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; r - l + <span class="number">1</span>; i++)</span><br><span class="line">arr[l + i] = help[i];</span><br><span class="line"><span class="keyword">delete</span>[] help;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">process</span><span class="params">(<span class="type">int</span>* arr, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (l == r)<span class="comment">//base case</span></span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="type">int</span> m = l + ((r - l) &gt;&gt; <span class="number">1</span>);</span><br><span class="line"><span class="built_in">process</span>(arr, l, m);</span><br><span class="line"><span class="built_in">process</span>(arr, m + <span class="number">1</span>, r);</span><br><span class="line"><span class="built_in">merge</span>(arr, l, m, r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">mergeSort</span><span class="params">(<span class="type">int</span>* arr, <span class="type">int</span> size)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (size == <span class="number">1</span>)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="type">int</span> r = size - <span class="number">1</span>;</span><br><span class="line"><span class="built_in">process</span>(arr, <span class="number">0</span>, r);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="font-color-gree--font"><font color='gree'></font></h4><p><strong><mark class="hl-label blue"></mark> </strong><br><br>: [7,5,6,4]<br>: 5<br>&lt;7,5&gt;,&lt;7,6&gt;,&lt;7,4&gt;,&lt;5,4&gt;,&lt;6,4&gt;</p><p><strong><mark class="hl-label blue"></mark> </strong></p><p><strong><font color='orange'></font></strong></p><img src="/2022/img/image-20220912202305683.png" alt="" style="zoom:67%;" /> merge() <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span>* arr, <span class="type">int</span> l, <span class="type">int</span> m, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span>* help = <span class="keyword">new</span> <span class="type">int</span>[r - l + <span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> p = <span class="number">0</span>;             <span class="comment">//help[]pointer</span></span><br><span class="line"><span class="type">int</span> lp = l;            <span class="comment">//left pointer</span></span><br><span class="line"><span class="type">int</span> rp = m + <span class="number">1</span>;        <span class="comment">//right pointer</span></span><br><span class="line"><span class="keyword">while</span> (lp &lt;= m &amp;&amp; rp &lt;= r)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (arr[lp] &gt; arr[rp])</span><br><span class="line">&#123;</span><br><span class="line">count_1 += r - rp + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">help[p++] = arr[lp] &gt; arr[rp] ? arr[lp++] : arr[rp++];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (lp &lt;= m)</span><br><span class="line">help[p++] = arr[lp++];</span><br><span class="line"><span class="keyword">while</span> (rp &lt;= r)           <span class="comment">//911while</span></span><br><span class="line">help[p++] = arr[rp++];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; r - l + <span class="number">1</span>; i++)</span><br><span class="line">arr[l + i] = help[i];</span><br><span class="line"><span class="keyword">delete</span>[] help;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="font-color-red--font"><font color='red'></font></h4><p> [9,5,4,2] 9 -&gt; 49 -&gt;25 -&gt; 2 3</p><p><strong><mark class="hl-label blue"></mark> </strong><br><strong><font color='orange'></font></strong> <strong> merge </strong>  merge<br><img src="/2022/img/image-20220912222454570-1694678814234-1.png" alt=",5" style="zoom:67%;" /><br><strong> merge</strong><br><img src="/2022/img/image-20220912222911740.png" style="zoom:67%;" /><br></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span>* arr, <span class="type">int</span> l, <span class="type">int</span> m, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> lp = l;           </span><br><span class="line"><span class="type">int</span> rp = m + <span class="number">1</span>;       </span><br><span class="line"><span class="keyword">while</span> (rp &lt;= r &amp;&amp; <span class="built_in">lp</span>&lt;=m)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (arr[lp] &gt; (arr[rp] * <span class="number">2</span>))</span><br><span class="line">&#123;</span><br><span class="line">count_1 += r - rp + <span class="number">1</span>;</span><br><span class="line">lp++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">rp++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span>* help = <span class="keyword">new</span> <span class="type">int</span>[r - l + <span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> p = <span class="number">0</span>;             <span class="comment">//help[]pointer</span></span><br><span class="line">lp = l;            <span class="comment">//left pointer</span></span><br><span class="line">rp = m + <span class="number">1</span>;        <span class="comment">//right pointer</span></span><br><span class="line"><span class="keyword">while</span> (lp &lt;= m &amp;&amp; rp &lt;= r)</span><br><span class="line">&#123;</span><br><span class="line">help[p++] = arr[lp] &gt; arr[rp] ? arr[lp++] : arr[rp++];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (lp &lt;= m)</span><br><span class="line">help[p++] = arr[lp++];</span><br><span class="line"><span class="keyword">while</span> (rp &lt;= r)           <span class="comment">//911while</span></span><br><span class="line">help[p++] = arr[rp++];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; r - l + <span class="number">1</span>; i++)</span><br><span class="line">arr[l + i] = help[i];</span><br><span class="line"><span class="keyword">delete</span>[] help;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong></strong></p><p><strong><font color='gree'></font></strong></p><p><strong></strong></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL-</title>
      <link href="/2022/09/10/MySQL-%E8%A1%A8%E8%BF%9E%E6%8E%A5/"/>
      <url>/2022/09/10/MySQL-%E8%A1%A8%E8%BF%9E%E6%8E%A5/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong>CROSS JOIN</strong><br></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">&lt;</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> <span class="operator">&lt;</span><span class="number">1</span><span class="operator">&gt;</span> <span class="keyword">CROSS</span> <span class="keyword">JOIN</span> <span class="operator">&lt;</span><span class="number">2</span><span class="operator">&gt;</span> [<span class="keyword">WHERE</span>]</span><br><span class="line">#</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">&lt;</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> <span class="operator">&lt;</span><span class="number">1</span><span class="operator">&gt;</span>, <span class="operator">&lt;</span><span class="number">2</span><span class="operator">&gt;</span> [<span class="keyword">WHERE</span>] </span><br></pre></td></tr></table></figure><p><strong></strong></p><p><strong></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> stuinfo;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+-----------+------+</span></span><br><span class="line"><span class="operator">|</span> name  <span class="operator">|</span> age  <span class="operator">|</span> course_id <span class="operator">|</span> sex  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+-----------+------+</span></span><br><span class="line"><span class="operator">|</span> Jack  <span class="operator">|</span>   <span class="number">18</span> <span class="operator">|</span>        <span class="number">23</span> <span class="operator">|</span> M    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Mike  <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span>        <span class="number">23</span> <span class="operator">|</span> M    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Frank <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span>        <span class="number">14</span> <span class="operator">|</span> M    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Cling <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span>        <span class="number">14</span> <span class="operator">|</span> W    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Daney <span class="operator">|</span>   <span class="number">18</span> <span class="operator">|</span>        <span class="number">14</span> <span class="operator">|</span> W    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Judy  <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span>        <span class="number">23</span> <span class="operator">|</span> W    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Xuan  <span class="operator">|</span>   <span class="number">21</span> <span class="operator">|</span>        <span class="number">30</span> <span class="operator">|</span> W    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+-----------+------+</span></span><br><span class="line"><span class="number">6</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span><span class="operator">*</span> <span class="keyword">FROM</span> course ;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+----------+------+</span></span><br><span class="line"><span class="operator">|</span> subject <span class="operator">|</span> capacity <span class="operator">|</span> id   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+----------+------+</span></span><br><span class="line"><span class="operator">|</span> English <span class="operator">|</span>       <span class="number">32</span> <span class="operator">|</span>   <span class="number">23</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Math    <span class="operator">|</span>       <span class="number">18</span> <span class="operator">|</span>   <span class="number">14</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+----------+------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> stuinfo <span class="keyword">CROSS</span> <span class="keyword">JOIN</span> course;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+-----------+------+---------+----------+------+</span></span><br><span class="line"><span class="operator">|</span> name  <span class="operator">|</span> age  <span class="operator">|</span> course_id <span class="operator">|</span> sex  <span class="operator">|</span> subject <span class="operator">|</span> capacity <span class="operator">|</span> id   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+-----------+------+---------+----------+------+</span></span><br><span class="line"><span class="operator">|</span> Jack  <span class="operator">|</span>   <span class="number">18</span> <span class="operator">|</span>        <span class="number">23</span> <span class="operator">|</span> M    <span class="operator">|</span> English <span class="operator">|</span>       <span class="number">32</span> <span class="operator">|</span>   <span class="number">23</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Jack  <span class="operator">|</span>   <span class="number">18</span> <span class="operator">|</span>        <span class="number">23</span> <span class="operator">|</span> M    <span class="operator">|</span> Math    <span class="operator">|</span>       <span class="number">18</span> <span class="operator">|</span>   <span class="number">14</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Mike  <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span>        <span class="number">23</span> <span class="operator">|</span> M    <span class="operator">|</span> English <span class="operator">|</span>       <span class="number">32</span> <span class="operator">|</span>   <span class="number">23</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Mike  <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span>        <span class="number">23</span> <span class="operator">|</span> M    <span class="operator">|</span> Math    <span class="operator">|</span>       <span class="number">18</span> <span class="operator">|</span>   <span class="number">14</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Frank <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span>        <span class="number">14</span> <span class="operator">|</span> M    <span class="operator">|</span> English <span class="operator">|</span>       <span class="number">32</span> <span class="operator">|</span>   <span class="number">23</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Frank <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span>        <span class="number">14</span> <span class="operator">|</span> M    <span class="operator">|</span> Math    <span class="operator">|</span>       <span class="number">18</span> <span class="operator">|</span>   <span class="number">14</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Cling <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span>        <span class="number">14</span> <span class="operator">|</span> W    <span class="operator">|</span> English <span class="operator">|</span>       <span class="number">32</span> <span class="operator">|</span>   <span class="number">23</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Cling <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span>        <span class="number">14</span> <span class="operator">|</span> W    <span class="operator">|</span> Math    <span class="operator">|</span>       <span class="number">18</span> <span class="operator">|</span>   <span class="number">14</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Daney <span class="operator">|</span>   <span class="number">18</span> <span class="operator">|</span>        <span class="number">14</span> <span class="operator">|</span> W    <span class="operator">|</span> English <span class="operator">|</span>       <span class="number">32</span> <span class="operator">|</span>   <span class="number">23</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Daney <span class="operator">|</span>   <span class="number">18</span> <span class="operator">|</span>        <span class="number">14</span> <span class="operator">|</span> W    <span class="operator">|</span> Math    <span class="operator">|</span>       <span class="number">18</span> <span class="operator">|</span>   <span class="number">14</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Judy  <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span>        <span class="number">23</span> <span class="operator">|</span> W    <span class="operator">|</span> English <span class="operator">|</span>       <span class="number">32</span> <span class="operator">|</span>   <span class="number">23</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Judy  <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span>        <span class="number">23</span> <span class="operator">|</span> W    <span class="operator">|</span> Math    <span class="operator">|</span>       <span class="number">18</span> <span class="operator">|</span>   <span class="number">14</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Xuan  <span class="operator">|</span>   <span class="number">21</span> <span class="operator">|</span>        <span class="number">30</span> <span class="operator">|</span> W    <span class="operator">|</span> English <span class="operator">|</span>       <span class="number">32</span> <span class="operator">|</span>   <span class="number">23</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Xuan  <span class="operator">|</span>   <span class="number">21</span> <span class="operator">|</span>        <span class="number">30</span> <span class="operator">|</span> W    <span class="operator">|</span> Math    <span class="operator">|</span>       <span class="number">18</span> <span class="operator">|</span>   <span class="number">14</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+-----------+------+---------+----------+------+</span></span><br></pre></td></tr></table></figure><p></p><h3 id="font-color-red--font"><font color='red'></font></h3><p> <strong>INNER JOIN</strong>  ON INNER JOIN  CROSS JOIN <br></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">&lt;</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> <span class="operator">&lt;</span><span class="number">1</span><span class="operator">&gt;</span> <span class="keyword">INNER</span> <span class="keyword">JOIN</span> <span class="operator">&lt;</span><span class="number">2</span><span class="operator">&gt;</span> [<span class="keyword">ON</span>]</span><br></pre></td></tr></table></figure><p>INNER JOIN  WHERE  INNER JOIN  ON  WHERE </p><blockquote><p> WHERE  ON </p><p>ON  WHERE  ON  WHERE </p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> stuinfo <span class="keyword">INNER</span> <span class="keyword">JOIN</span> course</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">ON</span> stuinfo.course_id<span class="operator">=</span>course.id;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+-----------+------+---------+----------+------+</span></span><br><span class="line"><span class="operator">|</span> name  <span class="operator">|</span> age  <span class="operator">|</span> course_id <span class="operator">|</span> sex  <span class="operator">|</span> subject <span class="operator">|</span> capacity <span class="operator">|</span> id   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+-----------+------+---------+----------+------+</span></span><br><span class="line"><span class="operator">|</span> Jack  <span class="operator">|</span>   <span class="number">18</span> <span class="operator">|</span>        <span class="number">23</span> <span class="operator">|</span> M    <span class="operator">|</span> English <span class="operator">|</span>       <span class="number">32</span> <span class="operator">|</span>   <span class="number">23</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Mike  <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span>        <span class="number">23</span> <span class="operator">|</span> M    <span class="operator">|</span> English <span class="operator">|</span>       <span class="number">32</span> <span class="operator">|</span>   <span class="number">23</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Frank <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span>        <span class="number">14</span> <span class="operator">|</span> M    <span class="operator">|</span> Math    <span class="operator">|</span>       <span class="number">18</span> <span class="operator">|</span>   <span class="number">14</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Cling <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span>        <span class="number">14</span> <span class="operator">|</span> W    <span class="operator">|</span> Math    <span class="operator">|</span>       <span class="number">18</span> <span class="operator">|</span>   <span class="number">14</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Daney <span class="operator">|</span>   <span class="number">18</span> <span class="operator">|</span>        <span class="number">14</span> <span class="operator">|</span> W    <span class="operator">|</span> Math    <span class="operator">|</span>       <span class="number">18</span> <span class="operator">|</span>   <span class="number">14</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Judy  <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span>        <span class="number">23</span> <span class="operator">|</span> W    <span class="operator">|</span> English <span class="operator">|</span>       <span class="number">32</span> <span class="operator">|</span>   <span class="number">23</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+-----------+------+---------+----------+------+</span></span><br><span class="line"><span class="number">6</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong></strong>  ON  stuinfo  course  id  <strong></strong> </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> stuinfo <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> course</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">ON</span> stuinfo.course_id<span class="operator">=</span>course.id;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+-----------+------+---------+----------+------+</span></span><br><span class="line"><span class="operator">|</span> name  <span class="operator">|</span> age  <span class="operator">|</span> course_id <span class="operator">|</span> sex  <span class="operator">|</span> subject <span class="operator">|</span> capacity <span class="operator">|</span> id   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+-----------+------+---------+----------+------+</span></span><br><span class="line"><span class="operator">|</span> Jack  <span class="operator">|</span>   <span class="number">18</span> <span class="operator">|</span>        <span class="number">23</span> <span class="operator">|</span> M    <span class="operator">|</span> English <span class="operator">|</span>       <span class="number">32</span> <span class="operator">|</span>   <span class="number">23</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Mike  <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span>        <span class="number">23</span> <span class="operator">|</span> M    <span class="operator">|</span> English <span class="operator">|</span>       <span class="number">32</span> <span class="operator">|</span>   <span class="number">23</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Judy  <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span>        <span class="number">23</span> <span class="operator">|</span> W    <span class="operator">|</span> English <span class="operator">|</span>       <span class="number">32</span> <span class="operator">|</span>   <span class="number">23</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Frank <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span>        <span class="number">14</span> <span class="operator">|</span> M    <span class="operator">|</span> Math    <span class="operator">|</span>       <span class="number">18</span> <span class="operator">|</span>   <span class="number">14</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Cling <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span>        <span class="number">14</span> <span class="operator">|</span> W    <span class="operator">|</span> Math    <span class="operator">|</span>       <span class="number">18</span> <span class="operator">|</span>   <span class="number">14</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Daney <span class="operator">|</span>   <span class="number">18</span> <span class="operator">|</span>        <span class="number">14</span> <span class="operator">|</span> W    <span class="operator">|</span> Math    <span class="operator">|</span>       <span class="number">18</span> <span class="operator">|</span>   <span class="number">14</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Xuan  <span class="operator">|</span>   <span class="number">21</span> <span class="operator">|</span>        <span class="number">30</span> <span class="operator">|</span> W    <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>     <span class="keyword">NULL</span> <span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+-----------+------+---------+----------+------+</span></span><br></pre></td></tr></table></figure><p>Xuan </p><p><strong> OUTER  LEFT JOIN</strong> MySQL Oracle </p><h3 id="font-color-red--font"><font color='red'></font></h3><p></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+-------+------+</span></span><br><span class="line"><span class="operator">|</span> id   <span class="operator">|</span> name  <span class="operator">|</span> mgn  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+-------+------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span> Han   <span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">2</span> <span class="operator">|</span> Jack  <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">3</span> <span class="operator">|</span> Tom   <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">4</span> <span class="operator">|</span> Cling <span class="operator">|</span>    <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">5</span> <span class="operator">|</span> Black <span class="operator">|</span>    <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+-------+------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> worker.name <span class="keyword">AS</span> &quot;&quot;,manager.name <span class="keyword">AS</span> &quot;&quot;</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> emp <span class="keyword">AS</span> worker, emp <span class="keyword">AS</span> manager</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> worker.mgr<span class="operator">=</span>manager.id;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+</span></span><br><span class="line"><span class="operator">|</span>      <span class="operator">|</span>      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+</span></span><br><span class="line"><span class="operator">|</span> Jack      <span class="operator">|</span> Han       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Tom       <span class="operator">|</span> Han       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Cling     <span class="operator">|</span> Jack      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Black     <span class="operator">|</span> Tom       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+</span></span><br></pre></td></tr></table></figure><p><strong><font color='orange'></font></strong><br>Han Han </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> worker.name <span class="keyword">AS</span> &quot;&quot;,manager.name <span class="keyword">AS</span> &quot;&quot;</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> emp <span class="keyword">AS</span> worker <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> emp <span class="keyword">AS</span> manager</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">ON</span> worker.mgr<span class="operator">=</span>manager.id;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+</span></span><br><span class="line"><span class="operator">|</span>      <span class="operator">|</span>      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+</span></span><br><span class="line"><span class="operator">|</span> Jack      <span class="operator">|</span> Han       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Tom       <span class="operator">|</span> Han       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Cling     <span class="operator">|</span> Jack      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Black     <span class="operator">|</span> Tom       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Han       <span class="operator">|</span> <span class="keyword">NULL</span>      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category> MySQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>:</title>
      <link href="/2022/09/09/%E5%9B%9E%E6%BA%AF%E6%B3%95%E4%B8%80-%E5%A1%AB%E6%95%B0%E5%AD%97/"/>
      <url>/2022/09/09/%E5%9B%9E%E6%BA%AF%E6%B3%95%E4%B8%80-%E5%A1%AB%E6%95%B0%E5%AD%97/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong><mark class="hl-label blue"></mark> </strong><br> 7 : 1 , 2 , 3 , 7 ,, 1  1 , 2  2 ,, 7  7 :<br><code>1 7 1 2 6 4 2 5 3 7 4 6 3 5</code></p><p></p><p><strong><mark class="hl-label blue"></mark> </strong></p><p></p><ol><li><p></p><img src="/2022/img/image-20220909104732262.png" style="zoom:50%;" /> [4]  3  [8]  3</li><li><p></p></li><li><p>() <strong></strong> <br><img src="/2022/img/image-20220909104746470.png" style="zoom:50%;" /></p><p> [9]  1,2,3,4,5  6 7</p></li><li><p> <strong></strong> <br> 6 (6) 5 (5) 6<br><img src="/2022/img/image-20220909105313901.png" style="zoom:50%;" /><br> 6  5 7 5 7 4 5<br><img src="/2022/img/image-20220909105659357.png" style="zoom:50%;" /><br> 5  4([12] 5 ) 6 6</p></li></ol><p><strong></strong></p><ol><li><strong></strong></li><li><strong></strong></li></ol><p><br><img src="/2022/img/image-20220909111056021.png" style="zoom:67%;" /><br> 7  6  6  2 6 5 6</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">bool</span> num[<span class="number">8</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"><span class="type">int</span> arr[<span class="number">15</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">canPut</span><span class="params">(<span class="type">int</span> i,<span class="type">int</span> pos)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (!num[i] <span class="comment">//</span></span><br><span class="line">        &amp;&amp; pos + <span class="number">1</span> + i &lt;= <span class="number">14</span> &amp;&amp; arr[pos + <span class="number">1</span> + i] == <span class="number">0</span>)<span class="comment">//</span></span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">put</span><span class="params">(<span class="type">int</span> k,<span class="type">int</span> pos)</span><span class="comment">//</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">arr[pos] = k;</span><br><span class="line">arr[pos + <span class="number">1</span> + k] = k;</span><br><span class="line">num[k] = <span class="number">1</span>;<span class="comment">//true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">go</span><span class="params">(<span class="type">int</span> pos, <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (pos&gt;<span class="number">14</span>)<span class="comment">//put</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">14</span>; i++)</span><br><span class="line">cout &lt;&lt; arr[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">cout &lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (arr[pos]!=<span class="number">0</span>)<span class="comment">//</span></span><br><span class="line"><span class="built_in">go</span>(pos + <span class="number">1</span>, n);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">1</span>; k &lt;= <span class="number">7</span>; k++)<span class="comment">//</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">canPut</span>(k, pos))</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">put</span>(k, pos);</span><br><span class="line"><span class="built_in">go</span>(pos + <span class="number">1</span>, k);<span class="comment">//</span></span><br><span class="line">                <span class="comment">//</span></span><br><span class="line">arr[pos + k + <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">arr[pos] = <span class="number">0</span>;</span><br><span class="line">num[k] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">go</span>(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL-()</title>
      <link href="/2022/09/06/MySQL-%E8%AF%A6%E8%A7%A3%E6%95%B0%E6%8D%AE%E8%A1%A8%E6%9F%A5%E8%AF%A2/"/>
      <url>/2022/09/06/MySQL-%E8%AF%A6%E8%A7%A3%E6%95%B0%E6%8D%AE%E8%A1%A8%E6%9F%A5%E8%AF%A2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">[<span class="keyword">DISTINCT</span>]</span><br><span class="line">&#123;<span class="operator">*</span> <span class="operator">|</span> <span class="operator">&lt;</span><span class="operator">&gt;</span>&#125;</span><br><span class="line">[    </span><br><span class="line"><span class="keyword">FROM</span> <span class="operator">&lt;</span> <span class="number">1</span><span class="operator">&gt;</span>, <span class="operator">&lt;</span> <span class="number">2</span><span class="operator">&gt;</span></span><br><span class="line">[<span class="keyword">WHERE</span> <span class="operator">&lt;</span><span class="operator">&gt;</span></span><br><span class="line">[<span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="operator">&lt;</span><span class="keyword">group</span> <span class="keyword">by</span> definition<span class="operator">&gt;</span></span><br><span class="line">[<span class="keyword">HAVING</span> <span class="operator">&lt;</span>expression<span class="operator">&gt;</span> [&#123;<span class="operator">&lt;</span>operator<span class="operator">&gt;</span> <span class="operator">&lt;</span>expression<span class="operator">&gt;</span>&#125;]]</span><br><span class="line">[<span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="operator">&lt;</span><span class="keyword">order</span> <span class="keyword">by</span> definition<span class="operator">&gt;</span>]</span><br><span class="line">[LIMIT[<span class="operator">&lt;</span><span class="keyword">offset</span><span class="operator">&gt;</span>,] <span class="operator">&lt;</span><span class="type">row</span> count<span class="operator">&gt;</span>]</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p><strong><font color='orange'></font></strong></p><p></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> demo_0;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+------+--------+</span></span><br><span class="line"><span class="operator">|</span> id    <span class="operator">|</span> name <span class="operator">|</span> age  <span class="operator">|</span> addr   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+------+--------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">33703</span> <span class="operator">|</span> Mike <span class="operator">|</span>   <span class="number">23</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">36640</span> <span class="operator">|</span> XUAN <span class="operator">|</span>   <span class="number">22</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">36964</span> <span class="operator">|</span> Han  <span class="operator">|</span>   <span class="number">22</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+------+--------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> `name` <span class="keyword">FROM</span> demo_0;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+</span></span><br><span class="line"><span class="operator">|</span> name <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+</span></span><br><span class="line"><span class="operator">|</span> Mike <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> XUAN <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Han  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure><h3 id="font-color-red--font"><font color='red'></font></h3><p>DISTINCT </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> <span class="operator">&lt;</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> <span class="operator">&lt;</span><span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure><p><strong> DISTINCT </strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> <span class="operator">*</span> <span class="keyword">FROM</span> demo_0;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-------+------+--------+</span></span><br><span class="line"><span class="operator">|</span> id    <span class="operator">|</span> name  <span class="operator">|</span> age  <span class="operator">|</span> addr   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-------+------+--------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">33703</span> <span class="operator">|</span> Mike  <span class="operator">|</span>   <span class="number">23</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">36640</span> <span class="operator">|</span> XUAN  <span class="operator">|</span>   <span class="number">22</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">36964</span> <span class="operator">|</span> Han   <span class="operator">|</span>   <span class="number">22</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">12398</span> <span class="operator">|</span> Jack  <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">21343</span> <span class="operator">|</span> Cling <span class="operator">|</span>   <span class="number">21</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-------+------+--------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> age <span class="keyword">FROM</span> demo_0;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+</span></span><br><span class="line"><span class="operator">|</span> age  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+</span></span><br><span class="line"><span class="operator">|</span>   <span class="number">23</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>   <span class="number">22</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>   <span class="number">21</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p> DISTINCT  DISTINCT  student  name  age SQL </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> name,age) <span class="keyword">FROM</span> student;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> name,age) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------+</span></span><br><span class="line"><span class="operator">|</span>                        <span class="number">5</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> (<span class="operator">+</span><span class="operator">+</span><span class="operator">+</span><span class="operator">+</span>) <span class="keyword">AS</span>  <span class="keyword">FROM</span> demo_2;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">397</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">388</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">436</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">352</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span>  (<span class="operator">+</span><span class="operator">+</span><span class="operator">+</span><span class="operator">+</span>) <span class="keyword">AS</span>  <span class="keyword">FROM</span> demo_2;</span><br><span class="line">ERROR <span class="number">1305</span> (<span class="number">42000</span>): <span class="keyword">FUNCTION</span> stuinfo. does <span class="keyword">not</span> exist</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span>  ,(<span class="operator">+</span><span class="operator">+</span><span class="operator">+</span><span class="operator">+</span>) <span class="keyword">AS</span>  <span class="keyword">FROM</span> demo_2;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------+</span></span><br><span class="line"><span class="operator">|</span>     <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------+</span></span><br><span class="line"><span class="operator">|</span> Jack   <span class="operator">|</span>    <span class="number">397</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Mike   <span class="operator">|</span>    <span class="number">388</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Han    <span class="operator">|</span>    <span class="number">436</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Xuan   <span class="operator">|</span>    <span class="number">352</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------+</span></span><br></pre></td></tr></table></figure><p><strong></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> stu.name ,stu.addr <span class="keyword">FROM</span> stu_info_table <span class="keyword">AS</span> stu;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+</span></span><br><span class="line"><span class="operator">|</span> name  <span class="operator">|</span> addr   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+</span></span><br><span class="line"><span class="operator">|</span> Mike  <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> XUAN  <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Han   <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Jack  <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Cling <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure><p><strong></strong><br><a href="https://jyxcpp.netlify.app/2022/09/10/mysql-%E8%A1%A8%E8%BF%9E%E6%8E%A5/"></a></p><h3 id="font-color-red--font"><font color='red'></font></h3><p> <code>LIMIT</code> </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> tbl LIMIT ,;</span><br></pre></td></tr></table></figure><p><strong><font color='orange'>0</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> stu_info_table LIMIT <span class="number">3</span>,<span class="number">2</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+</span></span><br><span class="line"><span class="operator">|</span> name  <span class="operator">|</span> addr   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+</span></span><br><span class="line"><span class="operator">|</span> Jack  <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Cling <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> stu_info_table LIMIT <span class="number">3</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------+</span></span><br><span class="line"><span class="operator">|</span> name <span class="operator">|</span> addr   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------+</span></span><br><span class="line"><span class="operator">|</span> Mike <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> XUAN <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Han  <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p> N <code>LIMIT (-1)*N , N</code></p><h3 id="font-color-red--font"><font color='red'></font></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="operator">&lt;</span><span class="operator">&gt;</span> [<span class="keyword">ASC</span><span class="operator">|</span><span class="keyword">DESC</span>]</span><br></pre></td></tr></table></figure><p> ASC DESC <strong></strong> <br></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> demo_2 <span class="keyword">ORDER</span> <span class="keyword">BY</span> math <span class="keyword">DESC</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------+--------+--------+--------+--------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span>    <span class="operator">|</span>    <span class="operator">|</span>    <span class="operator">|</span>    <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------+--------+--------+--------+--------+</span></span><br><span class="line"><span class="operator">|</span> Jack   <span class="operator">|</span>     <span class="number">98</span> <span class="operator">|</span>     <span class="number">87</span> <span class="operator">|</span>     <span class="number">87</span> <span class="operator">|</span>     <span class="number">68</span> <span class="operator">|</span>     <span class="number">57</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Han    <span class="operator">|</span>     <span class="number">87</span> <span class="operator">|</span>     <span class="number">98</span> <span class="operator">|</span>     <span class="number">97</span> <span class="operator">|</span>     <span class="number">96</span> <span class="operator">|</span>     <span class="number">58</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Mike   <span class="operator">|</span>     <span class="number">76</span> <span class="operator">|</span>     <span class="number">87</span> <span class="operator">|</span>     <span class="number">68</span> <span class="operator">|</span>     <span class="number">59</span> <span class="operator">|</span>     <span class="number">98</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Xuan   <span class="operator">|</span>     <span class="number">67</span> <span class="operator">|</span>     <span class="number">57</span> <span class="operator">|</span>     <span class="number">86</span> <span class="operator">|</span>     <span class="number">58</span> <span class="operator">|</span>     <span class="number">84</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------+--------+--------+--------+--------+</span></span><br></pre></td></tr></table></figure><p></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> Chinese, Math <span class="keyword">FROM</span> demo_2 <span class="keyword">ORDER</span> <span class="keyword">BY</span> Chinese ,Math <span class="keyword">DESC</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+------+</span></span><br><span class="line"><span class="operator">|</span> Chinese <span class="operator">|</span> Math <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+------+</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">57</span> <span class="operator">|</span>   <span class="number">67</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">87</span> <span class="operator">|</span>   <span class="number">98</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">87</span> <span class="operator">|</span>   <span class="number">76</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">98</span> <span class="operator">|</span>   <span class="number">87</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+------+</span></span><br></pre></td></tr></table></figure><p><strong><font color='orange'>MySQL </font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> Chinese, Math <span class="keyword">FROM</span> demo_2 <span class="keyword">ORDER</span> <span class="keyword">BY</span> Chinese <span class="keyword">DESC</span>,Math <span class="keyword">DESC</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+------+</span></span><br><span class="line"><span class="operator">|</span> Chinese <span class="operator">|</span> Math <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+------+</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">98</span> <span class="operator">|</span>   <span class="number">87</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">87</span> <span class="operator">|</span>   <span class="number">98</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">87</span> <span class="operator">|</span>   <span class="number">76</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">57</span> <span class="operator">|</span>   <span class="number">67</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p>DESC  height height  name <strong><font color='orange'> DESC </font></strong> </p><h3 id="font-color-red--font"><font color='red'></font></h3><p></p><ul><li><p>&gt; &lt;&gt;=&lt;=!= = </p></li><li><p>AND(&amp;&amp;) , NOT , OR(||) , XOR</p><blockquote><p>XOR</p></blockquote></li><li><p> <code>BETWEEN AND</code>  <code>&gt;=L AND &lt;= R</code></p></li><li><p> <code>IS NULL</code> ** <code>IS</code>  <code>=</code> **</p></li><li><p> <code>IN</code>  IN  IN(98,87)</p></li><li><p> <code>LIKE</code> <code>NOT LIKE</code> </p></li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">####<span class="keyword">IN</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> demo_2</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> Math <span class="keyword">IN</span>(<span class="number">98</span>,<span class="number">76</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">------+------+---------+---------+---------+-----------+</span></span><br><span class="line"><span class="operator">|</span> name <span class="operator">|</span> Math <span class="operator">|</span> Chinese <span class="operator">|</span> English <span class="operator">|</span> Physics <span class="operator">|</span> Chemistry <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+------+---------+---------+---------+-----------+</span></span><br><span class="line"><span class="operator">|</span> Jack <span class="operator">|</span>   <span class="number">98</span> <span class="operator">|</span>      <span class="number">87</span> <span class="operator">|</span>      <span class="number">87</span> <span class="operator">|</span>      <span class="number">68</span> <span class="operator">|</span>        <span class="number">57</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Mike <span class="operator">|</span>   <span class="number">76</span> <span class="operator">|</span>      <span class="number">87</span> <span class="operator">|</span>      <span class="number">68</span> <span class="operator">|</span>      <span class="number">59</span> <span class="operator">|</span>        <span class="number">98</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+------+---------+---------+---------+-----------+</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">####<span class="keyword">BETWEEN</span> <span class="keyword">AND</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> Chinese <span class="keyword">FROM</span> demo_2</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> Chinese <span class="keyword">BETWEEN</span> <span class="number">87</span> <span class="keyword">AND</span> <span class="number">98</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+</span></span><br><span class="line"><span class="operator">|</span> Chinese <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">87</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">87</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">98</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+</span></span><br><span class="line">####XOR</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> demo_2</span><br><span class="line">   <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> MATH <span class="operator">&gt;</span> <span class="number">70</span> XOR Physics <span class="operator">&lt;</span> <span class="number">70</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+------+---------+---------+---------+-----------+</span></span><br><span class="line"><span class="operator">|</span> name <span class="operator">|</span> Math <span class="operator">|</span> Chinese <span class="operator">|</span> English <span class="operator">|</span> Physics <span class="operator">|</span> Chemistry <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+------+---------+---------+---------+-----------+</span></span><br><span class="line"><span class="operator">|</span> Han  <span class="operator">|</span>   <span class="number">87</span> <span class="operator">|</span>      <span class="number">98</span> <span class="operator">|</span>      <span class="number">97</span> <span class="operator">|</span>      <span class="number">96</span> <span class="operator">|</span>        <span class="number">58</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Xuan <span class="operator">|</span>   <span class="number">67</span> <span class="operator">|</span>      <span class="number">57</span> <span class="operator">|</span>      <span class="number">86</span> <span class="operator">|</span>      <span class="number">58</span> <span class="operator">|</span>        <span class="number">84</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+------+---------+---------+---------+-----------+</span></span><br></pre></td></tr></table></figure><p><code>LIKE</code> <code>%</code>  0<code>_</code>  0</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> demo_1</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> `name` <span class="keyword">LIKE</span> &quot;%an%&quot;;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+------+--------+</span></span><br><span class="line"><span class="operator">|</span> id    <span class="operator">|</span> name   <span class="operator">|</span> age  <span class="operator">|</span> addr   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+------+--------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">12336</span> <span class="operator">|</span> QuanHa <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">12321</span> <span class="operator">|</span> Han    <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+------+--------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> demo_1</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> `name` <span class="keyword">LIKE</span> &quot;_a%&quot;;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+------+--------+</span></span><br><span class="line"><span class="operator">|</span> id    <span class="operator">|</span> name <span class="operator">|</span> age  <span class="operator">|</span> addr   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+------+--------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">12321</span> <span class="operator">|</span> Han  <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+------+--------+</span></span><br></pre></td></tr></table></figure><p><strong>LIKE </strong>  <code>BINARY</code> </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> demo_1</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> `name` <span class="keyword">LIKE</span> <span class="type">BINARY</span> &quot;han&quot;;</span><br><span class="line"><span class="keyword">Empty</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> demo_1</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> `name` <span class="keyword">LIKE</span> <span class="type">BINARY</span> &quot;Han&quot;;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+------+--------+</span></span><br><span class="line"><span class="operator">|</span> id    <span class="operator">|</span> name <span class="operator">|</span> age  <span class="operator">|</span> addr   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+------+--------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">12321</span> <span class="operator">|</span> Han  <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+------+--------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p><strong></strong><br><strong><font color='orange'>WHERE </font></strong> </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> name <span class="keyword">AS</span> ,Math <span class="keyword">AS</span>  <span class="keyword">FROM</span> demo_2</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> <span class="operator">&gt;</span><span class="number">60</span>;</span><br><span class="line">ERROR <span class="number">1054</span> (<span class="number">42</span>S22): <span class="literal">Unknown</span> <span class="keyword">column</span> <span class="string">&#x27;&#x27;</span> <span class="keyword">in</span> <span class="string">&#x27;where clause&#x27;</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> name <span class="keyword">AS</span> ,Math <span class="keyword">AS</span>  <span class="keyword">FROM</span> demo_2</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">HAVING</span> <span class="operator">&gt;</span><span class="number">60</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------+</span></span><br><span class="line"><span class="operator">|</span> Jack   <span class="operator">|</span>     <span class="number">98</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Mike   <span class="operator">|</span>     <span class="number">76</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Han    <span class="operator">|</span>     <span class="number">87</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Xuan   <span class="operator">|</span>     <span class="number">67</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><h3 id="font-color-red--font"><font color='red'></font></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span>  <span class="operator">&lt;</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure><ol><li>GROUP BY  COUNT()SUM()AVG()MAX()  MIN()</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> demo_2;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+------+------+---------+---------+---------+-----------+</span></span><br><span class="line"><span class="operator">|</span> SEX  <span class="operator">|</span> name <span class="operator">|</span> Math <span class="operator">|</span> Chinese <span class="operator">|</span> English <span class="operator">|</span> Physics <span class="operator">|</span> Chemistry <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+------+------+---------+---------+---------+-----------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> Jack <span class="operator">|</span>   <span class="number">98</span> <span class="operator">|</span>      <span class="number">87</span> <span class="operator">|</span>      <span class="number">87</span> <span class="operator">|</span>      <span class="number">68</span> <span class="operator">|</span>        <span class="number">57</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> Mike <span class="operator">|</span>   <span class="number">76</span> <span class="operator">|</span>      <span class="number">87</span> <span class="operator">|</span>      <span class="number">68</span> <span class="operator">|</span>      <span class="number">59</span> <span class="operator">|</span>        <span class="number">98</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> Han  <span class="operator">|</span>   <span class="number">87</span> <span class="operator">|</span>      <span class="number">98</span> <span class="operator">|</span>      <span class="number">97</span> <span class="operator">|</span>      <span class="number">96</span> <span class="operator">|</span>        <span class="number">58</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> Xuan <span class="operator">|</span>   <span class="number">67</span> <span class="operator">|</span>      <span class="number">57</span> <span class="operator">|</span>      <span class="number">86</span> <span class="operator">|</span>      <span class="number">58</span> <span class="operator">|</span>        <span class="number">84</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+------+------+---------+---------+---------+-----------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> SEX ,<span class="built_in">AVG</span>(Math) <span class="keyword">AS</span>  <span class="keyword">FROM</span> demo_2</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> SEX;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+-----------------+</span></span><br><span class="line"><span class="operator">|</span> SEX  <span class="operator">|</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+-----------------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span>         <span class="number">77.0000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span>         <span class="number">87.0000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+-----------------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><ol start="2"><li>GROUP BY  GROUP_CONCAT() GROUP_CONCAT() </li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> `name`, SEX <span class="keyword">FROM</span> demo_2</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> SEX;</span><br><span class="line">ERROR <span class="number">1055</span> (<span class="number">42000</span>): Expression <span class="number">1</span> <span class="keyword">of</span> <span class="keyword">SELECT</span> list <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> clause <span class="keyword">and</span> <span class="keyword">contains</span> nonaggregated <span class="keyword">column</span> <span class="string">&#x27;stuinfo.demo_2.name&#x27;</span> which <span class="keyword">is</span> <span class="keyword">not</span> functionally dependent <span class="keyword">on</span> columns <span class="keyword">in</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> clause; this <span class="keyword">is</span> incompatible <span class="keyword">with</span> sql_mode<span class="operator">=</span>only_full_group_by</span><br><span class="line">### SEX</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> SEX, GROUP_CONCAT(name) <span class="keyword">AS</span> name <span class="keyword">FROM</span> demo_2</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> SEX;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+-----------+</span></span><br><span class="line"><span class="operator">|</span> SEX  <span class="operator">|</span> name      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+-----------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> Han,Xuan  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> Jack,Mike <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+-----------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><ol start="3"><li>WITH POLLUP </li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> SEX, GROUP_CONCAT(name) <span class="keyword">AS</span> name <span class="keyword">FROM</span> demo_2</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> SEX <span class="keyword">WITH</span> <span class="keyword">ROLLUP</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------------------+</span></span><br><span class="line"><span class="operator">|</span> SEX  <span class="operator">|</span> name               <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------------------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> Han,Xuan           <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> Jack,Mike          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span> Han,Xuan,Jack,Mike <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------------------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure><h3 id="font-color-red--font"><font color='red'></font></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">HAVING</span> <span class="operator">&lt;</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure><p>HAVING  WHERE  HAVING  WHERE  WHERE  HAVING </p><ol><li><strong><font color='orange'>WHERE  HAVING </font></strong></li><li><strong>WHERE  HAVING </strong></li><li><strong>WHERE  HAVING  <font color='orange'> HAVING  GROUP BY </font></strong></li><li>WHERE  HAVING <strong>WHERE  HAVING <font color='orange'></font></strong></li><li><strong><font color='red'>WHERE  HAVING </font></strong></li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">#<span class="number">4</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> name <span class="keyword">FROM</span> demo_2</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">HAVING</span> Math<span class="operator">&gt;</span><span class="number">60</span>;</span><br><span class="line">ERROR <span class="number">1054</span> (<span class="number">42</span>S22): <span class="literal">Unknown</span> <span class="keyword">column</span> <span class="string">&#x27;Math&#x27;</span> <span class="keyword">in</span> <span class="string">&#x27;having clause&#x27;</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> name <span class="keyword">FROM</span> demo_2</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> Math<span class="operator">&gt;</span><span class="number">60</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+</span></span><br><span class="line"><span class="operator">|</span> name <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+</span></span><br><span class="line"><span class="operator">|</span> Jack <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Mike <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Han  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Xuan <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+</span></span><br><span class="line">#<span class="number">5</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> Math <span class="keyword">AS</span>  <span class="keyword">FROM</span> demo_2</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> <span class="operator">&gt;</span><span class="number">60</span>;</span><br><span class="line">ERROR <span class="number">1054</span> (<span class="number">42</span>S22): <span class="literal">Unknown</span> <span class="keyword">column</span> <span class="string">&#x27;&#x27;</span> <span class="keyword">in</span> <span class="string">&#x27;where clause&#x27;</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> Math <span class="keyword">AS</span>  <span class="keyword">FROM</span> demo_2</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">HAVING</span> <span class="operator">&gt;</span><span class="number">60</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">98</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">76</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">87</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">67</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> demo_0;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-------+------+--------+</span></span><br><span class="line"><span class="operator">|</span> id    <span class="operator">|</span> name  <span class="operator">|</span> age  <span class="operator">|</span> addr   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-------+------+--------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">33703</span> <span class="operator">|</span> Mike  <span class="operator">|</span>   <span class="number">23</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">36640</span> <span class="operator">|</span> XUAN  <span class="operator">|</span>   <span class="number">22</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">36964</span> <span class="operator">|</span> Han   <span class="operator">|</span>   <span class="number">22</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">12398</span> <span class="operator">|</span> Jack  <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">21343</span> <span class="operator">|</span> Cling <span class="operator">|</span>   <span class="number">21</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-------+------+--------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> GROUP_CONCAT(name) ,addr <span class="keyword">FROM</span> demo_0</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> addr</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">HAVING</span> addr<span class="operator">!=</span>&quot;&quot;;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+--------+</span></span><br><span class="line"><span class="operator">|</span> GROUP_CONCAT(name) <span class="operator">|</span> addr   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+--------+</span></span><br><span class="line"><span class="operator">|</span> Mike,XUAN,Han      <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Jack               <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+--------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong> SELECT  SELECT  SELECT FROM WHERE GROUP BY  HAVING </strong>  WHERE  INNOT INEXISTSNOT EXISTS </p><p></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">##</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> type_info;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------------+-------+----------+</span></span><br><span class="line"><span class="operator">|</span> id   <span class="operator">|</span> type         <span class="operator">|</span> price <span class="operator">|</span> capacity <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------------+-------+----------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span>        <span class="operator">|</span>   <span class="number">150</span> <span class="operator">|</span> <span class="number">2</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">2</span> <span class="operator">|</span>        <span class="operator">|</span>   <span class="number">200</span> <span class="operator">|</span> <span class="number">2</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">3</span> <span class="operator">|</span>        <span class="operator">|</span>   <span class="number">210</span> <span class="operator">|</span> <span class="number">2</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">4</span> <span class="operator">|</span>      <span class="operator">|</span>   <span class="number">400</span> <span class="operator">|</span> <span class="number">4</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">5</span> <span class="operator">|</span>      <span class="operator">|</span>   <span class="number">600</span> <span class="operator">|</span> <span class="number">4</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------------+-------+----------+</span></span><br><span class="line">##</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> room_info;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+----------+-------+---------+</span></span><br><span class="line"><span class="operator">|</span> type         <span class="operator">|</span> location <span class="operator">|</span> state <span class="operator">|</span> room_id <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+----------+-------+---------+</span></span><br><span class="line"><span class="operator">|</span>        <span class="operator">|</span> <span class="number">10</span><span class="number">-1</span>     <span class="operator">|</span>     <span class="number">1</span> <span class="operator">|</span> <span class="number">001</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>        <span class="operator">|</span> <span class="number">10</span><span class="number">-2</span>     <span class="operator">|</span>     <span class="number">1</span> <span class="operator">|</span> <span class="number">002</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>        <span class="operator">|</span> <span class="number">10</span><span class="number">-3</span>     <span class="operator">|</span>     <span class="number">0</span> <span class="operator">|</span> <span class="number">003</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>        <span class="operator">|</span> <span class="number">10</span><span class="number">-4</span>     <span class="operator">|</span>     <span class="number">0</span> <span class="operator">|</span> <span class="number">004</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>        <span class="operator">|</span> <span class="number">10</span><span class="number">-5</span>     <span class="operator">|</span>     <span class="number">0</span> <span class="operator">|</span> <span class="number">005</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>        <span class="operator">|</span> <span class="number">11</span><span class="number">-6</span>     <span class="operator">|</span>     <span class="number">0</span> <span class="operator">|</span> <span class="number">006</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>        <span class="operator">|</span> <span class="number">11</span><span class="number">-7</span>     <span class="operator">|</span>     <span class="number">0</span> <span class="operator">|</span> <span class="number">007</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>        <span class="operator">|</span> <span class="number">12</span><span class="number">-8</span>     <span class="operator">|</span>     <span class="number">0</span> <span class="operator">|</span> <span class="number">008</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="operator">|</span> <span class="number">12</span><span class="number">-9</span>     <span class="operator">|</span>     <span class="number">0</span> <span class="operator">|</span> <span class="number">009</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="operator">|</span> <span class="number">13</span><span class="number">-10</span>    <span class="operator">|</span>     <span class="number">0</span> <span class="operator">|</span> <span class="number">010</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="operator">|</span> <span class="number">10</span><span class="number">-11</span>    <span class="operator">|</span>     <span class="number">1</span> <span class="operator">|</span> <span class="number">011</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+----------+-------+---------+</span></span><br><span class="line">##</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> customer_info;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------+------+-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> name   <span class="operator">|</span> ID     <span class="operator">|</span> age  <span class="operator">|</span> tel         <span class="operator">|</span> room_id <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------+------+-------------+---------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> <span class="number">511323</span> <span class="operator">|</span>   <span class="number">18</span> <span class="operator">|</span> <span class="number">18990889826</span> <span class="operator">|</span> <span class="number">001</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> <span class="number">511345</span> <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span> <span class="number">17390199497</span> <span class="operator">|</span> <span class="number">011</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> <span class="number">532435</span> <span class="operator">|</span>   <span class="number">45</span> <span class="operator">|</span> <span class="number">18932981949</span> <span class="operator">|</span> <span class="number">002</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> <span class="number">343234</span> <span class="operator">|</span>   <span class="number">34</span> <span class="operator">|</span> <span class="number">14342324323</span> <span class="operator">|</span> <span class="number">001</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span> <span class="number">343323</span> <span class="operator">|</span>   <span class="number">23</span> <span class="operator">|</span> <span class="number">32232123343</span> <span class="operator">|</span> <span class="number">002</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------+------+-------------+---------+</span></span><br></pre></td></tr></table></figure><p><strong><mark class="hl-label blue"></mark> </strong></p><p>1</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> name <span class="keyword">FROM</span> customer_info</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> room_id <span class="operator">=</span> (</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> room_id <span class="keyword">FROM</span> customer_info <span class="keyword">WHERE</span> `name`<span class="operator">=</span>&quot;&quot;)</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">AND</span> `name`<span class="operator">!=</span><span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+</span></span><br><span class="line"><span class="operator">|</span> name   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+</span></span><br></pre></td></tr></table></figure><p>2</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> price <span class="keyword">FROM</span> type_info</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> type<span class="operator">=</span>(</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> type <span class="keyword">FROM</span> room_info</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> room_id<span class="operator">=</span>(</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> room_id <span class="keyword">FROM</span> customer_info</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> name <span class="operator">=</span> &quot;&quot;));</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+</span></span><br><span class="line"><span class="operator">|</span> price <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+</span></span><br><span class="line"><span class="operator">|</span>   <span class="number">150</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+</span></span><br></pre></td></tr></table></figure><p><strong><mark class="hl-label blue"></mark> </strong><br>1</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> price <span class="keyword">FROM</span> type_info</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> type <span class="keyword">IN</span>(</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> type <span class="keyword">FROM</span> room_info</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> state<span class="operator">=</span><span class="number">0</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+</span></span><br><span class="line"><span class="operator">|</span> price <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+</span></span><br><span class="line"><span class="operator">|</span>   <span class="number">150</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>   <span class="number">210</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>   <span class="number">200</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>   <span class="number">400</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+</span></span><br></pre></td></tr></table></figure><p>2 capacity  price typepricecapacity</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> type,price,capacity <span class="keyword">FROM</span> type_info</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> price <span class="keyword">IN</span>(</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="built_in">MAX</span>(price) <span class="keyword">FROM</span> type_info</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> capacity);</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+-------+----------+</span></span><br><span class="line"><span class="operator">|</span> type         <span class="operator">|</span> price <span class="operator">|</span> capacity <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+-------+----------+</span></span><br><span class="line"><span class="operator">|</span>        <span class="operator">|</span>   <span class="number">210</span> <span class="operator">|</span> <span class="number">2</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="operator">|</span>   <span class="number">600</span> <span class="operator">|</span> <span class="number">4</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+-------+----------+</span></span><br><span class="line"></span><br><span class="line">#</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> type, <span class="built_in">MAX</span>(price), capacity <span class="keyword">FROM</span> type_info</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> capacity;</span><br><span class="line">ERROR <span class="number">1055</span> (<span class="number">42000</span>): Expression #<span class="number">1</span> <span class="keyword">of</span> <span class="keyword">SELECT</span> list <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> clause <span class="keyword">and</span> <span class="keyword">contains</span> nonaggregated <span class="keyword">column</span> <span class="string">&#x27;custom_info.type_info.type&#x27;</span> which <span class="keyword">is</span> <span class="keyword">not</span> functionally dependent <span class="keyword">on</span> columns <span class="keyword">in</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> clause; this <span class="keyword">is</span> incompatible <span class="keyword">with</span> sql_mode<span class="operator">=</span>only_full_group_by</span><br><span class="line"># type  <span class="keyword">GROUP</span> <span class="keyword">BY</span>  </span><br></pre></td></tr></table></figure><p> IN  NOT IN EXISTS <strong>EXISTS  true  falseEXISTS </strong> </p><p>3</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> type_info</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> <span class="keyword">EXISTS</span>(</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> state <span class="keyword">FROM</span> room_info</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> state<span class="operator">=</span><span class="number">1</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------------+-------+----------+</span></span><br><span class="line"><span class="operator">|</span> id   <span class="operator">|</span> type         <span class="operator">|</span> price <span class="operator">|</span> capacity <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------------+-------+----------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span>        <span class="operator">|</span>   <span class="number">150</span> <span class="operator">|</span> <span class="number">2</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">2</span> <span class="operator">|</span>        <span class="operator">|</span>   <span class="number">200</span> <span class="operator">|</span> <span class="number">2</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">3</span> <span class="operator">|</span>        <span class="operator">|</span>   <span class="number">210</span> <span class="operator">|</span> <span class="number">2</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">4</span> <span class="operator">|</span>      <span class="operator">|</span>   <span class="number">400</span> <span class="operator">|</span> <span class="number">4</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">5</span> <span class="operator">|</span>      <span class="operator">|</span>   <span class="number">600</span> <span class="operator">|</span> <span class="number">4</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------------+-------+----------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p><strong> SQL </strong> <br> SELECT MySQL  SELECT <strong></strong> </p><h3 id="font-color-red--font"><font color='red'></font></h3><p> capacity  price typepricecapacity</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> type,price,capacity <span class="keyword">FROM</span> type_info</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> price <span class="keyword">IN</span>(</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="built_in">MAX</span>(price) <span class="keyword">FROM</span> type_info</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> capacity);</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+-------+----------+</span></span><br><span class="line"><span class="operator">|</span> type         <span class="operator">|</span> price <span class="operator">|</span> capacity <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+-------+----------+</span></span><br><span class="line"><span class="operator">|</span>        <span class="operator">|</span>   <span class="number">210</span> <span class="operator">|</span> <span class="number">2</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="operator">|</span>   <span class="number">600</span> <span class="operator">|</span> <span class="number">4</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+-------+----------+</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span>(</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> type,price,capacity <span class="keyword">FROM</span> type_info</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> price <span class="keyword">IN</span>(</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="built_in">MAX</span>(price) <span class="keyword">FROM</span> type_info</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> capacity)) temp</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> temp.price <span class="keyword">DESC</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> LIMIT <span class="number">1</span>,<span class="number">1</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-------+----------+</span></span><br><span class="line"><span class="operator">|</span> type      <span class="operator">|</span> price <span class="operator">|</span> capacity <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-------+----------+</span></span><br><span class="line"><span class="operator">|</span>     <span class="operator">|</span>   <span class="number">210</span> <span class="operator">|</span> <span class="number">2</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-------+----------+</span></span><br></pre></td></tr></table></figure><p> SELECT  FROM </p><p>SELECT  * FROM () AS <strong></strong></p><h3 id="font-color-red--font"><font color='red'></font></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+---------+------+------------+</span></span><br><span class="line"><span class="operator">|</span> id   <span class="operator">|</span> name    <span class="operator">|</span> mgr  <span class="operator">|</span> department <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+---------+------+------------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span> Han     <span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span> <span class="number">10</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">2</span> <span class="operator">|</span> Jack    <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> <span class="number">12</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">3</span> <span class="operator">|</span> Tom     <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> <span class="number">12</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">4</span> <span class="operator">|</span> Cling   <span class="operator">|</span> <span class="number">2</span>    <span class="operator">|</span> <span class="number">20</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">5</span> <span class="operator">|</span> Black   <span class="operator">|</span> <span class="number">3</span>    <span class="operator">|</span> <span class="number">20</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">6</span> <span class="operator">|</span> JayChou <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> <span class="number">12</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+---------+------+------------+</span></span><br></pre></td></tr></table></figure><p> Jack </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> (mgr,department)<span class="operator">=</span>(</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> mgr,department <span class="keyword">FROM</span> emp</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> name<span class="operator">=</span>&quot;Jack&quot;)</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="operator">&amp;&amp;</span> name<span class="operator">!=</span>&quot;Jack&quot;;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+---------+------+------------+</span></span><br><span class="line"><span class="operator">|</span> id   <span class="operator">|</span> name    <span class="operator">|</span> mgr  <span class="operator">|</span> department <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+---------+------+------------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">3</span> <span class="operator">|</span> Tom     <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> <span class="number">12</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">6</span> <span class="operator">|</span> JayChou <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> <span class="number">12</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+---------+------+------------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p> mgr  department </p><h3 id="font-color-red--font"><font color='red'></font></h3><p> <code>UNION ALL</code>  <code>UNION</code> NO.1  NO.2 </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> NO1SC.stu_info;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+------+-------+</span></span><br><span class="line"><span class="operator">|</span> name <span class="operator">|</span> age  <span class="operator">|</span> score <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+------+-------+</span></span><br><span class="line"><span class="operator">|</span> Jack <span class="operator">|</span>   <span class="number">18</span> <span class="operator">|</span>   <span class="number">150</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Mike <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span>   <span class="number">149</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Dan  <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span>   <span class="number">130</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Xuan <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span>   <span class="number">141</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+------+-------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> NO2SC.stu_info;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+------+-------+</span></span><br><span class="line"><span class="operator">|</span> name    <span class="operator">|</span> age  <span class="operator">|</span> score <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+------+-------+</span></span><br><span class="line"><span class="operator">|</span> JayChou <span class="operator">|</span>   <span class="number">17</span> <span class="operator">|</span>   <span class="number">120</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Black   <span class="operator">|</span>   <span class="number">28</span> <span class="operator">|</span>   <span class="number">120</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Han     <span class="operator">|</span>   <span class="number">21</span> <span class="operator">|</span>   <span class="number">147</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+------+-------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> NO1SC.stu_info</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">UNION</span> <span class="keyword">ALL</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> NO2SC.stu_info</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> score <span class="keyword">DESC</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+------+-------+</span></span><br><span class="line"><span class="operator">|</span> name    <span class="operator">|</span> age  <span class="operator">|</span> score <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+------+-------+</span></span><br><span class="line"><span class="operator">|</span> Jack    <span class="operator">|</span>   <span class="number">18</span> <span class="operator">|</span>   <span class="number">150</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Mike    <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span>   <span class="number">149</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Han     <span class="operator">|</span>   <span class="number">21</span> <span class="operator">|</span>   <span class="number">147</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Xuan    <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span>   <span class="number">141</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Dan     <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span>   <span class="number">130</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Black   <span class="operator">|</span>   <span class="number">28</span> <span class="operator">|</span>   <span class="number">120</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JayChou <span class="operator">|</span>   <span class="number">17</span> <span class="operator">|</span>   <span class="number">120</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+------+-------+</span></span><br></pre></td></tr></table></figure><blockquote><p><a href="http://c.biancheng.net/">C</a> <a href="https://www.bilibili.com/video/BV1H64y1U7GJ?p=30&amp;spm_id_from=pageDriver&amp;vd_source=f507850c724cff595de0e591730ebe9f">MYSQL</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category> MySQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>0?</title>
      <link href="/2022/09/05/%E6%95%B0%E7%BB%84%E7%9A%84%E8%B5%B7%E5%A7%8B%E4%B8%8B%E6%A0%87%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%BA0/"/>
      <url>/2022/09/05/%E6%95%B0%E7%BB%84%E7%9A%84%E8%B5%B7%E5%A7%8B%E4%B8%8B%E6%A0%87%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%BA0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>x0?</p><p> C  0  1 :smile:  C  0 </p><ul><li><p><strong><font color='orange'></font></strong><br>a[0]   =  a + 0 * 4   ()<br>a[1]   =  a + 1 * 4   (1, 4 )<br>a[2]   =  a + 2 * 4   (2, 8 )<br><br>a[5]  =  a + 5 * 4  (5   20)<br> 1 1,, 0  1</p></li><li><p><strong><font color='orange'></font></strong> <br><img src="/2022/img/2025849-20200824195059390-1250153254.png" alt=""></p><p>[x,y):[x,z)[z,y)</p></li><li><p>[1,3,4,7,8] 5/2 = 24 1  2 3</p></li><li><p> 15  14  0  15  15 </p></li></ul><p><strong></strong></p>]]></content>
      
      
      <categories>
          
          <category> C </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/09/05/%E5%88%9D%E8%AF%86%E5%A4%8D%E6%9D%82%E5%BA%A6%E4%B8%8E%E5%AF%B9%E6%95%B0%E5%99%A8/"/>
      <url>/2022/09/05/%E5%88%9D%E8%AF%86%E5%A4%8D%E6%9D%82%E5%BA%A6%E4%B8%8E%E5%AF%B9%E6%95%B0%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="font-color-red--font"><font color='red'></font></h2><ul><li> N  API </li><li><strong><font color='orange'></font></strong></li><li></li><li>(<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>) <br><strong>,</strong> ?,,,<strong>,,</strong> ,<a href="https://jyxcpp.netlify.app/2022/07/08/csapp/">csapp</a></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo><mo>&gt;</mo><mi>O</mi><mo stretchy="false">(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy="false">)</mo><mo>&gt;</mo><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo><mo>&gt;</mo><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo></mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy="false">)</mo><mo>&gt;</mo><mi>O</mi><mo stretchy="false">(</mo><msup><mi>N</mi><mi>X</mi></msup><mo stretchy="false">)</mo><mo>&gt;</mo><mi>O</mi><mo stretchy="false">(</mo><msup><mi>X</mi><mi>N</mi></msup><mo stretchy="false">)</mo><mo>&gt;</mo><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">!</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)&gt;O(logN)&gt;O(N)&gt;O(NlogN)&gt;O(N^X)&gt;O(X^N)&gt;O(N!)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">X</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">!)</span></span></span></span>  X N </li></ul><h2 id="font-color-red--font"><font color='red'></font></h2><p></p><ol><li><strong> a</strong></li><li><strong>() b</strong></li><li><strong></strong></li><li><strong> a  b </strong></li><li><strong> a  b  a </strong></li><li><strong></strong></li><li><strong> a </strong></li></ol><p>:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//sortTester.h</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span>* <span class="title">generateRandomArray</span><span class="params">(<span class="type">int</span> maxVar, <span class="type">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(maxVar &lt;= <span class="number">0</span> || len &lt;= <span class="number">0</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line"><span class="type">int</span> *arr = <span class="keyword">new</span> <span class="type">int</span>[len];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">&#123;</span><br><span class="line">arr[i] = <span class="built_in">rand</span>() % maxVar;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span>* <span class="title">cpyArr</span><span class="params">(<span class="type">int</span>* arr, <span class="type">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(arr == <span class="literal">NULL</span> || len &lt;= <span class="number">0</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line"><span class="type">int</span>* cpy = <span class="keyword">new</span> <span class="type">int</span>[len];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">&#123;</span><br><span class="line">cpy[i] = arr[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> cpy;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isEqual</span><span class="params">(<span class="type">int</span>* arr1, <span class="type">int</span>* arr2, <span class="type">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(arr1[i] != arr2[i])</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> function&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sortTester</span><span class="params">(function func, <span class="type">int</span> times, <span class="type">int</span> maxVar, <span class="type">int</span> maxLen)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">srand</span>(<span class="built_in">time</span>(<span class="literal">NULL</span>));</span><br><span class="line"><span class="type">int</span> len;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; times; i++)</span><br><span class="line">&#123;</span><br><span class="line">len = <span class="built_in">rand</span>() % maxLen;</span><br><span class="line"><span class="type">int</span>* arr = <span class="built_in">generateRandomArray</span>(maxVar, len);</span><br><span class="line"><span class="type">int</span>* cpy = <span class="built_in">cpyArr</span>(arr, len);</span><br><span class="line"><span class="type">int</span>* cpy1 = <span class="built_in">cpyArr</span>(arr, len);</span><br><span class="line"><span class="built_in">sort</span>(arr, &amp;arr[len], [](<span class="type">int</span> a, <span class="type">int</span> b)&#123;<span class="keyword">return</span> a &lt; b;&#125;); <span class="comment">//</span></span><br><span class="line"><span class="built_in">func</span>(cpy, len, [](<span class="type">int</span> a, <span class="type">int</span> b)&#123;<span class="keyword">return</span> a&lt;b;&#125;);</span><br><span class="line"><span class="keyword">if</span>(!<span class="built_in">isEqual</span>(arr, cpy, len))<span class="comment">//</span></span><br><span class="line">&#123;</span><br><span class="line">cout&lt;&lt; <span class="string">&quot;wrong....&quot;</span> &lt;&lt; endl;</span><br><span class="line">cout&lt;&lt; <span class="string">&quot;original : &quot;</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">cout&lt;&lt; cpy1[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">cout&lt;&lt; endl;</span><br><span class="line">cout&lt;&lt; <span class="string">&quot;wrong case: &quot;</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">cout&lt;&lt; cpy[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">cout&lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt; <span class="string">&quot;success&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">delete</span>[] cpy;</span><br><span class="line"><span class="keyword">delete</span>[] arr;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;sortTester.h&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T, <span class="keyword">class</span> cmptor&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">bubbleSort</span><span class="params">(T* vec, <span class="type">int</span> len, cmptor cmp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len<span class="number">-1</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>; k &lt; len<span class="number">-1</span>-i; k++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(!<span class="built_in">cmp</span>(vec[k], vec[k+<span class="number">1</span>]))</span><br><span class="line"><span class="built_in">swap</span>(vec[k], vec[k+<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">bool</span> <span class="params">(*cmp)</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span>;</span><br><span class="line"><span class="keyword">auto</span> sort = bubbleSort&lt;<span class="type">int</span>, cmp&gt;;</span><br><span class="line"><span class="built_in">sortTester</span>(sort, <span class="number">100</span>, <span class="number">100000</span>, <span class="number">10000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL-()</title>
      <link href="/2022/09/03/MySQL-%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C/"/>
      <url>/2022/09/03/MySQL-%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p><strong> <code>TABLE</code> </strong></p></blockquote><h2 id="font-color-red-INSERT-font"><font color='red'>INSERT</font></h2><p>INSERT <br><strong><mark class="hl-label blue">INSERT...VALUES</mark> </strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> [<span class="keyword">INTO</span>] <span class="operator">&lt;</span><span class="operator">&gt;</span> [ <span class="operator">&lt;</span><span class="number">1</span><span class="operator">&gt;</span> [ ,  <span class="operator">&lt;</span>n<span class="operator">&gt;</span>] ]</span><br><span class="line"><span class="keyword">VALUES</span> (&#123;expr<span class="operator">|</span><span class="keyword">DEFAULT</span>&#125;,...),(...),...</span><br></pre></td></tr></table></figure><p></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> demo_0(</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> id       <span class="type">CHAR</span>(<span class="number">12</span>),</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> `name`   <span class="type">VARCHAR</span>(<span class="number">32</span>),</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> age      TINYINT,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> addr     <span class="type">VARCHAR</span>(<span class="number">32</span>));</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> demo_0</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> (id, `name`, age, addr)</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">VALUE</span>(<span class="string">&#x27;12336&#x27;</span>, <span class="string">&#x27;QuanHa&#x27;</span>, <span class="number">20</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure><ul><li><p><strong></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> demo_0</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> (id, `name`, age, addr) <span class="keyword">VALUES</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> (<span class="string">&#x27;13445&#x27;</span>, <span class="string">&#x27;Jack&#x27;</span>, <span class="number">19</span>, <span class="string">&#x27;&#x27;</span>),</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> (<span class="string">&#x27;11234&#x27;</span>,<span class="string">&#x27;Mike&#x27;</span>, <span class="number">21</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">Query OK, <span class="number">2</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line">Records: <span class="number">2</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br></pre></td></tr></table></figure></li><li><p><strong> NULL()  </strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> demo_0 (id,age,addr)</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">VALUES</span>(<span class="string">&#x27;12345&#x27;</span>, <span class="number">18</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> demo_0;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+------+--------+</span></span><br><span class="line"><span class="operator">|</span> id    <span class="operator">|</span> name   <span class="operator">|</span> age  <span class="operator">|</span> addr   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+------+--------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">12336</span> <span class="operator">|</span> QuanHa <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">12345</span> <span class="operator">|</span> <span class="keyword">NULL</span>   <span class="operator">|</span>   <span class="number">18</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+------+--------+</span></span><br></pre></td></tr></table></figure></li><li><p><strong> VALUES </strong>  <code>DESC</code> </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> demo_0 <span class="keyword">VALUES</span>(<span class="string">&#x27;111111&#x27;</span>,<span class="string">&#x27;XUAN&#x27;</span>,<span class="number">19</span>,<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure></li></ul><p><strong><mark class="hl-label blue">INSERT...SET</mark> </strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> demo_0</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SET</span> id<span class="operator">=</span><span class="string">&#x27;12321&#x27;</span>, name<span class="operator">=</span><span class="string">&#x27;Han&#x27;</span>, age<span class="operator">=</span><span class="number">20</span>, addr<span class="operator">=</span><span class="string">&#x27;&#x27;</span>;</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> demo_0;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------+------+--------+</span></span><br><span class="line"><span class="operator">|</span> id     <span class="operator">|</span> name   <span class="operator">|</span> age  <span class="operator">|</span> addr   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------+------+--------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">12321</span>  <span class="operator">|</span> Han    <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------+------+--------+</span></span><br></pre></td></tr></table></figure><p><strong><mark class="hl-label blue">INSERT...SELECT</mark> </strong></p><p><strong><font color='orange'></font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> demo_1(id, name, age, addr)</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> id, name , age, addr</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> demo_0</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> age<span class="operator">=</span><span class="number">20</span>;</span><br><span class="line">Query OK, <span class="number">2</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line">Records: <span class="number">2</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> demo_1;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+------+--------+</span></span><br><span class="line"><span class="operator">|</span> id    <span class="operator">|</span> name   <span class="operator">|</span> age  <span class="operator">|</span> addr   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+------+--------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">12336</span> <span class="operator">|</span> QuanHa <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">12321</span> <span class="operator">|</span> Han    <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+------+--------+</span></span><br></pre></td></tr></table></figure><blockquote><p> INSERTDELAYDE INSERTSELECT  MySQL </p></blockquote><p><strong><mark class="hl-label blue"></mark> </strong><br></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+---------+------+------------+</span></span><br><span class="line"><span class="operator">|</span> id   <span class="operator">|</span> name    <span class="operator">|</span> mgr  <span class="operator">|</span> department <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+---------+------+------------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span> Han     <span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span> <span class="number">10</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">2</span> <span class="operator">|</span> Jack    <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> <span class="number">12</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">3</span> <span class="operator">|</span> Tom     <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> <span class="number">12</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">4</span> <span class="operator">|</span> Cling   <span class="operator">|</span> <span class="number">2</span>    <span class="operator">|</span> <span class="number">20</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">5</span> <span class="operator">|</span> Black   <span class="operator">|</span> <span class="number">3</span>    <span class="operator">|</span> <span class="number">20</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">6</span> <span class="operator">|</span> JayChou <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> <span class="number">12</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span> Han     <span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span> <span class="number">10</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">2</span> <span class="operator">|</span> Jack    <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> <span class="number">12</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">3</span> <span class="operator">|</span> Tom     <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> <span class="number">12</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">4</span> <span class="operator">|</span> Cling   <span class="operator">|</span> <span class="number">2</span>    <span class="operator">|</span> <span class="number">20</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">5</span> <span class="operator">|</span> Black   <span class="operator">|</span> <span class="number">3</span>    <span class="operator">|</span> <span class="number">20</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">6</span> <span class="operator">|</span> JayChou <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> <span class="number">12</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+---------+------+------------+</span></span><br><span class="line"><span class="number">12</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp<span class="operator">^</span>C</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp;</span><br><span class="line">Query OK, <span class="number">12</span> <span class="keyword">rows</span> affected (<span class="number">0.00</span> sec)</span><br><span class="line">Records: <span class="number">12</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp;</span><br><span class="line">Query OK, <span class="number">24</span> <span class="keyword">rows</span> affected (<span class="number">0.00</span> sec)</span><br><span class="line">Records: <span class="number">24</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line">###</span><br></pre></td></tr></table></figure><p></p><h2 id="font-color-red-UPDATE-font"><font color='red'>UPDATE</font></h2><p> UPDATE </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> <span class="operator">&lt;</span><span class="operator">&gt;</span> <span class="keyword">SET</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span> [,<span class="number">2</span><span class="operator">=</span><span class="number">2</span> ] [<span class="keyword">WHERE</span>]</span><br><span class="line">[<span class="keyword">ORDER</span> <span class="keyword">BY</span>] [LIMIT]</span><br></pre></td></tr></table></figure><p></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> demo_0;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------+------+--------+</span></span><br><span class="line"><span class="operator">|</span> id     <span class="operator">|</span> name   <span class="operator">|</span> age  <span class="operator">|</span> addr   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------+------+--------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">12345</span>  <span class="operator">|</span> <span class="keyword">NULL</span>   <span class="operator">|</span>   <span class="number">18</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">111111</span> <span class="operator">|</span> XUAN   <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------+------+--------+</span></span><br><span class="line"><span class="number">6</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">UPDATE</span> demo_0</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SET</span> id<span class="operator">=</span><span class="number">12213</span>, name<span class="operator">=</span><span class="keyword">NULL</span> #</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">111111</span>;</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line"><span class="keyword">Rows</span> matched: <span class="number">1</span>  Changed: <span class="number">1</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> demo_0;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+------+--------+</span></span><br><span class="line"><span class="operator">|</span> id    <span class="operator">|</span> name   <span class="operator">|</span> age  <span class="operator">|</span> addr   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+------+--------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">12345</span> <span class="operator">|</span> <span class="keyword">NULL</span>   <span class="operator">|</span>   <span class="number">18</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">12213</span> <span class="operator">|</span> <span class="keyword">NULL</span>   <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+------+--------+</span></span><br></pre></td></tr></table></figure><p></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">UPDATE</span> demo_0</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SET</span> id<span class="operator">=</span>id<span class="operator">*</span><span class="number">3</span>, id<span class="operator">=</span>id<span class="operator">+</span><span class="number">1</span>;</span><br><span class="line">Query OK, <span class="number">6</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line"><span class="keyword">Rows</span> matched: <span class="number">6</span>  Changed: <span class="number">6</span>  Warnings: <span class="number">0</span></span><br></pre></td></tr></table></figure><p>UPDATE id 1  3 </p><p> LIMIT </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">UPDATE</span> demo_0</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SET</span> age<span class="operator">=</span><span class="number">23</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> addr<span class="operator">=</span>&quot;&quot;</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> LIMIT <span class="number">3</span>;  #</span><br><span class="line">Query OK, <span class="number">3</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line"><span class="keyword">Rows</span> matched: <span class="number">3</span>  Changed: <span class="number">3</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> demo_0;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+------+--------+</span></span><br><span class="line"><span class="operator">|</span> id    <span class="operator">|</span> name   <span class="operator">|</span> age  <span class="operator">|</span> addr   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+------+--------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">37009</span> <span class="operator">|</span> QuanHa <span class="operator">|</span>   <span class="number">23</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">40336</span> <span class="operator">|</span> Jack   <span class="operator">|</span>   <span class="number">23</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">33703</span> <span class="operator">|</span> Mike   <span class="operator">|</span>   <span class="number">23</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">37036</span> <span class="operator">|</span> <span class="keyword">NULL</span>   <span class="operator">|</span>   <span class="number">22</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">36640</span> <span class="operator">|</span> XUAN   <span class="operator">|</span>   <span class="number">22</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">36964</span> <span class="operator">|</span> Han    <span class="operator">|</span>   <span class="number">21</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+------+--------+</span></span><br></pre></td></tr></table></figure><h2 id="font-color-red-DELETE-font"><font color='red'>DELETE</font></h2><p> DELETE </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> <span class="operator">&lt;</span><span class="operator">&gt;</span> [<span class="keyword">WHERE</span> ] [<span class="keyword">ORDER</span> <span class="keyword">BY</span> ] [LIMIT ]</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> demo_0;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+------+--------+</span></span><br><span class="line"><span class="operator">|</span> id    <span class="operator">|</span> name   <span class="operator">|</span> age  <span class="operator">|</span> addr   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+------+--------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">37009</span> <span class="operator">|</span> QuanHa <span class="operator">|</span>   <span class="number">23</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">40336</span> <span class="operator">|</span> Jack   <span class="operator">|</span>   <span class="number">23</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">33703</span> <span class="operator">|</span> Mike   <span class="operator">|</span>   <span class="number">23</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">37036</span> <span class="operator">|</span> <span class="keyword">NULL</span>   <span class="operator">|</span>   <span class="number">22</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">36640</span> <span class="operator">|</span> XUAN   <span class="operator">|</span>   <span class="number">22</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">36964</span> <span class="operator">|</span> Han    <span class="operator">|</span>   <span class="number">22</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+------+--------+</span></span><br><span class="line"><span class="number">6</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">DELETE</span> <span class="keyword">FROM</span> demo_0</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> id <span class="keyword">DESC</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> LIMIT <span class="number">3</span>;</span><br><span class="line">Query OK, <span class="number">3</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> demo_0;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+------+--------+</span></span><br><span class="line"><span class="operator">|</span> id    <span class="operator">|</span> name <span class="operator">|</span> age  <span class="operator">|</span> addr   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+------+--------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">33703</span> <span class="operator">|</span> Mike <span class="operator">|</span>   <span class="number">23</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">36640</span> <span class="operator">|</span> XUAN <span class="operator">|</span>   <span class="number">22</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">36964</span> <span class="operator">|</span> Han  <span class="operator">|</span>   <span class="number">22</span> <span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------+------+--------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p> 15  <code>DESC</code> (descent)  16  LIMIT  3 id <br><strong><font color='orange'> WHERE  LIMIT </font></strong></p><p><strong><mark class="hl-label blue"></mark> </strong></p><ol><li></li><li></li><li></li><li></li><li></li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+---------+------+------------+</span></span><br><span class="line"><span class="operator">|</span> id   <span class="operator">|</span> name    <span class="operator">|</span> mgr  <span class="operator">|</span> department <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+---------+------+------------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span> Han     <span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span> <span class="number">10</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">2</span> <span class="operator">|</span> Jack    <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> <span class="number">12</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">3</span> <span class="operator">|</span> Tom     <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> <span class="number">12</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">4</span> <span class="operator">|</span> Cling   <span class="operator">|</span> <span class="number">2</span>    <span class="operator">|</span> <span class="number">20</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">5</span> <span class="operator">|</span> Black   <span class="operator">|</span> <span class="number">3</span>    <span class="operator">|</span> <span class="number">20</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">6</span> <span class="operator">|</span> JayChou <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> <span class="number">12</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span> Han     <span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span> <span class="number">10</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">2</span> <span class="operator">|</span> Jack    <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> <span class="number">12</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">3</span> <span class="operator">|</span> Tom     <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> <span class="number">12</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">4</span> <span class="operator">|</span> Cling   <span class="operator">|</span> <span class="number">2</span>    <span class="operator">|</span> <span class="number">20</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">5</span> <span class="operator">|</span> Black   <span class="operator">|</span> <span class="number">3</span>    <span class="operator">|</span> <span class="number">20</span>         <span class="operator">|</span></span><br><span class="line"><span class="comment">--------------------------------------</span></span><br><span class="line"><span class="number">48</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span>  <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> temp <span class="keyword">LIKE</span> emp;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> temp</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp;</span><br><span class="line">Query OK, <span class="number">6</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line">Records: <span class="number">6</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">DROP</span> <span class="keyword">TABLE</span> emp;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> temp RENAME <span class="keyword">TO</span> emp;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+---------+------+------------+</span></span><br><span class="line"><span class="operator">|</span> id   <span class="operator">|</span> name    <span class="operator">|</span> mgr  <span class="operator">|</span> department <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+---------+------+------------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span> Han     <span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span> <span class="number">10</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">2</span> <span class="operator">|</span> Jack    <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> <span class="number">12</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">3</span> <span class="operator">|</span> Tom     <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> <span class="number">12</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">4</span> <span class="operator">|</span> Cling   <span class="operator">|</span> <span class="number">2</span>    <span class="operator">|</span> <span class="number">20</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">5</span> <span class="operator">|</span> Black   <span class="operator">|</span> <span class="number">3</span>    <span class="operator">|</span> <span class="number">20</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">6</span> <span class="operator">|</span> JayChou <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> <span class="number">12</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+---------+------+------------+</span></span><br><span class="line"><span class="number">6</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><h2 id="font-color-red-TRUNCATE-font"><font color='red'>TRUNCATE</font></h2><p><strong>TRUNCATE  TABLE </strong>  DELETE </p><ul><li><p>InnoDB TRUNCATE  TABLE  DELETE TRUNCATE  TABLE  AUTO_INCREMENT </p></li><li><p> MySQL 5.1 TRUNCATE TABLE  DELETE  FROM </p><ul><li></li><li></li><li></li><li> tbl_name.frm  TRUNCATE  TABLE </li><li> AUTO_INCREMENT  MyISAM  InnoDB MyISAM InnoDB</li><li>TRUNCATE  TABLE .par</li></ul></li></ul><p>TRUNCATE TABLE  MySQL  Oracle  SQL </p><h2 id="font-color-red-SELECT-font"><font color='red'>SELECT</font></h2><p>SELECT <a href="https://jyxcpp.netlify.app/2022/09/06/mysql-%E8%AF%A6%E8%A7%A3%E6%95%B0%E6%8D%AE%E8%A1%A8%E6%9F%A5%E8%AF%A2/">MySQL-SELECT</a></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category> MySQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL-()</title>
      <link href="/2022/09/02/MySQL-%E8%A1%A8%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/"/>
      <url>/2022/09/02/MySQL-%E8%A1%A8%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="font-color-red--font"><font color='red'></font></h2><p>1. 2. </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#################################################<span class="number">1.</span></span><br><span class="line"><span class="keyword">CREATE</span> [TEMPORARY] <span class="keyword">TABLE</span> [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] tbl_name</span><br><span class="line">    [(create_definition,...)]</span><br><span class="line">    [table_options] [select_statement]</span><br><span class="line">########<span class="number">1</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> demo_0 (</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> `name`   <span class="type">VARCHAR</span>(<span class="number">32</span>),</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>  age     TINYINT,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>  gender  <span class="type">CHAR</span>(<span class="number">1</span>),</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> `resume` TEXT);   #</span><br><span class="line">########<span class="number">2</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> demo_1 (</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> `name`  <span class="type">VARCHAR</span>(<span class="number">32</span>),</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>  age    TINYINT,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>  gender <span class="type">CHAR</span>(<span class="number">1</span>),</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> `resume` TEXT)</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> CHARSET utf8 <span class="keyword">COLLATE</span> utf8_bin ENGINE INNODB;</span><br><span class="line">#################################################<span class="number">2.</span></span><br><span class="line"><span class="keyword">CREATE</span> [TEMPORARY] <span class="keyword">TABLE</span> [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] tbl_name</span><br><span class="line">    [(] <span class="keyword">LIKE</span> old_tbl_name [)];</span><br><span class="line">########<span class="number">1</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> demo_2 <span class="keyword">LIKE</span> demo_1;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br></pre></td></tr></table></figure><blockquote><p> <code>table_options</code>  <code>select_statement</code>  <code>create_definition</code> <a href="https://jyxcpp.netlify.app/2022/08/31/mysql-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/">Mysql5.1</a> .</p></blockquote><ul><li><p>CREATE TABLE CREATE </p></li><li><p> 710  name  resume  ` <strong> name  resume  Mysql </strong> </p></li><li><p></p></li></ul>  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> staffInfo.demo_0 (</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> `name` <span class="type">VARCHAR</span>(<span class="number">32</span>));</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> USE staffInfo;</span><br><span class="line">Database changed</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> TABLES;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+</span></span><br><span class="line"><span class="operator">|</span> Tables_in_staffinfo <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+</span></span><br><span class="line"><span class="operator">|</span> demo_0              <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p> <code>db_name.tbl_name</code> `mydb` . `mytbl` `mydb.mytbl` </p><ul><li><p> <code>TEMPORARY</code> TEMPORARY <strong>TEMPORARY </strong>  CREATE  TEMPORARY TABLES </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> TEMPORARY <span class="keyword">TABLE</span> `aha`(data <span class="type">INT</span>); #stuinfo</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> quit; #</span><br><span class="line">Bye</span><br><span class="line">C:\Windows\system32<span class="operator">&gt;</span>mysql <span class="operator">-</span>u root <span class="operator">-</span>p</span><br><span class="line">Enter password: <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">Welcome <span class="keyword">to</span> the MySQL monitor.</span><br><span class="line">mysql<span class="operator">&gt;</span> use stuinfo;</span><br><span class="line">Database changed</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> tables;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------+</span></span><br><span class="line"><span class="operator">|</span> Tables_in_stuinfo <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------+</span></span><br><span class="line"><span class="operator">|</span> test_0            <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> test_1            <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> test_2            <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> test_3            <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> test_5            <span class="operator">|</span>  #</span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------+</span></span><br></pre></td></tr></table></figure></li><li><p><strong></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> demo (</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> country <span class="type">VARCHAR</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> &quot;China&quot;);</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> demo <span class="keyword">VALUES</span>(); #</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> demo;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+</span></span><br><span class="line"><span class="operator">|</span> country <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+</span></span><br><span class="line"><span class="operator">|</span> China   <span class="operator">|</span> #china</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+</span></span><br></pre></td></tr></table></figure><p> <code>NOT NULL DEFAULT</code> </p></li></ul><h2 id="font-color-red--font"><font color='red'></font></h2><p><strong><mark class="hl-label blue"></mark> </strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> TABLES;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------+</span></span><br><span class="line"><span class="operator">|</span> Tables_in_stuinfo <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------+</span></span><br><span class="line"><span class="operator">|</span> demo_1            <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> demo_3            <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> test_0            <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> test_1            <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> test_2            <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> test_3            <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> test_5            <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------+</span></span><br></pre></td></tr></table></figure><p><strong><mark class="hl-label blue"></mark> </strong></p><ol><li> <code>DESC</code>  <code>DESCRIBE</code> </li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">DESC</span> demo_1;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field   <span class="operator">|</span> Type        <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> age     <span class="operator">|</span> tinyint(<span class="number">4</span>)  <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> gender  <span class="operator">|</span> <span class="type">char</span>(<span class="number">1</span>)     <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> resume  <span class="operator">|</span> text        <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> address <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">32</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><ol start="2"><li> <code>SHOW CREATE TABLE</code> </li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> demo_1;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+-------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Table</span>  <span class="operator">|</span> <span class="keyword">Create</span> <span class="keyword">Table</span>                                                                               <span class="comment">----------------------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> demo_1 <span class="operator">|</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `demo_1` (</span><br><span class="line">  `age` tinyint(<span class="number">4</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `gender` <span class="type">char</span>(<span class="number">1</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `resume` text <span class="keyword">COLLATE</span> utf8_bin,</span><br><span class="line">  `address` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span></span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_bin <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+-------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p> DESCRIBE SHOW CREATE TABLE  SHOW CREATE TABLE  <code>\g</code>  <code>\G</code> </p><p><strong>&quot;<mark class="hl-label blue"></mark> </strong><br> <code>SHOW TABLE STATUS</code> </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> <span class="keyword">TABLE</span> STATUS \G;</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           Name: customer_info</span><br><span class="line">         Engine: InnoDB</span><br><span class="line">        Version: <span class="number">10</span></span><br><span class="line">     Row_format: <span class="keyword">Dynamic</span></span><br><span class="line">           <span class="keyword">Rows</span>: <span class="number">5</span></span><br><span class="line"> Avg_row_length: <span class="number">3276</span></span><br><span class="line">    Data_length: <span class="number">16384</span></span><br><span class="line">Max_data_length: <span class="number">0</span></span><br><span class="line">   Index_length: <span class="number">0</span></span><br><span class="line">      Data_free: <span class="number">0</span></span><br><span class="line"> Auto_increment: <span class="keyword">NULL</span></span><br><span class="line">    Create_time: <span class="number">2022</span><span class="number">-09</span><span class="number">-09</span> <span class="number">17</span>:<span class="number">03</span>:<span class="number">51</span></span><br><span class="line">    Update_time: <span class="keyword">NULL</span></span><br><span class="line">     Check_time: <span class="keyword">NULL</span></span><br><span class="line">      <span class="keyword">Collation</span>: utf8_general_ci</span><br><span class="line">       Checksum: <span class="keyword">NULL</span></span><br><span class="line"> Create_options:</span><br><span class="line">        Comment:</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">2.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           Name: fuck</span><br><span class="line">         Engine: <span class="keyword">NULL</span></span><br><span class="line">        Version: <span class="keyword">NULL</span></span><br><span class="line">     Row_format: <span class="keyword">NULL</span></span><br><span class="line">           <span class="keyword">Rows</span>: <span class="keyword">NULL</span></span><br><span class="line"> Avg_row_length: <span class="keyword">NULL</span></span><br><span class="line">    Data_length: <span class="keyword">NULL</span></span><br><span class="line">Max_data_length: <span class="keyword">NULL</span></span><br><span class="line">   Index_length: <span class="keyword">NULL</span></span><br><span class="line">      Data_free: <span class="keyword">NULL</span></span><br><span class="line"> Auto_increment: <span class="keyword">NULL</span></span><br><span class="line">    Create_time: <span class="keyword">NULL</span></span><br><span class="line">    Update_time: <span class="keyword">NULL</span></span><br><span class="line">     Check_time: <span class="keyword">NULL</span></span><br><span class="line">      <span class="keyword">Collation</span>: <span class="keyword">NULL</span></span><br><span class="line">       Checksum: <span class="keyword">NULL</span></span><br><span class="line"> Create_options: <span class="keyword">NULL</span></span><br><span class="line">        Comment: <span class="keyword">VIEW</span></span><br></pre></td></tr></table></figure><h2 id="font-color-red--font"><font color='red'></font></h2><p></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span><span class="operator">&gt;</span> []</span><br></pre></td></tr></table></figure><p></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123; </span><br><span class="line">  <span class="keyword">ADD</span> <span class="keyword">COLUMN</span> <span class="operator">&lt;</span><span class="operator">&gt;</span> <span class="operator">&lt;</span><span class="operator">&gt;</span></span><br><span class="line"><span class="operator">|</span> CHANGE <span class="keyword">COLUMN</span> <span class="operator">&lt;</span><span class="operator">&gt;</span> <span class="operator">&lt;</span><span class="operator">&gt;</span> <span class="operator">&lt;</span><span class="operator">&gt;</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">ALTER</span> <span class="keyword">COLUMN</span> <span class="operator">&lt;</span><span class="operator">&gt;</span> &#123; <span class="keyword">SET</span> <span class="keyword">DEFAULT</span> <span class="operator">&lt;</span><span class="operator">&gt;</span> <span class="operator">|</span> <span class="keyword">DROP</span> <span class="keyword">DEFAULT</span> &#125;</span><br><span class="line"><span class="operator">|</span> MODIFY <span class="keyword">COLUMN</span> <span class="operator">&lt;</span><span class="operator">&gt;</span> <span class="operator">&lt;</span><span class="operator">&gt;</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">DROP</span> <span class="keyword">COLUMN</span> <span class="operator">&lt;</span><span class="operator">&gt;</span></span><br><span class="line"><span class="operator">|</span> RENAME [<span class="keyword">TO</span>] <span class="operator">&lt;</span><span class="operator">&gt;</span></span><br><span class="line"><span class="operator">|</span> <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">&lt;</span><span class="operator">&gt;</span> # CHARSET</span><br><span class="line"><span class="operator">|</span> <span class="keyword">COLLATE</span> <span class="operator">&lt;</span><span class="operator">&gt;</span> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><a href="https://jyxcpp.netlify.app/2022/08/31/mysql-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/">Mysql5.1</a></p></blockquote><p><strong><mark class="hl-label blue"></mark> </strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> demo_2 RENAME <span class="keyword">TO</span> demo_3;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure><p><code>TO</code> </p><p><strong><mark class="hl-label blue"></mark> </strong></p><ol><li><strong></strong></li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">################</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> demo_1 CHARSET utf8 <span class="keyword">COLLATE</span> utf8_bin;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br></pre></td></tr></table></figure><ol start="2"><li><strong></strong></li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">################</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> demo_5 CHANGE country country <span class="type">CHAR</span>(<span class="number">10</span>) CHARSET ascii;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> demo_5 \G;</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">       <span class="keyword">Table</span>: demo_5</span><br><span class="line"><span class="keyword">Create</span> <span class="keyword">Table</span>: <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `demo_5` (</span><br><span class="line">  `name` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `country` <span class="type">char</span>(<span class="number">10</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> ascii <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8</span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p><strong><font color='orange'>()</font></strong></p><p><strong><mark class="hl-label blue"></mark> </strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">DESC</span> demo_1;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field  <span class="operator">|</span> Type        <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> name   <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">32</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> age    <span class="operator">|</span> tinyint(<span class="number">4</span>)  <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> gender <span class="operator">|</span> <span class="type">char</span>(<span class="number">1</span>)     <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> resume <span class="operator">|</span> text        <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> demo_1 <span class="keyword">ADD</span> <span class="keyword">COLUMN</span> address <span class="type">VARCHAR</span>(<span class="number">32</span>) </span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.03</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">DESC</span> demo_1;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field   <span class="operator">|</span> Type        <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> name    <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">32</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> age     <span class="operator">|</span> tinyint(<span class="number">4</span>)  <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> gender  <span class="operator">|</span> <span class="type">char</span>(<span class="number">1</span>)     <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> resume  <span class="operator">|</span> text        <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> address <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">32</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-------------+------+-----+---------+-------+</span></span><br></pre></td></tr></table></figure><p> <code>AFTER</code>  <code>FIRST</code> </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">DESC</span> demo_5;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field <span class="operator">|</span> Type        <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> name  <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">32</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> age   <span class="operator">|</span> tinyint(<span class="number">4</span>)  <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> sex   <span class="operator">|</span> <span class="type">char</span>(<span class="number">1</span>)     <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> demo_5 <span class="keyword">ADD</span> <span class="keyword">COLUMN</span> addr <span class="type">VARCHAR</span>(<span class="number">48</span>) AFTER age;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">DESC</span> demo_5;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field <span class="operator">|</span> Type        <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> name  <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">32</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> age   <span class="operator">|</span> tinyint(<span class="number">4</span>)  <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> addr  <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">48</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> sex   <span class="operator">|</span> <span class="type">char</span>(<span class="number">1</span>)     <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p><strong><mark class="hl-label blue"></mark> </strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> demo_1 CHANGE <span class="keyword">COLUMN</span> `name` `tel` <span class="type">VARCHAR</span>(<span class="number">11</span>);</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.07</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">DESC</span> demo_1;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field   <span class="operator">|</span> Type        <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> tel     <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">11</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> age     <span class="operator">|</span> tinyint(<span class="number">4</span>)  <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> gender  <span class="operator">|</span> <span class="type">char</span>(<span class="number">1</span>)     <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> resume  <span class="operator">|</span> text        <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> address <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">32</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-------------+------+-----+---------+-------+</span></span><br></pre></td></tr></table></figure><p><strong><font color='orange'></font></strong> </p><p><strong><mark class="hl-label blue"></mark> </strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> demo_1 MODIFY <span class="keyword">COLUMN</span> tel <span class="type">VARCHAR</span>(<span class="number">32</span>);</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">DESC</span> demo_1;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field   <span class="operator">|</span> Type        <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> tel     <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">32</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> age     <span class="operator">|</span> tinyint(<span class="number">4</span>)  <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> gender  <span class="operator">|</span> <span class="type">char</span>(<span class="number">1</span>)     <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> resume  <span class="operator">|</span> text        <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> address <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">32</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-------------+------+-----+---------+-------+</span></span><br></pre></td></tr></table></figure><p><strong> MODIFY </strong> <strong> CHANGE ()</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> demo_1 CHANGE <span class="keyword">COLUMN</span> `name` `name` <span class="type">VARCHAR</span>(<span class="number">32</span>);</span><br></pre></td></tr></table></figure><p><strong><mark class="hl-label blue"></mark> </strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> demo_1 <span class="keyword">DROP</span> tel;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">DESC</span> demo_1;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field   <span class="operator">|</span> Type        <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> age     <span class="operator">|</span> tinyint(<span class="number">4</span>)  <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> gender  <span class="operator">|</span> <span class="type">char</span>(<span class="number">1</span>)     <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> resume  <span class="operator">|</span> text        <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> address <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">32</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-------------+------+-----+---------+-------+</span></span><br></pre></td></tr></table></figure><h2 id="font-color-red--font"><font color='red'></font></h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> TABLES;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------+</span></span><br><span class="line"><span class="operator">|</span> Tables_in_stuinfo <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------+</span></span><br><span class="line"><span class="operator">|</span> demo_0            <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> demo_1            <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------+</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">DROP</span> <span class="keyword">TABLE</span> demo_0;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> TABLES;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------+</span></span><br><span class="line"><span class="operator">|</span> Tables_in_stuinfo <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------+</span></span><br><span class="line"><span class="operator">|</span> demo_1            <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------+</span></span><br></pre></td></tr></table></figure><h2 id="font-color-red--font"><font color='red'></font></h2><ul><li><p> ALTER TABLE  DESCRIBE tbl_name  MySQL VARCHARCHAR MySQL VARCHAR</p></li><li><p><strong><font color='orange'>ALTER TABLE (  RENAME )</font></strong>  ALTER  TABLE </p></li><li><p><strong><font color='orange'> ALTER TABLE ALTER,  INSERT  CREATE </font></strong></p></li><li><p> ALTER TABLE  ADD, ALTER,  DROP  CHANGE  MySQL  SQL  SQL  ALTER  TABLE </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">DESC</span> demo_1;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field   <span class="operator">|</span> Type       <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> gender  <span class="operator">|</span> <span class="type">char</span>(<span class="number">1</span>)    <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> resume  <span class="operator">|</span> text       <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> address <span class="operator">|</span> <span class="type">char</span>(<span class="number">8</span>)    <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+------------+------+-----+---------+-------+</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> demo_1 <span class="keyword">DROP</span> gender, <span class="keyword">DROP</span> resume;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">DESC</span> demo_1;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+---------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field   <span class="operator">|</span> Type    <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+---------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> address <span class="operator">|</span> <span class="type">char</span>(<span class="number">8</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+---------+------+-----+---------+-------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure></li><li><p><code>COLUMN</code> <code>CHARSET</code>  <code>CHARACTER SET</code> </p></li><li><p><strong><font color='orange'></font></strong> <strong></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> demo_1 CHARSET utf8;</span><br></pre></td></tr></table></figure><p><strong>CHAR, VARCHAR, TEXT</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tbl_name <span class="keyword">CONVERT</span> <span class="keyword">TO</span> CHARSET utf8;</span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category> MySQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL-</title>
      <link href="/2022/08/31/MySQL-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/"/>
      <url>/2022/08/31/MySQL-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="font-color-red--font"><font color='red'></font></h2><p>MySQL    MySQL  <strong><u></u><u>/</u><u></u><u>/</u></strong> <br><strong><mark class="hl-label blue"></mark> </strong></p><table><thead><tr><th></th><th></th><th>signed</th><th>unsigned</th></tr></thead><tbody><tr><td>TINYINT</td><td>1</td><td>-128  ~ 127</td><td>0 ~ 255</td></tr><tr><td>SMALLINT</td><td>2</td><td>-32768 ~ 32767</td><td>0 ~ 65535</td></tr><tr><td>MEDIUMINT</td><td>3</td><td>-8388608 ~ 8388607</td><td>0 ~ 16777215</td></tr><tr><td><font color='orange'>INT</font></td><td>4</td><td>-2147483648 ~ 2147483647</td><td>0 ~ 4294967295</td></tr><tr><td>BIGINT</td><td>8</td><td>-9223372036854775808 ~ 9223372036854775807</td><td>0 ~ 18446744073709551615</td></tr><tr><td><font color='orange'>FLOAT</font></td><td>4</td><td></td><td></td></tr><tr><td><font color='orange'>DOUBLE</font></td><td>8</td><td></td><td></td></tr><tr><td><font color='orange'>DECIMAL</font></td><td>M+2</td><td>M</td><td>M</td></tr></tbody></table><p><strong><mark class="hl-label blue"></mark> </strong></p><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td><font color='orange'>CHAR</font></td><td></td><td> 255 <u></u></td></tr><tr><td><font color='orange'>VARCHAR</font></td><td></td><td> 65532 <u></u></td></tr><tr><td>TINYTEXT</td><td></td><td>2^8 </td></tr><tr><td>TEXT</td><td></td><td>2^16  64 KB</td></tr><tr><td>MEDIUMTEXT</td><td></td><td>2^24  16 MB</td></tr><tr><td>LONGTEXT</td><td></td><td>2^32  4 GB</td></tr><tr><td>ENUM</td><td></td><td>12 (65535)</td></tr><tr><td>SET</td><td> SET</td><td>12348 64</td></tr></tbody></table><p><strong><mark class="hl-label blue">/</mark> </strong></p><table><thead><tr><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><td>YEAR</td><td>YYYY</td><td>1901 ~ 2155</td><td>1 </td></tr><tr><td><font color='orange'>TIME</font></td><td>HH:MM:SS</td><td>-838:59:59 ~ 838:59:59</td><td>3 </td></tr><tr><td><font color='orange'>DATE</font></td><td>YYYY-MM-DD</td><td>1000-01-01 ~ 9999-12-3</td><td>3 </td></tr><tr><td><font color='orange'>DATETIME</font></td><td>YYYY-MM-DD HH:MM:SS</td><td>1000-01-01 00:00:00 ~ 9999-12-31 23:59:59</td><td>8 </td></tr><tr><td>TIMESTAMP</td><td>YYYY-MM-DD HH:MM:SS</td><td>1980-01-01 00:00:01 UTC ~ 2040-01-19 03:14:07 UTC</td><td>4 </td></tr></tbody></table><p><strong><mark class="hl-label blue"></mark> </strong></p><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td>BIT</td><td></td><td> (M+7)/8 </td></tr><tr><td>BINARY</td><td></td><td>M </td></tr><tr><td>VARBINARY</td><td></td><td>M+1 </td></tr><tr><td>TINYBLOB</td><td>BLOB</td><td>L+1 L&lt;2^8</td></tr><tr><td>BLOB</td><td> BLOB</td><td>L+2 L&lt;2^16</td></tr><tr><td>MEDIUMBLOB</td><td>BLOB</td><td>L+3 L&lt;2^24</td></tr><tr><td>LONGBLOB</td><td>BLOB</td><td>L+4 L&lt;2^32</td></tr></tbody></table><p></p><h2 id="font-color-red--font"><font color='red'></font></h2><ul><li><p><code>Type [(M)] [UNSIGNED] [ZEROFILL]</code>  M  M  ZEROFILL  M <br><code>Type [(M,D)] [UNSIGNED] [ZEROFILL]</code>  M D <em>M</em><em>D</em><br>DECIMAL()<code>DECIMAL[(M[,D])] [UNSIGNED] [ZEROFILL]</code> M  65D  30 D  M<em>D</em>  0<em>M</em> 10DECIMAL  DECIMAL <a href="https://jyxcpp.netlify.app/2022/08/31/%E6%B5%AE%E7%82%B9%E6%95%B0%E4%B8%8E%E5%AE%9A%E7%82%B9%E6%95%B0/"></a></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">###################################################</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> demo_1(num <span class="type">INT</span>(<span class="number">5</span>) ZEROFILL );</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> demo_1 <span class="keyword">VALUES</span>(<span class="number">34</span>);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> demo_1;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+</span></span><br><span class="line"><span class="operator">|</span> num   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">00034</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> demo_1 <span class="keyword">VALUES</span>(<span class="number">1234567</span>);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> demo_1;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+</span></span><br><span class="line"><span class="operator">|</span> num     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+</span></span><br><span class="line"><span class="operator">|</span>   <span class="number">00034</span> <span class="operator">|</span>       # <span class="number">5</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1234567</span> <span class="operator">|</span>       # M</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line">#####################################################</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> demo_3 (dig <span class="keyword">DOUBLE</span>(<span class="number">7</span>,<span class="number">3</span>) );</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> demo_3 <span class="keyword">VALUES</span>(<span class="number">12345.6789</span>);</span><br><span class="line">ERROR <span class="number">1264</span> (<span class="number">22003</span>): <span class="keyword">Out</span> <span class="keyword">of</span> <span class="keyword">range</span> <span class="keyword">value</span> <span class="keyword">for</span> <span class="keyword">column</span> <span class="string">&#x27;dig&#x27;</span> <span class="keyword">at</span> <span class="type">row</span> <span class="number">1</span> #(<span class="number">7</span>,<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> demo_3 <span class="keyword">VALUES</span>(<span class="number">1235.679</span>);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure></li><li><p><code>FLOAT</code>  7 <code>DOUBLE</code>  15 </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test_08(</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> dig <span class="type">FLOAT</span>);</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> test_08 <span class="keyword">VALUES</span>(<span class="number">0.123456789</span>);#<span class="number">9</span></span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> test_08;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+</span></span><br><span class="line"><span class="operator">|</span> dig      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">0.123457</span> <span class="operator">|</span> #<span class="number">6</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test_09(</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> dig <span class="keyword">DOUBLE</span>);</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> test_09 <span class="keyword">VALUES</span>(<span class="number">0.123456789123456789</span>);#<span class="number">18</span></span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.00</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> test_09;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+</span></span><br><span class="line"><span class="operator">|</span> dig                 <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">0.12345678912345678</span> <span class="operator">|</span> #<span class="number">17</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure></li><li><p><strong><font color='orange'>MySQL  BIGINT  DOUBLE </font></strong>  63  BIGINT  DOUBLE BIGINT  DOUBLE <br><strong><font color='orange'>-+*   BIGINT </font></strong>  9223372036854775807(63) </p></li></ul><h2 id="font-color-red--font"><font color='red'></font></h2><ul><li><p>CHAR  VARCHAR  <strong></strong> <strong><font color='orange'>CHAR  255 VARCHAR  (65535-3)/3=21844 (utf8)</font></strong>  3  Mysql  utf8 <u></u> 3utf81-5VARCHAR  65,532  3  <strong>VARCHAR ()</strong>  3 <strong>CHAR CHAR</strong> <strong><font color='red'>MySQLCHAR  VARCHAR </font><font color='orange'> VARCHAR </font></strong>  CHAR  VARCHAR </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> demo4(data <span class="type">VARCHAR</span>(<span class="number">21845</span>));</span><br><span class="line">ERROR <span class="number">1118</span> (<span class="number">42000</span>): <span class="type">Row</span> size too large. </span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> demo4(data <span class="type">VARCHAR</span>(<span class="number">21844</span>));#utf8<span class="type">VARCHAR</span><span class="number">21844</span></span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)           #gbk<span class="type">VARCHAR</span>(<span class="number">65535</span><span class="number">-3</span>)<span class="operator">/</span><span class="number">2</span></span><br><span class="line">###################################################</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> demo5(data <span class="type">CHAR</span>(<span class="number">5</span>));</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> demo5 <span class="keyword">VALUES</span>(&quot;year&quot;); #</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> demo5 <span class="keyword">WHERE</span> data<span class="operator">=</span>&quot;year&quot;;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+</span></span><br><span class="line"><span class="operator">|</span> data <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">year</span> <span class="operator">|</span>     #<span class="keyword">year</span><span class="type">CHAR</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line">###################################################</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> demo7(data <span class="type">VARCHAR</span>(<span class="number">8</span>));</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> demo7 <span class="keyword">VALUES</span>(&quot;DAY       &quot;);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected, <span class="number">1</span> warning (<span class="number">0.01</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> demo7 <span class="keyword">WHERE</span> data<span class="operator">=</span>&quot;DAY&quot;;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+</span></span><br><span class="line"><span class="operator">|</span> data     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">DAY</span>      <span class="operator">|</span> #<span class="keyword">DAY</span><span class="type">VARCHAR</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+ #DAY</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line">###################################################</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> demo7 <span class="keyword">VALUES</span>(&quot;DAY                &quot;);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected, <span class="number">1</span> warning (<span class="number">0.01</span> sec) #</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> demo7 <span class="keyword">VALUES</span>(&quot;DAYDAYHAPPY &quot;);</span><br><span class="line">ERROR <span class="number">1406</span> (<span class="number">22001</span>): Data too long <span class="keyword">for</span> <span class="keyword">column</span> <span class="string">&#x27;data&#x27;</span> <span class="keyword">at</span> <span class="type">row</span> <span class="number">1</span> #</span><br></pre></td></tr></table></figure></li><li><p> CHAR VARCHAR<strong>CHAR  VARCHAR </strong> </p></li><li><p> CHAR  VARCHAR  TEXT MySQL  <strong>TEXT  TEXT MySQL CHAR  VARCHAR </strong>  TEXT TINYTEXT  1 TEXT  2 MEDIUMTEXT  3 LONGTEXT </p></li></ul><h2 id="font-color-red--font"><font color='red'></font></h2><ul><li><p>BIT BIT(<em>M</em>)<em>M</em><strong><em>M</em>164</strong> </p></li><li><p><strong>CHARVARCHARBINARYVARBINARY</strong></p></li><li><p>BIT </p><p><img src="/2022/img/image-20220831213507973.png" alt=""></p><p></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> demo_4 (dig BIT(<span class="number">8</span>) );</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> demo_4 <span class="keyword">VALUES</span>(<span class="number">129</span>);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> demo_4;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+</span></span><br><span class="line"><span class="operator">|</span> dig  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+</span></span><br><span class="line"><span class="operator">|</span>      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure></li><li><p>BINARY  VARBINARY  CHAR  VARCHAR <strong></strong> ( Qt  QByteArray) <font color='orange'></font></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> demo_5 (data <span class="type">BINARY</span>);</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> demo_6 <span class="keyword">VALUES</span>(&quot;&quot;);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.00</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> demo_6;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="operator">|</span> data       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="operator">|</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p> Mysql  Qt </p><img src="/2022/img/image-20220831223235303.png" alt="" style="zoom:67%;" /><p> <code>BINARY</code> <strong><u></u></strong>  0x00(\0) 0x00 <u></u></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> demo_6 (data <span class="type">BINARY</span>(<span class="number">10</span>)); #<span class="number">10</span></span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> demo_6 <span class="keyword">VALUES</span>(&quot;hello&quot;); #hello<span class="number">0x00</span></span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> demo_6 <span class="keyword">WHERE</span> data <span class="operator">=</span> &quot;hello&quot;;#hello</span><br><span class="line"><span class="keyword">Empty</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)   #<span class="number">0x00</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> demo_6 <span class="keyword">WHERE</span> data<span class="operator">=</span>&quot;hello\0\0\0\0\0&quot;;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="operator">|</span> data       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="operator">|</span> hello      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p> <code>VARBINARY</code> ,</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> demo_7 (data <span class="type">VARBINARY</span>(<span class="number">10</span>));</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> demo_7 <span class="keyword">VALUES</span>(&quot;&quot;);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> demo_7 <span class="keyword">WHERE</span> data<span class="operator">=</span>&quot;&quot;;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+</span></span><br><span class="line"><span class="operator">|</span> data   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure></li><li><p> BLOB  VARBINARYBLOB </p></li></ul><h2 id="font-color-red---font"><font color='red'>/</font></h2><ul><li><p>MySQL</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test_0(ddl <span class="type">DATE</span>);</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> test_0 <span class="keyword">VALUE</span>(&quot;2022-11-31&quot;);</span><br><span class="line">ERROR <span class="number">1292</span> (<span class="number">22007</span>): Incorrect <span class="type">date</span> <span class="keyword">value</span>: <span class="string">&#x27;2022-11-31&#x27;</span> <span class="keyword">for</span> <span class="keyword">column</span> <span class="string">&#x27;ddl&#x27;</span> <span class="keyword">at</span> <span class="type">row</span> <span class="number">1</span> #<span class="number">11</span><span class="number">31</span></span><br></pre></td></tr></table></figure><p> <code>ALLOW_INVALID_DATES</code> SQL  MySQL  2002-00-00  <code>NO_ZERO_IN_DATE</code> SQL</p></li><li><p> <code>2022</code> -&gt; <code>22</code>  MySQL</p><ul><li><p>70-99  1970-1999</p></li><li><p>00-69  2000-2069</p></li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> test_0 <span class="keyword">VALUE</span>(&quot;22-10-30&quot;);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> test_0 <span class="keyword">VALUE</span>(&quot;70-10-30&quot;);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> test_0;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="operator">|</span> ddl        <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2022</span><span class="number">-10</span><span class="number">-30</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1970</span><span class="number">-10</span><span class="number">-30</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure></li><li><p>MySQL  <code>YYYY-MM-DD HH:MM:SS</code>  <code>YY-MM-DD HH:MM:SS</code> </p><ul><li><code>98-12-31  11:30:45</code> <code>98.12.31 11+30+45</code> <code>98/12/31  11*30*45</code>  <code>98@12@31 11^30^45</code> </li><li><code>YYYYMMDDHHMMSS</code>  <code>YYMMDDHHMMSS</code> <code>19970523091528</code>  <code>970523091528</code>  <code>1997-05-23  09:15:28</code>  <code>971122129015</code> () <code>0000-00-00  00:00:00</code> <strong></strong></li><li> 10<code>1979-6-9</code>  <code>1979-06-09</code>  10<code>1979-10-30 1:2:3</code>  <code>1979-10-30 01:02:03</code> </li></ul></li><li><p></p><ul><li> DATETIME  TIMESTAMP  DATE  <code>00:00:00</code>  DATE </li><li> DATE  DATETIME  TIMESTAMP  DATE </li><li>TIMESTAMP  <code>1970</code>  <code>2037</code>  <code>1968-01-01</code> DATETIMEDATETIMESTAMP  0</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">##### DATETIME  <span class="type">TIMESTAMP</span>  <span class="type">DATE</span> </span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test_0(ddl <span class="type">DATE</span>);</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> test_0 <span class="keyword">VALUE</span>(&quot;2021-12-29 11:30:49&quot;);</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> test_0;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="operator">|</span> ddl        <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2021</span><span class="number">-12</span><span class="number">-29</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line">##### <span class="type">DATE</span>  DATETIME  <span class="type">TIMESTAMP</span> </span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test_1 (ddl DATETIME);</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> test_1 <span class="keyword">VALUES</span>(&quot;2022-12-29&quot;);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> test_1;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+</span></span><br><span class="line"><span class="operator">|</span> ddl                 <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2022</span><span class="number">-12</span><span class="number">-29</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+</span></span><br><span class="line">#####</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test_2(data <span class="type">TIMESTAMP</span>);</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> test_2 <span class="keyword">VALUES</span>(&quot;2022-12-29 12:43:49&quot;);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.00</span> sec)     </span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> test_2;  #<span class="number">1970</span><span class="operator">~</span><span class="number">2037</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+</span></span><br><span class="line"><span class="operator">|</span> data                <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2022</span><span class="number">-12</span><span class="number">-29</span> <span class="number">12</span>:<span class="number">43</span>:<span class="number">49</span> <span class="operator">|</span>  </span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> test_2 <span class="keyword">VALUES</span>(&quot;2045-12-29 12:43:49&quot;);#<span class="number">1970</span><span class="operator">~</span><span class="number">2037</span></span><br><span class="line">ERROR <span class="number">1292</span> (<span class="number">22007</span>): Incorrect datetime <span class="keyword">value</span>: <span class="string">&#x27;2045-12-29 12:43:49&#x27;</span> <span class="keyword">for</span> <span class="keyword">column</span> <span class="string">&#x27;data&#x27;</span> <span class="keyword">at</span> <span class="type">row</span> <span class="number">1</span></span><br></pre></td></tr></table></figure></li><li><p> 22  MySQL  4  INT </p><p>1 UTC  UTC  INT (UNIX_TIMESTAMP)<br>2INT UTC ( FROM_UNIXTIME )</p></li><li><p>()</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test_5(ddl <span class="type">DATE</span>, log_time <span class="type">TIMESTAMP</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span>);  #<span class="number">2</span><span class="number">3</span></span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> test_5(DDL) <span class="keyword">VALUES</span>(&quot;2023-11-11&quot;);#ddl</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> test_5;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------+---------------------+</span></span><br><span class="line"><span class="operator">|</span> ddl        <span class="operator">|</span> log_time            <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+---------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2023</span><span class="number">-11</span><span class="number">-11</span> <span class="operator">|</span> <span class="number">2022</span><span class="number">-09</span><span class="number">-01</span> <span class="number">17</span>:<span class="number">35</span>:<span class="number">45</span> <span class="operator">|</span> #</span><br><span class="line"><span class="operator">+</span><span class="comment">------------+---------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure></li></ul><h2 id="font-color-red--font"><font color='red'></font></h2><p><strong><mark class="hl-label blue">ZEROFILL</mark> </strong></p><p><code>ZEROFILL</code>  0 <strong>ZEROFILLMySQLUNSIGNED</strong> <code>ZEROFILL</code> </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test_5(</span><br><span class="line">    id <span class="type">INT</span> ZEROFILL);</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">7.03</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> test_5 <span class="keyword">VALUES</span>(<span class="number">1</span>);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> test_5 ;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="operator">|</span> id         <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">0000000001</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p><strong><mark class="hl-label blue">/</mark> </strong></p><p>MySQL  SQL MySQL  traditional() SQL  INT  UNSIGNED 0  4294967295 -9999999999  9999999999 0  4294967296()MySQL</p><p>MySQL ALTER  TABLELOAD DATA  INFILEUPDATE  INSERT  MySQL <strong> Mysql </strong></p><blockquote><p><a href="https://jyxcpp.netlify.app/img/mysql5.1_zh_chm.rar">Mysql5.1()</a><a href="https://www.yiibai.com/mysql/text.html">TEXT</a><a href="https://www.bilibili.com/video/BV1H64y1U7GJ?p=17&amp;spm_id_from=pageDriver&amp;vd_source=f507850c724cff595de0e591730ebe9f">Mysql</a><a href="http://c.biancheng.net/view/2426.html">C</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category> MySQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL-()</title>
      <link href="/2022/08/30/MySQL-%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/"/>
      <url>/2022/08/30/MySQL-%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p> SQLStructured Query LanguageSQL  DBMS(Datebase Management System)  SQL  SQL  DBMS  SQL  SQLANCI SQL SQL  DBMS</p></blockquote><h2 id="font-color-red-SQL-font"><font color='red'>SQL</font></h2><p>SQL  4 </p><ol><li><p><strong>Data Definition LanguageDDL</strong></p><p><strong><font color='orange'>()</font></strong> </p><ul><li><strong><mark class="hl-label default">DROP</mark> </strong> </li><li><strong><mark class="hl-label default">CREATE</mark> </strong> </li><li><strong><mark class="hl-label default">ALTER</mark> </strong> </li></ul></li><li><p><strong>Data Manipulation LanguageDML</strong></p><p><strong><font color='orange'>()</font></strong> </p><ul><li><strong><mark class="hl-label default">SELECT</mark> </strong> </li><li><strong><mark class="hl-label default">INSERT</mark> </strong> </li><li><strong><mark class="hl-label default">UPDATE</mark> </strong> </li><li><strong><mark class="hl-label default">DELETE</mark> </strong> </li></ul></li><li><p><strong>Data Query LanguageDQL</strong></p><p> <strong><mark class="hl-label default">SELECT</mark> </strong>  </p></li><li><p><strong>Data Control LanguageDCL</strong></p><p></p><ul><li><strong><mark class="hl-label default">GRANT</mark> </strong> </li><li><strong><mark class="hl-label default">REVOKE</mark> </strong> </li><li><strong><mark class="hl-label default">COMMIT</mark> </strong> </li><li><strong><mark class="hl-label default">ROLLBACK</mark> </strong> </li></ul></li></ol><h2 id="font-color-red-SQL-font"><font color='red'>SQL</font></h2><ul><li><p><strong>SQL  <code>;</code> </strong>  SQL </p></li><li><p><strong></strong></p></li><li><p><strong>SQL </strong></p><ul><li>SQL </li><li><strong>MySQL </strong> <font color='orange'></font> Windows  Windows  MySQL Linux  Linux  MySQL </li><li> SQL </li><li></li><li> Linux  Windows </li></ul><img src="/2022/img/image-20220830161650126.png" alt="" style="zoom:67%;" /><blockquote><p> <strong>( COLLATE )</strong>  <code>utf8_general_ci</code> () <code>utf8_bin</code> </p></blockquote><p> Linux  Windows </p></li></ul><h2 id="font-color-red--font"><font color='red'></font></h2><h3 id="font-color-red--font"><font color='red'></font></h3><p> <strong>CREATE DATABASE</strong> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CREATE DATABASE [IF NOT EXISTS] &lt;&gt;</span><br><span class="line">[[DEFAULT] CHARACTER SET &lt;&gt;] </span><br><span class="line">[[DEFAULT] COLLATE &lt;&gt;];</span><br></pre></td></tr></table></figure><p>[ ]</p><ul><li><code>&lt;&gt;</code> MySQL  MySQL  MySQL </li><li><code>IF NOT EXISTS</code></li><li><code>[DEFAULT] CHARACTER SET</code>  <code>utf-8</code> </li><li><code>[DEFAULT] COLLATE</code>  <code>utf8_general_ci</code> </li><li><code>DATABASE</code>  <code>S</code>  <code>''</code> </li></ul><blockquote><p><strong> MySQL </strong></p></blockquote><p><strong><mark class="hl-label blue"></mark> </strong></p><p><strong></strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; CREATE DATABASE test_db;</span><br><span class="line">Query OK, 1 row affected (0.12 sec);</span><br></pre></td></tr></table></figure><p><code>CREATE DATABASE test_db;</code> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; CREATE DATABASE test_db;</span><br><span class="line">ERROR 1007 (HY000): Can&#x27;t create database &#x27;test_db&#x27;; database exists</span><br></pre></td></tr></table></figure><p>MySQL  <code>IF NOT EXISTS</code> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; CREATE DATABASE IF NOT EXISTS test_db;</span><br><span class="line">Query OK, 1 row affected (0.12 sec)</span><br></pre></td></tr></table></figure><p><strong></strong></p><p> MySQL  test_db_char <code>utf8</code> <code>utf8_chinese_ci</code> SQL </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; CREATE DATABASE IF NOT EXISTS test_db_char</span><br><span class="line">    -&gt; DEFAULT CHARACTER SET utf8</span><br><span class="line">    -&gt; DEFAULT COLLATE utf8_chinese_ci;</span><br><span class="line">Query OK, 1 row affected (0.03 sec)</span><br></pre></td></tr></table></figure><p><strong><font color='orange'></font></strong> <code>DEFAULT</code> <br> <code>SHOW CREATE DATABASE</code>  test_db_char  <code>utf8</code> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SHOW CREATE DATABASE test_db_char;</span><br><span class="line">+--------------+-----------------------------------------------------+</span><br><span class="line">| Database     | Create Database                                     |</span><br><span class="line">+--------------+-----------------------------------------------------+</span><br><span class="line">| test_db_char | CREATE DATABASE `test_db_char` /*!40100 DEFAULT CHARACTER SET utf8 */ |</span><br><span class="line">+--------------+-----------------------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure><h3 id="font-color-gree--font"><font color='gree'></font></h3><p> MySQL  MySQL  MySQL  <strong><mark class="hl-label default">SHOW DATABASES</mark> </strong> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW DATABASES LIKE &#x27;&#x27;;</span><br></pre></td></tr></table></figure><ul><li>LIKE LIKE <ul><li> stuInfo        <strong><code>SHOW DATABASES LIKE 'stuInfo';</code></strong></li><li> stuInfo <strong><code>SHOW DATABASES LIKE '%stuInfo%';</code></strong></li><li> stuInfo <strong><code>SHOW DATABASES LIKE '%stuInfo';</code></strong></li><li> stuInfo <strong><code>SHOW DATABASES LIKE 'stuInfo%';</code></strong></li></ul></li><li> <code>DATABASES</code>  <code>S</code> </li><li></li></ul><p><strong></strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SHOW DATABASES;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sakila             |</span><br><span class="line">| sys                |</span><br><span class="line">| world              |</span><br><span class="line">+--------------------+</span><br><span class="line">6 row in set (0.22 sec)</span><br></pre></td></tr></table></figure><p><code>SHOW DATABASES;</code> </p><ul><li>information_schema</li><li>mysqlMySQL  SQL Server  master  MySQL  mysql  user  root </li><li>performance_schema</li><li>sakilaMySQL  16 </li><li>sysMySQL 5.7  sys sys  performation_schema</li><li>worldworld  MySQL  3 </li></ul><p><strong></strong></p><p> <code>SHOW CREATE DATABASE</code>  test_db_char  <code>utf8</code> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SHOW CREATE DATABASE test_db_char;</span><br><span class="line">+--------------+-----------------------------------------------------+</span><br><span class="line">| Database     | Create Database                                     |</span><br><span class="line">+--------------+-----------------------------------------------------+</span><br><span class="line">| test_db_char | CREATE DATABASE `test_db_char` /*!40100 DEFAULT CHARACTER SET utf8 */ |</span><br><span class="line">+--------------+-----------------------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure><p><code>test_db_char</code>  `  CREATE </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; CREATE DATABASE `CREATE`;</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br></pre></td></tr></table></figure><p><strong></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> DATABASE();</span><br><span class="line">############################</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> tables;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------+</span></span><br><span class="line"><span class="operator">|</span> Tables_in_test    <span class="operator">|</span>#</span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------+</span></span><br><span class="line"><span class="operator">|</span> push_test         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ship_order_detail <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line">############################</span><br><span class="line">mysql<span class="operator">&gt;</span> status;</span><br><span class="line"><span class="comment">--------------</span></span><br><span class="line">mysql  Ver <span class="number">14.14</span> Distrib <span class="number">5.7</span><span class="number">.19</span>, <span class="keyword">for</span> Win64 (x86_64)</span><br><span class="line"></span><br><span class="line">Connection id:          <span class="number">3</span></span><br><span class="line"><span class="keyword">Current</span> database:       no1sc  #</span><br><span class="line"><span class="keyword">Current</span> <span class="keyword">user</span>:           root<span class="variable">@localhost</span></span><br><span class="line">SSL:                    <span class="keyword">Not</span> <span class="keyword">in</span> use</span><br><span class="line"><span class="keyword">Using</span> delimiter:        ;</span><br><span class="line">Server version:         <span class="number">5.7</span><span class="number">.19</span> MySQL Community Server (GPL)</span><br><span class="line">Protocol version:       <span class="number">10</span></span><br><span class="line">Connection:             localhost via TCP<span class="operator">/</span>IP</span><br><span class="line">Server characterset:    utf8</span><br><span class="line">Db     characterset:    utf8</span><br><span class="line">Client characterset:    utf8</span><br><span class="line">Conn.  characterset:    utf8</span><br><span class="line">TCP port:               <span class="number">3306</span></span><br><span class="line">Uptime:                 <span class="number">1</span> <span class="keyword">day</span> <span class="number">4</span> hours <span class="number">20</span> min <span class="number">58</span> sec</span><br></pre></td></tr></table></figure><h3 id="font-color-gree--font"><font color='gree'></font></h3><p> MySQL <u></u> db.opt </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ALTER DATABASE [] &#123; </span><br><span class="line">[ DEFAULT ] CHARACTER SET &lt;&gt; |</span><br><span class="line">[ DEFAULT ] COLLATE &lt;&gt;&#125;</span><br></pre></td></tr></table></figure><p></p><ul><li>ALTER DATABASE </li><li> ALTER DATABASE  ALTER </li><li></li></ul><p><strong><mark class="hl-label blue"></mark> </strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; ALTER DATABASE test_db</span><br><span class="line">    -&gt; DEFAULT CHARACTER SET gb2312</span><br><span class="line">    -&gt; DEFAULT COLLATE gb2312_chinese_ci;</span><br><span class="line">mysql&gt; SHOW CREATE DATABASE test_db;</span><br><span class="line">+----------+--------------------------------------------------------+</span><br><span class="line">| Database | ALTER Database                                        |</span><br><span class="line">+----------+--------------------------------------------------------+</span><br><span class="line">| test_db  | ALTER DATABASE `test_db` /*!40100 DEFAULT CHARACTER SET gb2312 */|</span><br><span class="line">+----------+--------------------------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure><h3 id="font-color-gree--font"><font color='gree'></font></h3><p>Mysql </p><img src="/2022/img/image-20220830121356695.png" alt="stuinfo" style="zoom:67%;" /><img src="/2022/img/image-20220830121414517.png" alt="table_1" style="zoom:67%;" /><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP DATABASE [ IF EXISTS ] &lt;&gt;</span><br></pre></td></tr></table></figure><ul><li>IF EXISTS</li><li>DROP DATABASE DROP DATABASE DROP </li></ul><p><strong><mark class="hl-label blue"></mark> </strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#stuInfo</span><br><span class="line">mysql&gt; SHOW DATABASES;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| stuinfo            |</span><br><span class="line">| sys                |</span><br><span class="line">+--------------------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; DROP DATABASE stuInfo;</span><br><span class="line">Query OK, 1 row affected (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SHOW DATABASES;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">+--------------------+</span><br><span class="line">4 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><p> MySQL ()()</p><h3 id="font-color-gree--font"><font color='gree'></font></h3><p> CREATE DATABASE  USE </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">USE &lt;&gt;</span><br></pre></td></tr></table></figure><p><strong> <code>DATABASE</code> !</strong>  MySQL  <code>&lt;&gt;</code> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| stuinfo            |</span><br><span class="line">| sys                |</span><br><span class="line">+--------------------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; use stuinfo;</span><br><span class="line">Database changed</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category> MySQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL-</title>
      <link href="/2022/08/29/MySQL-%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/"/>
      <url>/2022/08/29/MySQL-%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="font-color-red-MySQL-font"><font color='red'>MySQL</font></h2><p><a href="https://downloads.mysql.com/archives/community/">MySQL</a>  <code>5.7.19</code>  <code>Microsoft Windows</code>  <code>Windows (x86, 64-bit), ZIP Archive</code>  <code>Download</code> </p><p><img src="/2022/img/image-20220829185625160.png" alt=""></p><p> <code>.zip</code>  <code>D:\MySQL</code> </p><p><img src="/2022/img/image-20220829194816430.png" alt=""></p><p><img src="/2022/img/image-20220829195010717.png" alt=""></p><h2 id="font-color-red-MySQL-font"><font color='red'>MySQL</font></h2><h3 id="font-color-orange--font"><font color='orange'></font></h3><p> <code>D:\MySQL\mysql-5.7.19-winx64</code>  <code>my.ini</code> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[client]</span><br><span class="line">port=3306</span><br><span class="line">default-character-set=utf8</span><br><span class="line">[mysqld]</span><br><span class="line">#  MySQL</span><br><span class="line">basedir=D:\\MySQL\\mysql-5.7.19-winx64\\</span><br><span class="line">#  MySQL</span><br><span class="line">datadir=D:\\MySQL\\mysql-5.7.19-winx64\\data</span><br><span class="line">port=3306</span><br><span class="line">character-set-server=utf8</span><br><span class="line">#</span><br><span class="line">skip-grant-tables </span><br></pre></td></tr></table></figure><p><strong><font color='gree'></font></strong></p><h3 id="font-color-orange--font"><font color='orange'></font></h3><p> <code></code> -&gt; <code></code> </p><p><img src="/2022/img/image-20220829195720092.png" alt=""></p><p> <code></code> -&gt; <code></code> -&gt; <code>PATH</code> -&gt; <code></code> -&gt; <code></code> -&gt;  <code>D:\MySQL\mysql-5.7.19-winx64\bin</code>  MySQL </p><img src="/2022/img/image-20220829200227747.png" alt="" style="zoom:50%;" /><img src="/2022/img/image-20220829200318095.png" alt="" style="zoom:67%;" /><img src="/2022/img/image-20220829200413903.png" alt="" style="zoom:67%;" />**admin** <blockquote><p> MySQL  MySQL  MySQL  bin  MySQL </p></blockquote><h3 id="font-color-orange--font"><font color='orange'></font></h3><ol><li><strong><font color='gree'>cmd</font></strong></li></ol><img src="/2022/img/image-20220829200909610.png" alt="" style="zoom:67%;" /><ol start="2"><li><p> <code>D:\MySQL\mysql-5.7.19-winx64\bin</code>  <code>D:</code>  <code>cd D:\MySQL\mysql-5.7.19-winx64\bin</code> </p><p><img src="/2022/img/image-20220829201327011.png" alt=""></p></li><li><p> MySQL <code>mysqld -install</code></p></li><li><p> <code>mysqld --initialize-insecure --user=mysql</code>  <code>D:\MySQL\mysql-5.7.19-winx64\</code>  <code>data</code> </p><img src="/2022/img/image-20220829201735873.png" style="zoom:67%;" /></li><li><p> MySQL  <code>net start mysql</code></p><img src="/2022/img/image-20220829202122072.png" style="zoom:67%;" /><p> <code>net stop mysql</code> </p></li><li><p> MySQL  <code>mysql -u root -p</code> root p  password </p><blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D:\MySQL\mysql-5.7.19-winx64\bin&gt;mysql -h 127.0.0.1 -P 3306 -u root -p</span><br></pre></td></tr></table></figure><p> <code>-h IP</code>  <code>-P </code>  3306 Pp</p></blockquote></li><li><p> root  <code>use mysql;</code> <strong>SQL</strong>  <code>update user set authentication_string=password('password') where user='root' and Host='localhost';</code>  <code>password</code>  <code>flush privileges</code> </p></li><li><p> <code>my.ini</code>  <code>skip-grant-tables </code>  <code>quit</code>  MySQL </p></li></ol><p> MySQL  <code>sc delete mysql</code> () <code>MySQL</code>  <code>net stop mysql</code> </p><blockquote><p><a href="https://www.bilibili.com/video/BV1H64y1U7GJ?p=2&amp;spm_id_from=pageDriver&amp;vd_source=f507850c724cff595de0e591730ebe9f">MySQL</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category> MySQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/08/17/%E8%B7%AF%E7%94%B1%E5%99%A8%E4%B8%AD%E7%9A%84%E6%8E%92%E9%98%9F%E4%B8%8E%E8%B0%83%E5%BA%A61/"/>
      <url>/2022/08/17/%E8%B7%AF%E7%94%B1%E5%99%A8%E4%B8%AD%E7%9A%84%E6%8E%92%E9%98%9F%E4%B8%8E%E8%B0%83%E5%BA%A61/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p><a href="https://jyxcpp.netlify.app/2022/08/17/%E8%B7%AF%E7%94%B1%E5%99%A8%E4%BA%A4%E6%8D%A2%E7%BB%93%E6%9E%84/"></a>(Queuing)(Scheduling)</p></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><p> <strong>(packet loss)</strong>  TCP </p><h4 id="font-color-orange--font"><font color='orange'></font></h4><p><u></u><strong>1.2.(Head-Of-The-Line, HOL)</strong> </p><img src="/2022/img/image-20220819103139081.png" alt="" style="zoom:67%;" /><p><strong><mark class="hl-label blue"></mark> </strong></p><p> crossbar <a href="https://jyxcpp.netlify.app/2022/08/17/%E8%B7%AF%E7%94%B1%E5%99%A8%E4%BA%A4%E6%8D%A2%E7%BB%93%E6%9E%84/"></a></p><p><strong><mark class="hl-label blue">HOL</mark> </strong></p><p>()(FIFO) HOL  58% HOL  HOL  <strong>(Virtual Output Queues)</strong> <u></u> 2  4 <em>i</em>SLIP</p><img src="/2022/img/format,f_auto.png" alt="" style="zoom:67%;" /><blockquote><p></p></blockquote><h4 id="font-color-orange--font"><font color='orange'></font></h4><p> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mrow><mi>s</mi><mi>w</mi><mi>i</mi><mi>t</mi><mi>c</mi><mi>h</mi></mrow></msub><mo>=</mo><mi>N</mi><mo></mo><msub><mi>R</mi><mrow><mi>l</mi><mi>i</mi><mi>n</mi><mi>e</mi></mrow></msub></mrow><annotation encoding="application/x-tex">R_{switch}=NR_{line}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">in</span><span class="mord mathnormal mtight">e</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> (drop-tail) <strong>(AQM)</strong> </p><p><strong><mark class="hl-label blue"></mark> </strong></p><p>()<strong></strong>  <strong>(buffer bloat)</strong> <strong><a href="https://jyxcpp.netlify.app/2022/08/07/tcp%E6%8B%A5%E5%A1%9E%E6%8E%A7%E5%88%B6/">TCP</a></strong> TCP </p><p> AQM  TCP  BBR <a href="https://jyxcpp.netlify.app/2022/08/07/tcp%E6%8B%A5%E5%A1%9E%E6%8E%A7%E5%88%B6/">TCP()</a><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>=</mo><mi>R</mi><mi>T</mi><mi>T</mi><mo></mo><mi>C</mi></mrow><annotation encoding="application/x-tex">B=RTTC</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">RTT</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>  C RTT </p><h3 id="font-color-red--font"><font color='red'></font></h3><p> <strong>(FCFS, (FIFO))</strong>  <strong>(Packets Scheduling)</strong> </p><h4 id="font-color-orange--FIFO-font"><font color='orange'>(FIFO)</font></h4><p> FIFO drop-tailFIFO FIFO <br>FIFOInternet FIFO  TCP  TCP TCP </p><h4 id="font-color-orange--priority-queuing-font"><font color='orange'>(priority queuing)</font></h4><p><strong> FIFO </strong>  134  25  1  23  3  2 1  3  4  2  <strong></strong>  4  2 2  4 </p><img src="/2022/img/image-20220819170315190.png" alt="image-20220819170315190" style="zoom:67%;" /><p> <strong></strong> </p><h4 id="font-color-orange--WFQ-font"><font color='orange'>(WFQ)</font></h4><p>WFQWFQ</p><ol><li><p>WFQFfairness</p></li><li><p></p></li><li><p></p></li></ol><p>WFQ  IP (TOS) Hash WFQ low-volumehigher-precedence large-volumelower-precedence ()WFQ [WFQ](<a href="https://baike.baidu.com/item/WFQ/10000942">WFQ_ (baidu.com)</a>) </p><blockquote><p><a href="%5B%E7%BD%91%E7%BB%9C%E4%B8%AD%E5%B8%B8%E7%94%A8%E7%9A%84%E9%98%9F%E5%88%97%E7%AE%A1%E7%90%86%E6%96%B9%E6%B3%95%E6%AF%94%E8%BE%83_%E7%9F%A5%E8%A1%8C%E6%B5%81%E6%B5%AA%E7%9A%84%E5%8D%9A%E5%AE%A2-CSDN%E5%8D%9A%E5%AE%A2_%E7%BD%91%E7%BB%9C%E9%98%9F%E5%88%97%5D(https://blog.csdn.net/zengxiantao1994/article/details/53080941#:~:text=%E5%85%88%E8%BF%9B%E5%85%88%E5%87%BA%E5%B1%9E%E4%BA%8E%E5%85%B8%E5%9E%8B,%E9%BB%98%E8%AE%A4%E7%9A%84%E6%8E%92%E9%98%9F%E6%96%B9%E5%BC%8F%E3%80%82)">FIFO</a><a href="http://lihaizhou.top/2020/08/27/%E8%87%AD%E5%90%8D%E6%98%AD%E8%91%97%E7%9A%84bufferbloat/"></a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/08/17/%E8%B7%AF%E7%94%B1%E5%99%A8%E4%BA%A4%E6%8D%A2%E7%BB%93%E6%9E%84/"/>
      <url>/2022/08/17/%E8%B7%AF%E7%94%B1%E5%99%A8%E4%BA%A4%E6%8D%A2%E7%BB%93%E6%9E%84/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p></p></blockquote><p></p><img src="/2022/img/assets%2F-M8zvqNNVZctOHx6v8No%2F-ME3magMx6taYZhZPGd3%2F-ME3qV3nJvjh-GRCnpGI%2Fimage.png" alt="1" style="zoom:67%;" /><img src="/2022/img/assets%2F-M8zvqNNVZctOHx6v8No%2F-ME3magMx6taYZhZPGd3%2F-ME3qgLtqu7FWWNziVrZ%2Fimage.png" alt="" style="zoom:67%;" /><img src="/2022/img/assets%2F-M8zvqNNVZctOHx6v8No%2F-ME3magMx6taYZhZPGd3%2F-ME3r8ffUymOfqAgojKQ%2Fimage.png" alt="" style="zoom:67%;" /><p> <strong></strong> </p><h3 id="font-color-red--font"><font color='red'></font></h3><p>1 PHY(Physical Layer Device) MAU(Medium Attachment Unit) MAC <br>2 MAC  PHY  FCS<strong> FCS </strong>  <strong> MAC  MAC </strong>  MAC <br>3 <strong></strong> </p><blockquote><p> PHY  MAC </p><p>MAC ()<strong><font color='orange'></font></strong>  PHY(MAU) <strong><font color='red'> MAC  PHY  PHY(MAU) </font></strong> </p></blockquote><p></p><img src="/2022/img/417F6E2A7DA886977A88FF9C0AE6F9AC.png" alt="" style="zoom:50%;" /><p><u></u><strong><u></u>(Line Card)</strong> <strong><font color='red'> IP </font></strong>  <strong><font color=#3b8dfe></font> (longest prefix matching rule)</strong>  <code>192.168.1.10</code>  <code>192.168.1.10</code>  IP  345 <strong></strong> (4)<u></u>()<strong></strong> <font color='orange'> ICMP </font> <code>0.0.0.0</code> </p><p> 10 Gbps 64  IP  IP  51.2 </p><ol><li></li><li></li><li> CIDR  [<a href="https://jyxcpp.netlify.app/2022/08/16/ip%E7%BC%96%E5%9D%80/">IP</a>]</li><li></li></ol><p> IP CheckSum  TTL <u></u>TTL TTL  64  128 <strong><font color='orange'> CheckSum  TTL  TTL CheckSum </font></strong> </p><h3 id="font-color-red--Switching-Fbric-font"><font color='red'>(Switching Fbric)</font></h3><p></p><img src="/2022/img/IMG_0447(20220818-180045).PNG" alt="" style="zoom: 50%;" /><ol><li><strong></strong>  CPU  CPU  IP 1 CPU 2/</li><li><strong></strong> </li><li><strong>crossbar</strong>  2N  N  N () A  Y (AY) A  Y <strong>crossbar </strong> 12(NN)(MN)(AX)(BY)()</li></ol><blockquote><p> 1.2  1.2 speed up ratio,NE5000E 2</p></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><p><a href="https://jyxcpp.netlify.app/2022/08/17/%E8%B7%AF%E7%94%B1%E5%99%A8%E4%B8%AD%E7%9A%84%E6%8E%92%E9%98%9F%E4%B8%8E%E8%B0%83%E5%BA%A61/"></a></p><h3 id="font-color-red--font"><font color='red'></font></h3><img src="/2022/img/IMG_0445(20220818-115058)-166082484083011.PNG" alt="" style="zoom:50%;" /><p>() <strong>SDN(Software Defined Network)</strong> <a href="https://jyxcpp.netlify.app/2022/08/17/%E9%80%9A%E7%94%A8%E8%BD%AC%E5%8F%91%E4%B8%8Esdn/">SDN</a></p><blockquote><p><br><a href="https://www.zhihu.com/question/48343492">CLOS</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>IP</title>
      <link href="/2022/08/16/IP%E7%BC%96%E5%9D%80/"/>
      <url>/2022/08/16/IP%E7%BC%96%E5%9D%80/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="font-color-red-IP-font"><font color='red'>IP</font></h3><p>IP (IPv4) 32  bit  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> ~ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>32</mn></msup><mo></mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^{32}-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">32</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>  43  IP  <strong></strong>  IP <br><img src="/2022/img/IMG_0441(20220817-104106).PNG" alt="" style="zoom:50%;" /></p><p><strong>IP (NIC)</strong>  IP  IPv4  IP (43) IPv4  <a href="">NAT</a>IPv6  IPv4 </p><p><strong>IP </strong> ()()IP <strong></strong>  IP  <strong>(subnet mask)</strong> <u></u></p><h3 id="font-color-red-IP--font"><font color='red'>IP </font></h3><p>IP  ABCDE IP  1  4 </p><img src="/2022/img/IMG_0442(20220817-112008).PNG" alt="IP" style="zoom:50%;" /><p><strong>A</strong>  <code>0</code>  2  8  0.0.0.0 ~ 127.0.0.0  A  24  A  16,777,214 <br><strong>B</strong>  <code>10</code>  2  16  128.0.0.1 ~ 191.255.0.0  B  16  A  65,534 <br><strong>C</strong>  <code>110</code>  2  24  192.168.0.0 ~ 239.255.255.0  C  8  A  254 <br><strong>D</strong>  <code>1110</code>  2  32  224.0.0.0 ~ 239.255.255.255  D D <a href="https://jyxcpp.netlify.app/2022/08/16/%E5%B9%BF%E6%92%AD-%E5%A4%9A%E6%92%AD-%E4%BB%BB%E6%92%AD/"></a> </p><p>A B C D E </p><blockquote><p> 2 0  1 <a href="https://jyxcpp.netlify.app/2022/08/16/%E5%B9%BF%E6%92%AD-%E5%A4%9A%E6%92%AD-%E4%BB%BB%E6%92%AD/"></a><code>0.0.0.0</code>  IP  DHCP  IP </p></blockquote><p> AB IP </p><h3 id="font-color-red-CIDRVLSM-font"><font color='red'>CIDRVLSM</font></h3><p> IP  IP  IP  <strong>CIDR()</strong>  CIDR  C </p><img src="/2022/img/IMG_0444(20220818-102905).PNG" alt="CIDR" style="zoom:50%;" /><p> CIDR  C  <code>255.255.255.0</code> (C 24 )CIDR  IP ( <strong></strong> )<strong></strong>  CIDR  C </p><p> CIDR <u></u>(IP,)  /24  100  25 (IP) IP () IP </p><p><strong>VLSM(Variable Length Subnet Mask)</strong> <strong>VLSM  IP </strong>   /24 (254) 100  /25 (127) IP </p><p><strong>CIDR  ISP/Provider  VLSM </strong> </p><p>CIDR  VLSM <strong><font color='orange'>CIDR  VLSM CIDR  VLSM  IP  IP  IP </font></strong></p><blockquote><p><a href="https://community.cisco.com/t5/switching/what-is-the-difference-between-cidr-and-vlsm/td-p/1172242"></a><a href="https://blog.csdn.net/qq_43207781/article/details/105059613">CIDRVSLM</a>TCP/IP</p></blockquote>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category>  </category>
          
          <category> IP </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/08/16/%E5%B7%AE%E9%94%99%E6%A3%80%E6%B5%8B%E5%92%8C%E7%BA%A0%E6%AD%A3%E6%8A%80%E6%9C%AF/"/>
      <url>/2022/08/16/%E5%B7%AE%E9%94%99%E6%A3%80%E6%B5%8B%E5%92%8C%E7%BA%A0%E6%AD%A3%E6%8A%80%E6%9C%AF/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p> TCP/UDP (CRC)</p></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong>(Checksum)</strong> <u></u> <strong>UDP  TCP </strong> CheckSum </p><ul><li><p>IPIP </p></li><li><p>ICMPICMP  + ICMP </p></li><li><p>UDPTCP +  + </p></li></ul><blockquote><p><u> TCP&amp;UDP  IP </u>  =  IP  +  IP  + 8  + 16  UDP  +UDP+()()()</p></blockquote><p> UDP (TCP)</p><p><strong><mark class="hl-label blue">.</mark> </strong></p><ol><li><p> 0 ()</p></li><li><p> 16  <strong><font color='orange'></font></strong></p></li><li><p></p></li></ol><p></p><ul><li>UDPTCP  16  0 (<u></u>)</li><li><strong> 1</strong> <strong></strong></li></ul><p><img src="/2022/img/image-20220816104346070.png" alt=""></p><p><strong><mark class="hl-label blue">.</mark> </strong></p><p>() 16 <strong>0</strong> </p><p><strong><mark class="hl-label blue">.</mark> </strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">uint16_t</span> <span class="title">check_sum</span><span class="params">(<span class="type">const</span> <span class="type">uint16_t</span> *buffer, <span class="type">int</span> size)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> cksum = <span class="number">0</span>;</span><br><span class="line">     </span><br><span class="line">    <span class="comment">//16</span></span><br><span class="line">    <span class="keyword">while</span>(size&gt;<span class="number">1</span>)&#123;</span><br><span class="line">        cksum += *buffer++;</span><br><span class="line">        size -= <span class="built_in">sizeof</span>(<span class="type">uint16_t</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="keyword">if</span>(size)</span><br><span class="line">        cksum += *((<span class="type">unsigned</span> <span class="type">char</span> *)buffer);</span><br><span class="line">     </span><br><span class="line">    <span class="comment">//160</span></span><br><span class="line">    cksum = (cksum&gt;&gt;<span class="number">16</span>) + (cksum&amp;<span class="number">0xffff</span>);</span><br><span class="line">    cksum += (cksum&gt;&gt;<span class="number">16</span>);</span><br><span class="line">     </span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="type">uint16_t</span>)(~cksum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><strong><mark class="hl-label blue"></mark> </strong></p><p><strong>()</strong> htonsntohs16</p><p><img src="/2022/img/20160929173826754.png" alt=""></p><p></p><p><strong><mark class="hl-label blue">UDP</mark> </strong></p><p>UDP  CheckSum  0  UDP  CheckSum 0 1 CheckSum  0  1 ( CheckSum  0 )</p></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong></strong> <u></u> 11</p><img src="/2022/img/v2-ed494a01b2527927febaac2845b51d9c_1440w.jpg" alt="" style="zoom:67%;" /><blockquote><p></p></blockquote><p><strong><mark class="hl-label blue"></mark> </strong></p><p> <u>+</u>   1  <u>+</u>  1  <strong></strong>  <strong></strong> </p><p><strong><mark class="hl-label blue"></mark> </strong></p><p> <a href="https://jyxcpp.netlify.app/2022/07/31/%E8%AF%A6%E8%A7%A3arq%E5%8D%8F%E8%AE%AE/">ARQ </a></p><p><strong><mark class="hl-label blue"></mark> </strong></p><p>(,) 50%</p><ol><li><p> N  1000  100  10  100 </p></li><li><p><strong><font color='orange'></font></strong>  N  D  D /<strong></strong></p><img src="/2022/img/IMG_0440(20220816-154217).PNG" alt="IMG_0440(20220816-154217)" style="zoom: 50%;" /><p>()</p></li><li><p><strong><font color='orange'></font></strong> () 40  ECC ()</p></li></ol><p><strong><mark class="hl-label blue"></mark> </strong></p><p><strong></strong> </p><img src="/2022/img/image-20220816170748013.png" alt="image-20220816170748013" style="zoom:50%;" /><p> 7  4  <u>7-4 </u> <u> 7-4  <strong></strong> </u> </p><p><strong></strong></p><ol><li><p>7411<br><img src="/2022/img/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzE5NzgyMDE5,size_16,color_FFFFFF,t_70.png" alt="img" style="zoom: 33%;" /></p></li><li><p><u></u> <strong>22^0=1,2^1=2,2^2=4,2^3=8</strong> 12487<br><img src="/2022/img/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzE5NzgyMDE5,size_16,color_FFFFFF,t_70-166064187407110.png" alt="" style="zoom:33%;" /></p></li><li><p><br><img src="/2022/img/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzE5NzgyMDE5,size_16,color_FFFFFF,t_70-166064194823213.png" alt="" style="zoom: 50%;" /><br><u></u> 11011, 1001, 0111, 0101, 0011, 0001<br><img src="/2022/img/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzE5NzgyMDE5,size_16,color_FFFFFF,t_70-166064212510716.png" alt="" style="zoom: 50%;" /><br>11011, 1010, 0111, 0110, 0011, 0010<br><img src="/2022/img/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzE5NzgyMDE5,size_16,color_FFFFFF,t_70-166064216439519.png" alt="" style="zoom: 50%;" /><br></p></li><li><p><br><img src="/2022/img/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzE5NzgyMDE5,size_16,color_FFFFFF,t_70-166064231040322.png" alt="" style="zoom: 50%;" /><br>(1,3,5,7,9,11)1  4  1()<br><img src="/2022/img/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzE5NzgyMDE5,size_16,color_FFFFFF,t_70-166064258132625.png" alt="" style="zoom:50%;" /></p><p></p></li></ol><p><strong></strong><br><br>1,3,5,7,9,111  6  1  1  1<br>2,3,6,7,10,11 13 0<br>4,5,6,71  2 1  1 1<br>8,9,10,111  3 0<br></p><p><img src="/2022/img/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzE5NzgyMDE5,size_16,color_FFFFFF,t_70-166064303859628.png" alt=""></p><p><code>0101</code> <code>0101</code>  5 5 5 </p><blockquote><p><br>() 10000  200 (100100) 14 ()</p></blockquote><h3 id="font-color-red--CRC-font"><font color='red'>(CRC)</font></h3><p>CRC <u></u>  CRC <u> CRC </u> CRC  CRC <br><strong>CRC </strong>  CRC  <code> + </code> </p><p><strong><mark class="hl-label blue">CRC</mark> </strong></p><p><strong><font color=#3b8dfe></font></strong></p><ol><li><code>101001</code></li><li><strong>G(x)()</strong>  G(x) = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x^3 + x^2 + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></li><li> + 0<code>101001000</code></li><li>G(x) <strong></strong> : G(x) = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo></mo><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><mn>1</mn><mo></mo><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mn>0</mn><mo></mo><msup><mi>x</mi><mn>1</mn></msup><mo>+</mo><mn>1</mn><mo></mo><msup><mi>x</mi><mn>0</mn></msup><mtext></mtext></mrow><annotation encoding="application/x-tex">1  x^3 + 1  x^2 + 0  x^1 + 1  x^0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span><span class="mord cjk_fallback"></span></span></span></span> <code>1101</code></li><li><u>()</u> <strong>2</strong>  <code>001</code>   <code>101001001</code></li></ol><p><img src="/2022/img/2021021213262352.png" alt=""></p><p><strong><font color=#3b8dfe></font></strong></p><ol><li> <code>101001001</code></li><li> <code>1101</code> </li></ol><p><img src="/2022/img/20210212134841902.png" alt=""></p><p><strong>0</strong> </p><blockquote><p> CRC <br><img src="/2022/img/20210212140304184.png" alt=""></p></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><p> <strong>(Forward Error Correction, FEC)</strong> FEC  ARQ FEC </p><blockquote><p><a href="https://blog.csdn.net/jiangqin115/article/details/39315085"></a><a href="http://www.metools.info/code/c128.html"></a><a href="https://www.cnblogs.com/iamwho/p/11510160.html"></a><a href="https://blog.csdn.net/axiqia/article/details/52704061?spm=1001.2101.3001.6661.1&amp;utm_medium=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-1-52704061-blog-103358272.pc_relevant_vip_default&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-1-52704061-blog-103358272.pc_relevant_vip_default&amp;utm_relevant_index=1"></a><a href="https://blog.csdn.net/qq_19782019/article/details/87452394"></a><a href="https://baike.baidu.com/item/%E6%B1%89%E6%98%8E%E7%A0%81/3226749">-</a><a href="https://blog.csdn.net/TL18382950497/article/details/113794438">CRC</a><a href="https://zhuanlan.zhihu.com/p/61636624">CRC</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TCP</title>
      <link href="/2022/08/08/TCP%E5%AD%98%E6%B4%BB%E6%A3%80%E6%B5%8B/"/>
      <url>/2022/08/08/TCP%E5%AD%98%E6%B4%BB%E6%A3%80%E6%B5%8B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong><mark class="hl-label blue">TCP</mark> </strong></p><p> TCP ()TCP</p><ol><li></li><li>NAT TCP </li></ol><p>TCP TCP  NAT TCP  <strong></strong> </p><p><strong><mark class="hl-label blue"></mark> </strong></p><ol><li><strong></strong></li><li><strong>TCP</strong></li></ol><p><a href="https://baike.baidu.com/item/%E9%95%BF%E8%BF%9E%E6%8E%A5"></a></p><p><strong><mark class="hl-label default"></mark> </strong></p><p></p><p><strong><mark class="hl-label default">TCP</mark> </strong></p><p>TCP <strong></strong>  TCP  <code>keepalive time</code> TCP(keepalive probe ) ACK ACK  <code>keepalive time</code>  ACK  <code>keepalive interval</code> <code>keepalive probes</code>  ACK  ACK  <code>keepalive time</code>  <code>keepalive interval</code> </p><p><code>keepalive time</code>  7200 ms()<code>keepalive interval</code>  75 ms<code>keepalive probs</code>  9 <u>keepalive</u> </p><p><strong><mark class="hl-label blue">TCP</mark> </strong></p><p> TCP   TCP </p><blockquote><p><a href="https://www.zhihu.com/question/40602902">TCP37</a><a href="https://www.zhihu.com/question/40602902"></a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category> TCP </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TCP</title>
      <link href="/2022/08/08/TCP%E4%B8%83%E7%A7%8D%E8%AE%A1%E6%97%B6%E5%99%A8%E8%AF%A6%E8%A7%A3/"/>
      <url>/2022/08/08/TCP%E4%B8%83%E7%A7%8D%E8%AE%A1%E6%97%B6%E5%99%A8%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p> (connection-establishment timer)<br> (retransmission timer)<br> (delayed ACK timer)<br> (persist timer)<br> (keepalive timer)<br>FIN_WAIT_2  (FIN_WAIT_2 timer)<br>TIME_WAIT  (TIME_WAIT timer, 2MSL timer)</p></blockquote><p><strong><mark class="hl-label blue"></mark> </strong></p><p> SYN  (13) SYN   1  SYN  RTO  2 4 Linux  SYN  <code>tcp_syn_retries</code> 5 60 </p><p><strong><mark class="hl-label blue"></mark> </strong></p><p> TCP <u></u>(1)<a href="https://jyxcpp.netlify.app/2022/08/05/rtt%E7%9A%84%E6%B5%8B%E9%87%8F/">RTT</a> ACK RTO </p><ol><li>TCPRTO</li><li> ACK </li><li></li></ol><p> <code>tcp_retries2</code> <a href="https://www.cnblogs.com/lshs/p/6038527.html"></a> </p><p><strong><mark class="hl-label blue"></mark> </strong></p><p>ACK  0.5  ACK  0.5  ACKTCP  ACK </p><p><strong><mark class="hl-label blue"></mark> </strong></p><p> TCP <code>window size</code>  0(zero window) TCP TCP TCP <code>Window size</code> <code> Window size</code> (window update)<strong> pure ACK </strong>  <strong></strong> NagleACK <strong></strong>  <strong></strong> RFC1122 RTO <code>tcp_retries2</code>  <code>tcp_retries2</code>  RTO <strong> TCP  RTO  <code>tcp_retries2</code> TCP</strong></p><p><strong><mark class="hl-label blue"></mark> </strong></p><p><strong> TCP  <code>SO_KEEPALIVE</code> </strong>  2  <a href="https://jyxcpp.netlify.app/2022/08/08/tcp%E5%AD%98%E6%B4%BB%E6%A3%80%E6%B5%8B/"></a> </p><p><strong><mark class="hl-label blue">FIN_WAIT_2</mark> </strong></p><p> FIN  <code>FIN_WAIT_2</code>  FIN <code>FIN_WAIT_2</code>   FIN  close()  <code>FIN_WAIT2</code>  <code>tcp_fin_timeout</code>  60  shutdown() </p><p><strong><mark class="hl-label blue">TIME_WAIT</mark> </strong></p><p> <code>TIME_WAIT</code>  <code>2MSL</code>  <code>2MSL</code> <a href="https://jyxcpp.netlify.app/2022/08/03/tcp%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E4%B8%8E%E6%8C%A5%E6%89%8B/"></a> <code>MSL</code>  ip  <code>TTL</code> rfc793  <code>MSL</code>  2 linux  30 s</p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category> TCP </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TCP</title>
      <link href="/2022/08/08/TCP%E2%80%9C%E7%B2%98%E5%8C%85%E2%80%9D/"/>
      <url>/2022/08/08/TCP%E2%80%9C%E7%B2%98%E5%8C%85%E2%80%9D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>TCP  <strong>TCP </strong>  TCP  UDP  <strong></strong>  TCP  TCP TCP<u>TCP</u> TCP</p></blockquote><p><strong><mark class="hl-label blue"></mark> </strong></p><p> <strong></strong>  01  01  <strong></strong>  TCP </p><p><strong></strong></p><p> Nagle <a href="https://jyxcpp.netlify.app/2022/08/07/tcp%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6%E8%AF%A6%E8%A7%A3/"></a></p><ul><li> <code>MSS</code>  <code>Fin</code> <code>MSS</code></li><li>200ms <code>MSS</code> </li></ul><img src="/2022/img/1460000039691668.png" alt="negle" style="zoom: 80%;" /><p> msg1 + msg2(1) </p><p><strong></strong></p><p></p><img src="/2022/img/1460000039691676.png" alt="Negle" style="zoom:67%;" /><p><strong><mark class="hl-label blue"></mark> </strong></p><p> <strong><u></u></strong> &quot;&quot; 01 <u></u>  TCP  TCP </p><blockquote><p>TCP UDP </p></blockquote><p><strong></strong> </p><ol><li><p><strong></strong>  FTP SMTP &quot;\r\n&quot; <strong>CRLF</strong> \r\n</p><img src="/2022/img/1460000039691673.png" alt="" style="zoom: 50%;" /></li><li><p><strong> + </strong> <strong></strong> </p></li></ol><p> <mark class="hl-label default">+</mark>  </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> pack(push, 1)</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">msg_header</span></span><br><span class="line">&#123;   </span><br><span class="line">    <span class="type">int32_t</span>  bodysize;         <span class="comment">//  </span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> pack(pop)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//10M</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX_PACKAGE_SIZE    10 * 1024 * 1024</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ChatSession::OnRead</span><span class="params">(<span class="type">const</span> std::shared_ptr&lt;TcpConnection&gt;&amp; conn, Buffer* pBuffer, Timestamp receivTime)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) <span class="comment">//while</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="keyword">if</span> (pBuffer-&gt;<span class="built_in">readableBytes</span>() &lt; (<span class="type">size_t</span>)<span class="built_in">sizeof</span>(msg_header))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//LOGI &lt;&lt; &quot;buffer is not enough for a package header, pBuffer-&gt;readableBytes()=&quot; &lt;&lt; pBuffer-&gt;readableBytes() &lt;&lt; &quot;, sizeof(msg_header)=&quot; &lt;&lt; sizeof(msg_header);</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        msg_header header;</span><br><span class="line">        <span class="built_in">memcpy</span>(&amp;header, pBuffer-&gt;<span class="built_in">peek</span>(), <span class="built_in">sizeof</span>(msg_header));<span class="comment">//peek</span></span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="keyword">if</span> (header.bodysize &lt;= <span class="number">0</span> || header.bodysize &gt; MAX_PACKAGE_SIZE)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//bodysize</span></span><br><span class="line">            <span class="built_in">LOGE</span>(<span class="string">&quot;Illegal package, bodysize: %lld, close TcpConnection, client: %s&quot;</span>, header.bodysize, conn-&gt;<span class="built_in">peerAddress</span>().<span class="built_in">toIpPort</span>().<span class="built_in">c_str</span>());</span><br><span class="line">            conn-&gt;forceClose();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="keyword">if</span> (pBuffer-&gt;<span class="built_in">readableBytes</span>() &lt; (<span class="type">size_t</span>)header.bodysize + <span class="built_in">sizeof</span>(msg_header))</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        pBuffer-&gt;<span class="built_in">retrieve</span>(<span class="built_in">sizeof</span>(msg_header));</span><br><span class="line">        <span class="comment">//inbuf</span></span><br><span class="line">        std::string inbuf;</span><br><span class="line">        inbuf.<span class="built_in">append</span>(pBuffer-&gt;<span class="built_in">peek</span>(), header.bodysize);</span><br><span class="line">        pBuffer-&gt;<span class="built_in">retrieve</span>(header.bodysize);</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">Process</span>(conn, inbuf.<span class="built_in">c_str</span>(), inbuf.<span class="built_in">length</span>()))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//</span></span><br><span class="line">            <span class="built_in">LOGE</span>(<span class="string">&quot;Process package error, close TcpConnection, client: %s&quot;</span>, conn-&gt;<span class="built_in">peerAddress</span>().<span class="built_in">toIpPort</span>().<span class="built_in">c_str</span>());</span><br><span class="line">            conn-&gt;forceClose();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="comment">// end while-loop</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><mark class="hl-label blue">UDP</mark> </strong></p><p>UDP </p><blockquote><p><a href="https://segmentfault.com/a/1190000039691657"></a><a href="https://www.zhihu.com/question/20210025"></a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category> TCP </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TCP()</title>
      <link href="/2022/08/07/tcp%E6%8B%A5%E5%A1%9E%E6%8E%A7%E5%88%B6/"/>
      <url>/2022/08/07/tcp%E6%8B%A5%E5%A1%9E%E6%8E%A7%E5%88%B6/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong><mark class="hl-label blue"></mark> </strong></p><p> TCP  <strong>(congestion)</strong> </p><p><img src="/2022/img/282120371196460.png" alt="CliffCliff"></p><p><strong><mark class="hl-label blue"></mark> </strong></p><ol><li></li><li>TCP Window size <u></u> </li></ol><p><strong></strong>  IP  IP  TCP </p><blockquote><p>TCP </p></blockquote><p> <code>rwnd</code> TCP  <code>cwnd</code> <strong><font color='orange'> <code>W = min(rwnd, cwnd)</code></font></strong> cwnd  MSS </p><p> ACK  <strong>flight size</strong> <strong> <code>flight size&lt;=W</code></strong> </p><ol><li><p> SACK flight size  seq  ACK Number</p></li><li><p> SACK flight size  SACK </p></li></ol><blockquote><p>W  <strong></strong> </p><p><strong></strong>  TCP  in_flight  <code>in_flight&gt;=cwnd</code> </p></blockquote><p>TCP <strong></strong> </p><h3 id="font-color-red--font"><font color='red'></font></h3><p> TCP  cwnd  TCP  cwnd  cwnd</p><ul><li> <code>cwnd = 1</code> <code>MSS</code> </li><li> ACK cwnd  1 2 </li><li> 2  ACK  cwnd  22  4 </li><li> 4  ACK  cwnd  1 4  cwnd  4 4  8 </li></ul><img src="/2022/img/271.jpg" alt="" style="zoom:50%;" /><blockquote><ul><li> <strong> ACK</strong>  <code>cwnd</code>  ACK<code>cwnd</code>  <strong>(ssthresh)</strong>  <strong></strong> </li><li> 1.5 </li><li>Linux 3.0 <code>cwnd</code>  10 MSS</li></ul></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><p> <code>cwnd</code>  <code>ssthresh</code>  <code>ssthresh</code>  <code>65535</code> </p><p><strong> ACK cwnd  1/cwndACKcwnd++</strong> </p><img src="/2022/img/281.jpg" alt="" style="zoom:67%;" /> <p> <strong>AIMD</strong></p><h3 id="font-color-red--font"><font color='red'></font></h3><p>TCP 1<strong></strong> 2<strong> ACK</strong>  ACK  ACK </p><p>TCP </p><ol><li><strong>RTO</strong><ul><li>sshthresh = cwnd /2</li><li>cwnd  1</li><li></li></ul></li><li><strong> ACKTCP Reno</strong><ul><li>cwnd = cwnd /2</li><li>sshthresh = cwnd</li><li></li></ul></li></ol><h3 id="font-color-red--font"><font color='red'></font></h3><p></p><ul><li>cwnd = sshthresh + 3 * MSS 33</li><li> Duplicated ACK </li><li> duplicated Acks cwnd = cwnd +1</li><li> ACKcwnd = sshthresh </li></ul><img src="/2022/img/-.drawio.png" alt="Reno " style="zoom:67%;" /><p><strong><mark class="hl-label blue">cwnd=ssthresh+33</mark> </strong></p><p> ACK </p><blockquote><p> 3  ACK 3  ACK  RTO TCP Fast Recovery SACK  D-SACK  Fast Recovery  TCP SACKSACKSACKNew Reno </p></blockquote><p><strong>New Reno</strong></p><ul><li>3 Duplicated ACK ACK  ACK  ACK  Partial ACK</li><li> Partial ACK  Partial Ack</li></ul><p> SACK  <strong>FACK</strong> </p><blockquote><p><a href="https://www.cnblogs.com/lshs/p/6038757.html"></a><a href="http://www.52im.net/thread-515-1-1.html">TCP</a><a href="https://xiaolincoding.com/network/3_tcp/tcp_feature.html#%E5%BF%AB%E9%80%9F%E6%81%A2%E5%A4%8D">coding</a><a href="https://blog.csdn.net/dl962454/article/details/115796513"></a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category> TCP </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TCP</title>
      <link href="/2022/08/07/TCP%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6%E8%AF%A6%E8%A7%A3/"/>
      <url>/2022/08/07/TCP%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="font-color-red--font"><font color='red'></font></h3><p>TCP  <strong></strong> ( ARQ ) </p><p><img src="/2022/img/101120ihanzfsth0hhcllk.png" alt=""></p><p> Window Size <strong></strong>  TCP <strong></strong> </p><blockquote><p><strong><font color='orange'></font></strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">S_f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">Sn</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">n</span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mrow><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi></mrow></mrow><annotation encoding="application/x-tex">S{size}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">ze</span></span></span></span></span> </p><img src="/2022/img/IMG_0427(20220802-163852).PNG" alt="" style="zoom:50%;" /></blockquote><p><img src="/2022/img/104946z1skgjjxx8g0txbx.png" alt=""></p><p>12( <strong></strong> )</p><blockquote><p><strong></strong> </p><ul><li><strong><font color='orange'> Nagle Cork </font></strong></li><li><strong><font color='orange'>Clark Solution</font></strong></li></ul></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong>Delayed Acknowledgements</strong> </p><ol><li></li><li> pure ACK  <strong></strong> </li></ol><p><strong><font color='orange'> ACK  0.5  ACK</font></strong> <u></u> </p><ol><li><p><strong> ACK  MSS</strong></p><blockquote><p><u>TCP </u>  MSS  MSS</p></blockquote></li><li><p><strong> quick ACK</strong></p></li><li><p><strong></strong></p></li></ol><p>( ACK recv)Nagle()</p><blockquote><p><strong>quick ACK</strong></p><p> ACK Linux  quick ACK  quick ack  ACK<u></u> <u> RTO </u> <u></u>   quck ack  quick ac k quick ack  16 (16) 16  ACK</p></blockquote><h3 id="font-color-red-Nagle--font"><font color='red'>Nagle </font></h3><blockquote><p> TCP Nagle </p></blockquote><p><strong>Nagle </strong> </p><ol><li> 1 </li><li><strong><font color='orange'> ACK  MMS  FIN </font></strong></li></ol><p><strong><mark class="hl-label blue">NagleACK</mark> </strong></p><p> Nagle  ACK </p><ol><li></li><li> ACK  MMS</li><li>0.5s</li></ol><p> <strong>(deadlock)</strong> NagleACK<strong>telnetssh</strong>  Socket  <code>TCP_NODELAY</code> </p><h3 id="font-color-red-Cork--font"><font color='red'>Cork </font></h3><p><strong>Nagle </strong> Cork  Nagle  Cork  Cork TCP  ACK  MMS  RTO  MMS </p><p>linux  <code>TCP_CORK</code>  Socket  Cork <code>TCP_NODELAY</code>  <code>TCP_CORK</code>  Linux  linux <code>TCP_CORK</code>  <code>TCP_NODELAY</code> </p><blockquote><p>CORK  Nagle Nagle  CORK </p></blockquote><h3 id="font-color-red-Clark-Solution-font"><font color='red'>Clark Solution</font></h3><p><strong>Clark Solution </strong> Clark  <strong><font color='orange'></font></strong> </p><blockquote><p><a href="https://www.cnblogs.com/lshs/p/6038647.html">Cork</a><a href="https://www.cnblogs.com/lshs/p/6038641.html">Nagle</a><a href="https://www.cnblogs.com/lshs/p/6038635.html">ACK</a><a href="http://www.52im.net/thread-515-1-1.html">TCP</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category> TCP </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TCP</title>
      <link href="/2022/08/07/TCP%E9%87%8D%E4%BC%A0%E6%9C%BA%E5%88%B6%E8%AF%A6%E8%A7%A3/"/>
      <url>/2022/08/07/TCP%E9%87%8D%E4%BC%A0%E6%9C%BA%E5%88%B6%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong><font color='orange'></font></strong>  ACK </p><blockquote><p> ACK <a href="https://jyxcpp.netlify.app/2022/07/31/%E8%AF%A6%E8%A7%A3arq%E5%8D%8F%E8%AE%AE/">ARQ</a></p></blockquote><p></p><ol><li><p><strong>RTO() </strong></p></li><li><p><strong></strong></p></li><li><p><strong></strong></p><blockquote><p> 12345  1245 ACK = 3  ACK  3  ACK   345  ACK  3  345  45 </p></blockquote></li></ol><p><a href="https://jyxcpp.netlify.app/2022/08/05/rtt%E7%9A%84%E6%B5%8B%E9%87%8F/"></a> <strong></strong> <strong>SACK</strong> <strong><font color='orange'> <a href="https://jyxcpp.netlify.app/2022/08/05/rtt%E7%9A%84%E6%B5%8B%E9%87%8F/"></a> <a href="https://www.cnblogs.com/lshs/p/6038527.html"></a></font></strong> </p><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong><font color='orange'></font></strong> </p><p><img src="/2022/img/140607dww7fwawwfft7a1j.png" alt=""></p><p> 12345  ACK 2 2 3  ACK 2 4  5  ACK  2 2  <code>ACK = 2</code>  2  2 2 345  <code>ACK = 6</code> </p><blockquote><p><strong>1.  <u></u> ACK2.  <u></u> ACK</strong></p></blockquote><p><strong><mark class="hl-label blue"></mark> </strong><br> dup ACK  3  <a href="zhihu.com/question/21789252"></a></p><p> 2  2345 3  <code>ACK = 2</code>  20  61020 220 TCP SACK</p><h3 id="font-color-red-SACK-font"><font color='red'>SACK</font></h3><p>SACK Selective Acknowledgment  TCP  SACK </p><img src="/2022/img/image-20220807120644997.png" alt="image-20220807120644997" style="zoom:67%;" /><img src="/2022/img/140643mooa22groefuggoh.jpg" alt="SACK" style="zoom: 67%;" /><p><code>SACK</code>  ACK  <code>SACK</code> </p><ol><li> <code>SACK</code> Linux  <code>net.ipv4.tcp_sack</code> Linux 2.4 </li><li><strong>TCP40 SACK 4</strong></li><li> Reneging Reneging  SACK <strong> SACK</strong>  ACK Time-Out ACK  SACK </li><li>SACK  SACK </li></ol><blockquote><p>SACK <a href="https://jyxcpp.netlify.app/2022/07/31/%E8%AF%A6%E8%A7%A3arq%E5%8D%8F%E8%AE%AE/">ARQ</a>  ACK ACK </p></blockquote><h3 id="font-color-red-DSACK-font"><font color='red'>DSACK</font></h3><p>Duplicate SACK  D-SACK SACK  SACK  DSACK</p><ul><li> SACK  ACK  DSACK</li><li> SACK  SACK  DSACK</li></ul><p>DSACK </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">.ACK</span><br><span class="line"></span><br><span class="line">Transmitted  Received    ACK Sent</span><br><span class="line">Segment      Segment     (Including SACK Blocks)</span><br><span class="line">  </span><br><span class="line">3000-3499    3000-3499   3500 (ACK dropped)</span><br><span class="line">3500-3999    3500-3999   4000 (ACK dropped)</span><br><span class="line">3000-3499    3000-3499   4000, SACK=3000-3500</span><br><span class="line">----------------------------------------------</span><br><span class="line">.</span><br><span class="line">Transmitted    Received    ACK Sent</span><br><span class="line">Segment        Segment     (Including SACK Blocks)</span><br><span class="line">  </span><br><span class="line">500-999        500-999     1000</span><br><span class="line">1000-1499      (delayed)                         -&gt;| SACK</span><br><span class="line">1500-1999      1500-1999   1000, SACK=1500-2000    | SACK</span><br><span class="line">2000-2499      2000-2499   1000, SACK=1500-2500    | SACK</span><br><span class="line">2500-2999      2500-2999   1000, SACK=1500-3000    | SACK</span><br><span class="line">1000-1499      1000-1499   3000                    |</span><br><span class="line">               1000-1499   3000, SACK=1000-1500  &lt;-| DSACK</span><br></pre></td></tr></table></figure><p><strong>D-SACK</strong></p><ul><li> ACK </li><li> timeout </li><li></li><li></li></ul><p> TCP Linux <code>tcp_dsack</code> Linux 2.4</p><blockquote><p>DSACK  SACK  DSACK </p></blockquote><h3 id="font-color-red-ER-font"><font color='red'>ER</font></h3><blockquote><p> ACK </p></blockquote><p> RFC5827ER ERERlinux  TCP  ERER</p><p><strong>ER  dup ACK</strong> dup ACK  TCP  4  dup ACK ( dup ACK  3)<strong>ER</strong></p><ol><li>ACKTCP (oseg)  4</li><li><u></u>  dup ACK </li></ol><p> TCP  SACK  ER  dup ACK  <code>ER_thresh = oseg - 1</code>  TCP  SACK  ER <code>(oseg-1) TCP SACK </code> </p><blockquote><p><strong> SACK </strong></p><p> 123  13  2 </p><ol><li> 1  3  ACK=2   SACK  ACK dup ACK  dup ACK ERRTO(S2S3) SACK 13 SACKED ER  2 </li><li> 1  ER </li></ol></blockquote><blockquote><p><a href="https://www.cnblogs.com/lshs/p/6038527.html"></a> <a href="https://perthcharles.github.io/2015/10/31/wiki-network-tcp-early-retrans/"></a> <a href="http://www.52im.net/thread-513-1-1.html">TCP</a> <a href="https://www.cnblogs.com/lshs/p/6038575.html">TCP 20</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category> TCP </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TCP:T/TCPTFO</title>
      <link href="/2022/08/05/TCP-Fast-Open-TFO/"/>
      <url>/2022/08/05/TCP-Fast-Open-TFO/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p> web  web-like  UDP RTT  <strong></strong>  <strong><u></u></strong>  RTT T/TCP  TFO <br><a href="https://cloud.tencent.com/developer/article/1640430"></a></p></blockquote><h3 id="font-color-red--T-TCP-font"><font color='red'> T/TCP</font></h3><p>T/TCP  TCP  http  DNS - TCP T/TCP  SYN T/TCP  SYN FINSYN  MSS<br><img src="/2022/img/IMG_0578(20230406-153450).PNG" alt=""><br> SYN  T/TCP UNPP321 </p><h3 id="font-color-red--TFO-font"><font color='red'> TFO</font></h3><p>TFO  cookie  T/TCP <strong><u><font color='gree'> TCP </font></u></strong> <u><strong> SYN </strong></u> </p><img src="/2022/img/e8b8def71ea7471dac12535fe1068790tplv-k3u1fbpfcp-zoom-in-crop-mark3024000.webp" alt="" style="zoom:67%;" /><p>TCP  ACK  HTTP Response RTT TFP RTT</p><p> <a href="https://switch-router.gitee.io/blog/tcp-fastopen/(https://tools.ietf.org/html/rfc793)">RFC793</a>  SYN <u> TCP </u>  Server  SYN  TCP  TCP <u><strong> TCP Fast Open  SYN  RTT</strong></u>  Web HTTP  Web  HTTP <u> Web  HTTP </u></p><h3 id="font-color-red-TFO-font"><font color='red'>TFO</font></h3><ol><li><strong> TFO client </strong> <strong>FOC</strong> (Fast Open Cookie)<ul><li>1.client  Fast Open SYN cookie  cookie</li><li>2.server  cookie SYN-ACK  Fast Open  client</li><li>3.client  cookie  TFO </li></ul></li><li> TFO<ul><li>1.client  SYN  Fast Open  cookie</li><li>2.server  cookie cookie server  SYN-ACK  server  cookieserver  SYN  SYN-ACK  SYN </li><li>4.client ACK server  SYN  client  SYN client  ACK </li><li>4. TCP client  FOC Fast Open  cookie </li></ul></li></ol><h3 id="font-color-red--font"><font color='red'></font></h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//server</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;netinet/tcp.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> sock_listen = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);</span><br><span class="line">    <span class="type">int</span> qlen = <span class="number">0</span>;</span><br><span class="line">    setsockopt(sock_listen, SOL_TCP, TCP_FASTOPEN, &amp;qlen, <span class="keyword">sizeof</span>(qlen));</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">addr</span>;</span></span><br><span class="line">    bzero(&amp;addr, <span class="keyword">sizeof</span>(addr));</span><br><span class="line">    addr.sin_family = AF_INET;</span><br><span class="line">    addr.sin_port = htons(<span class="number">12345</span>);</span><br><span class="line">    addr.sin_addr.s_addr = inet_addr(<span class="string">&quot;192.168.248.128&quot;</span>);</span><br><span class="line">    bind(sock_listen, (<span class="keyword">struct</span> sockaddr*)&amp;addr, <span class="keyword">sizeof</span>(addr));</span><br><span class="line">    listen(sock_listen, <span class="number">30</span>);</span><br><span class="line">    <span class="type">int</span> sock_conn = accept(sock_listen, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    close(sock_conn);</span><br><span class="line">    close(sock_listen);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//=========================</span></span><br><span class="line"><span class="comment">//client</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> sock;</span><br><span class="line">    sock = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">addr_serv</span>;</span></span><br><span class="line">    bzero(&amp;addr_serv, <span class="keyword">sizeof</span>(addr_serv));</span><br><span class="line">    addr_serv.sin_addr.s_addr = inet_addr(<span class="string">&quot;192.168.248.128&quot;</span>);</span><br><span class="line">    addr_serv.sin_port = htons(<span class="number">12345</span>);</span><br><span class="line">    addr_serv.sin_family = AF_INET;</span><br><span class="line">    <span class="type">char</span> buf[<span class="number">1000</span>];</span><br><span class="line">    sendto(sock, buf, <span class="keyword">sizeof</span>(buf), MSG_FASTOPEN, (<span class="keyword">struct</span> sockaddr*)&amp;addr_serv, <span class="keyword">sizeof</span>(addr_serv));</span><br><span class="line">    <span class="comment">//other things</span></span><br><span class="line">    close(sock);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p> &lt;netinet/tcp.h&gt;</p></li><li><p> 6  qlen  TFO  TFO </p></li><li><p> 7  qlen  TCP_FASTOPEN</p></li><li><p> 33  SYN  sendto  MSG_FASTOPEN</p><blockquote><p>sendto()  UDP</p></blockquote></li></ul><p><strong><u>TFO  TCP </u></strong>  TFO<strong></strong> </p><p><code>/proc/sys/net/ipv4/tcp_fastopen</code> </p><ul><li><p>tcp_fastopen = 1</p><p> cookie</p></li><li><p>tcp_fastopen = 2</p><p> cookie</p></li><li><p>tcp_fastopen = 3</p><p> cookie</p></li></ul><blockquote><p> 2  1  3 </p></blockquote><h3 id="font-color-red-wireshark-font"><font color='red'>wireshark</font></h3><p><img src="/2022/img/image-20230406171933277.png" alt=""></p><p> TCP SYN  1000 </p><p> TFO  RST</p><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong><mark class="hl-label blue">Cookie </mark> </strong></p><p>Cookie  TCP (Kind = 34) TCP  Server  &lt;ClinetIPServerIP&gt; <strong>Cookie  TCP </strong> <strong><font color='gree'> Client  Server  IP  TCP  Cookie</font></strong>  Cookie </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">                                +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">                                |      Kind     |    Length     |</span><br><span class="line">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line">|                                                               |</span><br><span class="line">~                            Cookie                             ~</span><br><span class="line">|                                                               |</span><br><span class="line">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class="line"></span><br><span class="line">Kind            1 byte: value = 34</span><br><span class="line">Length          1 byte: range 6 to 18 (bytes); limited by</span><br><span class="line">                        remaining space in the options field.</span><br><span class="line">                        The number MUST be even.</span><br><span class="line">Cookie          0, or 4 to 16 bytes (Length - 2)</span><br></pre></td></tr></table></figure><p><strong><mark class="hl-label default">TFO </mark> </strong></p><blockquote><p><strong></strong></p><p><strong></strong>   TCP </p></blockquote><p> TCP () <strong></strong>  TFO  SYN  IP  SYN  SYN SYNSYN SYN <u><strong>TFO</strong></u></p><blockquote><p> TFO SYN </p></blockquote><blockquote><p><a href="https://lwn.net/Articles/508865/">TCP Fast Open</a> <a href="https://toutiao.io/posts/1580/app_preview"></a> <a href="https://lwn.net/Articles/508865/">TFO</a> <a href="https://switch-router.gitee.io/blog/tcp-fastopen/">TFO</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category> TCP </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RTTRTTM</title>
      <link href="/2022/08/05/RTT%E7%9A%84%E6%B5%8B%E9%87%8F/"/>
      <url>/2022/08/05/RTT%E7%9A%84%E6%B5%8B%E9%87%8F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p> TCP  RTO (Retransmission Time Out)  RTO  RTT Round-Trip Time RTT  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">T_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>  ACK  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">T_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>T</mi><mi>T</mi><mo>=</mo><msub><mi>T</mi><mn>1</mn></msub><mtext></mtext><msub><mi>T</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">RTT = T_1  T_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">RTT</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>  </p></blockquote><h4 id="font-color-red-Jacobson-Karels--font"><font color='red'>Jacobson / Karels </font></h4><ol><li><p> RTT <strong>SampleRTT</strong>  SampleRTT  <strong></strong>  ACK SampleRTT  SampleRTT </p></li><li><p> RTT SampleRTT <strong>RTT<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>T</mi><msub><mi>T</mi><mi>S</mi></msub></mrow><annotation encoding="application/x-tex">RTT_S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">RT</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></strong> <br><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>T</mi><msub><mi>T</mi><mi>S</mi></msub><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo></mo><mi></mi><mo stretchy="false">)</mo><mi>R</mi><mi>T</mi><msub><mi>T</mi><mi>S</mi></msub><mo>+</mo><mi></mi><mo></mo><mi>S</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>e</mi><mi>R</mi><mi>T</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">RTT_S = (1 - )RTT_S+SampleRTT</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">RT</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;"></span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.13889em;">RT</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">am</span><span class="mord mathnormal" style="margin-right:0.01968em;">pl</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.13889em;">RTT</span></span></span></span></strong></p><p>   0.125</p></li><li><p> RTTDeviationRTT <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>T</mi><msub><mi>T</mi><mi>D</mi></msub></mrow><annotation encoding="application/x-tex">RTT_D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">RT</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>T</mi><msub><mi>T</mi><mi>S</mi></msub></mrow><annotation encoding="application/x-tex">RTT_S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">RT</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>  SampleRTT</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>T</mi><msub><mi>T</mi><mi>D</mi></msub><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo></mo><mi></mi><mo stretchy="false">)</mo><mo></mo><mi>R</mi><mi>T</mi><msub><mi>T</mi><mi>D</mi></msub><mo>+</mo><mi></mi><mo></mo><mi mathvariant="normal"></mi><mi>R</mi><mi>T</mi><msub><mi>T</mi><mi>S</mi></msub><mo></mo><mi>S</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>e</mi><mi>R</mi><mi>T</mi><mi>T</mi><mi mathvariant="normal"></mi></mrow><annotation encoding="application/x-tex">RTT_D=(1-)RTT_D+|RTT_S-SampleRTT|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">RT</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;"></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">RT</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.13889em;">RT</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">am</span><span class="mord mathnormal" style="margin-right:0.01968em;">pl</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.13889em;">RTT</span><span class="mord"></span></span></span></span></p><p>   0.25</p></li><li><p> RTT  RTO</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>T</mi><mi>O</mi><mo>=</mo><mi>R</mi><mi>T</mi><msub><mi>T</mi><mi>S</mi></msub><mo>+</mo><mn>4</mn><mo></mo><mi>R</mi><mi>T</mi><msub><mi>T</mi><mi>D</mi></msub></mrow><annotation encoding="application/x-tex">RTO=RTT_S+4RTT_D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">RTO</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">RT</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">RT</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p></li></ol><p></p><img src="/2022/img/IMG_0439(20220805-181810).PNG" alt="RTO" style="zoom: 50%;" /><p> <code>SNY+ACK</code> SampleRTT  1.5  RTO</p><ol><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>e</mi><mi>R</mi><mi>T</mi><mi>T</mi><mo>=</mo><mn>1.5</mn></mrow><annotation encoding="application/x-tex">SampleRTT=1.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">am</span><span class="mord mathnormal" style="margin-right:0.01968em;">pl</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.13889em;">RTT</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1.5</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>T</mi><msub><mi>T</mi><mi>S</mi></msub><mo>=</mo><mn>1.5</mn></mrow><annotation encoding="application/x-tex">RTT_S=1.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">RT</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1.5</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>T</mi><msub><mi>T</mi><mi>D</mi></msub><mo>=</mo><mn>1.5</mn><mi mathvariant="normal">/</mi><mn>2</mn><mo>=</mo><mn>0.75</mn></mrow><annotation encoding="application/x-tex">RTT_D=1.5/2=0.75</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">RT</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1.5/2</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.75</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>T</mi><mi>O</mi><mo>=</mo><mn>1.5</mn><mo>+</mo><mn>4</mn><mo></mo><mn>0.75</mn></mrow><annotation encoding="application/x-tex">RTO=1.5+40.75</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">RTO</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1.5</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.75</span></span></span></span></li></ol><blockquote><p> RTT  0.25 <strong>RTT </strong> <code>RFC 6298</code>  RTO  1 </p></blockquote><h4 id="font-color-red-Karn-font"><font color='red'>Karn</font></h4><p> ACK  ACK  RTT  ACK  RTT </p><img src="/2022/img/101017ipbtj3eijbtmj2j2.jpg" alt="" style="zoom:67%;" /><ul><li>a ACK  ACK </li><li>b ACK  ACK  ACK </li></ul><p> <strong>Karn</strong> <u> RTT</u> RTO <strong>Karn</strong>  <strong><font color='orange'></font></strong>  RTO  RTO = 2 sRTO = 4 s <br><strong>Karn 12 RTO </strong></p><h4 id="font-color-red-RTT-font"><font color='red'>RTT</font></h4><p><a href="https://jyxcpp.netlify.app/2022/08/04/tcp-%E5%BA%8F%E5%88%97%E5%8F%B7%E5%9B%9E%E7%BB%95%E9%97%AE%E9%A2%98/">RTTM</a></p><blockquote><p>  <a href="https://www.cnblogs.com/lshs/p/6038536.html">TCP 14</a> <a href="http://www.52im.net/thread-515-1-1.html"></a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category> TCP </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RTTM</title>
      <link href="/2022/08/04/TCP-%E5%BA%8F%E5%88%97%E5%8F%B7%E5%9B%9E%E7%BB%95%E9%97%AE%E9%A2%98/"/>
      <url>/2022/08/04/TCP-%E5%BA%8F%E5%88%97%E5%8F%B7%E5%9B%9E%E7%BB%95%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h4 id="font-color-red--font"><font color='red'></font></h4><p>TimeStampTSOPT</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//           Kind: 8</span></span><br><span class="line"><span class="comment">//         Length: 10 bytes</span></span><br><span class="line"><span class="comment">//          +-------+-------+---------------------+---------------------+</span></span><br><span class="line"><span class="comment">//          |Kind=8 |  10   |   TS Value (TSval)  |TS Echo Reply (TSecr)|</span></span><br><span class="line"><span class="comment">//          +-------+-------+---------------------+---------------------+</span></span><br><span class="line"><span class="comment">//              1       1              4                     4</span></span><br></pre></td></tr></table></figure><p><code>TSval</code>   <code>TSecr</code>  (Echo)  <code>TSval</code> </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//                   TCP  A                               TCP B</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//                             &lt;A,TSval=1,TSecr=120&gt; -----&gt;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//                  &lt;---- &lt;ACK(A),TSval=127,TSecr=1&gt;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//                             &lt;B,TSval=5,TSecr=127&gt; -----&gt;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//                  &lt;---- &lt;ACK(B),TSval=131,TSecr=5&gt;</span></span><br></pre></td></tr></table></figure><p> Timestamp <u></u> <font color='orange'>,  RST  Timestamp  Timestamp </font></p><h4 id="font-color-red--font"><font color='red'></font></h4><p>RFC1323TSOPT <strong>RTTM</strong>  (round-trip time measurement) ACK  <strong>PAWS</strong>  (protect against wrapped sequence numbers) SYN-cookie Eifel Detection Algorithm </p><h5 id="font-color-orange-RTTM-font"><font color='orange'>RTTM</font></h5><blockquote><p> RTT 10s  tick   1s  TCP  ACK  TSecr   RTT  0 ! RTT  RTTM <a href="https://jyxcpp.netlify.app/2022/08/05/rtt%E7%9A%84%E6%B5%8B%E9%87%8F/">RTT</a></p></blockquote><p><strong><mark class="hl-label blue">TSOPTRTT</mark> </strong></p><p> ACK </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//            A                                B</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//                             &lt;A,TSval=1&gt; -----&gt;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//                  &lt;---- &lt;ACK(A),TSecr=1&gt;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//                             &lt;B,TSval=5&gt; -----&gt;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//                  &lt;---- &lt;ACK(B),TSecr=5&gt;</span></span><br></pre></td></tr></table></figure><p><strong> RTT</strong>  TSOPT  TSval  A  A  TSval  ACK  TSecr  ACK  TSecr  TSecr  RTT  ACK  TSval </p><ol><li><p><strong>Delay ACK</strong></p><blockquote><p>1. ACK <u></u> 2. ACK pure ACK </p></blockquote><p> Delay ACK,  TSval  Echo  TSval ?<strong> Echo  TSval</strong>  ,  RTT <u> TS.recent  TSecr , TSecr  TS.Recent </u></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//                                       TS.Recent   </span></span><br><span class="line"><span class="comment">//              &lt;A, TSval=1&gt; -------------------&gt;     1      </span></span><br><span class="line"><span class="comment">//                                                    </span></span><br><span class="line"><span class="comment">//              &lt;B, TSval=2&gt; -------------------&gt;     1      </span></span><br><span class="line"><span class="comment">//                                                     </span></span><br><span class="line"><span class="comment">//                       &lt;---- &lt;ACK(B), TSecr=1&gt;      1      </span></span><br><span class="line"><span class="comment">//echo</span></span><br></pre></td></tr></table></figure></li><li><p><strong></strong></p><p><strong></strong> () Echo  TSval  TSval ,  RTT </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">A-&gt;B-&gt;C-&gt;D-&gt;E</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                                         TS.Recent   </span></span><br><span class="line"><span class="comment">       &lt;A, TSval=1&gt; -------------------&gt;    1       </span></span><br><span class="line"><span class="comment">                                                     </span></span><br><span class="line"><span class="comment">                &lt;---- &lt;ACK(A), TSecr=1&gt;1       </span></span><br><span class="line"><span class="comment">                                                    </span></span><br><span class="line"><span class="comment">       &lt;C, TSval=3&gt; -------------------&gt;1       </span></span><br><span class="line"><span class="comment">                                                    </span></span><br><span class="line"><span class="comment">                &lt;---- &lt;ACK(A), TSecr=1&gt;1    </span></span><br><span class="line"><span class="comment">                                                    </span></span><br><span class="line"><span class="comment">       &lt;B, TSval=2&gt; -------------------&gt;1-&gt;2    </span></span><br><span class="line"><span class="comment">                                                   </span></span><br><span class="line"><span class="comment">                &lt;---- &lt;ACK(C), TSecr=2&gt;2       </span></span><br><span class="line"><span class="comment">                                                    </span></span><br><span class="line"><span class="comment">       &lt;E, TSval=5&gt; -------------------&gt;2       </span></span><br><span class="line"><span class="comment">                                                    </span></span><br><span class="line"><span class="comment">                &lt;---- &lt;ACK(C), TSecr=2&gt;2       </span></span><br><span class="line"><span class="comment">                                                    </span></span><br><span class="line"><span class="comment">       &lt;D, TSval=4&gt; -------------------&gt;2-&gt;4    </span></span><br><span class="line"><span class="comment">                                                   </span></span><br><span class="line"><span class="comment">                &lt;---- &lt;ACK(E), TSecr=4&gt;4                                                       </span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p> 11 ACK  TSecr = 1  3 1. RTT 2. 3  TS.Recent  3  B <code>TSecr = 2 &lt; TS.Recent = 3</code>  B </p></li></ol><h5 id="font-color-orange-PAWS-font"><font color='orange'>PAWS</font></h5><blockquote><p> 32  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> ~ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>32</mn></msup><mo></mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^{32}-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">32</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>  4  GB  1 MB /S 1.19  <code>MSL</code>  30 Linux 1 GB <strong></strong> </p></blockquote><p> 1  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>32</mn></msup><mo>+</mo><mn>4999</mn></mrow><annotation encoding="application/x-tex">2^{32}+4999</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">32</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4999</span></span></span></span>  <code>RCV.NXT = 5000</code>, <code>TS.Recent = 100</code> ,  <code>Seq = 5000</code> , <code>LEN = 1000</code> , <code>TSval=70</code>   5000 ~ 5999  <code>TSval &lt; TS.Resent</code> </p><p><strong><mark class="hl-label blue">32</mark> </strong></p><p>1ms 1ms 32-bit  24.8  </p><p><strong><mark class="hl-label blue"></mark> </strong></p><ol><li> <code>TIME-WAIT</code>  <a href="https://xiaolincoding.com/network/3_tcp/time_wait_recv_syn.html"></a></li><li> SYN Cookie  <a href="https://jyxcpp.netlify.app/2022/08/04/syn%E6%B3%9B%E6%B4%AA%E6%94%BB%E5%87%BB/"></a></li><li>RACK </li><li>Eifel </li></ol><blockquote><p><a href="https://www.cnblogs.com/lshs/p/6038494.html">TCP 08</a> <a href="https://switch-router.gitee.io/blog/tcp-timestamp/"></a> <a href="https://switch-router.gitee.io/blog/TCP-SYN-Cookies/">SYN Cookie</a> <a href="https://blog.51cto.com/u_9164120/3289669">RTT</a>  <a href="https://www.gingerdoc.com/tcp-seq-and-loop"></a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category> TCP </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SYN</title>
      <link href="/2022/08/04/SYN%E6%B3%9B%E6%B4%AA%E6%94%BB%E5%87%BB/"/>
      <url>/2022/08/04/SYN%E6%B3%9B%E6%B4%AA%E6%94%BB%E5%87%BB/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong><mark class="hl-label blue"> SYN </mark> </strong></p><p>SYN <u> (DDoS) </u>  TCP  (SYN)  <strong></strong> </p><p><strong><mark class="hl-label blue">SYN </mark> </strong></p><ol><li> IP  <code>SYN</code> </li><li> <code>ACK+SYN</code> </li><li> <code>ACK</code>  <code>SYN</code>  <strong></strong> </li></ol><p><strong><mark class="hl-label blue"></mark> </strong></p><p></p><ul><li> <code>SYN</code>  <strong>SYN </strong> </li><li> <code>SYN + ACK</code>  <code>ACK</code> </li><li> <code>ACK</code>  SYN  <strong>Accept </strong> </li><li> <code>accpet()</code> socket  Accept </li></ul><img src="/2022/img/3d05f574867b70d1134e685e5f5ac137.jpg" alt="" style="zoom:50%;" /><p> SYN SYN  SYN </p><p><strong><mark class="hl-label blue">SYN-Cookie</mark> </strong></p><p><strong><font color='orange'><code>Syn-Flood</code> </font></strong>  TCP  <code>MSS</code> <code>timestamp</code> <code>Sack</code><code>Wscale</code>  <code>ACK</code> </p><p> <strong><font color='orange'></font></strong></p><ul><li><p><strong> <code>ACK</code> </strong></p></li><li><p><strong> <code>SYN</code>  TCP </strong></p></li></ul><blockquote><p><strong> TCP  <code>MSS</code>  <code>WSOPT</code>  SYN  TCP </strong></p></blockquote><p><strong> SYN-cookie </strong></p><p><strong><font color='orange'>TCP  TCP </font></strong>  <code>SYN cookies</code> <u></u></p><ul><li> <code>t</code> (64s)</li><li> <code>m</code>  <code>SYN</code>  <code>MSS</code> </li><li> <code>s</code>  <code>t</code>  <code>Hash</code>  <code>s = hash(sip,dip,sport,dport,t)</code> <code>s</code>  <strong>24</strong> </li></ul><p> <code>n</code> </p><ul><li> <strong>5</strong>  <code>t mod 32</code></li><li><strong>3</strong> <code>m</code> </li><li> <strong>24</strong>  <code>s</code></li></ul><blockquote><p> SYN+ACK </p></blockquote><p><strong> <code>SYN+ACK</code>  <code>ACK</code>  <code>ack = n + 1</code> <code>ack - 1</code>  <code>SYN+ACK</code> </strong>  <code>SYN</code>  <code>ack - 1</code> </p><ul><li> <strong>5</strong>  <code>t</code> </li><li> <code>t</code>  <code>s</code>  <strong>24</strong> </li><li> <code>mss</code> </li></ul><p></p><p><strong><font color='gree'>SYN Cookies  SYN </font></strong>  <br><img src="/2022/img/39-1679303729834-1.jpg" alt=""></p><blockquote><p> <strong></strong>  <code>SYN</code>  TCP </p></blockquote><p><strong><mark class="hl-label blue"> SYN </mark> </strong></p><p><strong><font color='orange'> Linux </font></strong></p><ul><li><p><strong></strong><br>-<a href="https://jyx-fyh.github.io/2023/03/20/%E5%8D%8A%E8%BF%9E%E6%8E%A5%E4%B8%8E%E5%85%A8%E8%BF%9E%E6%8E%A5%E9%98%9F%E5%88%97/"></a></p></li><li><p><strong> SYN-Cookie</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> 1 &gt; /proc/sys/net/ipv4/tcp_syncookies</span><br></pre></td></tr></table></figure><blockquote><ul><li>0 </li><li>1  SYN </li><li>2 </li></ul></blockquote></li><li><p><strong> SYN+ACK </strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//1</span><br><span class="line"><span class="built_in">echo</span> 1 &gt; /proc/sys/net/ipv4/tcp_synack_retries</span><br></pre></td></tr></table></figure><p> 5 <br><img src="/2022/img/image-20230320172721725.png" alt=""></p></li></ul><blockquote><p><a href="https://segmentfault.com/a/1190000019292140">TCPSYN-Cookies</a> <a href="https://xiaolincoding.com/network/3_tcp/tcp_interview.html#tcp-%E8%BF%9E%E6%8E%A5%E5%BB%BA%E7%AB%8B">coding</a> <a href="https://www.cloudflare.com/zh-cn/learning/ddos/syn-flood-ddos-attack/">cloudflare</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category> TCP </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TCP</title>
      <link href="/2022/08/03/TCP%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E4%B8%8E%E6%8C%A5%E6%89%8B/"/>
      <url>/2022/08/03/TCP%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E4%B8%8E%E6%8C%A5%E6%89%8B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>TCP  <strong></strong>  <strong></strong>  TCP </p></blockquote><p>TCP</p><ol><li></li><li></li><li></li></ol><p>TCP<strong>(three-way handshake)</strong>  <strong>(four-way handshake)</strong> </p><h3 id="font-color-red--font"><font color='red'></font></h3><p><img src="/2022/img/image-20230408100933808.png" alt=""></p><ol><li>client_ISN TCP  <code></code>  <code>SYN</code>  1  <code>SYN</code>  <code>SYN</code> <strong><u><font color='orange'></font></u></strong>  <mark class="hl-label default">SYN-SENT</mark>  </li><li> <code>SYN</code> server_isn TCP  <code></code>  TCP  <code></code>  client_isn + 1 ,  <code>SYN</code>  <code>ACK</code>   1  <code>rwnd</code> <strong><u><font color='orange'></font></u></strong>  <mark class="hl-label default">SYN-RCVD</mark>  </li><li> TCP  <code>ACK</code>  1  <code></code>  server_isn + 1 <strong><u><font color='orange'></font></u></strong>  <mark class="hl-label default">ESTABLISHED</mark>  </li><li> <mark class="hl-label default">ESTABLISHED</mark>  </li></ol><blockquote><p><strong><font color=#FF00FF> <code>SYN</code>  <code>SYN+ACK</code> <code>ACK</code> </font></strong>  <strong>TFO</strong> <a href=""></a></p><p> <strong></strong> </p></blockquote><blockquote><p><strong><font color=#3b8dfe>ISN </font></strong></p><ol><li><p><strong></strong></p><p> TCP  TCP  TCP  RFC0793  ISN  4s  1<br><code>ISN = M + F(localhost, localport, remotehost, remoteport)</code></p><ul><li><p><code>M</code>  4  1</p></li><li><p><code>F</code>  Hash  IP IP<a href="!%5Bimg%5D(https://cdn.xiaolincoding.com/gh/xiaolincoder/network/tcp/isn%E7%9B%B8%E5%90%8C.png)"></a></p></li></ul></li><li><p><strong> TCP </strong></p><p>TCP </p><p><img src="/2022/img/image-20220803170133160.png" alt=""></p><p> A B C </p><ol><li> C  B  A  C  IP  B </li></ol></li><li><p> A  B IP  C  B  B  <code>SYN+ACK</code>  B  C  DOS ( B  <code>RST</code>  TCP )</p></li><li><p> C  A  ISN B  A  A  B  C  B  A </p></li></ol><p> wireshark  SYN  ISN  0<br><img src="/2022/img/image-20230409173536342.png" alt=""></p><p>wireshark <br><img src="/2022/img/image-20230409173616067.png" alt=""></p></blockquote><p><strong><mark class="hl-label blue"></mark> </strong></p><ol><li><p><strong></strong></p><p> SYNseq = 90  SYN  SYNseq = 100 </p><img src="/2022/img/image-20220803170152579.png" alt="" style="zoom:67%;" /><p> SYN <strong></strong></p><ul><li> SYN  SYN  </li><li> <code>SYN + ACK</code> </li><li> <code>RST</code> </li><li> SYN </li></ul><p></p><img src="/2022/img/fe898053d2e93abac950b1637645943f.png" alt="" style="zoom: 67%;" /></li><li><p><strong></strong></p><p><u>TCP </u>  <strong></strong> </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  A  --SYN=9        --&gt;  B</span></span><br><span class="line"><span class="comment">//  A  &lt;-SYN=4 ACK=10 --   B</span></span><br><span class="line"><span class="comment">//  A  --      ACK=5  --&gt;  B</span></span><br></pre></td></tr></table></figure><p> A  B  A  A  B A -&gt; B TCPB -&gt; A UDP B  A </p></li><li><p><strong></strong></p><p> SYN </p></li></ol><blockquote><p></p><ul><li></li><li></li></ul></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><blockquote><p></p></blockquote><p><img src="/2022/img/740952-20161107133341092-1088495812.png" alt="-"></p><ol><li> TCP  <code>FIN</code>  <code>1</code>  <code>FIN</code>  <code>FIN_WAIT_1</code> </li><li> <code>ACK</code>  <code>CLOSED_WAIT</code> </li><li> <code>ACK</code>  <code>FIN_WAIT_2</code> </li><li> <code>FIN</code>  <code>LAST_ACK</code> </li><li> <code>FIN</code>  <code>ACK</code>  <code>TIME_WAIT</code> </li><li> <code>ACK</code>  <code>CLOSED</code> </li><li> <code>2MSL</code>  <code>CLOSED</code> <strong> TIME_WAIT </strong> <u>TCPFIN</u></li></ol><blockquote><p><strong></strong> TCP  TCP  <code>FIN</code>  <code>FIN</code> <u><font color='orange'></font></u>  shutdown()  close()  TCP shutdown()  <code>FIN</code>  <code>FIN</code> <a href="https://www.cnblogs.com/lshs/p/6038468.html"></a></p></blockquote><p><strong><mark class="hl-label blue"></mark> </strong></p><p><u> TCP  <strong></strong> </u></p><ul><li> <code>FIN</code> </li><li> <code>FIN</code>  <code>ACK</code> <u></u>  <code>FIN</code> </li></ul><p><strong><mark class="hl-label blue"></mark> </strong></p><p><font color='pink'></font> </p><ul><li><p><font color=#3b8dfe> <code>FIN</code> </font> <code>ACK</code>  <code>FIN</code> </p></li><li><p><font color=#3b8dfe> <code>FIN</code>  MMS </font> <code>ACK</code> <code>FIN</code> </p></li><li><p> close()  RST </p><img src="/2022/img/640-16615889860813.png" alt="" style="zoom:67%;" /></li></ul><p><strong><mark class="hl-label blue">FIN </mark> </strong></p><p> FIN </p><p><strong><mark class="hl-label blue"> TIME_WAIT </mark> </strong></p><ol><li><p><strong><font color='orange'></font></strong></p><p> <strong><u></u></strong>  <code>TIME_WAIT</code> </p><blockquote><p> <strong></strong> </p></blockquote></li><li><p><strong><font color='orange'></font></strong></p><p> FIN  TIME_WAIT  ACK  FIN RST</p></li></ol><p><strong><mark class="hl-label blue"> TIME_WAIT  2MSL</mark> </strong></p><p><strong><u><font color=#FF00FF> 2MSL </font></u></strong> </p><img src="/2022/img/14f8dc84f7d660ffa06e18a4877707ae.png" alt="" style="zoom: 67%;" /><p> A  ACK  ACK  1MSL  B B  ACK  FIN FIN  1MSL  A  ACK  2MSL  A  ACK B  FIN <a href="https://www.zhihu.com/people/noo-40/answers"></a> </p><blockquote><p><code>MSL</code>  IP  <code>TTL</code> RFC793  <code>MSL</code>  2 Linux  30 s</p></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><p><a href="https://jyx-fyh.github.io/2023/04/15/%E4%B8%89%E6%8F%A1%E5%9B%9B%E6%8C%A5%E5%BC%82%E5%B8%B8%E5%88%86%E6%9E%90/"></a></p><blockquote><p><br>UNP<a href="https://xiaolincoding.com/network/3_tcp/tcp_interview.html#tcp-%E8%BF%9E%E6%8E%A5%E5%BB%BA%E7%AB%8B">coding</a> <a href="https://www.cnblogs.com/lshs/p/6038477.html">TCP</a> <a href="https://www.zhihu.com/people/noo-40/answers"></a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category> TCP </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TCP</title>
      <link href="/2022/08/02/TCP%E6%A6%82%E8%BF%B0%E5%8F%8A%E6%8A%A5%E5%A4%B4%E8%A7%A3%E6%9E%90/"/>
      <url>/2022/08/02/TCP%E6%A6%82%E8%BF%B0%E5%8F%8A%E6%8A%A5%E5%A4%B4%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="font-color-red-TCP--font"><font color='red'>TCP </font></h3><p>TCP  OSI  <strong><font color='red'>connection-orientedreliablebyte stream</font></strong> </p><blockquote><ul><li><strong></strong>  TCP  TCP  TCP  <strong></strong>  <strong></strong> TCP </li><li><strong></strong> TCP  IP  <strong></strong> (packet bit errors)<strong></strong> (packet reordering)<strong></strong> (packet duplication)<strong></strong> (packet drops)TCPTCP  <strong></strong> <strong></strong> <strong></strong> TCP<u></u></li><li><strong></strong>  TCP (TCP)(TCP)<strong>TCP </strong> UDP  UDP </li></ul></blockquote><h3 id="font-color-red--font"><font color='red'></font></h3><img src="/2022/img/IMG_0433(20220803-094417).PNG" alt="" style="zoom:67%;" /><p> <strong>20 ~ 60 </strong>  option  20 </p><ul><li><p><strong></strong> </p><blockquote><p> IP  IP  <strong></strong>  TCP  IP  <strong></strong>  TCP  <strong></strong> (demultiplex) <strong></strong> (multiplex)</p></blockquote></li><li><p><strong>(SN)</strong>  TCP  ARQ <u></u>  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> ~ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>32</mn></msup><mo></mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^{32}-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">32</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> </p><blockquote><p>TCP  <u></u>  <strong>ISN</strong>  ISN + 1 ISN = 23  500 24 ~ 500  501  SYN =1 TCP </p></blockquote></li><li><p><strong>(ACK)</strong>  ACK  1  <code>SN = 54</code>  <code>ACK = 55</code>  55  55  <a href="https://jyxcpp.netlify.app/2022/07/31/%E8%AF%A6%E8%A7%A3arq%E5%8D%8F%E8%AE%AE/">GBN</a> <u></u></p></li><li><p><strong></strong>  4 bit  0 ~ 15  20 ~ 60 bytes 4 bytes 11 <code>11  4 = 44</code> bytes </p></li><li><p><strong></strong>  6 0 RFC3540  Nonce </p></li><li><p><strong></strong> 16 <u>64Kb</u>  <strong>rwnd</strong> <u></u> </p></li><li><p><strong></strong>  checksum CheckSum  <u>+TCP+TCP</u> </p><blockquote><p><u></u> UDP  =  IP  +  IP  + 8 + 16UDP <br><strong>UDP  TCP </strong> UDP UDPIPUDPIPUDPIPUDPUDP CRC TCP/UDP </p></blockquote></li><li><p><strong></strong> 16URG<u>URG</u> </p></li><li><p><strong></strong></p><ul><li><strong>CWR(Congestion Window Reduce)</strong> ECETCP</li><li><strong>ECE(ECN Echo)</strong> ECN  TCP 3 TCP  ECN TCPIPECN11ECN(Explicit Congestion Notification)<a href="https://jyxcpp.netlify.app/2022/08/07/tcp%E6%8B%A5%E5%A1%9E%E6%8E%A7%E5%88%B6/"></a></li><li><strong>URG(Urgent)</strong> (The urgent pointer) </li><li><strong>ACK(Acknowledgment)</strong> 1  ACK 0</li><li><strong>PSH(Push)</strong> <u> telnet  rlogin </u></li><li><strong>RST(Reset)</strong> TCP TCP <ol><li></li><li></li><li></li><li>TWA(TIME-WAIT Assassination)</li><li> <a href="https://www.cnblogs.com/lshs/p/6038500.html"></a></li></ol></li><li><strong>SYN(Synchronize</strong>) TCPTCP.</li><li><strong>FIN(Finish)</strong> TCP<u></u> </li></ul></li><li><p><strong>(Option)</strong> 32bits MSSSACKTimestamp <u></u> </p><blockquote><img src="/2022/img/20191026141216154.png" alt="" style="zoom:67%;" /><p><img src="/2022/img/740952-20161107134032077-307444296.png" alt=""></p><p></p><ul><li><p><strong>(Maximum Segment Size  MSS )</strong> <strong><font color='red'>MSS</font></strong> </p><blockquote><p>MSS  TCP TCP <strong><u></u></strong> MSS = MTU - 20 TCP - 20IP <strong>MSS1500-20-20=1460</strong></p></blockquote></li><li><p><strong>(window scaling  WSOPT  )</strong> <strong><font color='red'></font></strong> TCPwindow scale</p><blockquote><p><code>window size</code>  16  64 kb WSOPT </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//         +---------+---------+---------+</span></span><br><span class="line"><span class="comment">//         | Kind=3  |Length=3 |shift.cnt|</span></span><br><span class="line"><span class="comment">//         +---------+---------+---------+</span></span><br></pre></td></tr></table></figure><p> WSOPT  <code>Window Size &lt;&lt; shift.cnt</code> <u><strong>shift.cnt 14</strong></u>  shift.cnt  14  14  <strong>Window Size</strong> WSOPT  16  <strong>Window Size</strong>  30 (1GB)TCP</p></blockquote></li><li><p><strong>(Selective Acknowledgements SACK )</strong> </p></li><li><p><strong>(timestamps )</strong>  <u></u> RTTM<u></u> PAWS<a href="https://jyxcpp.netlify.app/2022/08/04/tcp-%E5%BA%8F%E5%88%97%E5%8F%B7%E5%9B%9E%E7%BB%95%E9%97%AE%E9%A2%98/"></a> </p></li><li><p><strong>NOP</strong> <u>4NOP</u> </p></li><li><p><strong>EOL</strong> </p><blockquote><p> <strong>Header Length</strong>  TCP  40 bytes 29-38 bytes  TSOPT  39 byte  EOL  EOL  TCP  40 byte byte RFC793  0 EOL 0  TCP linux  TCP  EOL  NOP  TCP </p></blockquote></li><li><p><strong>FOC</strong>  <strong>TFO</strong>  Cookie <a href="https://jyxcpp.netlify.app/2022/08/05/tcp-fast-open-tfo/"></a></p></li></ul></blockquote></li></ul><blockquote><p></p><p><a href="https://www.cnblogs.com/lshs/p/6038458.html">TCP01</a> ,<a href="https://www.gingerdoc.com/tcp-intro"></a> ,<a href="https://coolshell.cn/articles/11564.html">TCP</a> , <a href="https://www.cnblogs.com/lshs/p/6038494.html">TCP 8</a> , </p></blockquote>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category> TCP </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/08/02/%E5%88%9D%E8%AF%86%E7%AB%AF%E5%8F%A3/"/>
      <url>/2022/08/02/%E5%88%9D%E8%AF%86%E7%AB%AF%E5%8F%A3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="font-color-red--font"><font color='red'></font></h3><p><strong></strong> IP  IP  IP <strong><font color=#3b8dfe></font></strong> </p><blockquote><p> IP  <strong></strong>  IP  <strong></strong> </p></blockquote><p> <strong></strong>  49152 ~ 65535</p><p> <strong>well-know port</strong></p><div class="note info flat"><p><strong><font color='gree'>ICANN</font></strong></p><p><strong></strong> <strong>0 ~ 1023</strong></p><p><strong></strong> <strong>1024 ~ 49151</strong></p><p><strong></strong> <strong>49152 ~ 65535</strong></p><p><strong><font color=#3b8dfe> 16  bit  0 ~ 65535</font></strong>   ICANN  TCP  UDP  http - 80DNS - 53 ICANN </p><p><strong><font color='orange'> Linux  <code>/etc/services</code></font></strong></p></div><div class="note warning flat"><p> TCP/IP  </p></div><p><strong></strong></p><ul><li><p><strong> TCP  IP <a href="https://jyx-fyh.github.io/2023/04/02/%E5%B8%B8%E7%94%A8socket%E9%80%89%E9%A1%B9/">Socket</a></strong></p></li><li><p><strong><font color='red'>UDP  TCP </font></strong> TCP/IP  TCP  UDP  http  80 TCP  UDP  80 </p><blockquote><p> HTTPTCPUDP TCP  UDP  UDP  TCP  512~514  <code>etc/services</code></p></blockquote></li></ul>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category> TCP </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ARQ</title>
      <link href="/2022/07/31/%E8%AF%A6%E8%A7%A3ARQ%E5%8D%8F%E8%AE%AE/"/>
      <url>/2022/07/31/%E8%AF%A6%E8%A7%A3ARQ%E5%8D%8F%E8%AE%AE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong><font color='gree'></font></strong>Automatic Repeat-reQuestARQ OSI  <u></u>  <u></u>  <strong></strong>  <strong></strong> <strong></strong> <strong></strong></p><blockquote><p><font color='orange'>ARQ ?</font></p><p>ARQ  ARQ  FCS  TCP TCP  seq </p></blockquote><p><strong><font color=#FF00FF>ARQ  - SWNGBNSR</font></strong> </p><h3 id="font-color-red--SW-font"><font color='red'> - SW</font></h3><ul><li><p><strong> 1 </strong> <strong> ACK </strong></p></li><li><p>ARQ  <strong>seq</strong>  <strong>ACK</strong>  ACK <strong> seq  1  0  1</strong>  ACK  <strong></strong>  seq = 1  ACK = 0  seq = 0 </p><blockquote><p><mark class="hl-label default"> - </mark>   2 </p></blockquote></li><li><p> <strong></strong> </p><blockquote><p><a href="https://jyxcpp.netlify.app/2022/08/16/%E5%B7%AE%E9%94%99%E6%A3%80%E6%B5%8B%E5%92%8C%E7%BA%A0%E6%AD%A3%E6%8A%80%E6%9C%AF/"></a></p></blockquote></li><li><p><strong></strong> </p><ul><li> </li><li>ACK </li><li> ACK   ACK </li><li></li></ul><p><strong></strong> </p><ul><li><p> Seq  = R ACK = R + 1% 2 </p></li><li><p> Seq != R ACK = R </p></li><li><p> ACK</p><img src="/2022/img/IMG_0426(20220802-152553).PNG" alt="" style="zoom: 50%;" /></li></ul></li><li><p><strong></strong> </p><blockquote><p><strong><font color=#3b8dfe></font></strong>   <br><strong>  </strong></p><p>  -   1Mbps1 bit  20 </p><p> = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo></mo><mn>1</mn><msup><mn>0</mn><mn>6</mn></msup><mo stretchy="false">)</mo><mo></mo><mo stretchy="false">(</mo><mn>20</mn><mo></mo><mn>1</mn><msup><mn>0</mn><mrow><mo></mo><mn>3</mn></mrow></msup><mo stretchy="false">)</mo><mo>=</mo><mn>20000</mn></mrow><annotation encoding="application/x-tex">(1  10^6)  (20  10^{-3}) = 20000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">20</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">20000</span></span></span></span>  20000  1000  5%</p><p> 15 15000 75% <strong>N</strong> </p></blockquote></li></ul><h3 id="font-color-red-NGBN-font"><font color='red'>NGBN</font></h3><blockquote><p> <strong>pipeline</strong> </p></blockquote><ul><li><p> ACK <strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>m</mi></msup><mo></mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^{m}-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7477em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></strong> <strong> 1</strong> </p><blockquote><p><strong><font color='orange'></font></strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">S_f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">Sn</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">n</span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mrow><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi></mrow></mrow><annotation encoding="application/x-tex">S{size}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">ze</span></span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">R_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p><img src="/2022/img/IMG_0427(20220802-163852).PNG" alt="" style="zoom:50%;" /></blockquote></li><li><p><strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>m</mi></msup></mrow><annotation encoding="application/x-tex">2^m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6644em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span></span></span></span> </strong>  m  TCP  Seq  16  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> ~ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>32</mn></msup><mo></mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^{32}-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">32</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>    </p></li><li><p><strong> ACK </strong>  ACK = 4  <strong>Seq = 4 </strong>  ACK </p></li><li><p><strong></strong> </p></li><li><p><strong></strong> </p><ul><li><p><strong> ACK</strong> </p><blockquote><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>f</mi></msub><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">S_f = 4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>n</mi></msub><mo>=</mo><mn>7</mn></mrow><annotation encoding="application/x-tex">S_n = 7</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">7</span></span></span></span>  4  456</p></blockquote></li><li><p> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>C</mi><mi>K</mi><mo>=</mo><msub><mi>S</mi><mi>f</mi></msub><mo>+</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">ACK = S_f+m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>f</mi></msub><mo>&lt;</mo><msub><mi>S</mi><mi>f</mi></msub><mo>+</mo><mi>m</mi><mo>&lt;</mo><mo>=</mo><msub><mi>S</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">S_f&lt;S_f+m&lt;=S_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>f</mi></msub><mo>=</mo><msub><mi>S</mi><mi>f</mi></msub><mo>+</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">S_f=S_f+m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> <strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>C</mi><mi>K</mi><mo mathvariant="normal"></mo><msub><mi>S</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">ACK  S_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> </strong> </p></li><li><p> ACK </p></li><li><p></p></li></ul><p><strong></strong> </p><ul><li> ACK</li><li><strong> ACK = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">R_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>  ACK </strong>  Seq = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">R_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> </li><li> ACK </li></ul></li></ul><div class="note info flat"><p><strong><font color=#3b8dfe> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>m</mi></msup><mo></mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^{m}-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7477em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> </font></strong></p><p><strong></strong></p><img src="/2022/img/IMG_0428(20220802-173239).PNG" alt="" style="zoom:50%;" /></div><blockquote><p><strong></strong> </p><img src="/2022/img/IMG_0429(20220802-173821).PNG" alt="" style="zoom:50%;" /><p>ACK = 3  Seq = 12 </p></blockquote><p></p><img src="/2022/img/IMG_0430(20220802-174823).PNG" alt="" style="zoom: 67%;" /><h3 id="font-color-red-SR-font"><font color='red'>SR</font></h3><blockquote><p>GBN </p></blockquote><ul><li><p><strong> GBN  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mi>m</mi><mo></mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">2^{m-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></strong>  </p></li><li><p><strong></strong> </p></li><li><p> GBN <strong>SR </strong> </p></li><li><p> GBN </p><blockquote><p> SR GBN </p></blockquote></li><li><p><strong></strong></p><ul><li></li><li> ACK  ACK = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">S_f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">S_f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> </li><li> ACK </li><li></li></ul><p><strong></strong></p><ul><li> Seq  ACK = Seq  Seq = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">R_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> </li><li> Seq  ACK = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">R_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> </li><li></li></ul></li></ul><div class="note info flat"><p><strong><font color=#3b8dfe> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mi>m</mi><mo></mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">2^{m-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></font></strong></p><img src="/2022/img/IMG_0431(20220802-201744).PNG" alt="" style="zoom: 50%;" /></div><p></p><img src="/2022/img/IMG_0432(20220802-202103).PNG" alt="" style="zoom:50%;" />]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category> TCP </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CSAPP</title>
      <link href="/2022/07/08/CSAPP/"/>
      <url>/2022/07/08/CSAPP/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="font-color-red--font"><font color='red'></font></h2><h3 id="font-color-orange--font"><font color='orange'></font></h3><div class="mermaid-wrap"><pre class="mermaid-src" hidden>  graph LRhello.c--&gt; B{}--&gt;hello.i--&gt;L{}--&gt;hello.s--&gt;G{}--&gt;K(&quot;hello.o&quot;)--&gt;A{}--&gt;Z(&quot;printf.o&quot;)--&gt;A  </pre></div><blockquote><ul><li><code>hello.i</code>  <code>hello.c</code> </li><li>CC</li><li><strong></strong>  CPU </li><li><code>printf</code>  <code>printf.o</code>  <code>hello.c</code> </li></ul></blockquote><h3 id="font-color-orange--font"><font color='orange'></font></h3><ol><li><p><strong></strong></p><blockquote><p> <strong>word</strong> 432863<font color='gree'>C</font></p></blockquote></li><li><p>I/O</p><blockquote><p>I/O</p></blockquote></li><li><p></p><blockquote><p> <strong>DRAM</strong> </p></blockquote></li><li><p></p><blockquote><p></p><ul><li></li><li></li><li>ALU/ALU</li><li></li></ul></blockquote></li></ol><h3 id="font-color-orange--font"><font color='orange'></font></h3><p> CPU </p><blockquote><p> CPU </p><p> CPU </p></blockquote><p><strong></strong> </p><img src="/2022/img/20220709092100.png" alt="" style="zoom:50%;" /><div class="note info flat"><p>L1L2L3 <strong>SRAM</strong> </p></div><p><strong><font color='greew'></font></strong></p><h3 id="font-color-orange--font"><font color='orange'></font></h3><p><strong>  </strong></p><p></p><ol><li></li><li></li></ol><p><strong><font color=#00FFFF></font></strong></p><p><u></u><u></u><u></u></p><ul><li> I/O </li><li> I/O </li><li> I/O </li></ul><h3 id="font-color-orange--font"><font color='orange'></font></h3><p><strong><font color=#00FFFF></font></strong>  CPU  <strong></strong> PC<strong></strong> </p><p><strong>kernel</strong></p><h3 id="font-color-orange--font"><font color='orange'></font></h3><blockquote><p>Linux<strong></strong></p></blockquote><p><strong></strong>  Linux/Unix  I/O  Unix I/O  I/O </p><h3 id="font-color-orange-Amdahl-font"><font color='orange'>Amdahl</font></h3><p><strong><font color='pink'></font></strong> </p><blockquote><p> 60%  2.5X</p></blockquote><hr><h2 id="font-color-red--font"><font color='red'></font></h2><p><strong><font color='greew'> =  + </font></strong></p><blockquote><p></p></blockquote><h3 id="font-color-orange--font"><font color='orange'></font></h3><p><strong>byte</strong>  <strong></strong> </p><blockquote><p>C</p><p><strong><font color='gree'></font></strong> CPU </p></blockquote><h4 id="font-color-00FFFF--font"><font color=#00FFFF></font></h4><p><strong> = 4</strong> <strong> = 2 = 1</strong></p><blockquote><p>0x173A4</p><img src="/2022/img/20220709110111.png" alt="image-20220709110110979" style="zoom:67%;" /></blockquote><h4 id="font-color-00FFFF--font"><font color=#00FFFF></font></h4><p><strong>word size</strong> </p><p>64  32  32  64 32  64 </p><p>C</p><blockquote><p>char  char  int</p></blockquote><p>ISO C99 int32_tint64_t </p><p><strong>C char  1 </strong></p><blockquote><p> char C</p></blockquote><h4 id="font-color-00FFFF--font"><font color=#00FFFF></font></h4><p><strong>little endian</strong> </p><p><strong>big   endian</strong> </p><p>0x01234567</p><img src="https://jyxcpp.netlify.app/img/20220709113101.PNG" alt="IMG_0381(20220709-113043)" style="zoom:67%;" /><p><strong></strong></p><blockquote><p></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> a = <span class="number">0x12345678</span>;</span><br><span class="line"><span class="type">char</span> *b = (<span class="type">char</span>*)&amp;a;</span><br><span class="line"><span class="keyword">if</span> (*b == <span class="number">0x78</span>)</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;little endian&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;big endian&quot;</span> &lt;&lt; endl;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">union</span> <span class="title class_">Demo</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">char</span> ch;</span><br><span class="line"><span class="type">short</span> sh;</span><br><span class="line">&#125;demo;</span><br><span class="line"> </span><br><span class="line">demo.sh = <span class="number">0x0001</span>;<span class="comment">//0x0100    :0x0001</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span>(demo.ch == <span class="number">0x01</span>)</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;little endian&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;big endian&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><h4 id="font-color-00FFFF--font"><font color=#00FFFF></font></h4><p><strong> k  k  k  0 </strong>  <strong></strong>  <strong></strong> </p><p> k  <strong></strong> </p><p> k  0</p><blockquote><ul><li><p>C</p></li><li><p> <strong><font color=#FF00FF> = k % w</font></strong> w <code>int a = 0x12345678 &lt;&lt; 36</code>  <code>36%32=4</code> Cjava</p></li></ul></blockquote><h4 id="font-color-00FFFF--font"><font color=#00FFFF></font></h4><blockquote><p>C/C++ java </p><p><strong>CJava</strong></p></blockquote><p></p><img src="https://jyxcpp.netlify.app/img/20220710093132.png" alt="image-20220710093132790" style="zoom:67%;" /><p><strong><font color='greew'>10</font></strong></p><div class="note info flat"><p></p><img src="https://jyxcpp.netlify.app/img/20220710103319.png" alt="" style="zoom:50%;" /></div><blockquote><p></p><p>A - B = A + (-B)<strong>BBB</strong> A  B  B  -B ()  B  B </p><p><strong></strong></p></blockquote><p><strong></strong></p><ul><li><p>|MIN| = |MAX| + 1</p><blockquote><p> <strong>-MIN = MIN</strong></p><p><font color='red'>X &gt; Y != (-X) &lt; (-Y)</font></p></blockquote></li><li><p>1</p></li></ul><div class="note info flat"><p></p><p></p><ul><li><p> <strong></strong> , , . 8:</p><p>[+1] = 0000 0001</p><p>[- 1] = 1000 0001</p></li><li><p>, <strong><font color='greew'></font></strong> </p><p>[+1] = [00000001] = [00000001]</p><p>[- 1] = [10000001] = [11111110]</p></li><li><p>, <strong><font color='greew'></font></strong>  , +1. (+1)</p><p>[+1] = [00000001] = [00000001] = [00000001]</p><p>[-1 ] = [10000001] = [11111110]  = [11111111]</p></li></ul><p><strong></strong></p><p><strong><font color='red'>10</font></strong> </p><p><strong>-X = ~X + 1</strong></p><p><a href="https://www.cnblogs.com/zhangziqiu/archive/2011/03/30/computercode.html">, ,  </a></p></div><h4 id="font-color-00FFFF--font"><font color=#00FFFF></font></h4><ul><li><p><strong></strong></p></li><li><p><strong></strong></p><blockquote><ul><li><p><strong><font color='red'></font></strong> signed unsigned </p><blockquote><p></p><p></p><p>832</p><p></p><p>a = 1110           -&gt;  -&gt; 0010</p><p>b = 11111110    -&gt;  -&gt; 00000010</p><p>ab a = b</p></blockquote></li><li><p><strong><font color='red'></font></strong> <font color='red'> </font> <strong> signed int  unsigned </strong>  signed int unsigned int </p></li><li><p><strong><font color='red'></font></strong> <font color='red'></font></p><div class="note danger flat"><blockquote><p><strong><font color='red'></font></strong></p></blockquote></div></li></ul></blockquote></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">char</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="type">signed</span> <span class="type">int</span> b = <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">if</span> (a &lt; b)</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;aha&quot;</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;dada&quot;</span>;   <span class="comment">//dada</span></span><br><span class="line"><span class="comment">//==================================</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="type">signed</span> <span class="type">int</span> b = <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">if</span> (a &lt; b)</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;aha&quot;</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;dada&quot;</span>;  <span class="comment">//aha</span></span><br></pre></td></tr></table></figure><p></p><ul><li><ol><li><code>unsigned char</code>  <code>signed int</code>  <code>unsigned char</code>  <code>signed int</code>  <code>unsigned char</code> a  <code>signed int</code></li><li>a  b  <code>signed int</code> a &gt; b dada</li></ol></li><li><ol><li><code>unsigned int</code>  <code>signed int</code> -1  INT_MAX</li><li>b &gt; a aha</li></ol></li></ul><p><strong><font color=#FF00FF></font></strong></p><p><img src="https://jyxcpp.netlify.app/img/20220710160958.png" alt=""></p><p><strong><font color=#FF00FF></font></strong></p><p><img src="https://jyxcpp.netlify.app/img/20220710161025.png" alt=""></p><hr><h4 id="font-color-00FFFF--font"><font color=#00FFFF></font></h4><p><strong>kX = X % <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>K</mi></msup></mrow><annotation encoding="application/x-tex">2^K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span></span></span></span></span></span></span></span></strong></p><p><strong>kX = X % <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>K</mi></msup></mrow><annotation encoding="application/x-tex">2^K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span></span></span></span></span></span></span></span> </strong></p><blockquote><p><strong><font color='orange'></font></strong></p><p>10101 2   = 1110</p><p>10101 %  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>4</mn></msup></mrow><annotation encoding="application/x-tex">2^4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span> = 1110</p></blockquote><p></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> a = <span class="number">0x12345678</span>;</span><br><span class="line"><span class="type">char</span> c = a;</span><br><span class="line"><span class="keyword">if</span>(c==<span class="number">0x78</span>)</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;little endian&quot;</span>&lt;&lt;endl;</span><br></pre></td></tr></table></figure><p><strong><font color='red'></font></strong></p><hr><h4 id="font-color-00FFFF--font"><font color=#00FFFF></font></h4><p><strong><font color=#FF00FF>X + Y = ( X + Y ) % <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>k</mi></msup></mrow><annotation encoding="application/x-tex">2^k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span></font></strong></p><p><img src="https://jyxcpp.netlify.app/img/20220713083030.png" alt="image-20220713083023388"></p><p> <strong></strong>  <strong></strong>  <strong></strong> </p><blockquote><p> ( X + Y ) - Y  ( X + Y )  ( X + Y ) - Y = X</p><p><strong><font color=#FF00FF></font></strong></p></blockquote><hr><h4 id="font-color-00FFFF--font"><font color=#00FFFF></font></h4><img src="https://jyxcpp.netlify.app/img/20220713083826.PNG" alt="" style="zoom:67%;" /><img src="https://jyxcpp.netlify.app/img/20220713083902.PNG" alt="" style="zoom:67%;" /><p><strong></strong></p><div class="note danger flat"><p><strong><font color='red'> X&lt;1  X-1&lt;0</font></strong>  X = INT_MIN X - 1 = INT_MAX</p><p></p></div><hr><h4 id="font-color-00FFFF--font"><font color=#00FFFF></font></h4><blockquote><p> 1 </p></blockquote><p><strong><font color=#FF00FF> X&lt;&lt; K = X * <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>K</mi></msup></mrow><annotation encoding="application/x-tex">2^K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span></span></span></span></span></span></span></span></font></strong></p><p> n  m n&gt;m 1  14 </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 0000 0000 0000 1110</span></span><br><span class="line"><span class="comment">//                </span></span><br><span class="line"><span class="comment">//                3210</span></span><br></pre></td></tr></table></figure><p><strong></strong></p><ol><li>x &lt;&lt; n + x&lt;&lt;(n-1) +  + x&lt;&lt;m</li><li>x&lt;&lt;(n + 1) - (x &lt;&lt; m)</li></ol><p></p><blockquote><p></p><ul><li>X * 14 = X * ( <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>3</mn></msup></mrow><annotation encoding="application/x-tex">2^3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span> + <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">2^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span> +<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>1</mn></msup></mrow><annotation encoding="application/x-tex">2^1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span> ) = (X&lt;&lt;3) + (X&lt;&lt;2)+ (X&lt;&lt;1) = (X&lt;&lt;4) - (X&lt;&lt;1)</li><li>3*A = A&lt;&lt;1 + A</li></ul></blockquote><hr><h4 id="font-color-00FFFF--font"><font color=#00FFFF></font></h4><blockquote><p>30 <strong></strong> </p></blockquote><p><strong></strong></p><p><strong><font color='greew'> 2 </font></strong> <strong><font color='greew'>X &gt;&gt;k = [X / <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>k</mi></msup></mrow><annotation encoding="application/x-tex">2^k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span>]</font></strong></p><blockquote><p>[ a ]  a  [14.5] = 14 [-3.5] = -4</p></blockquote><div class="note info flat"><p> [ a ] =  a  </p><p><strong>(x+(1&lt;&lt;k)-1)&gt;&gt;1 = [x/<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>k</mi></msup></mrow><annotation encoding="application/x-tex">2^k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span>]</strong></p><p><strong><font color='greew'>0</font></strong></p><p><mark class="hl-label default">(x &lt; 0?x+(1 &lt;&lt; k ) - 1 : x) &gt;&gt; k</mark></p></div><div class="note danger flat"><p><strong><font color='red'></font></strong></p></div><hr><h4 id="font-color-00FFFF--font"><font color=#00FFFF></font></h4><blockquote><p>Intel  8087  William Kahan  8087  IEEE  1985  IEEE 754 IEEE 754</p></blockquote><p> <strong></strong> </p><img src="https://jyxcpp.netlify.app/img/20220713113938.png" alt="" style="zoom:50%;" /><p><img src="https://jyxcpp.netlify.app/img/20220713114053.png" alt=""></p><p><strong></strong></p><p>161616016160</p><p><strong></strong></p><p> <strong></strong><strong>31</strong> <strong> 32  31  31~32 </strong> </p><p><strong></strong></p><p>Bit 1 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>16</mn></msup></mrow><annotation encoding="application/x-tex">2^{16}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">16</span></span></span></span></span></span></span></span></span></span></span></span> - <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mo></mo><mn>16</mn></mrow></msup></mrow><annotation encoding="application/x-tex">2^{-16}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span><span class="mord mtight">16</span></span></span></span></span></span></span></span></span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>16</mn></msup></mrow><annotation encoding="application/x-tex">2^{16}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">16</span></span></span></span></span></span></span></span></span></span></span></span> 6553632 10 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mo></mo><mn>16</mn></mrow></msup></mrow><annotation encoding="application/x-tex">2^{-16}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span><span class="mord mtight">16</span></span></span></span></span></span></span></span></span></span></span></span></p><p><strong></strong></p><p></p><p><strong><font color=#FF00FF></font></strong></p><blockquote><p></p></blockquote><p><strong>C</strong> </p><mark class="hl-label default">flt = sign  mantissa  base^exponent</mark> <p></p><ul><li><mark class="hl-label default">flt</mark>  </li><li><mark class="hl-label default">sign</mark>   flt  0  1 0  flt  1  flt </li><li><mark class="hl-label default">base</mark>   2</li><li><mark class="hl-label default">mantissa</mark>   base  1  mantissa  base****  <div class="note danger flat"><p>10.101  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><msup><mn>0</mn><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">10^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span> 10.101  1  mantissa  base </p></div></li><li><mark class="hl-label default">exponent</mark>  </li></ul><p>1.0101  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><msup><mn>0</mn><mn>3</mn></msup></mrow><annotation encoding="application/x-tex">10^3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span>  1.0101 10 3 </p><p><strong><font color=#FF00FF></font></strong></p><p> base  10 19.625 </p><p>19.625 = 1.9625  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><msup><mn>0</mn><mn>1</mn></msup></mrow><annotation encoding="application/x-tex">10^1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></p><p> base  2  19.625  10011.101</p><p>19.625 = 10011.101 = 1.0011101  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>4</mn></msup></mrow><annotation encoding="application/x-tex">2^4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></p><blockquote><p>19.625 <br>19 = 1  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>4</mn></msup></mrow><annotation encoding="application/x-tex">2^4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span> + 0  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>3</mn></msup></mrow><annotation encoding="application/x-tex">2^3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span> + 0  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">2^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span> + 1  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>1</mn></msup></mrow><annotation encoding="application/x-tex">2^1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span> + 1  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>0</mn></msup></mrow><annotation encoding="application/x-tex">2^0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span> = 10011<br><br>0.625 = 1  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mo></mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">2^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> + 0  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mo></mo><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">2^{-2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span> + 1  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mo></mo><mn>3</mn></mrow></msup></mrow><annotation encoding="application/x-tex">2^{-3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span></span> = 101<br><br>19.625 = 10011.101</p></blockquote><p>base <strong><font color=#00FFFF> exponent </font></strong> </p><ul><li>exponent mantissa  exponent </li><li>exponent mantissa  exponent </li></ul><p><strong><font color=#FF00FF></font></strong></p><p><strong>32 float</strong> <mark class="hl-label default"> 1 bit</mark>  + <mark class="hl-label default"> 8 bit</mark>  + <mark class="hl-label default"> 23 bit</mark> </p><p><strong>64 double</strong> <mark class="hl-label default"> 1 bit</mark>  + <mark class="hl-label default"> 11 bit</mark>  + <mark class="hl-label default"> 52 bit</mark> </p><ul><li><p><strong></strong>  0  1 </p></li><li><p><strong></strong>  1  mantissa  2<strong><font color='red'> 1</font></strong> <strong></strong>  1.0011101 0011101 </p></li><li><p><strong></strong>  <strong></strong> </p><blockquote><p><strong><font color=#00FFFF></font></strong> float  8 Bits 0-255  127 bias <strong></strong> 127 <strong></strong>  127 19.625  44+127 = 131131  1000 0011 19.626  float </p><p> double bias = 1023 </p><p><strong>bias = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mi>k</mi><mo></mo><mn>1</mn></mrow></msup><mo></mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^{k-1} - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9324em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></strong></p></blockquote></li></ul><p><strong> <mark class="hl-label default">exponent</mark>  </strong></p><ul><li><p></p><p><img src="https://jyxcpp.netlify.app/img/20220713160938.png" alt=""></p></li><li><p></p><p><img src="https://jyxcpp.netlify.app/img/20220713183224.png" alt=""></p><p><strong><font color=#00FFFF> 1 0</font></strong></p></li><li><p></p><p><img src="https://jyxcpp.netlify.app/img/20220713161208.png" alt=""></p></li><li><p>NaNNot a Number</p><p><img src="https://jyxcpp.netlify.app/img/20220713161445.png" alt="NaN"></p></li></ul><div class="note info flat"><p><strong></strong></p><p><strong><font color=#00FFFF> E = e - bias  E = 1 - bias</font></strong>  <strong>E e </strong> </p><p><img src="https://jyxcpp.netlify.app/img/20220713173041.png" alt="8"></p><p> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>7</mn><mn>512</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac {7} {512}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">512</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">7</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>8</mn><mn>512</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac {8} {512}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">512</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>  E  1 </p><p><strong></strong> IEEE </p><p><strong></strong></p><ul><li><font color=#00FFFF> 0 mantissa  1 0 </font> 0  +0.0  1  0  -0.0 </li><li><font color=#00FFFF> 0 </font></li></ul></div><div class="note info flat"><p> NaN -1   -  </p></div><p><strong><font color='red'></font></strong></p><p> 5  <strong></strong>  float  double <strong></strong><br> float 23  1 24  23  23~24 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>24</mn></msup><mo>=</mo><mn>16777216</mn></mrow><annotation encoding="application/x-tex">2^{24}= 16 777 216</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">24</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">16777216</span></span></span></span> 8<strong> 8  7  7~8  double 52~53  15~16 </strong></p><blockquote><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.5</mn><mo>=</mo><mn>1</mn><mo></mo><msup><mn>2</mn><mrow><mo></mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">0.5=12^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.5</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.75</mn><mo>=</mo><mn>1</mn><mo></mo><msup><mn>2</mn><mrow><mo></mo><mn>1</mn></mrow></msup><mo>+</mo><mn>1</mn><mo></mo><msup><mn>2</mn><mrow><mo></mo><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">0.75 = 12^{-1}+12^{-2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.75</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>  0.55  0.755 </p></blockquote><p><strong><font color='red'></font></strong></p><p> 12345 </p><ol><li><p>12345 = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1.100000011100</mn><msub><mn>1</mn><mn>2</mn></msub><mo></mo><mn>1</mn><msup><mn>2</mn><mn>13</mn></msup></mrow><annotation encoding="application/x-tex">1.1000000111001_2  12^{13}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7944em;vertical-align:-0.15em;"></span><span class="mord">1.100000011100</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">13</span></span></span></span></span></span></span></span></span></span></span></span></p></li><li><p> 1  <strong></strong>  10  0  <code>10000001110010000000000</code></p><blockquote><p><font color='red'> 0   0</font></p></blockquote></li><li><p>13 + 127 = 140 <code>10001100</code></p></li><li><p> 0</p></li><li><p> <code>01000110010000001110010000000000</code></p></li></ol><p> 12345   12345 </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  00000000000000000011000000111001</span></span><br><span class="line"><span class="comment">//                     </span></span><br><span class="line"><span class="comment">//            01000110010000001110010000000000</span></span><br></pre></td></tr></table></figure><p></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/06/24/%E8%BD%AC%E4%B8%93%E4%B8%9A%E5%A4%B1%E8%B4%A5%E6%80%BB%E7%BB%93/"/>
      <url>/2022/06/24/%E8%BD%AC%E4%B8%93%E4%B8%9A%E5%A4%B1%E8%B4%A5%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p></p></blockquote><p></p><blockquote><p></p><ol><li></li><li></li><li></li><li></li><li></li></ol></blockquote><p></p><p> </p><p></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>shared_ptr</title>
      <link href="/2022/06/20/shared-ptr%E4%B8%8E%E8%99%9A%E6%9E%90%E6%9E%84/"/>
      <url>/2022/06/20/shared-ptr%E4%B8%8E%E8%99%9A%E6%9E%90%E6%9E%84/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="built_in">A</span>();</span><br><span class="line">  ~<span class="built_in">A</span>();</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">  Data* data;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AX</span> : <span class="keyword">public</span> A &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">   <span class="built_in">AX</span>();</span><br><span class="line">  ~<span class="built_in">AX</span>();</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">  AXData* ax_data;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p></p><p>A. <code>AX* p = new AX(); delete p;</code></p><p>B. <code>A* p = new AX(); delete p;</code></p><p>C. <code>shared_ptr&lt;A&gt; p = shared_ptr&lt;A&gt;(make_shared&lt;AX&gt;()); delete p; </code></p><p>D. <code>shared_ptr&lt;A&gt; p = shared_ptr&lt;A&gt;(make_shared&lt;A&gt;());  delete p; </code></p><blockquote><p> <font color='gree'>A,C,D</font></p><p></p><p>B <code>virtual</code>  p </p><p>D</p><p>C<strong><font color=#00FFFF>shared_ptr</font></strong></p><hr><p><strong><font color='orange'>shared_ptr </font></strong></p><p>STL</p><p><a href="https://zhuanlan.zhihu.com/p/56865771"> -  (zhihu.com)</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/06/20/%E9%87%8D%E8%BD%BD%E8%A6%86%E7%9B%96%E9%9A%90%E8%97%8F/"/>
      <url>/2022/06/20/%E9%87%8D%E8%BD%BD%E8%A6%86%E7%9B%96%E9%9A%90%E8%97%8F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="/2022/img/20220620174905.png" alt="image-20220620174904944"></p><blockquote><p></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>assertif</title>
      <link href="/2022/06/20/assert-%E4%B8%8Eif/"/>
      <url>/2022/06/20/assert-%E4%B8%8Eif/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="font-color-red--assert-font"><font color='red'>. assert</font></h2><p> <code>if</code> </p><ol><li></li><li> 0</li><li></li><li></li></ol><p><code>assert(exp);</code></p><p><code>assert</code>   <code>expression</code>  0 <code>stderr</code> , <code>abort</code> <strong></strong> </p><p></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">assert</span>(<span class="number">0</span> != b);</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="keyword">if</span> (<span class="number">0</span> == b)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;b is zero...&quot;</span>);</span><br><span class="line">    <span class="built_in">abort</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><font color='orange'><code>assert</code> </font></strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifdef</span> NDEBUG</span></span><br><span class="line">    <span class="meta">#<span class="keyword">define</span> assert(condition) ((void)0)</span></span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line">    <span class="meta">#<span class="keyword">define</span> assert(condition) <span class="comment">/*implementation defined*/</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><blockquote><p>assert</p><ol><li> <code>NDEBUG</code> <code>assert()</code>  <code>(void)0;</code><strong> release (Makefile)</strong> </li><li> <code>NDEBUG</code> <code>assert()</code> <strong> debug  <code>NDEBUG</code> </strong>  assert()  Debug  assert() assert() assert() assert() </li></ol></blockquote><h2 id="font-color-red--assertif-font"><font color='red'>. assertif</font></h2><p><strong><font color=#FF00FF></font></strong> </p><blockquote><p><font color='orange'>1 assert </font></p><p> <code>my_concat()</code> <strong></strong> </p><p><font color='orange'>2if </font></p><p> <code>my_concat()</code> </p></blockquote><p><code>assert</code>  debug  release  debug  bug  <strong><font color=#FF00FF></font></strong>  <strong></strong> release <code>if</code>   </p><blockquote><p><strong><font color=#00FFFF></font></strong>  bug <strong></strong></p><p><strong><font color=#00FFFF></font></strong>  <code>malloc()</code>  <code>NULL</code> </p><p><code>assert</code> <strong> crash crash bug assert </strong></p><p><code>if</code> </p></blockquote><h2 id="font-color-red---font"><font color='red'>. </font></h2><ol><li><p><strong></strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">resetBufferSize</span><span class="params">(<span class="type">int</span> nNewSize)</span> </span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line"><span class="built_in">assert</span>(nNewSize &gt;= <span class="number">0</span>);     <span class="comment">//nNewSize&lt;0</span></span><br><span class="line"><span class="built_in">assert</span>(nNewSize &lt;= MAX_BUFFER_SIZE); </span><br><span class="line"><span class="keyword">if</span>(nNewSize == <span class="number">0</span>)&#123;...&#125;     <span class="comment">//nNewSize=0</span></span><br><span class="line">    <span class="keyword">else</span>&#123;...&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>assert,,,</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">assert</span>(nOffset&gt;=<span class="number">0</span> &amp;&amp; nOffset+nSize&lt;=m_nInfomationSize);  <span class="comment">//</span></span><br><span class="line"><span class="comment">//========================================================</span></span><br><span class="line"><span class="built_in">assert</span>(nOffset &gt;= <span class="number">0</span>); </span><br><span class="line"><span class="built_in">assert</span>(nOffset+nSize &lt;= m_nInfomationSize);  <span class="comment">//</span></span><br></pre></td></tr></table></figure></li><li><p><strong>,assertDEBUG,,</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">assert</span>(i++ &lt; <span class="number">100</span>); <span class="comment">//</span></span><br><span class="line"><span class="comment">//========================</span></span><br><span class="line"><span class="built_in">assert</span>(i &lt; <span class="number">100</span>)</span><br><span class="line">i++;               <span class="comment">//</span></span><br></pre></td></tr></table></figure></li><li><p><strong>assert,</strong></p></li><li><p><strong>,assert</strong></p><p> <strong><font color=#00FFFF></font></strong>  <strong><font color=#00FFFF></font></strong> </p></li></ol><hr><p></p>]]></content>
      
      
      <categories>
          
          <category> C </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C </tag>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>strcpy()</title>
      <link href="/2022/06/19/%E9%AB%98%E8%B4%A8%E9%87%8F%E7%BC%96%E5%86%99strcpy/"/>
      <url>/2022/06/19/%E9%AB%98%E8%B4%A8%E9%87%8F%E7%BC%96%E5%86%99strcpy/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>C++strcpy()</p><p></p><ul><li></li><li></li><li></li></ul><p>strcpy()</p></blockquote><p></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">char</span>* <span class="title">strcpy</span><span class="params">(<span class="type">char</span>* des, <span class="type">const</span> <span class="type">char</span>* src)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(des == src)</span><br><span class="line">        <span class="keyword">return</span> src;</span><br><span class="line">    <span class="built_in">assert</span>(des != <span class="literal">NULL</span>);</span><br><span class="line">    <span class="built_in">assert</span>(src != <span class="literal">NULL</span>);</span><br><span class="line">    <span class="type">char</span>* temp = des;</span><br><span class="line">    <span class="keyword">while</span>((*des++ = *src++) != <span class="string">&#x27;\0&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> temp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><ul><li><strong><font color='orange'></font></strong> <code>src</code><code>des</code><code>src</code><code>src</code> <code>const char*</code></li><li><strong><font color='orange'></font></strong> <code>des</code><code>src</code><code>string</code></li><li><strong><font color='orange'></font></strong>  <code>assert</code>  <code>if</code>  <a href="https://jyxcpp.github.io/2022/06/20/assert-yu-if/">ifassert</a><code>assert</code>  <code>assert((dest!=NULL) &amp;&amp; (src !=NULL))</code>?NULL</li><li><strong><font color='orange'>des</font></strong> des</li><li><strong><font color='orange'><code>char*</code> </font></strong> <code>int len = strlen(strcpy(des,src))</code></li></ul></blockquote><p>srcdes</p><blockquote><ol><li>strcpy()memcpy()nnn<code>'\n'</code> </li><li>bug != </li></ol></blockquote><hr><p></p>]]></content>
      
      
      <categories>
          
          <category> C </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++</title>
      <link href="/2022/06/19/%E9%AB%98%E8%B4%A8%E9%87%8FCpp%E7%BC%96%E7%A8%8B/"/>
      <url>/2022/06/19/%E9%AB%98%E8%B4%A8%E9%87%8FCpp%E7%BC%96%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="/2022/img/20220619190951.png" alt="C"></p><blockquote><p>pdfpdf<a href="https://pan.baidu.com/s/1VPet6-2dVqXjLW2gN2fXMQ?pwd=gzwb">C++pdf</a>gzwb</p></blockquote><p></p><blockquote><p> C++/C  ?<br>( CAD  3D )  1995  2000 ?<br><br> 10  C++ 3D  3D   <br>   strcpy <br>?<br>! :<br>(1);<br>(2);</p><p>(3)()<br>  <br>  IT  <br>? !<br><br> IT  () ??!</p></blockquote><p></p><p>C++</p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
            <tag>  </tag>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>explicit</title>
      <link href="/2022/06/19/explicit%E5%85%B3%E9%94%AE%E5%AD%97/"/>
      <url>/2022/06/19/explicit%E5%85%B3%E9%94%AE%E5%AD%97/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="font-color-red-explicit-font"><strong><font color='red'>explicit</font></strong></h3><p>C++explicit, <strong>, </strong> implicit,implicit</p><blockquote><p><strong><font color=#FF00FF>explicit</font></strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"> <span class="built_in">A</span>(<span class="type">int</span> x)&#123;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;&quot;</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func</span><span class="params">(A a)</span></span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">( )</span></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">func</span>(<span class="number">1</span>);<span class="comment">// func(A(1)) 1A(1)</span></span><br><span class="line">        <span class="comment">//&quot;&quot;</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>func(1)</p><p><strong><font color=#FF00FF></font></strong></p><ul><li><code>explict</code></li><li></li></ul></blockquote>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/06/19/%E7%B1%BB%E5%86%85%E5%AD%98%E5%B8%83%E5%B1%80%E4%B8%8E%E8%99%9A%E5%87%BD%E6%95%B0%E8%A1%A8/"/>
      <url>/2022/06/19/%E7%B1%BB%E5%86%85%E5%AD%98%E5%B8%83%E5%B1%80%E4%B8%8E%E8%99%9A%E5%87%BD%E6%95%B0%E8%A1%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="font-color-red---font"><strong><font color='red'> + </font></strong></h3><p>sizeofC</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">C</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">char</span> a;</span><br><span class="line">    <span class="type">static</span> <span class="type">char</span> b;</span><br><span class="line">    <span class="type">void</span> *p;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> *c;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">func1</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">func2</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><p><strong><font color=#FF00FF></font></strong></p><ul><li><p><strong><font color='orange'>static,</font></strong></p></li><li><p><strong><font color='orange'>sizeofsizeof</font></strong></p><blockquote><p>newmallocsizeof</p></blockquote></li><li><p><strong><font color='orange'>,</font></strong></p></li><li><p><strong><font color='orange'><font color='red'></font></font></strong></p></li><li><p><strong><font color='orange'></font></strong></p></li></ul></blockquote>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/06/19/%E7%BB%93%E6%9E%84%E4%BD%93%E5%AF%B9%E9%BD%90/"/>
      <url>/2022/06/19/%E7%BB%93%E6%9E%84%E4%BD%93%E5%AF%B9%E9%BD%90/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="font-color-red--font"><strong><font color='red'></font></strong></h3><p> 64 </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">st_t</span> &#123;</span><br><span class="line">    <span class="type">int</span> status;</span><br><span class="line">    <span class="type">short</span> *pdata;</span><br><span class="line">    <span class="type">char</span> errstr[<span class="number">32</span>]; </span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">st_t</span> st[<span class="number">16</span>];</span><br><span class="line"><span class="type">char</span> *p = (<span class="type">char</span> *)(st[<span class="number">2</span>].errstr + <span class="number">32</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, (p - (<span class="type">char</span> *)(st)));</span><br></pre></td></tr></table></figure><p>A.  32B. 120 C. 114<font color='gree'>D. 144 </font></p><blockquote><p><strong><font color=#FF00FF></font></strong></p><ul><li></li><li></li></ul><p><strong><font color=#FF00FF></font></strong></p><p><strong>1.0</strong></p><p><strong>2.</strong>(<font color='orange'> = VS8  </font>) <strong><font color='gree'></font></strong> </p><p><strong>3.()</strong><strong><font color='gree'></font></strong></p><p><strong>4. </strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">S3</span> &#123;</span><br><span class="line"><span class="type">double</span> d;  <span class="comment">//</span></span><br><span class="line"><span class="type">char</span> c;    <span class="comment">//</span></span><br><span class="line"><span class="type">int</span> i;     <span class="comment">//</span></span><br><span class="line">&#125;;</span><br><span class="line">               <span class="comment">//s3  8</span></span><br><span class="line">                                           </span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">S4</span> &#123;                 <span class="number">0</span>          <span class="number">8</span>     <span class="number">12</span></span><br><span class="line"><span class="type">int</span> f;     <span class="comment">//</span></span><br><span class="line"><span class="type">char</span> c;    <span class="comment">//</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">S3</span> s3;  </span><br><span class="line">&#125;;             <span class="comment">//s4</span></span><br><span class="line">                                         </span><br><span class="line">                            <span class="number">0</span>     <span class="number">4</span>    <span class="number">8</span></span><br></pre></td></tr></table></figure><p><strong><font color=#FF00FF></font></strong></p><ul><li><strong>()</strong> </li><li><strong></strong> () </li></ul><p><strong><font color=#FF00FF></font></strong></p><p>    <strong>doubleintintchar</strong> </p><p><strong><font color=#FF00FF></font></strong></p><p>    <code>#pragma pack(x)//x</code><br> <code>#pragma pack(1)</code></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> C </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C </tag>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/06/19/%E6%A8%A1%E6%9D%BF-%E7%BB%A7%E6%89%BF/"/>
      <url>/2022/06/19/%E6%A8%A1%E6%9D%BF-%E7%BB%A7%E6%89%BF/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="font-color-red--font"><strong><font color='red'></font></strong></h3><p></p><p><font color='gree'>A. </font></p><p><font color='gree'>B. </font></p><p>C. </p><p>D. </p><blockquote><p>C:  <code></code> </p><p>D:  <code></code> </p><hr><p><strong><font color=#FF00FF></font></strong></p><ul><li></li><li></li><li></li><li></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//==============================================1</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T1, <span class="keyword">typename</span> T2&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span></span><br><span class="line">&#123;</span><br><span class="line">    T1 x;</span><br><span class="line">    T2 y;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T1, <span class="keyword">typename</span> T2&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span> : <span class="keyword">public</span> A&lt;T2, T1&gt;</span><br><span class="line">&#123;</span><br><span class="line">    T1 x1;</span><br><span class="line">    T2 y2;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T1T2, T3&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span> : <span class="keyword">public</span> B&lt;T1, T3&gt;</span><br><span class="line">&#123;</span><br><span class="line">    T2 x3;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//==============================================2</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">D</span> : <span class="keyword">public</span> A&lt;<span class="type">int</span>, <span class="type">double</span>&gt; <span class="comment">//</span></span><br><span class="line">&#123;</span><br><span class="line">    T x4;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//==============================================3</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">E</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> x4;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">F</span> : <span class="keyword">public</span> E</span><br><span class="line">&#123;</span><br><span class="line">    T X5;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//==============================================4</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">H</span> : <span class="keyword">public</span> F&lt;<span class="type">int</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> h;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></blockquote>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>+</title>
      <link href="/2022/06/19/%E8%99%9A%E5%87%BD%E6%95%B0-inline/"/>
      <url>/2022/06/19/%E8%99%9A%E5%87%BD%E6%95%B0-inline/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="font-color-red--inline-font"><font color='red'> inline</font></h3><p>,( )</p><p>A. </p><p><font color='gree'>B. </font></p><p><font color='gree'>C. inline</font></p><p>D. </p><blockquote><p><strong><font color='orange'></font></strong> </p><ul><li><strong><font color='orange'></font></strong> </li><li><strong><font color='orange'></font></strong> </li></ul><hr><p><strong><font color='orange'></font></strong></p><p><strong><font color=#00FFFF></font></strong></p><p></p><hr><p><strong><font color='orange'></font></strong></p><p><strong><font color=#00FFFF></font></strong><br> <code>inline virtual</code><strong></strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Base</span>&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">   <span class="function"><span class="keyword">inline</span> <span class="keyword">virtual</span> <span class="type">void</span> <span class="title">who</span><span class="params">()</span></span>&#123;</span><br><span class="line">   cout &lt;&lt; <span class="string">&quot;I am Base\n&quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">virtual</span> ~<span class="built_in">Base</span>() &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Derived</span> : <span class="keyword">public</span> Base&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">   <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">who</span><span class="params">()</span>  </span>&#123;  <span class="comment">// inline</span></span><br><span class="line">   cout &lt;&lt; <span class="string">&quot;I am Derived\n&quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="comment">//  who()Baseb</span></span><br><span class="line">   <span class="comment">//  </span></span><br><span class="line">   Base b;</span><br><span class="line">   b.<span class="built_in">who</span>();</span><br><span class="line"></span><br><span class="line">   <span class="comment">// </span></span><br><span class="line">   <span class="comment">//   </span></span><br><span class="line">   Base *ptr = <span class="keyword">new</span> <span class="built_in">Derived</span>();</span><br><span class="line">   ptr-&gt;<span class="built_in">who</span>();</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><hr><p><strong><font color=#00FFFF></font></strong></p><p><em><strong></strong></em>this<em><strong>this</strong></em>this<font color=#FF00FF></font>this</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>+</title>
      <link href="/2022/06/19/%E8%BD%AC%E5%9E%8B%E5%92%8C%E7%BB%A7%E6%89%BF%E9%93%BE/"/>
      <url>/2022/06/19/%E8%BD%AC%E5%9E%8B%E5%92%8C%E7%BB%A7%E6%89%BF%E9%93%BE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="font-color-red-2---font"><em><strong><font color='red'>2.  + </font></strong></em></h3><p></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="title">show</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span> : <span class="keyword">public</span> A</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="title">show</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span> : <span class="keyword">public</span> B</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="title">show</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"> A* p1 = <span class="keyword">new</span> C;</span><br><span class="line"> B* p2 = <span class="built_in">dynamic_cast</span>&lt;B*&gt;(p1);  <span class="comment">//L1</span></span><br><span class="line"> A* p3 = <span class="keyword">new</span> A;</span><br><span class="line"> B* p2 = <span class="built_in">dynamic_cast</span>&lt;B*&gt;(p3);  <span class="comment">//L2</span></span><br><span class="line"> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>A. L 1L 2   <font color='gree'> B. L1L2 </font>    C. L 1L 2       D. L 1L 2</p><blockquote><p><strong><font color='orange'></font></strong></p><ol><li><strong><font color='cornflowerblue'>static_cast</font></strong></li><li><strong><font color='cornflowerblue'>const_cast</font></strong> const  constvolatile  volatile </li><li><strong><font color='cornflowerblue'>reinterpret_cast</font></strong> C++ </li><li><strong><font color='cornflowerblue'>dynamic_cast</font></strong><em><strong> RTTIDowncasting</strong></em></li></ol><hr><p><strong><font color='orange'></font></strong></p><p> <code>dynamic_cast</code> <em><strong></strong></em><font color='red'></font>(type_info)</p><img src="/2022/img/20220619132309.png" alt="image-20220619132309381" style="zoom:50%;" /><p>L1L2</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>&amp;</title>
      <link href="/2022/06/19/%E7%BB%A7%E6%89%BF%E8%B0%83%E7%94%A8%E9%A1%BA%E5%BA%8F%E4%B8%8E%E8%99%9A%E5%87%BD%E6%95%B0/"/>
      <url>/2022/06/19/%E7%BB%A7%E6%89%BF%E8%B0%83%E7%94%A8%E9%A1%BA%E5%BA%8F%E4%B8%8E%E8%99%9A%E5%87%BD%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>____</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>&#123;</span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">A</span> ():<span class="built_in">m_iVal</span>(<span class="number">0</span>)&#123;<span class="built_in">test</span>();&#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">func</span><span class="params">()</span> </span>&#123; std::cout&lt;&lt;m_iVal&lt;&lt;<span class="string">&#x27; &#x27;</span>;&#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;<span class="built_in">func</span>();&#125;</span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">      <span class="type">int</span> m_iVal;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span> : <span class="keyword">public</span> A&#123;</span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">B</span>()&#123;<span class="built_in">test</span>();&#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">func</span><span class="params">()</span></span>&#123;</span><br><span class="line">      ++m_iVal;</span><br><span class="line">      std::cout &lt;&lt; m_iVal &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc ,<span class="type">char</span>* argv[])</span></span>&#123;</span><br><span class="line">  A*p = <span class="keyword">new</span> B;</span><br><span class="line">  p-&gt;<span class="built_in">test</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>A. 1 0   <font color='red'> B. 0 1 </font> <font color='gree'>   C. 0 1 2  </font>  D. </p><blockquote><p></p><ol><li><p><font color='red'>C++</font></p><p><strong>(1)</strong></p><p><strong>(2)</strong></p><p><strong>(3)</strong></p><p><strong>(4)</strong></p><blockquote><p><strong><font color=#FF00FF></font></strong> </p></blockquote></li><li><p><font color='red'></font></p><p><strong></strong></p><blockquote><p></p><p>int aaaaa</p></blockquote></li></ol></blockquote>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/06/19/%E5%8F%AF%E5%8F%98%E9%95%BF%E5%8F%82%E6%95%B0%E5%88%97%E8%A1%A8/"/>
      <url>/2022/06/19/%E5%8F%AF%E5%8F%98%E9%95%BF%E5%8F%82%E6%95%B0%E5%88%97%E8%A1%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="font-color-red--font"><font color='red'> </font></h3><p></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> arr[]=&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>&#125;;</span><br><span class="line">    <span class="type">int</span> *p=arr;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d,%d\n&quot;</span>,*p,*(++p));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><font color='gree'>A. 3,3</font>B. 2,2C. 2,3D. 3,2</p><blockquote><p><strong><font color=#FF00FF></font></strong></p><p>c/c++<code>__cdecl</code></p><table><thead><tr><th style="text-align:left"></th><th style="text-align:left"></th><th style="text-align:left"></th></tr></thead><tbody><tr><td style="text-align:left">__cdecl</td><td style="text-align:left">Caller</td><td style="text-align:left"></td></tr><tr><td style="text-align:left">__clrcall</td><td style="text-align:left">n/a</td><td style="text-align:left"> CLR </td></tr><tr><td style="text-align:left">__stdcall</td><td style="text-align:left">Callee</td><td style="text-align:left"></td></tr><tr><td style="text-align:left">__fastcall</td><td style="text-align:left">Callee</td><td style="text-align:left"></td></tr><tr><td style="text-align:left">__thiscall</td><td style="text-align:left">Callee</td><td style="text-align:left"> ECX </td></tr><tr><td style="text-align:left">__vectorcall</td><td style="text-align:left">Callee</td><td style="text-align:left"></td></tr></tbody></table><p> <strong><font color='gree'></font></strong> <code>fmt...</code>printf(%s %s,str1 ,str2)<code>%s</code><code>fmt...</code><code>fmt...</code><code>fmt...</code></p><p><code>*(++p)</code><code>*p</code>A</p><p><strong><font color=#FF00FF></font></strong></p><ul><li><p><strong></strong>C()C++</p></li><li><p><strong></strong> <code>char</code><code>short</code><code>int</code><code>float</code><code>double</code><code>%f</code><code>float</code><code>double</code></p></li></ul></blockquote>]]></content>
      
      
      <categories>
          
          <category> C </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>memcpymemmove</title>
      <link href="/2022/06/19/memcpy%E4%B8%8Ememmove%E7%9A%84%E5%8C%BA%E5%88%AB/"/>
      <url>/2022/06/19/memcpy%E4%B8%8Ememmove%E7%9A%84%E5%8C%BA%E5%88%AB/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="font-color-red-memcpymemmove-font"><font color='red'> memcpymemmove</font></h3><p>s2ns1<font color=#FF00FF>memcpy  memmove </font>memcpy <strong></strong> </p><ul><li><p>srcdest<br><img src="/2022/img/20220619095616.webp" alt=""></p></li><li><p>srcdest</p><img src="/2022/img/20220619095613.webp" alt="" style="zoom:80%;" /><blockquote><p>srcdest345srcsrc</p><p>vs2019memcpymemmove memcpy  memmove </p></blockquote></li></ul><p><strong>memmove</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> *<span class="title">memmove</span><span class="params">(<span class="type">void</span> *dest, <span class="type">const</span> <span class="type">void</span> *src, <span class="type">size_t</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *pd = dest;</span><br><span class="line">    <span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> *ps = src;</span><br><span class="line">    <span class="keyword">if</span>((ps + n &gt; pd)&amp;&amp; ps &lt; pd)</span><br><span class="line">        <span class="keyword">for</span> (pd += n, ps += n; n--;)</span><br><span class="line">            *--pd = *--ps;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">while</span>(n--)</span><br><span class="line">            *pd++ = *ps++;</span><br><span class="line">    <span class="keyword">return</span> dest;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>memmove<strong><font color=#FF00FF></font></strong> <strong><font color='pink'> C99 </font></strong> </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> *<span class="title">memmove</span><span class="params">(<span class="type">void</span> *dest, <span class="type">const</span> <span class="type">void</span> *src, <span class="type">size_t</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"> <span class="type">unsigned</span> <span class="type">char</span> tmp[n];</span><br><span class="line"> <span class="built_in">memcpy</span>(tmp,src,n);</span><br><span class="line"> <span class="built_in">memcpy</span>(dest,tmp,n);</span><br><span class="line"> <span class="keyword">return</span> dest;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><p><strong>memcpy</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> *<span class="title">memcpy</span><span class="params">(<span class="type">void</span> *dest, <span class="type">const</span> <span class="type">void</span> *src, <span class="type">size_t</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">char</span> *dp = dest;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *sp = src;</span><br><span class="line">    <span class="keyword">while</span> (n--)</span><br><span class="line">        *dp++ = *sp++;</span><br><span class="line">    <span class="keyword">return</span> dest;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//memcpy</span></span><br><span class="line"><span class="function"><span class="type">void</span> *<span class="title">memcpy</span><span class="params">(<span class="type">void</span> *dst, <span class="type">const</span> <span class="type">void</span> *src, <span class="type">size_t</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="literal">NULL</span> == dst || <span class="literal">NULL</span> == src)&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> *ret = dst;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(dst &lt;= src || (<span class="type">char</span> *)dst &gt;= (<span class="type">char</span> *)src + len)&#123;</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="keyword">while</span>(len--)&#123;</span><br><span class="line">*(<span class="type">char</span> *)dst = *(<span class="type">char</span> *)src;</span><br><span class="line">dst = (<span class="type">char</span> *)dst + <span class="number">1</span>;</span><br><span class="line">src = (<span class="type">char</span> *)src + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="comment">//</span></span><br><span class="line">src = (<span class="type">char</span> *)src + len - <span class="number">1</span>;</span><br><span class="line">dst = (<span class="type">char</span> *)dst + len - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(len--)&#123;</span><br><span class="line">*(<span class="type">char</span> *)dst = *(<span class="type">char</span> *)src;</span><br><span class="line">dst = (<span class="type">char</span> *)dst - <span class="number">1</span>;</span><br><span class="line">src = (<span class="type">char</span> *)src - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> C </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/06/19/%E4%BA%8C%E5%8F%89%E6%8E%92%E5%BA%8F%E6%A0%91%E7%9A%84%E6%93%8D%E4%BD%9C/"/>
      <url>/2022/06/19/%E4%BA%8C%E5%8F%89%E6%8E%92%E5%BA%8F%E6%A0%91%E7%9A%84%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><a href="https://www.bilibili.com/video/BV1EK4y1e7UY/?spm_id_from=333.788"></a></p><p></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;array&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DataType int</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">BST_node</span></span><br><span class="line">&#123;</span><br><span class="line">DataType data;</span><br><span class="line">BST_node *left;</span><br><span class="line">BST_node *right;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BST</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">BST_node* root;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">BST</span>(DataType arr[], <span class="type">size_t</span> arr_size);</span><br><span class="line">~<span class="built_in">BST</span>() &#123; <span class="built_in">release</span>(root); &#125;;   <span class="comment">//release</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">in_traverse</span><span class="params">()</span> </span>&#123; <span class="built_in">traverse</span>(root); &#125;<span class="comment">//root</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(DataType key)</span> </span>&#123; <span class="built_in">bi_insert</span>(root, key); &#125;<span class="comment">//</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">del</span><span class="params">(DataType key)</span> </span>&#123; root = <span class="built_in">bi_delete</span>(root, key); &#125;<span class="comment">//</span></span><br><span class="line"><span class="function">BST_node* <span class="title">search</span><span class="params">(DataType key)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">bi_search</span>(root, key); &#125;<span class="comment">//</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">traverse</span><span class="params">(BST_node*)</span></span>;<span class="comment">//</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">release</span><span class="params">(BST_node* node)</span></span>;<span class="comment">//</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">bi_insert</span><span class="params">(BST_node*&amp; nood, DataType key)</span></span>;<span class="comment">//</span></span><br><span class="line"><span class="function">BST_node* <span class="title">bi_delete</span><span class="params">(BST_node* node, DataType key)</span></span>;</span><br><span class="line"><span class="function">BST_node* <span class="title">bi_search</span><span class="params">(BST_node* node, DataType key)</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">BST::bi_insert</span><span class="params">(BST_node* &amp;Root, DataType data)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (Root == <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line">BST_node* new_node = <span class="keyword">new</span> BST_node;</span><br><span class="line">new_node-&gt;data = data;</span><br><span class="line">new_node-&gt;left = <span class="literal">NULL</span>;</span><br><span class="line">new_node-&gt;right = <span class="literal">NULL</span>;</span><br><span class="line">Root = new_node;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (Root-&gt;data &gt; data)</span><br><span class="line"><span class="built_in">bi_insert</span>(Root-&gt;left, data);</span><br><span class="line"><span class="keyword">if</span>(Root-&gt;data&lt;data)</span><br><span class="line"><span class="built_in">bi_insert</span>(Root-&gt;right, data);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">BST::release</span><span class="params">(BST_node* node)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (node == <span class="literal">NULL</span>)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="built_in">release</span>(node-&gt;left);</span><br><span class="line"><span class="built_in">release</span>(node-&gt;right);</span><br><span class="line"><span class="keyword">delete</span> node;       <span class="comment">//</span></span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">BST::<span class="built_in">BST</span>(DataType arr[], <span class="type">size_t</span> arr_size)</span><br><span class="line">&#123;</span><br><span class="line">root = <span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; arr_size; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">bi_insert</span>(root, arr[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">BST::traverse</span><span class="params">(BST_node* node)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (node == <span class="literal">NULL</span>)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="built_in">traverse</span>(node-&gt;left);</span><br><span class="line">cout &lt;&lt; node-&gt;data &lt;&lt; <span class="string">&quot; &quot;</span>;<span class="comment">//</span></span><br><span class="line"><span class="built_in">traverse</span>(node-&gt;right);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function">BST_node* <span class="title">BST::bi_search</span><span class="params">(BST_node* node, DataType key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (node == <span class="literal">NULL</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">if</span> (node-&gt;data &gt; key)</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">bi_search</span>(node-&gt;left, key);<span class="comment">//return</span></span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (node-&gt;data &lt; key)</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">bi_search</span>(node-&gt;right, key);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">return</span> node;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function">BST_node* <span class="title">BST::bi_delete</span><span class="params">(BST_node* root, DataType key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">BST_node* target = <span class="built_in">bi_search</span>(root, key);</span><br><span class="line">BST_node* copy_root = root;</span><br><span class="line">BST_node* temp = <span class="literal">NULL</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> (root-&gt;data == key)<span class="comment">//</span></span><br><span class="line">&#123;</span><br><span class="line">temp = root-&gt;left;</span><br><span class="line">root = root-&gt;right;</span><br><span class="line"><span class="keyword">while</span> (root-&gt;left != <span class="literal">NULL</span>)</span><br><span class="line">root = root-&gt;left;</span><br><span class="line">root-&gt;left = temp;</span><br><span class="line"><span class="keyword">return</span> copy_root-&gt;right;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>                </span><br><span class="line">&#123;</span><br><span class="line">BST_node* temp1 = <span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">while</span> ((root-&gt;left==<span class="literal">NULL</span> || root-&gt;left-&gt;data != key) &amp;&amp;(root-&gt;right==<span class="literal">NULL</span> || root-&gt;right-&gt;data != key)) <span class="comment">//4</span></span><br><span class="line">key &lt; root-&gt;data ? root = root-&gt;left : root = root-&gt;right;</span><br><span class="line">key &lt; root-&gt;data ? temp = root-&gt;left : temp = root-&gt;right;</span><br><span class="line">temp1 = temp-&gt;right;</span><br><span class="line"><span class="keyword">if</span> (temp1 == <span class="literal">NULL</span>)  <span class="comment">//if-else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (temp-&gt;data &gt; root-&gt;data)</span><br><span class="line">root-&gt;right = temp-&gt;left;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">root-&gt;left = temp-&gt;left;</span><br><span class="line"><span class="keyword">return</span> copy_root;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>                <span class="comment">//</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span> (temp1-&gt;left != <span class="literal">NULL</span>)</span><br><span class="line">temp1 = temp1-&gt;left;</span><br><span class="line">temp1-&gt;left = temp-&gt;left;</span><br><span class="line"><span class="keyword">if</span> (temp-&gt;data &lt; root-&gt;data)</span><br><span class="line">&#123;</span><br><span class="line">root-&gt;left = temp-&gt;right;</span><br><span class="line"><span class="keyword">delete</span> temp;</span><br><span class="line"><span class="keyword">return</span> copy_root;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">root-&gt;right = temp-&gt;right;</span><br><span class="line"><span class="keyword">delete</span> temp;</span><br><span class="line"><span class="keyword">return</span> copy_root;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">array&lt;<span class="type">int</span>, 10&gt;arr&#123; <span class="number">12</span>,<span class="number">32</span>,<span class="number">43</span>,<span class="number">23</span>,<span class="number">45</span>,<span class="number">15</span>,<span class="number">76</span>,<span class="number">48</span>,<span class="number">98</span>,<span class="number">56</span> &#125;;<span class="comment">//STLSTL</span></span><br><span class="line"><span class="function">BST <span class="title">bi_ser_tre</span><span class="params">(arr.data(), arr.size())</span></span>;</span><br><span class="line">bi_ser_tre.<span class="built_in">in_traverse</span>();</span><br><span class="line">cout &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;9:&quot;</span> &lt;&lt; endl;</span><br><span class="line">bi_ser_tre.<span class="built_in">insert</span>(<span class="number">9</span>);</span><br><span class="line">bi_ser_tre.<span class="built_in">in_traverse</span>();</span><br><span class="line">cout &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;76:&quot;</span> &lt;&lt; endl;</span><br><span class="line">bi_ser_tre.<span class="built_in">del</span>(<span class="number">76</span>);</span><br><span class="line">bi_ser_tre.<span class="built_in">in_traverse</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>easyx</title>
      <link href="/2022/06/19/easyx%E5%9D%A6%E5%85%8B%E5%A4%A7%E6%88%98/"/>
      <url>/2022/06/19/easyx%E5%9D%A6%E5%85%8B%E5%A4%A7%E6%88%98/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p></p><img src="/2022/img/image-20220731195930223.png" alt="image-20220731195930223" style="zoom:50%;" /><p></p><ul><li></li><li></li><li>bgm</li></ul><blockquote><p> <strong>01</strong> </p><p><a href="https://pan.baidu.com/s/17PI4mMjW-RfygXp1yS5IjQ?pwd=gzwb">https://pan.baidu.com/s/17PI4mMjW-RfygXp1yS5IjQ?pwd=gzwb</a><br>gzwb</p></blockquote>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/06/19/%E5%93%88%E5%A4%AB%E6%9B%BC%E6%A0%91/"/>
      <url>/2022/06/19/%E5%93%88%E5%A4%AB%E6%9B%BC%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><a href="https://zhidao.baidu.com/question/747308677055660332.html"></a></p><p><a href="http://c.biancheng.net/view/3398.html"></a></p><p></p><blockquote><p></p></blockquote><img src="/2022/img/20220619003149.png" alt="img" style="zoom:67%;" /><ol start="3"><li>bnew_rootnew_rootnew_root(d)new_rootnew_root</li></ol><img src="/2022/img/20220619003141.png" alt="img" style="zoom:67%;" /><ol start="4"><li>01</li></ol><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">huf_tree</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">char</span> data;<span class="comment">//</span></span><br><span class="line"><span class="type">int</span> weight;<span class="comment">//</span></span><br><span class="line">huf_tree* left;<span class="comment">//</span></span><br><span class="line">huf_tree* right;<span class="comment">//</span></span><br><span class="line">huf_tree* rlink;<span class="comment">//</span></span><br><span class="line">string code;<span class="comment">//stringstring</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">words</span><span class="comment">//</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">char</span> letters;</span><br><span class="line"><span class="type">int</span> counts;<span class="comment">//or</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="function">huf_tree* <span class="title">cre_huf_tree</span><span class="params">(huf_tree*, <span class="type">int</span>)</span></span>;<span class="comment">//</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ini_lett_arr</span><span class="params">(words**)</span></span>;<span class="comment">//</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">essay_data</span><span class="params">(words**)</span></span>;<span class="comment">//,</span></span><br><span class="line"><span class="function">huf_tree* <span class="title">cre_link_list</span><span class="params">(words**)</span></span>;<span class="comment">//</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">huf_coding</span><span class="params">(huf_tree* root,string)</span></span>;<span class="comment">//</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dis_code</span><span class="params">(huf_tree* root)</span></span>;<span class="comment">//</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> n = <span class="number">36</span>;<span class="comment">//26+10</span></span><br><span class="line">words* letter_arr[<span class="number">36</span>]; <span class="comment">//</span></span><br><span class="line"><span class="built_in">ini_lett_arr</span>(letter_arr);<span class="comment">//</span></span><br><span class="line"><span class="built_in">essay_data</span>(letter_arr);</span><br><span class="line">huf_tree* head = <span class="built_in">cre_link_list</span>(letter_arr);</span><br><span class="line">huf_tree* root = <span class="built_in">cre_huf_tree</span>(head, n);</span><br><span class="line">root-&gt;code = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="built_in">huf_coding</span>(root,<span class="string">&quot;&quot;</span>);</span><br><span class="line"><span class="built_in">dis_code</span>(root);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ini_lett_arr</span><span class="params">(words** arr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">97</span>; i &lt;=<span class="number">122</span>; i++)<span class="comment">//arr0-25a-zwords</span></span><br><span class="line">&#123;</span><br><span class="line">arr[i<span class="number">-97</span>] = <span class="keyword">new</span> words;<span class="comment">//</span></span><br><span class="line">arr[i - <span class="number">97</span>]-&gt;letters = i;</span><br><span class="line">arr[i - <span class="number">97</span>]-&gt;counts = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">48</span>; i &lt;=<span class="number">57</span> ; i++)<span class="comment">//ASCII48-570-9,arr[26]-arr[35]</span></span><br><span class="line">&#123;</span><br><span class="line">arr[i - <span class="number">22</span>] = <span class="keyword">new</span> words;</span><br><span class="line">arr[i - <span class="number">22</span>]-&gt;letters = i;</span><br><span class="line">arr[i - <span class="number">22</span>]-&gt;counts = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">huf_tree* <span class="title">cre_huf_tree</span><span class="params">(huf_tree* head, <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">huf_tree* new_root = <span class="keyword">new</span> huf_tree; <span class="comment">//</span></span><br><span class="line"><span class="keyword">if</span> (n == <span class="number">2</span>)<span class="comment">//link_list</span></span><br><span class="line">&#123;</span><br><span class="line">new_root-&gt;right = head-&gt;rlink;</span><br><span class="line">new_root-&gt;left = head;</span><br><span class="line">new_root-&gt;data = <span class="string">&#x27;#&#x27;</span>;</span><br><span class="line">new_root-&gt;weight = new_root-&gt;right-&gt;weight + new_root-&gt;left-&gt;weight;</span><br><span class="line"><span class="keyword">return</span> new_root;</span><br><span class="line">&#125;</span><br><span class="line">huf_tree* new_head = head-&gt;rlink-&gt;rlink;</span><br><span class="line">huf_tree* temp = new_head;</span><br><span class="line">new_root-&gt;right = head-&gt;rlink;</span><br><span class="line">new_root-&gt;left = head;</span><br><span class="line">new_root-&gt;data = <span class="string">&#x27;#&#x27;</span>;</span><br><span class="line">new_root-&gt;weight = new_root-&gt;right-&gt;weight + new_root-&gt;left-&gt;weight;</span><br><span class="line">head-&gt;rlink-&gt;rlink = <span class="literal">NULL</span>;</span><br><span class="line">head-&gt;rlink = <span class="literal">NULL</span>;</span><br><span class="line"><span class="type">int</span> step = <span class="number">-1</span>;<span class="comment">//step-10rlink,ABCDCDtempBD</span></span><br><span class="line"><span class="keyword">if</span> (new_root-&gt;weight &lt; new_head-&gt;weight)</span><br><span class="line">&#123;</span><br><span class="line">new_root-&gt;rlink = new_head;</span><br><span class="line">new_head = new_root;   <span class="comment">//</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (new_root-&gt;weight == new_head-&gt;weight)</span><br><span class="line">&#123;</span><br><span class="line">new_root-&gt;rlink = new_head-&gt;rlink;</span><br><span class="line">new_head-&gt;rlink = new_root;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>  <span class="comment">//</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span> ((temp != <span class="literal">NULL</span>) &amp;&amp; (new_root-&gt;weight &gt; temp-&gt;weight))<span class="comment">//temp!=NULL</span></span><br><span class="line">&#123;</span><br><span class="line">step++;</span><br><span class="line">temp = temp-&gt;rlink;</span><br><span class="line">&#125;</span><br><span class="line">temp = new_head;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; step; i++)</span><br><span class="line">&#123;</span><br><span class="line">temp = temp-&gt;rlink;      <span class="comment">//temp</span></span><br><span class="line">&#125;</span><br><span class="line">new_root-&gt;rlink = temp-&gt;rlink;</span><br><span class="line">temp-&gt;rlink = new_root;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">cre_huf_tree</span>(new_head, n - <span class="number">1</span>);<span class="comment">//</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">essay_data</span><span class="params">(words** arr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;(&#x27;#&#x27;):&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="type">char</span> letter = <span class="built_in">getchar</span>();                      <span class="comment">//while</span></span><br><span class="line"><span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> ( letter &gt;= <span class="number">97</span> &amp;&amp; letter &lt;= <span class="number">122</span>)<span class="comment">//</span></span><br><span class="line">&#123;</span><br><span class="line">arr[letter - <span class="number">97</span>]-&gt;counts++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (letter &gt;= <span class="number">48</span> &amp;&amp; letter &lt;= <span class="number">57</span>)<span class="comment">//</span></span><br><span class="line">&#123;</span><br><span class="line">arr[letter - <span class="number">22</span>]-&gt;counts++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (letter &gt;= <span class="number">65</span> &amp;&amp; letter &lt;= <span class="number">90</span>)</span><br><span class="line">&#123;</span><br><span class="line">arr[letter + <span class="number">32</span> - <span class="number">97</span>]-&gt;counts++;<span class="comment">//</span></span><br><span class="line">&#125;</span><br><span class="line">letter = <span class="built_in">getchar</span>();</span><br><span class="line"><span class="keyword">if</span> (letter == <span class="string">&#x27;#&#x27;</span>)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">huf_tree* <span class="title">cre_link_list</span><span class="params">(words** arr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">35</span>; i++)          <span class="comment">//3635</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">35</span> - i; k++)  </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (arr[k]-&gt;counts &gt; arr[k + <span class="number">1</span>]-&gt;counts)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">swap</span>(arr[k], arr[k + <span class="number">1</span>]);<span class="comment">//swap()</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">huf_tree* head = <span class="keyword">new</span> huf_tree;<span class="comment">//</span></span><br><span class="line">head-&gt;weight = arr[<span class="number">0</span>]-&gt;counts;</span><br><span class="line">head-&gt;data = arr[<span class="number">0</span>]-&gt;letters;</span><br><span class="line">head-&gt;right = head-&gt;left = <span class="literal">NULL</span>;</span><br><span class="line">huf_tree* temp_head = head;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; <span class="number">36</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">huf_tree* huf_node = <span class="keyword">new</span> huf_tree;</span><br><span class="line">huf_node-&gt;weight = arr[i]-&gt;counts;</span><br><span class="line">huf_node-&gt;data = arr[i]-&gt;letters;</span><br><span class="line">huf_node-&gt;left = huf_node-&gt;right = huf_node-&gt;rlink = <span class="literal">NULL</span>;</span><br><span class="line">temp_head-&gt;rlink = huf_node;</span><br><span class="line">temp_head = temp_head-&gt;rlink;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">huf_coding</span><span class="params">(huf_tree* root,string code)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (root-&gt;right==<span class="literal">NULL</span> || root-&gt;left==<span class="literal">NULL</span>)<span class="comment">//right=NULLleftNULL</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">root-&gt;left-&gt;code = code + <span class="string">&quot;0&quot;</span>;</span><br><span class="line"><span class="built_in">huf_coding</span>(root-&gt;left,root-&gt;left-&gt;code);      <span class="comment">//</span></span><br><span class="line"> </span><br><span class="line">root-&gt;right-&gt;code = code + <span class="string">&quot;1&quot;</span>;</span><br><span class="line"><span class="built_in">huf_coding</span>(root-&gt;right,root-&gt;right-&gt;code);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dis_code</span><span class="params">(huf_tree* root)</span><span class="comment">//</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (root == <span class="literal">NULL</span>)</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">if</span> (root-&gt;data &gt;= <span class="number">97</span> &amp;&amp; root-&gt;data &lt;= <span class="number">122</span>&amp;&amp;root-&gt;weight!=<span class="number">0</span>)<span class="comment">//</span></span><br><span class="line">&#123;                                                         <span class="comment">//</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;&#x27;%c&#x27; %-4d   &quot;</span>, root-&gt;data, root-&gt;weight);</span><br><span class="line">cout &lt;&lt; root-&gt;code &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">dis_code</span>(root-&gt;left);</span><br><span class="line"><span class="built_in">dis_code</span>(root-&gt;right);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="/2022/img/20220619003137.png" alt="img" style="zoom:67%;" />]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>:</title>
      <link href="/2022/06/19/%E5%85%AB%E7%9A%87%E5%90%8E%E5%9B%9E%E6%BA%AF%E7%AE%97%E6%B3%95/"/>
      <url>/2022/06/19/%E5%85%AB%E7%9A%87%E5%90%8E%E5%9B%9E%E6%BA%AF%E7%AE%97%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p><a href="https://www.bilibili.com/video/BV1ZK411K7A8?spm_id_from=333.999.0.0"></a></p><p></p><p>vectorvectornewnew<code></code></p></blockquote><p><strong><mark class="hl-label blue"></mark> </strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> dir_x[<span class="number">8</span>] = &#123; <span class="number">-1</span>, <span class="number">-1</span>, <span class="number">-1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span> &#125;;<span class="comment">//</span></span><br><span class="line"><span class="type">int</span> dir_y[<span class="number">8</span>] = &#123;  <span class="number">0</span> , <span class="number">1</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">1</span>,<span class="number">-1</span>, <span class="number">1</span>,<span class="number">-1</span> &#125;;</span><br><span class="line">              <span class="comment">//  L  LU  LD  R RU RD  U  D      LRD,U </span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">copy_attack</span><span class="params">(<span class="type">int</span>(*attack)[<span class="number">8</span>], <span class="type">int</span>(*temp)[<span class="number">8</span>])</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">update_attack</span><span class="params">(<span class="type">int</span>(*attack)[<span class="number">8</span>], <span class="type">int</span> i, <span class="type">int</span> k)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ini_att_que</span><span class="params">(<span class="type">int</span> (*attack)[<span class="number">8</span>], <span class="type">char</span> (*queen)[<span class="number">8</span>])</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">backtrack</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span>(*attack)[<span class="number">8</span>], <span class="type">char</span>(*queen)[<span class="number">8</span>])</span></span>;</span><br><span class="line"><span class="type">int</span> counts;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> attack[<span class="number">8</span>][<span class="number">8</span>];</span><br><span class="line"><span class="type">char</span> queen[<span class="number">8</span>][<span class="number">8</span>];</span><br><span class="line"><span class="built_in">ini_att_que</span>(attack, queen);</span><br><span class="line"><span class="built_in">backtrack</span>(<span class="number">0</span>, attack, queen);</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;&quot;</span> &lt;&lt; counts &lt;&lt; <span class="string">&quot;&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ini_att_que</span><span class="params">(<span class="type">int</span> (*attack)[<span class="number">8</span>], <span class="type">char</span> (*queen)[<span class="number">8</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">64</span>; i++)</span><br><span class="line">*(*attack + i) = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">64</span>; i++)</span><br><span class="line">*(*queen + i) = <span class="string">&#x27;#&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">backtrack</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span>(*attack)[<span class="number">8</span>], <span class="type">char</span>(*queen)[<span class="number">8</span>])</span><span class="comment">//n</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (n == <span class="number">8</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">8</span>; k++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%  c  &quot;</span>, queen[i][k]);</span><br><span class="line">cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;=====================================\n&quot;</span>);</span><br><span class="line">counts++;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> col = <span class="number">0</span>; col &lt; <span class="number">8</span>; col++)<span class="comment">//colcolumn</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (attack[n][col] == <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> temp[<span class="number">8</span>][<span class="number">8</span>];</span><br><span class="line"><span class="built_in">copy_attack</span>(attack,temp);<span class="comment">//attack</span></span><br><span class="line">queen[n][col] = <span class="string">&#x27;Q&#x27;</span>;<span class="comment">//</span></span><br><span class="line"><span class="built_in">update_attack</span>(attack, n, col);</span><br><span class="line"><span class="built_in">backtrack</span>(n + <span class="number">1</span>, attack, queen);<span class="comment">//</span></span><br><span class="line"><span class="built_in">copy_attack</span>(temp, attack);<span class="comment">//update_attackattack=temptemp()</span></span><br><span class="line">queen[n][col] = <span class="string">&#x27;#&#x27;</span>;     <span class="comment">//</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">copy_attack</span><span class="params">(<span class="type">int</span>(*attack)[<span class="number">8</span>],<span class="type">int</span>(*temp)[<span class="number">8</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">8</span>; k++)</span><br><span class="line">temp[i][k] = attack[i][k];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">update_attack</span><span class="params">(<span class="type">int</span>(*attack)[<span class="number">8</span>],<span class="type">int</span> i,<span class="type">int</span> k)</span><span class="comment">//ik</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> m = <span class="number">1</span>; m &lt; <span class="number">8</span>; m++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> g = <span class="number">0</span>; g &lt; <span class="number">8</span>; g++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> nx = i + m * dir_x[g];<span class="comment">//nxny</span></span><br><span class="line"><span class="type">int</span> ny = k + m * dir_y[g];</span><br><span class="line"><span class="keyword">if</span> (nx &gt;= <span class="number">0</span> &amp;&amp; nx &lt; <span class="number">8</span> &amp;&amp; ny &gt;= <span class="number">0</span> &amp;&amp; ny &lt; <span class="number">8</span>)</span><br><span class="line">&#123;</span><br><span class="line">attack[nx][ny] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><mark class="hl-label blue"></mark> </strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> n,  x[N], ret = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">canPut</span><span class="params">(<span class="type">int</span> m)</span></span>&#123;</span><br><span class="line"><span class="type">int</span> j;</span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;m;j++) <span class="comment">//jm</span></span><br><span class="line"><span class="keyword">if</span>(x[m]==x[j]  <span class="comment">//[m][i][m][j]</span></span><br><span class="line">|| <span class="built_in">abs</span>(j-m)==<span class="built_in">abs</span>(x[j]-x[m]))<span class="comment">//[m][i]j-m=; x[j]-x[m]=</span></span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">go</span><span class="params">(<span class="type">int</span> m)</span></span>&#123;</span><br><span class="line"><span class="type">int</span> i;</span><br><span class="line"><span class="keyword">if</span>(m&gt;n<span class="number">-1</span>)&#123; <span class="comment">//n-180m&gt;7</span></span><br><span class="line">ret++;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">cout&lt;&lt;x[i]&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;    &quot;</span>&lt;&lt;ret&lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++)&#123;<span class="comment">//</span></span><br><span class="line"></span><br><span class="line">x[m]=i;      <span class="comment">//x</span></span><br><span class="line"> <span class="comment">//mx[m]x[m]x[m]=i[m][i]x[m][m][i]</span></span><br><span class="line"> <span class="comment">//x[m]fmfx[m]=i[m][f]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">canPut</span>(m))<span class="comment">//</span></span><br><span class="line"><span class="built_in">go</span>(m+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> i,j;</span><br><span class="line">n=<span class="number">8</span>;</span><br><span class="line"><span class="built_in">go</span>(<span class="number">0</span>);</span><br><span class="line">cout&lt;&lt;ret;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>*+</strong></p><hr><p></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>constconstexpr</title>
      <link href="/2022/06/18/const%E4%B8%8Econstexpr/"/>
      <url>/2022/06/18/const%E4%B8%8Econstexpr/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>constexprC++11 ==== </p><p>const</p><p><strong><font color=#FF00FF> &quot;&quot;</font></strong></p><p>constconstexpr</p></blockquote><p><strong></strong> ()</p><blockquote><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> b = <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> a = b;</span><br></pre></td></tr></table></figure><p>aa</p><p>a:</p><p><code>a = 20;//a</code></p><p></p><p><code>int* pa = (int*)&amp;a;</code></p><p><code>*pa = 30;//a30.</code></p><p>C++const()(const int a = b;) ()const int a = 10;</p></blockquote><p><strong></strong> </p><blockquote><p><code>constexpr int a = 10;</code></p><p><strong><font color=#FF00FF>aa10()</font></strong></p><p>constexpr= ()</p></blockquote><p><strong><font color=#00FFFF>C++constexprconst</font></strong></p><p>C++Cconst  <strong><font color='orange'></font></strong> constconstconstexpr</p><blockquote><p>const int a = 10;//</p><p>constexpr int a = 10;//,a</p><p></p><p>int b = 10;</p><p>const int a = b;//</p><p>const int a = 10//</p><p> <strong><font color='gree'></font></strong>  <strong><font color='gree'></font></strong> <a href="http://www.bubuko.com/infodetail-3446312.html"></a></p><p></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> k;</span><br><span class="line">cin&gt;&gt;k;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> a = <span class="built_in">max</span>(k,<span class="number">10</span>);</span><br></pre></td></tr></table></figure><p>ak</p><p>a(k)Caa</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> size = <span class="number">10</span>;</span><br><span class="line"><span class="type">int</span> arr[size] = &#123;<span class="number">0</span>&#125;; <span class="comment">//</span></span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> a = <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> size = a;</span><br><span class="line"><span class="type">int</span> arr[size] = &#123;<span class="number">0</span>&#125;; <span class="comment">//a</span></span><br></pre></td></tr></table></figure></blockquote><p><code>const</code><code>constexpr</code><code>#define</code></p><ul><li><p>const</p><p>1.const&quot;&quot;()</p><p>2.const</p><p>3.</p></li><li><p>constexpr</p><ol><li><p>constexpr&quot;&quot;</p></li><li><p><strong>constexpr </strong></p></li></ol></li><li><p></p><p>1.</p><p>2.</p><p>3.define</p></li></ul><hr><p></p>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>kruskal</title>
      <link href="/2022/06/18/kruskal%E7%AE%97%E6%B3%95%E5%89%96%E6%9E%90/"/>
      <url>/2022/06/18/kruskal%E7%AE%97%E6%B3%95%E5%89%96%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="font-color-red---font"><font color='red'>.</font></h3><img src="/2022/img/20220618230130.png" alt="img" style="zoom: 33%;" /><p>66</p><h3 id="font-color-red---font"><font color='red'>.</font></h3><ol><li>edge</li></ol><p><img src="/2022/img/20220618230116.png" alt="img" style="zoom:33%;" /> <img src="/2022/img/20220618230124.png" alt="img" style="zoom:33%;" /></p><ol start="2"><li><p></p><blockquote><p><font color=#FF00FF>-1</font></p></blockquote></li><li><p>edge</p><blockquote><p><font color=#00FFFF></font></p></blockquote></li><li><p>-1Minimum Spanning Tree</p><blockquote><p>nn-1</p></blockquote></li></ol><h3 id="font-color-red---font"><font color='red'>. </font></h3><p></p><ul><li></li><li></li></ul><blockquote><p>,,,,</p><p>-1</p></blockquote><h3 id="font-color-red---font"><font color='red'>. </font></h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX_VEX  10</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX_EDGE 100  <span class="comment">//10100</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TYPE int</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span>  <span class="comment">//</span></span><br><span class="line">&#123;</span><br><span class="line">TYPE start;</span><br><span class="line">TYPE end;</span><br><span class="line">TYPE weight;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ini_gragh</span><span class="params">(<span class="type">int</span>&amp; vex, <span class="type">int</span>&amp; edge, Edge* gragh)</span></span>;<span class="comment">//</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sort_edge</span><span class="params">(Edge* edges,<span class="type">int</span> edge)</span></span>;<span class="comment">//</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find_root</span><span class="params">(<span class="type">int</span> parent[], <span class="type">int</span> n)</span></span>;<span class="comment">//</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> vex; <span class="comment">//</span></span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> edge; <span class="comment">//</span></span><br><span class="line"> </span><br><span class="line">Edge gragh[MAX_EDGE];</span><br><span class="line"> </span><br><span class="line"><span class="built_in">ini_gragh</span>(vex, edge, gragh);<span class="comment">//</span></span><br><span class="line"> </span><br><span class="line"><span class="built_in">sort_edge</span>(gragh, edge);<span class="comment">//</span></span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> roots[MAX_VEX];  <span class="comment">//</span></span><br><span class="line"> </span><br><span class="line">Edge MST[MAX_EDGE];   <span class="comment">//minimum spanning tree</span></span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> count = <span class="number">0</span>;  </span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; vex; i++)</span><br><span class="line">roots[i] = <span class="number">-1</span>;  <span class="comment">//root-1</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; MAX_EDGE; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> vex_m = <span class="built_in">find_root</span>(roots, gragh[i].start);<span class="comment">//</span></span><br><span class="line"><span class="type">int</span> vex_n = <span class="built_in">find_root</span>(roots, gragh[i].end);<span class="comment">//</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> (vex_m != vex_n)<span class="comment">//</span></span><br><span class="line">&#123;</span><br><span class="line">MST[count] = gragh[i];<span class="comment">//MST</span></span><br><span class="line">count++;</span><br><span class="line">roots[vex_m] = vex_n;<span class="comment">//vex_nvex_m</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (count == vex<span class="number">-1</span>)<span class="comment">//count-1</span></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; vex - <span class="number">1</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;(%d,%d)%d\n&quot;</span>, MST[i].start, MST[i].end, MST[i].weight);   <span class="comment">//</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ini_gragh</span><span class="params">(<span class="type">int</span>&amp; vex, <span class="type">int</span>&amp; edge, Edge* gragh)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;&quot;</span>;</span><br><span class="line">cin &gt;&gt; vex;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">cin &gt;&gt; edge;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;()&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; edge; i++)</span><br><span class="line">&#123;</span><br><span class="line">cin &gt;&gt; gragh[i].start &gt;&gt; gragh[i].end &gt;&gt; gragh[i].weight;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sort_edge</span><span class="params">(Edge* edges_arr,<span class="type">int</span> edge)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Edge temp;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; edge; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; edge - i - <span class="number">1</span>; k++)<span class="comment">//1</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (edges_arr[k].weight &gt; edges_arr[k + <span class="number">1</span>].weight)</span><br><span class="line">&#123;</span><br><span class="line">temp = edges_arr[k];</span><br><span class="line">edges_arr[k] = edges_arr[k + <span class="number">1</span>];</span><br><span class="line">edges_arr[k + <span class="number">1</span>] = temp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find_root</span><span class="params">(<span class="type">int</span> roots[], <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">while</span> (roots[n] &gt; <span class="number">-1</span>)  <span class="comment">//</span></span><br><span class="line">n = roots[n];</span><br><span class="line"><span class="keyword">return</span> n;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><img src="/2022/img/20220618230100.png" alt="img" style="zoom: 50%;" /><hr><p></p>]]></content>
      
      
      <categories>
          
          <category>  </category>
          
          <category>  </category>
          
      </categories>
      
      
        <tags>
            
            <tag>  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++11</title>
      <link href="/2022/06/18/%E6%A8%A1%E6%9D%BF%E5%8F%AF%E5%8F%98%E5%8F%82%E6%95%B0%E6%89%A9%E5%B1%95%E5%8C%85/"/>
      <url>/2022/06/18/%E6%A8%A1%E6%9D%BF%E5%8F%AF%E5%8F%98%E5%8F%82%E6%95%B0%E6%89%A9%E5%B1%95%E5%8C%85/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p><br><br><a href="http://c.biancheng.net/view/vip_8692.html">C++11 </a></p></blockquote><h2 id="-">.</h2><ul><li><p></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T,<span class="keyword">typename</span> ...args&gt;<span class="comment">// ... args  </span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">vir_fun</span><span class="params">(T args, args... argv)</span><span class="comment">//... argv</span></span></span><br><span class="line"><span class="function"></span>&#123;                                 <span class="comment">// ... </span></span><br><span class="line">    cout&lt;&lt;argc&lt;&lt;endl;</span><br><span class="line">    <span class="built_in">vir_fun</span>(argv...);<span class="comment">//.........</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>argsargv<br>argsT <strong><font color='red'>args()</font></strong> 9 <strong><font color='red'>1argv()</font></strong> </p></li><li><p>12,<br>====</p></li></ul><h2 id="-">.</h2><ul><li><p>+vir_fun()</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">vir_fun</span>(<span class="number">12</span>, <span class="string">&quot;aha&quot;</span>, <span class="number">12.34</span>, <span class="number">10</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>12 argcargv <br>argv</p><img src="https://img-blog.csdnimg.cn/7793cc15e78d4efabe526fb2001f09df.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA55So5pe26Ze05Y675rKJ5reA,size_17,color_FFFFFF,t_70,g_se,x_16" alt="img" style="zoom:50%;" /></li><li><p>,vir_fun(),argv(12)&quot;haa&quot;+(12.34+10)<br>(12.34+10)+</p></li><li><p>  </p><p><img src="/2022/img/20220618215511.png" alt="img" style="zoom:50%;" />(13argv)</p><p><code></code> <strong><font color=#FF00FF>+</font></strong> 1argv<code>&quot;haa&quot;+argv1</code></p></li><li><p>sizeof</p><img src="/2022/img/20220618215702.png" alt="img" style="zoom:50%;" /><p></p><img src="/2022/img/20220618215815.png" alt="img" style="zoom:80%;" /><p>1</p></li></ul><hr><p></p>]]></content>
      
      
      <categories>
          
          <category> C++ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
